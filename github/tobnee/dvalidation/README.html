<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a href="https://github.com/tobnee/dvalidation#dvalidation" aria-hidden="true" class="anchor" id="user-content-dvalidation" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>DValidation</h1> 
  <p>DValidation is a little, opinionated domain object validation toolkit on top of <a href="https://github.com/scalaz/scalaz" target="_blank">scalaz</a>. While scalaz already offers the great <a href="http://eed3si9n.com/learning-scalaz/Validation.html" target="_blank">Validation</a> abstractions for building, composing and transforming validations it is a very general tool.</p> 
  <p>DValidation tries to be more opinionated with the goal to offer tools for common validation situations including:</p> 
  <ul> 
   <li>A set of built-in specific and generic <a href="https://github.com/tobnee/dvalidation#default-validators" target="_blank">validators</a></li> 
   <li>A custom error aggregation type (DomainErrors)</li> 
   <li>An abstract, translation friendly error type (DomainError)</li> 
   <li>A set of classes representing common error cases (IsEmptyStringError, IsNotGreaterThenError, ...)</li> 
   <li>A Path abstraction for locating errors in a class hierarchy</li> 
   <li><a href="https://github.com/tobnee/dvalidation#standard-library-conversions" target="_blank">Converters</a> from other error representations</li> 
   <li><a href="https://github.com/tobnee/dvalidation#customize-error-values-with-errormaps" target="_blank">Tools</a> for creating domain specific error types</li> 
   <li><a href="https://github.com/tobnee/DValidation/blob/3abf6ed0580281799e9b20a573be714fed88d90e/src/test/scala/net/atinu/dvalidation/DValidationSpec.scala#L224-L230" target="_blank">Utilities</a> to support testing validations</li> 
  </ul> 
  <p><a href="https://camo.githubusercontent.com/5787cdfc095d8175bef4429f0a8b07ac99e77438/68747470733a2f2f7472617669732d63692e6f72672f746f626e65652f4456616c69646174696f6e2e7376673f6272616e63683d6d6173746572" target="_blank"><img src="https://camo.githubusercontent.com/5787cdfc095d8175bef4429f0a8b07ac99e77438/68747470733a2f2f7472617669732d63692e6f72672f746f626e65652f4456616c69646174696f6e2e7376673f6272616e63683d6d6173746572" alt="&quot;Build Status&quot;" data-canonical-src="https://travis-ci.org/tobnee/DValidation.svg?branch=master" style="max-width:100%;"></a></p> 
  <h2><a href="https://github.com/tobnee/dvalidation#getting-dvalidation" aria-hidden="true" class="anchor" id="user-content-getting-dvalidation" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Getting DValidation</h2> 
  <p>DValidation is available via the Sonatype OSS repository:</p> 
  <pre><code>resolvers += Resolver.sonatypeRepo("releases")
</code></pre> 
  <p>The current release targets the Scala 2.10.x and 2.11.x series together with scalaz 7.0.6 or 7.1.0.</p> 
  <pre><code>libraryDependencies += "net.atinu" %% "dvalidation" % "0.2"
libraryDependencies += "org.scalaz" %% "scalaz-core" % "7.1.0"
</code></pre> 
  <h2><a href="https://github.com/tobnee/dvalidation#basic-usage" aria-hidden="true" class="anchor" id="user-content-basic-usage" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Basic Usage</h2> 
  <p>Lets start with this simple domain model:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">trait</span> <span class="pl-en">Classification</span>
<span class="pl-k">case</span> <span class="pl-k">object</span> <span class="pl-en">StringInstrument</span> <span class="pl-k">extends</span> <span class="pl-e">Classification</span>
<span class="pl-k">case</span> <span class="pl-k">object</span> <span class="pl-en">Keyboard</span> <span class="pl-k">extends</span> <span class="pl-e">Classification</span>

<span class="pl-k">abstract</span> <span class="pl-k">class</span> <span class="pl-en">Instrument</span>(<span class="pl-k">val</span> <span class="pl-en">classification</span><span class="pl-k">:</span> <span class="pl-en">Classification</span>)
<span class="pl-k">case</span> <span class="pl-k">object</span> <span class="pl-en">BassGuitar</span> <span class="pl-k">extends</span> <span class="pl-e">Instrument</span>(<span class="pl-en">StringInstrument</span>)
<span class="pl-k">case</span> <span class="pl-k">object</span> <span class="pl-en">Guitar</span> <span class="pl-k">extends</span> <span class="pl-e">Instrument</span>(<span class="pl-en">StringInstrument</span>)
<span class="pl-k">case</span> <span class="pl-k">object</span> <span class="pl-en">Piano</span> <span class="pl-k">extends</span> <span class="pl-e">Instrument</span>(<span class="pl-en">Keyboard</span>)

<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Musician</span>(<span class="pl-v">name</span>: <span class="pl-k">String</span>, <span class="pl-v">age</span>: <span class="pl-k">Int</span>, <span class="pl-v">instruments</span>: <span class="pl-en">Seq</span>[<span class="pl-en">Instrument</span>])</pre>
  </div> 
  <p>A way to get started with DValidation is to define an ad-hoc validation using the predefined combinators:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">mikael</span> <span class="pl-k">=</span> <span class="pl-en">Musician</span>(<span class="pl-s"><span class="pl-pds">"</span>Mikael Åkerfeldt<span class="pl-pds">"</span></span>, <span class="pl-c1">40</span>, <span class="pl-en">List</span>(<span class="pl-en">Guitar</span>, <span class="pl-en">BassGuitar</span>))
<span class="pl-k">val</span> <span class="pl-en">martin</span> <span class="pl-k">=</span> <span class="pl-en">Musician</span>(<span class="pl-s"><span class="pl-pds">"</span>Martin Mendez<span class="pl-pds">"</span></span>, <span class="pl-c1">17</span>, <span class="pl-en">List</span>(<span class="pl-en">BassGuitar</span>))

<span class="pl-k">val</span> <span class="pl-en">res</span><span class="pl-k">:</span> <span class="pl-en">DValidation</span>[<span class="pl-en">Musician</span>] <span class="pl-k">=</span> mikael.validateWith(
  notBlank(mikael.name) forAttribute <span class="pl-en">'name</span>,
  ensure(mikael.age)(<span class="pl-s"><span class="pl-pds">"</span>error.dvalidation.legalage<span class="pl-pds">"</span></span>, <span class="pl-c1">18</span>)(_ <span class="pl-k">&gt;</span> <span class="pl-c1">18</span>) forAttribute <span class="pl-en">'age</span>,
  hasElements(mikael.instruments) forAttribute <span class="pl-en">'instruments</span>
)</pre>
  </div> 
  <p>The object <em>mikael</em> is valid and therefore the validation will result in a <em>Success</em>:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">Success</span>(<span class="pl-en">User</span>(<span class="pl-en">Mikael</span> Åkerfeldt,<span class="pl-c1">40</span>))</pre>
  </div> 
  <p><em>martin</em> on the other hand is too young which is also reflected in the validation result:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">Failure</span>(<span class="pl-en">DomainError</span>(<span class="pl-v">path</span>: <span class="pl-k">/</span>age, <span class="pl-v">value</span>: <span class="pl-c1">17</span>, <span class="pl-v">msgKey</span>: error.dvalidation.legalage, <span class="pl-v">args</span>: <span class="pl-c1">18</span>))</pre>
  </div> 
  <h2><a href="https://github.com/tobnee/dvalidation#templated-validation" aria-hidden="true" class="anchor" id="user-content-templated-validation" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Templated Validation</h2> 
  <p>The definition of reusable validations can be achieved using a <em>DValidator</em> which can be defined as follows:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">musicianValidator</span><span class="pl-k">:</span> <span class="pl-en">DValidator</span>[<span class="pl-en">Musician</span>] <span class="pl-k">=</span> <span class="pl-en">Validator</span>.template[<span class="pl-en">Musician</span>] { musician <span class="pl-k">=&gt;</span>
  musician.validateWith(
  notBlank(musician.name) forAttribute <span class="pl-en">'name</span>,
  ensure(musician.age)(key <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>error.dvalidation.legalage<span class="pl-pds">"</span></span>, args <span class="pl-k">=</span> <span class="pl-c1">18</span>)(_ <span class="pl-k">&gt;</span> <span class="pl-c1">18</span>) forAttribute <span class="pl-en">'age</span>,
  hasElements(musician.instruments) forAttribute <span class="pl-en">'instruments</span>
 )
}
musicianValidator(mikael)
musicianValidator(martin)</pre>
  </div> 
  <h2><a href="https://github.com/tobnee/dvalidation#sequence-validation" aria-hidden="true" class="anchor" id="user-content-sequence-validation" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Sequence Validation</h2> 
  <p>A common issue when validating business objects is the validation of sequences since errors are either global or have to be mapped to a specific element. In the example the <code>hasElements</code> combinator is used to define a global validation rule. <code>validSequence</code> is a combinator which applies a given validation to all elements of a sequence. The <code>withValidations</code> combinator will include the resulting sequence of <code>DValidations</code> in the parent validation context.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">max</span> <span class="pl-k">=</span> <span class="pl-en">Musician</span>(<span class="pl-s"><span class="pl-pds">"</span>Max Mustermann<span class="pl-pds">"</span></span>, <span class="pl-c1">29</span>, <span class="pl-en">List</span>(<span class="pl-en">Piano</span>, <span class="pl-en">Guitar</span>))

<span class="pl-k">val</span> <span class="pl-en">stringInstrumentValidator</span> <span class="pl-k">=</span> <span class="pl-en">Validator</span>.template[<span class="pl-en">Instrument</span>](i <span class="pl-k">=&gt;</span>
  ensure(i)(
   key <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>error.dvalidation.stringinstrument<span class="pl-pds">"</span></span>, 
   args <span class="pl-k">=</span> i.classification)(_.classification <span class="pl-k">==</span> <span class="pl-en">StringInstrument</span>)
)

max.validateWith(
  notBlank(max.name) forAttribute <span class="pl-en">'name</span>,
  ensure(max.age)(<span class="pl-s"><span class="pl-pds">"</span>error.dvalidation.legalage<span class="pl-pds">"</span></span>, <span class="pl-c1">18</span>)(_ <span class="pl-k">&gt;</span> <span class="pl-c1">18</span>) forAttribute <span class="pl-en">'age</span>,
  hasElements(max.instruments) forAttribute <span class="pl-en">'instruments</span>
).withValidations(
  validSequence(max.instruments, stringInstrumentValidator) forAttribute <span class="pl-en">'instruments</span>
)</pre>
  </div> 
  <p>This validation will result in one <code>DomainError</code> with a path indicating the position in the sequence.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">Failure</span>(<span class="pl-en">DomainError</span>(<span class="pl-v">path</span>: <span class="pl-k">/</span>instruments<span class="pl-k">/</span>[<span class="pl-c1">0</span>], <span class="pl-v">value</span>: <span class="pl-en">Piano</span>, <span class="pl-v">msgKey</span>: error.dvalidation.stringinstrument, <span class="pl-v">args</span>: <span class="pl-en">Keyboard</span>))</pre>
  </div> 
  <h2><a href="https://github.com/tobnee/dvalidation#default-validators" aria-hidden="true" class="anchor" id="user-content-default-validators" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Default Validators</h2> 
  <table> 
   <thead> 
    <tr> 
     <th>Validator</th> 
     <th>Syntax</th> 
     <th>Works for</th> 
     <th>Example</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td>notBlank</td> 
     <td></td> 
     <td>String</td> 
     <td>notBlank("a") or notBlank(" ", trimWhitespace = true)</td> 
    </tr> 
    <tr> 
     <td>notZero</td> 
     <td></td> 
     <td><em>scalaz.Monoid</em></td> 
     <td></td> 
    </tr> 
    <tr> 
     <td>hasElements</td> 
     <td></td> 
     <td>Traversable</td> 
     <td>hasElements(List(1,2,3))</td> 
    </tr> 
    <tr> 
     <td>isSome</td> 
     <td></td> 
     <td>Option</td> 
     <td>isSome(Option(2))</td> 
    </tr> 
    <tr> 
     <td>isTrySuccess</td> 
     <td></td> 
     <td>Try</td> 
     <td>isTrySuccess(Try{ "bla" })</td> 
    </tr> 
    <tr> 
     <td>isEqual</td> 
     <td>is_==</td> 
     <td><em>scalaz.Order</em></td> 
     <td>1 is_== 1</td> 
    </tr> 
    <tr> 
     <td>isEqualStrict</td> 
     <td>is_===</td> 
     <td><em>scalaz.Order</em></td> 
     <td>1 is_=== 1</td> 
    </tr> 
    <tr> 
     <td>isGreaterThan</td> 
     <td>is_&gt; / is_&gt;=</td> 
     <td><em>scalaz.Order</em></td> 
     <td>2 is_&gt; 1</td> 
    </tr> 
    <tr> 
     <td>isSmallerThan</td> 
     <td>is_&lt; / is_&lt;</td> 
     <td><em>scalaz.Order</em></td> 
     <td>1 is_&lt; 2</td> 
    </tr> 
    <tr> 
     <td>isInRange</td> 
     <td></td> 
     <td><em>scalaz.Order</em></td> 
     <td>isInRange(4, min = 1, max = 5)</td> 
    </tr> 
    <tr> 
     <td>hasSize</td> 
     <td></td> 
     <td><em>dvalidation.Sized</em></td> 
     <td>hasSize(List(1, 2, 3), min = 4)</td> 
    </tr> 
    <tr> 
     <td>hasLength</td> 
     <td></td> 
     <td>String</td> 
     <td>hasLength("1", min = 1)</td> 
    </tr> 
    <tr> 
     <td><em>italic</em> types are required implicit views</td> 
     <td></td> 
     <td></td> 
     <td></td> 
    </tr>
   </tbody>
  </table> 
  <h2><a href="https://github.com/tobnee/dvalidation#higher-order-validators" aria-hidden="true" class="anchor" id="user-content-higher-order-validators" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Higher Order Validators</h2> 
  <p>Validation often get applied to data which lives in a context. The state of the context now becomes a requirement for a successful validation. If for example an <code>Option[String]</code> is used to represent an optional academic title a validation expects the <code>String</code> to be non empty if the <code>Option</code> is a <code>Some</code>. To support those use cases higher order validators have been introduces for <code>Option</code> and <code>Try</code>. With this tool the <em>academic title</em> example can be solved like this:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">academicTitle</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-k">String</span>] <span class="pl-k">=</span> <span class="pl-en">Some</span>(<span class="pl-s"><span class="pl-pds">"</span>Dr.<span class="pl-pds">"</span></span>)
validOptRequired(academicTitle)(title <span class="pl-k">=&gt;</span> notBlank(title)) </pre>
  </div> 
  <h2><a href="https://github.com/tobnee/dvalidation#define-custom-validators" aria-hidden="true" class="anchor" id="user-content-define-custom-validators" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Define Custom Validators</h2> 
  <p>The ensure combinator offers a simple approach how to define a custom validator.</p> 
  <div class="highlight highlight-source-scala">
   <pre> <span class="pl-k">def</span> <span class="pl-en">isEqual</span>[<span class="pl-en">T</span>](<span class="pl-v">valueCheck</span>: <span class="pl-en">T</span>, <span class="pl-v">valueExcept</span>: <span class="pl-en">T</span>)<span class="pl-k">:</span> <span class="pl-en">DValidation</span>[<span class="pl-en">T</span>] <span class="pl-k">=</span>
    ensure(valueCheck)(<span class="pl-s"><span class="pl-pds">"</span>error.dvalidation.isequal<span class="pl-pds">"</span></span>, valueExcept)(a <span class="pl-k">=&gt;</span> a <span class="pl-k">==</span> valueExcept)</pre>
  </div> 
  <h2><a href="https://github.com/tobnee/dvalidation#customize-error-values-with-errormaps" aria-hidden="true" class="anchor" id="user-content-customize-error-values-with-errormaps" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Customize error values with ErrorMaps</h2> 
  <p>DValidation offers generic validators which are only useful when applied to a concrete class or use case. For example the isSmallerThan validator works for all instances with a defined <code>scalaz.Order</code> type class. A validation for Java 8 java.time.LocalDateTime for example would look like this:</p> 
  <div class="highlight highlight-source-scala">
   <pre>  <span class="pl-k">object</span> <span class="pl-en">DateValidation</span> {
    <span class="pl-k">private</span> <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">lDtOrder</span> <span class="pl-k">=</span> scalaz.<span class="pl-en">Order</span>.order[<span class="pl-en">LocalDateTime</span>]((a, b) <span class="pl-k">=&gt;</span>
      <span class="pl-k">if</span> (a.isBefore(b)) <span class="pl-en">Ordering</span>.<span class="pl-en">LT</span> <span class="pl-k">else</span> <span class="pl-en">Ordering</span>.<span class="pl-en">GT</span>)
    
    <span class="pl-k">val</span> <span class="pl-en">inPast</span> <span class="pl-k">=</span> <span class="pl-en">Validator</span>.template[<span class="pl-en">LocalDateTime</span>](_ is_<span class="pl-k">&lt;</span> <span class="pl-en">LocalDateTime</span>.now())
    <span class="pl-k">val</span> <span class="pl-en">inFuture</span> <span class="pl-k">=</span> <span class="pl-en">Validator</span>.template[<span class="pl-en">LocalDateTime</span>](_ is_<span class="pl-k">&gt;</span> <span class="pl-en">LocalDateTime</span>.now())
  }</pre>
  </div> 
  <p>Since <code>isSmallerThen</code> does not know for which class the validation was done, the validator can only yield an <code>IsNotLowerThenError</code>. This is not an optimal situation if specific translations have to be presented to the user or if business logic should is bound to this error scenario.</p> 
  <p>DValidation offers so called <code>ErrorMaps</code> to map the generic error value of a validator to a use case specific error representation. In the context of the date validation this could look like this:</p> 
  <div class="highlight highlight-source-scala">
   <pre>  <span class="pl-k">object</span> <span class="pl-en">DateValidation</span> {
    <span class="pl-k">private</span> <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">lDtOrder</span> <span class="pl-k">=</span> scalaz.<span class="pl-en">Order</span>.order[<span class="pl-en">LocalDateTime</span>]((a, b) <span class="pl-k">=&gt;</span>
      <span class="pl-k">if</span> (a.isBefore(b)) <span class="pl-en">Ordering</span>.<span class="pl-en">LT</span> <span class="pl-k">else</span> <span class="pl-en">Ordering</span>.<span class="pl-en">GT</span>)
    <span class="pl-k">private</span> <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">toInPastError</span> <span class="pl-k">=</span> <span class="pl-en">ErrorMap</span>.mapKey[<span class="pl-en">IsNotLowerThenError</span>](<span class="pl-s"><span class="pl-pds">"</span>dvalidaiton.dateInPast<span class="pl-pds">"</span></span>)
    <span class="pl-k">private</span> <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">toInFutureError</span> <span class="pl-k">=</span> <span class="pl-en">ErrorMap</span>.mapKey[<span class="pl-en">IsNotGreaterThenError</span>](<span class="pl-s"><span class="pl-pds">"</span>dvalidaiton.dateInFuture<span class="pl-pds">"</span></span>)

    <span class="pl-k">val</span> <span class="pl-en">inPast</span> <span class="pl-k">=</span> <span class="pl-en">Validator</span>.template[<span class="pl-en">LocalDateTime</span>](_ is_<span class="pl-k">&lt;</span> <span class="pl-en">LocalDateTime</span>.now())
    <span class="pl-k">val</span> <span class="pl-en">inFuture</span> <span class="pl-k">=</span> <span class="pl-en">Validator</span>.template[<span class="pl-en">LocalDateTime</span>](_ is_<span class="pl-k">&gt;</span> <span class="pl-en">LocalDateTime</span>.now())
  }</pre>
  </div> 
  <h2><a href="https://github.com/tobnee/dvalidation#use-applicative-validation" aria-hidden="true" class="anchor" id="user-content-use-applicative-validation" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Use Applicative Validation</h2> 
  <p><em>scalaz Validation</em> offers an applicative validation style with which validations can be composed and mapped to a larger validation. In this aspect the applicative validation is similar to the common validation style of DValidation, with the difference that the mapping from element validations to a bigger validation is done explicitly via a mapping function. Because of this the applicative validation style is potentially more type safe, if the <code>apply</code> function of a case class is used. The cost of this style is the fixed structure of the expected validations, which can lead to more complicated validation code.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">musicianValidatorApplicative</span> <span class="pl-k">=</span> <span class="pl-en">Validator</span>.template[<span class="pl-en">Musician</span>] { musician <span class="pl-k">=&gt;</span>
  <span class="pl-k">val</span> <span class="pl-en">stringInstrument</span> <span class="pl-k">=</span> validSequence(musician.instruments, stringInstrumentValidator).collapse
  <span class="pl-k">val</span> <span class="pl-en">atLeastOneString</span> <span class="pl-k">=</span> stringInstrument.disjunction
      .flatMap(value <span class="pl-k">=&gt;</span> hasElements(value).disjunction).validation
  <span class="pl-k">val</span> <span class="pl-en">hasLegalAge</span> <span class="pl-k">=</span> ensure(musician.age)(key <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>error.dvalidation.legalage<span class="pl-pds">"</span></span>, args <span class="pl-k">=</span> <span class="pl-c1">18</span>)(_ <span class="pl-k">&gt;</span> <span class="pl-c1">18</span>)

  ((notBlank(musician.name) forAttribute <span class="pl-en">'name</span>) <span class="pl-k">|@|</span>
   (hasLegalAge forAttribute <span class="pl-en">'age</span>) <span class="pl-k">|@|</span>
   (atLeastOneString forAttribute <span class="pl-en">'instruments</span>))(<span class="pl-en">Musician</span>.apply)
}</pre>
  </div> 
  <h2><a href="https://github.com/tobnee/dvalidation#standard-library-conversions" aria-hidden="true" class="anchor" id="user-content-standard-library-conversions" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Standard Library Conversions</h2> 
  <p>DValidation offers conversions between Scala standard library types and DValidation.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">Some</span>(<span class="pl-c1">1</span>).asValidation
<span class="pl-c"><span class="pl-c">//</span> =&gt; Success(1)</span>

<span class="pl-k">val</span> <span class="pl-en">opt</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-k">Int</span>] <span class="pl-k">=</span> <span class="pl-c1">None</span>
opt.asValidation
<span class="pl-c"><span class="pl-c">//</span> =&gt; Failure(DomainError(path: /, value: None, msgKey: error.dvalidation.isNone))</span>

scala.util.<span class="pl-en">Success</span>(<span class="pl-c1">1</span>).asValidation
<span class="pl-c"><span class="pl-c">//</span> =&gt; Success(1)</span>

<span class="pl-k">val</span> <span class="pl-en">exception</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">IllegalArgumentException</span>
scala.util.<span class="pl-en">Failure</span>(exception).asValidation
<span class="pl-c"><span class="pl-c">//</span> =&gt; Failure(DomainError(path: /, value: java.lang.IllegalArgumentException, msgKey: error.dvalidation.isTryFailue))</span></pre>
  </div> 
  <h2><a href="https://github.com/tobnee/dvalidation#dvalidation-internals" aria-hidden="true" class="anchor" id="user-content-dvalidation-internals" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>DValidation Internals</h2> 
  <p>A <code>DValidation</code> and <code>DValidator</code> are defined as follows:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">type</span> <span class="pl-en">DValidation</span>[<span class="pl-en">T</span>] <span class="pl-k">=</span> scalaz.<span class="pl-en">Validation</span>[<span class="pl-en">DomainErrors</span>, <span class="pl-en">T</span>]
<span class="pl-k">type</span> <span class="pl-en">DValidator</span>[<span class="pl-en">T</span>] <span class="pl-k">=</span> <span class="pl-en">T</span> <span class="pl-k">=&gt;</span> <span class="pl-en">DValidation</span>[<span class="pl-en">T</span>]</pre>
  </div> 
  <p>In other words, in the failure case of a <code>scalaz.Valdation</code> the <code>DomainErrors</code> type is used, which itself is a list of at least one DomainError. This type has attributes which allow clients to handle errors appropriately. The <code>path</code> attribute helps to map an error to the domain object which is responsible for the error. The <code>value</code> attribute will return the value of the validated attribute. Together with the <code>msgKey</code> and <code>args</code> attributes clients can build language specific error messages, which can be represented to users.</p> 
  <p>The library packages some predefined type of DomainErrors like <code>IsEmptySeqError</code> which already chooses appropriate value and msgKey values.</p> 
 </article>
</div>