<div class="announce instapaper_body md" data-path="Readme.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-an-sbt-plugin-for-bdd-testing-cucumber-and-scala" class="anchor" href="https://github.com/lewismj/cucumber#an-sbt-plugin-for-bdd-testing-cucumber-and-scala" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>An SBT Plugin For BDD Testing (Cucumber And Scala)</h1> 
  <h2><a id="user-content-update" class="anchor" href="https://github.com/lewismj/cucumber#update" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Update</h2> 
  <p>The plugin &amp; runner (described below) should now be available from the <a href="http://search.maven.org/#search%7Cga%7C1%7Cwaioeka" target="_blank">central repository</a></p> 
  <p>The latest version of the cucumber plugin is 0.1.0, the runner is 0.0.5</p> 
  <h2><a id="user-content-introduction" class="anchor" href="https://github.com/lewismj/cucumber#introduction" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Introduction</h2> 
  <p>Many Scala projects will use the FlatSpec for their BDD like testing. Some teams prefer the separation of Feature files from the code. </p> 
  <p>The support for Cucumber with Scala is quite mixed. There is an existing plugin <a href="https://github.com/skipoleschris/xsbt-cucumber-plugin" target="_blank">xsbt-cucumber-plugin</a> but this plugin has a few issues. </p> 
  <p>Firstly, it does not work on Windows (Classpath separator is incorrect). It uses the old SBT plugin interface and hasn’t been updated for some time. The author hasn’t responded to pull requests.</p> 
  <p>There are two core projects, each has an example proejct illustrating the usage. </p> 
  <ul> 
   <li>cucumber-plugin</li> 
   <li>cucumber-runner</li> 
  </ul> 
  <p>The first provides a Cucumber plugin. This allow you to write <code>sbt cucumber</code> and invoke the Cucumber tests in a standalone JVM.</p> 
  <p>The second allows you to run <code>sbt test</code> and have the supplied test framework run the Cucumber tests. </p> 
  <p>Both are effectively wrappers for Cucumber with different launch mechanisms.</p> 
  <p>The code is very early in development, just a few hours were spent putting together the core functionality we required. </p> 
  <p>I would greatly welcome anyone that wants to help create a more fully featured (and bug free) version.</p> 
  <h2><a id="user-content-contact" class="anchor" href="https://github.com/lewismj/cucumber#contact" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Contact</h2> 
  <p>Michael Lewis, lewismj at waioeka.com</p> 
  <h2><a id="user-content-details" class="anchor" href="https://github.com/lewismj/cucumber#details" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Details</h2> 
  <h3><a id="user-content-cucumber-plugin" class="anchor" href="https://github.com/lewismj/cucumber#cucumber-plugin" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>cucumber-plugin</h3> 
  <p>Note: You only need to do the following if you want to build the plugin from source yourself. The plugin is now available from the Central Repository. i.e. In your end application just have</p> 
  <pre><code>addSbtPlugin("com.waioeka.sbt" % "cucumber-plugin" % "0.1.0")
</code></pre> 
  <p>in your plugins.sbt file.</p> 
  <p>If building from source locally, from your local Nexus repo, run the following.</p> 
  <pre><code>sbt compile
sbt publishLocal
</code></pre> 
  <p>You are now ready to use the plugin to run feature file tests. Start by looking at the test project cucumber-plugin-example.</p> 
  <h3><a id="user-content-cucumber-plugin-example" class="anchor" href="https://github.com/lewismj/cucumber#cucumber-plugin-example" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>cucumber-plugin-example</h3> 
  <p>After you have built and published the plugin. You can view an example use case by building and running the plugin example.</p> 
  <p>sbt compile sbt cucumber</p> 
  <p>If you follow this example you can use the plugin for your test project. To do this, update your <code>build.sbt</code> as follows:</p> 
  <pre><code>    name := "cucumber-test"

    organization := "com.waioeka.sbt"

    version := "0.1.0"

    libraryDependencies ++= Seq (
    "info.cukes" % "cucumber-core" % "1.2.4" % "test",
    "info.cukes" %% "cucumber-scala" % "1.2.4" % "test",
    "info.cukes" % "cucumber-jvm" % "1.2.4" % "test",
    "info.cukes" % "cucumber-junit" % "1.2.4" % "test",
    "org.scalatest" %% "scalatest" % "2.2.4" % "test")

    enablePlugins(CucumberPlugin)

    CucumberPlugin.glue := "com/waioeka/sbt/"
</code></pre> 
  <p>Remember to set the <code>CucumberPlugin.glue</code> parameter to the sub directory in <code>test</code> that contains your Scala step definitions.</p> 
  <p>For example, in your <code>resources</code> directory, put your feature file. For example:</p> 
  <pre><code>    @my-tag
    Feature: Multiplication
      In order to avoid making mistakes
      As a dummy
      I want to multiply numbers

      Scenario: Multiply two variables
    Given a variable x with value 2
    And a variable y with value 3
    When I multiply x * y
    Then I get 6
</code></pre> 
  <p>Note, if you need to generate the stubs, just run <code>sbt cucumber</code> and you will get an error complaining about missing stubs, you can copy and paste the stub functions into your step implementation.</p> 
  <p>You can now put in your stub implementation. For example:</p> 
  <pre><code>    package com.waioeka.sbt

    import cucumber.api.scala.{ScalaDsl, EN}
    import org.scalatest.Matchers

    /**
    MultiplicationSteps
      *
      */
    class MultiplicationSteps extends ScalaDsl with EN with Matchers {
      var x : Int = 0
      var y : Int = 0
      var z : Int = 0

      Given("""^a variable x with value (\d+)$""") { (arg0: Int) =&gt;
    x = arg0
      }

      Given("""^a variable y with value (\d+)$""") { (arg0: Int) =&gt;
    y = arg0
      }

      When("""^I multiply x \* y$""") { () =&gt;
    z = x * y
      }

     Then("""^I get (\d+)$""") { (arg0: Int) =&gt;
       z should be (arg0)
     }
    }
</code></pre> 
  <p>You can now run the tests in standalone mode:</p> 
  <pre><code>sbt compile
sbt cucumber
</code></pre> 
  <p>You should see some output as follows:</p> 
  <pre><code>paeroa:cucumber-test lewismj$ sbt cucumber
[info] Loading project definition from /Users/lewismj/waioeka/upa-plugins/cucumber-test/project
[info] Set current project to cucumber-test (in build file:/Users/lewismj/waioeka/upa-plugins/cucumber-test/)
[info] Feature: Multiplication
[info]   In order to avoid making mistakes
[info]   As a dummy
[info]   I want to multiply numbers
[info]
[info]   Scenario: Multiply two variables  # Multiplication.feature:6
[info]     Given a variable x with value 2 # MultiplicationSteps.scala:17
[info]     And a variable y with value 3   # MultiplicationSteps.scala:21
[info]     When I multiply x * y           # MultiplicationSteps.scala:25
[info]     Then I get 6                    # MultiplicationSteps.scala:29
[info]
[info] 1 Scenarios (1 passed)
[info] 4 Steps (4 passed)
[info] 0m0.106s
[info]
[success] Total time: 1 s, completed 28-Dec-2015 22:16:19
</code></pre> 
  <p>The result formats will be written:</p> 
  <ul> 
   <li>cucumber-html, standard Cucumber html output.</li> 
   <li>cucumber.json, standard Cucumber json output.</li> 
   <li>cucumber-junit-report.xml, a Junit style rest report.</li> 
  </ul> 
  <h3><a id="user-content-cucumber-runner-example" class="anchor" href="https://github.com/lewismj/cucumber#cucumber-runner-example" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>cucumber-runner-example</h3> 
  <p>If you want to run cucumber tests as part of an <code>sbt test</code> (unit test) run then, in addition to the plugin, first compile and publish the <strong>cucumber-runner</strong> project. The next step is to simply update your <code>build.sbt</code> file to reference the new test framework (Essentially a slightly different hook into running Cucumber).</p> 
  <p>The <strong><em>cucumber-runner-example</em></strong> illustrates how to do this, and integrate BDD testing into unit test framework.</p> 
  <p>See below, you can now run <code>sbt test</code> in addition to <code>sbt cucumber</code>. </p> 
  <pre><code>    mlewis@LEWISMJ-WINDEV MINGW64 /e/Dev/Plugins/upa-plugins/cucumber-runner-test (feature/test-runner)
    $ sbt cucumber
    [info] Loading project definition from E:\Dev\Plugins\upa-plugins\cucumber-runner-test\project
    [info] Set current project to cucumber-test2 (in build file:/E:/Dev/Plugins/upa-plugins/cucumber-runner-test/)
    [info] Compiling 1 Scala source to E:\Dev\Plugins\upa-plugins\cucumber-runner-test\target\scala-2.10\test-classes...
    [info] Feature: Multiplication
    [info]   In order to avoid making mistakes
    [info]   As a dummy
    [info]   I want to multiply numbers
    [info]
    [info]   Scenario: Multiply two variables  # Multiplication.feature:6
    [info]     Given a variable x with value 2 # MultiplicationSteps.scala:19
    [info]     And a variable y with value 3   # MultiplicationSteps.scala:23
    [info]     When I multiply x * y           # MultiplicationSteps.scala:27
    [info]     Then I get 6                    # MultiplicationSteps.scala:31
    [info]
    [info] 1 Scenarios (1 passed)
    [info] 4 Steps (4 passed)
    [info] 0m0.152s
    [info]
    [success] Total time: 5 s, completed 29-Dec-2015 15:28:51

    mlewis@LEWISMJ-WINDEV MINGW64 /e/Dev/Plugins/upa-plugins/cucumber-runner-test (feature/test-runner)
    $ sbt test
    [info] Loading project definition from E:\Dev\Plugins\upa-plugins\cucumber-runner-test\project
    [info] Set current project to cucumber-test2 (in build file:/E:/Dev/Plugins/upa-plugins/cucumber-runner-test/)
    Feature: Multiplication
      In order to avoid making mistakes
      As a dummy
      I want to multiply numbers

      Scenario: Multiply two variables  # Multiplication.feature:6
    Given a variable x with value 2 # MultiplicationSteps.scala:19
    And a variable y with value 3   # MultiplicationSteps.scala:23
    When I multiply x * y           # MultiplicationSteps.scala:27
    Then I get 6                    # MultiplicationSteps.scala:31

    1 Scenarios (1 passed)
    4 Steps (4 passed)
    0m0.170s

    [info] ScalaTest
    [info] Run completed in 672 milliseconds.
    [info] Total number of tests run: 0
    [info] Suites: completed 0, aborted 0
    [info] Tests: succeeded 0, failed 0, canceled 0, ignored 0, pending 0
    [info] No tests were executed.
    [info] Passed: Total 1, Failed 0, Errors 0, Passed 1
    [success] Total time: 1 s, completed 29-Dec-2015 15:29:11

    mlewis@LEWISMJ-WINDEV MINGW64 /e/Dev/Plugins/upa-plugins/cucumber-runner-test (feature/test-runner)
</code></pre> 
  <p>In order to run <code>sbt test</code> you must add the following hook to your <code>build.sbt</code> file.</p> 
  <pre><code>testFrameworks += new TestFramework("com.waioeka.sbt.runner")
</code></pre> 
  <h3><a id="user-content-cucumber-arguments" class="anchor" href="https://github.com/lewismj/cucumber#cucumber-arguments" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Cucumber arguments</h3> 
  <p>You can now (v0.0.5) supply cucumber arguments. For example, <code>sbt "cucumber --tags ~@my-tag"</code> will now correctly filter tagged feature files.</p> 
  <pre><code>[success] Total time: 1 s, completed 15-Jun-2016 09:23:22
paeroa:cucumber-plugin-example lewismj$ sbt "cucumber --tags ~@my-tag"
[info] Loading global plugins from /Users/lewismj/.sbt/0.13/plugins
[info] Loading project definition from /Users/lewismj/github/cucumber/cucumber-plugin-example/project
[info] Set current project to cucumber-test (in build file:/Users/lewismj/github/cucumber/cucumber-plugin-example/)
** hello **
[info] None of the features at [classpath:] matched the filters: [~@my-tag]
[info] 
[info] 0 Scenarios
[info] 0 Steps
[info] 0m0.000s
[info] 
** goodbye **
[success] Total time: 1 s, completed 15-Jun-2016 09:23:41
</code></pre> 
 </article>
</div>