<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-akka-sse" class="anchor" href="https://github.com/hseeberger/akka-sse#akka-sse" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Akka SSE</h1> 
  <p><a href="https://gitter.im/hseeberger/akka-sse?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge" target="_blank"><img src="https://camo.githubusercontent.com/da2edb525cde1455a622c58c0effc3a90b9a181c/68747470733a2f2f6261646765732e6769747465722e696d2f4a6f696e253230436861742e737667" alt="Join the chat at https://gitter.im/hseeberger/akka-sse" data-canonical-src="https://badges.gitter.im/Join%20Chat.svg" style="max-width:100%;"></a> <a href="https://travis-ci.org/hseeberger/akka-sse" target="_blank"><img src="https://camo.githubusercontent.com/da12743e2cfa8c8846e4872eccb8e99c50cf14da/68747470733a2f2f7472617669732d63692e6f72672f687365656265726765722f616b6b612d7373652e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/hseeberger/akka-sse.svg?branch=master" style="max-width:100%;"></a> <a href="https://maven-badges.herokuapp.com/maven-central/de.heikoseeberger/akka-sse_2.12" target="_blank"><img src="https://camo.githubusercontent.com/54409e349381044f03a052e33b200a243171246a/68747470733a2f2f696d672e736869656c64732e696f2f6d6176656e2d63656e7472616c2f762f64652e6865696b6f7365656265726765722f616b6b612d7373655f322e31322e737667" alt="Maven Central" data-canonical-src="https://img.shields.io/maven-central/v/de.heikoseeberger/akka-sse_2.12.svg" style="max-width:100%;"></a></p> 
  <p>Akka SSE adds support for <a href="http://www.w3.org/TR/eventsource" target="_blank">Server-Sent Events</a> (SSE) – a lightweight and standardized technology for pushing notifications from a HTTP server to a HTTP client – to <a href="https://github.com/akka/akka-http" target="_blank">Akka HTTP</a>. In contrast to <a href="http://tools.ietf.org/html/rfc6455" target="_blank">WebSocket</a>, which enables two-way communication, SSE only allows for one-way communication from the server to the client. If that's all you need, SSE offers advantages, because it's much simpler and relies on HTTP only.</p> 
  <p>Since version 2 Akka SSE supports both Scala and Java, even if the below examples only show Scala.</p> 
  <h2><a id="user-content-getting-akka-sse" class="anchor" href="https://github.com/hseeberger/akka-sse#getting-akka-sse" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Getting Akka SSE</h2> 
  <p>Akka SSE is published to Bintray and Maven Central.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span> All releases including intermediate ones are published here,</span>
<span class="pl-c"><span class="pl-c">//</span> final ones are also published to Maven Central.</span>
resolvers <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-en">Resolver</span>.bintrayRepo(<span class="pl-s"><span class="pl-pds">"</span>hseeberger<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>maven<span class="pl-pds">"</span></span>)

libraryDependencies <span class="pl-k">++</span><span class="pl-k">=</span> <span class="pl-en">Vector</span>(
  <span class="pl-s"><span class="pl-pds">"</span>de.heikoseeberger<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>akka-sse<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>3.0.0<span class="pl-pds">"</span></span>,
  ...
)</pre>
  </div> 
  <h2><a id="user-content-usage--basics" class="anchor" href="https://github.com/hseeberger/akka-sse#usage--basics" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage – basics</h2> 
  <p>Akka SSE models a event stream as <code>Source[ServerSentEvent, Any]</code> with <code>Source</code> from Akka Streams and <code>ServerSentEvent</code> from Akka SSE. <code>ServerSentEvent</code> is a case class with the following fields:</p> 
  <ul> 
   <li><code>data</code> of type <code>Option[String]</code>: payload, may be defined with the empty string</li> 
   <li><code>eventType</code> of type <code>Option[String]</code> with default <code>None</code>: handler to be invoked, e.g. "message", "added", etc.</li> 
   <li><code>id</code> of type <code>Option[String]</code> with default <code>None</code>: sets the client's last event ID value</li> 
   <li><code>retry</code> of type <code>Option[Int]</code> with default <code>None</code>: set the client's reconnection time</li> 
  </ul> 
  <p>More info about the above fields can be found in the <a href="http://www.w3.org/TR/eventsource" target="_blank">specification</a>.</p> 
  <h2><a id="user-content-usage--server-side" class="anchor" href="https://github.com/hseeberger/akka-sse#usage--server-side" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage – server-side</h2> 
  <p>In order to respond to a HTTP request with an event stream, you have to bring the implicit <code>ToResponseMarshaller[Source[ServerSentEvent, Any]]</code> defined by the <code>EventStreamMarshalling</code> trait or object into the scope defining the respective route:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">object</span> <span class="pl-en">TimeServer</span> {

  ...

  <span class="pl-k">private</span> <span class="pl-k">def</span> <span class="pl-en">route</span> <span class="pl-k">=</span> {
    <span class="pl-k">import</span> <span class="pl-v">Directives.</span><span class="pl-v">_</span>
    <span class="pl-k">import</span> <span class="pl-v">EventStreamMarshalling.</span><span class="pl-v">_ </span><span class="pl-c"><span class="pl-c">//</span> That does the trick!</span>

    <span class="pl-k">def</span> <span class="pl-en">assets</span> <span class="pl-k">=</span> ...

    <span class="pl-k">def</span> <span class="pl-en">events</span> <span class="pl-k">=</span>
      path(<span class="pl-s"><span class="pl-pds">"</span>events<span class="pl-pds">"</span></span>) {
        get {
          complete {
            <span class="pl-en">Source</span>
              .tick(<span class="pl-c1">2.</span>seconds, <span class="pl-c1">2.</span>seconds, <span class="pl-en">NotUsed</span>)
              .map(_ <span class="pl-k">=&gt;</span> <span class="pl-en">LocalTime</span>.now())
              .map(timeToServerSentEvent)
              .keepAlive(<span class="pl-c1">1.</span>second, () <span class="pl-k">=&gt;</span> <span class="pl-en">ServerSentEvent</span>.heartbeat)
          }
        }
      }

    assets <span class="pl-k">~</span> events
  }

  <span class="pl-k">private</span> <span class="pl-k">def</span> <span class="pl-en">timeToServerSentEvent</span>(<span class="pl-v">time</span>: <span class="pl-en">LocalTime</span>) <span class="pl-k">=</span>
    <span class="pl-en">ServerSentEvent</span>(<span class="pl-en">DateTimeFormatter</span>.<span class="pl-en">ISO_LOCAL_TIME</span>.format(time))
}</pre>
  </div> 
  <p>To send periodic heartbeats, simply use the <code>keepAlive</code> standard stage with a <code>ServerSentEvent.heartbeat</code>.</p> 
  <h2><a id="user-content-usage--client-side" class="anchor" href="https://github.com/hseeberger/akka-sse#usage--client-side" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage – client-side</h2> 
  <p>In order to unmarshal server-sent events as <code>Source[ServerSentEvent, NotUsed]</code>, you have to bring the implicit <code>FromEntityUnmarshaller[Source[ServerSentEvent, NotUsed]]</code> defined by the <code>EventStreamUnmarshalling</code> trait or object into scope:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">EventStreamUnmarshalling.</span><span class="pl-v">_ </span><span class="pl-c"><span class="pl-c">//</span> That does the trick!</span>
<span class="pl-k">import</span> <span class="pl-v">system.</span><span class="pl-v">dispatcher</span>

<span class="pl-en">Http</span>()
  .singleRequest(<span class="pl-en">Get</span>(<span class="pl-s"><span class="pl-pds">"</span>http://localhost:8000/events<span class="pl-pds">"</span></span>))
  .flatMap(<span class="pl-en">Unmarshal</span>(_).to[<span class="pl-en">Source</span>[<span class="pl-en">ServerSentEvent</span>, <span class="pl-en">NotUsed</span>]])
  .foreach(_.runForeach(print))</pre>
  </div> 
  <h2><a id="user-content-references" class="anchor" href="https://github.com/hseeberger/akka-sse#references" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>References</h2> 
  <ul> 
   <li><a href="https://github.com/hseeberger/akka-sse/tree/master/example" target="_blank">Example application</a></li> 
   <li><a href="https://github.com/hseeberger/reactive-flows" target="_blank">Reactive Flows</a></li> 
   <li><a href="http://www.typesafe.com/products/conductr" target="_blank">Typesafe ConductR</a></li> 
  </ul> 
  <h2><a id="user-content-contribution-policy" class="anchor" href="https://github.com/hseeberger/akka-sse#contribution-policy" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Contribution policy</h2> 
  <p>Contributions via GitHub pull requests are gladly accepted from their original author. Along with any pull requests, please state that the contribution is your original work and that you license the work to the project under the project's open source license. Whether or not you state this explicitly, by submitting any copyrighted material via pull request, email, or other means you agree to license the material under the project's open source license and warrant that you have the legal authority to do so.</p> 
  <h2><a id="user-content-license" class="anchor" href="https://github.com/hseeberger/akka-sse#license" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>License</h2> 
  <p>This code is open source software licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html" target="_blank">Apache 2.0 License</a>.</p> 
 </article>
</div>