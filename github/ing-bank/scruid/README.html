<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <p><a href="https://circleci.com/gh/ing-bank/scruid" target="_blank"><img src="https://camo.githubusercontent.com/f365f4523f15625b3894a11802a6bd9405e12012/68747470733a2f2f636972636c6563692e636f6d2f67682f696e672d62616e6b2f7363727569642e7376673f7374796c653d737667" alt="CircleCI" data-canonical-src="https://circleci.com/gh/ing-bank/scruid.svg?style=svg" style="max-width:100%;"></a> <a href="https://www.codacy.com/app/fokko/scruid?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=ing-bank/scruid&amp;utm_campaign=Badge_Grade" target="_blank"><img src="https://camo.githubusercontent.com/e529ea204fdcbd715fd0bd1247725fbd257222dc/68747470733a2f2f6170692e636f646163792e636f6d2f70726f6a6563742f62616467652f47726164652f3962376334616466386164343437656661396337656138613966666461366232" alt="Codacy Badge" data-canonical-src="https://api.codacy.com/project/badge/Grade/9b7c4adf8ad447efa9c7ea8a9ffda6b2" style="max-width:100%;"></a> <a href="https://bintray.com/ing-bank/maven-releases/scruid/_latestVersion" target="_blank"><img src="https://camo.githubusercontent.com/2c128f1efe841061bafe3068fc838ae3b6f0d268/68747470733a2f2f6170692e62696e747261792e636f6d2f7061636b616765732f696e672d62616e6b2f6d6176656e2d72656c65617365732f7363727569642f696d616765732f646f776e6c6f61642e737667" alt="Download" data-canonical-src="https://api.bintray.com/packages/ing-bank/maven-releases/scruid/images/download.svg" style="max-width:100%;"></a></p> 
  <h1><a id="user-content-scruid" class="anchor" href="https://github.com/ing-bank/scruid#scruid" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Scruid</h1> 
  <p>Scruid (Scala+Druid) is an open source library that allows you to compose queries easily in Scala. The library will take care of the translation of the query into json, parse the result in the case class that you define.</p> 
  <p>Currently the API is under heavy development, so changes might occur.</p> 
  <h2><a id="user-content-example-queries" class="anchor" href="https://github.com/ing-bank/scruid#example-queries" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Example queries:</h2> 
  <p>Below the example queries supported by Scruid. For more information about how to query Druid, and what query to pick, please refer to the <a href="http://druid.io/docs/latest/querying/querying.html" target="_blank">Druid documentation</a></p> 
  <h3><a id="user-content-topn-query" class="anchor" href="https://github.com/ing-bank/scruid#topn-query" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>TopN query</h3> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">TopCountry</span>(<span class="pl-v">count</span>: <span class="pl-k">Int</span>, <span class="pl-v">countryName</span>: <span class="pl-k">String</span> <span class="pl-k">=</span> <span class="pl-c1">null</span>)

<span class="pl-en">TopNQuery</span>[<span class="pl-en">TopCountry</span>](
  dimension <span class="pl-k">=</span> <span class="pl-en">Dimension</span>(
    dimension <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>countryName<span class="pl-pds">"</span></span>
  ),
  threshold <span class="pl-k">=</span> <span class="pl-c1">5</span>,
  metric <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>count<span class="pl-pds">"</span></span>,
  aggregations <span class="pl-k">=</span> <span class="pl-en">List</span>(
    <span class="pl-en">Aggregation</span>(
      kind <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>count<span class="pl-pds">"</span></span>,
      name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>count<span class="pl-pds">"</span></span>,
      fieldName <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>count<span class="pl-pds">"</span></span>
    )
  ),
  intervals <span class="pl-k">=</span> <span class="pl-en">List</span>(<span class="pl-s"><span class="pl-pds">"</span>2011-06-01/2017-06-01<span class="pl-pds">"</span></span>)
).execute</pre>
  </div> 
  <p>This will return a <code>List[TopCountry]</code>.</p> 
  <h3><a id="user-content-groupby-query" class="anchor" href="https://github.com/ing-bank/scruid#groupby-query" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>GroupBy query</h3> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">GroupByIsAnonymous</span>(<span class="pl-v">isAnonymous</span>: <span class="pl-k">Boolean</span>, <span class="pl-v">count</span>: <span class="pl-k">Int</span>)

<span class="pl-k">val</span> <span class="pl-en">result</span> <span class="pl-k">=</span> <span class="pl-en">GroupByQuery</span>[<span class="pl-en">GroupByIsAnonymous</span>](
  aggregations <span class="pl-k">=</span> <span class="pl-en">List</span>(
    <span class="pl-en">Aggregation</span>(
      kind <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>count<span class="pl-pds">"</span></span>,
      name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>count<span class="pl-pds">"</span></span>,
      fieldName <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>count<span class="pl-pds">"</span></span>
    )
  ),
  dimensions <span class="pl-k">=</span> <span class="pl-en">List</span>(<span class="pl-s"><span class="pl-pds">"</span>isAnonymous<span class="pl-pds">"</span></span>),
  intervals <span class="pl-k">=</span> <span class="pl-en">List</span>(<span class="pl-s"><span class="pl-pds">"</span>2011-06-01/2017-06-01<span class="pl-pds">"</span></span>)
).execute()</pre>
  </div> 
  <p>This will return <code>List[GroupByIsAnonymous]</code> where <code>isAnonymouse</code> is either <code>true or false</code>. Please keep in mind that Druid is only able to handle strings, and recently also numerics. So Druid will be returning a string, and the conversion from a string to a boolean is done by the json parser.</p> 
  <h3><a id="user-content-timeseries-query" class="anchor" href="https://github.com/ing-bank/scruid#timeseries-query" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>TimeSeries query</h3> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">TimeseriesCount</span>(<span class="pl-v">count</span>: <span class="pl-k">Int</span>)

<span class="pl-k">val</span> <span class="pl-en">result</span> <span class="pl-k">=</span> <span class="pl-en">TimeSeriesQuery</span>[<span class="pl-en">TimeseriesCount</span>](
  aggregations <span class="pl-k">=</span> <span class="pl-en">List</span>(
    <span class="pl-en">Aggregation</span>(
      kind <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>count<span class="pl-pds">"</span></span>,
      name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>count<span class="pl-pds">"</span></span>,
      fieldName <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>count<span class="pl-pds">"</span></span>
    )
  ),
  granularity <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>hour<span class="pl-pds">"</span></span>,
  intervals <span class="pl-k">=</span> <span class="pl-en">List</span>(<span class="pl-s"><span class="pl-pds">"</span>2011-06-01/2017-06-01<span class="pl-pds">"</span></span>)
).execute</pre>
  </div> 
  <p>This will return a <code>List[TimeSeriesResult[TimeseriesCount]]</code>. Where the <code>TimeSeriesResult</code> contains the timestamp of the interval in joda time, and the <code>TimeseriesCount</code> class contains the actual result of the query as defined in the aggregation.</p> 
  <h2><a id="user-content-configuration" class="anchor" href="https://github.com/ing-bank/scruid#configuration" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Configuration</h2> 
  <p>The configuration is done by <a href="https://github.com/typesafehub/config" target="_blank">Typesafe config</a>. The configuration can be overriden by using environment variables, e.g. <code>DRUID_URL</code> and <code>DRUID_DATASOURCE</code>. Or by placing an application.conf in your own project and this will override the reference.conf of the scruid library.</p> 
  <pre><code>druid = {
  url = "http://localhost:8082/druid/v2/"
  url = ${?DRUID_URL}

  datasource = "wikiticker"
  datasource = ${?DRUID_DATASOURCE}

  connectionTimeout = 10000
  readTimeout = 30000
}
</code></pre> 
  <h2><a id="user-content-tests" class="anchor" href="https://github.com/ing-bank/scruid#tests" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Tests</h2> 
  <p>To run the tests, please make sure that you have the Druid instance running:</p> 
  <pre><code>docker run --rm -i -p 8082:8082 -p 8081:8081 fokkodriesprong/docker-druid
</code></pre> 
 </article>
</div>