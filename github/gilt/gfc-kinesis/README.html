<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-deprecated" class="anchor" href="https://github.com/gilt/gfc-kinesis#deprecated" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>DEPRECATED</h1> 
  <p>This project is deprecated. We will not accept pull requests or make any changes to this repo going forward. If you are using gfc-kinesis already and want to add new features or fix any bugs you may find, feel free to fork the repo and continue development there. </p> 
  <p>Otherwise, we recommend using <a href="https://github.com/gilt/gfc-aws-kinesis" target="_blank">https://github.com/gilt/gfc-aws-kinesis</a> instead, a much more lightweight scala wrapper for the AWS Kinesis Client Library, that Gilt will continue to actively support.</p> 
  <h1><a id="user-content-gfc-kinesis" class="anchor" href="https://github.com/gilt/gfc-kinesis#gfc-kinesis" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>gfc-kinesis</h1> 
  <p>A library providing simple Scala API for Amazon Kinesis, for event publishers and consumers. This library is part of the gilt foundation classes.</p> 
  <h2><a id="user-content-simple-configuration" class="anchor" href="https://github.com/gilt/gfc-kinesis#simple-configuration" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Simple Configuration</h2> 
  <p>This library allows simple configuration for both consumers and publishers. The configurations come with readonable defaults (where possible).</p> 
  <h2><a id="user-content-typed-api" class="anchor" href="https://github.com/gilt/gfc-kinesis#typed-api" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Typed API</h2> 
  <p>This library provides a typed API that allows applications to be written in terms of <em>typed events</em>.</p> 
  <p>The entry point to this API is the <code>com.gilt.gfc.kinesis.KinesisFactory</code>. This can be used to create a Publisher:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">config</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">KinesisPublisherConfig</span> {
    <span class="pl-k">override</span> <span class="pl-k">val</span> <span class="pl-en">regionName</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>us-west-1<span class="pl-pds">"</span></span>
}

<span class="pl-k">def</span> <span class="pl-en">convertString</span>(<span class="pl-v">str</span>: <span class="pl-k">String</span>) <span class="pl-k">=</span> <span class="pl-en">RawRecord</span>(str.getBytes, <span class="pl-en">PartitionKey</span>(<span class="pl-s"><span class="pl-pds">"</span>sensible-partition-key<span class="pl-pds">"</span></span>))

<span class="pl-k">val</span> <span class="pl-en">publisher</span> <span class="pl-k">=</span> <span class="pl-en">KinesisFactory</span>.newPublisher(<span class="pl-s"><span class="pl-pds">"</span>my-stream-name<span class="pl-pds">"</span></span>, config, convertString)

<span class="pl-c">// Now publish some events...</span>
publisher.publish(<span class="pl-s"><span class="pl-pds">"</span>event1<span class="pl-pds">"</span></span>)
publisher.publish(<span class="pl-s"><span class="pl-pds">"</span>event2<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>or an event Receiver, which in turn can be used to consume events:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">config</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">KinesisConsumerConfig</span> {
    <span class="pl-k">override</span> <span class="pl-k">val</span> <span class="pl-en">appName</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>example-app-name<span class="pl-pds">"</span></span>
    <span class="pl-k">override</span> <span class="pl-k">val</span> <span class="pl-en">regionName</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>us-west-1<span class="pl-pds">"</span></span>
}

<span class="pl-k">def</span> <span class="pl-en">convert</span>(<span class="pl-v">record</span>: <span class="pl-en">RawRecord</span>)<span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-k">String</span>] <span class="pl-k">=</span> <span class="pl-en">Some</span>(<span class="pl-k">new</span> <span class="pl-en">String</span>(record.data))

<span class="pl-k">val</span> <span class="pl-en">receiver</span> <span class="pl-k">=</span> <span class="pl-en">KinesisFactory</span>.newReceiver(<span class="pl-s"><span class="pl-pds">"</span>my-stream-name<span class="pl-pds">"</span></span>, config, convert)

<span class="pl-k">def</span> <span class="pl-en">onEvent</span>(<span class="pl-v">event</span>: <span class="pl-k">String</span>) <span class="pl-k">=</span> println(s<span class="pl-s"><span class="pl-pds">"</span>Received event: $event<span class="pl-pds">"</span></span>)

receiver.registerConsumer(onEvent)

receiver.start()</pre>
  </div> 
  <p>By default, the Kinesis receiver here checkpoints the stream/shard every 1 minute. This can be changed by specifying a different <code>com.gilt.gfc.kinesis.consumer.CheckpointingStrategy</code> which allows for various strategies, including age, event throughput, per-batch, per-shard sequence-number tracking, or various other combinations.</p> 
  <h2><a id="user-content-closer-to-kinesis" class="anchor" href="https://github.com/gilt/gfc-kinesis#closer-to-kinesis" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Closer to Kinesis</h2> 
  <p>In addition to the typed API, this library also provides a lower level <em>raw API</em>, for both consumer (<code>com.gilt.gfc.kinesis.consumer.RawKinesisStreamConsumer</code>) and publisher (<code>com.gilt.gfc.kinesis.publisher.RawKinesisStreamPublisher</code>).</p> 
  <p>This raw API allow for more detailed integration with Kinesis, which may be useful if the event based API is too abstract for certain specific use cases.</p> 
  <p>The Typed API is built on top of this raw API.</p> 
  <h2><a id="user-content-raw-stream-publisher" class="anchor" href="https://github.com/gilt/gfc-kinesis#raw-stream-publisher" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Raw Stream Publisher</h2> 
  <p>Package <code>com.gilt.gfc.kinesis.publisher</code> provides a lightweight wrapper for producing events into a kinesis stream.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">config</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">KinesisPublisherConfig</span> {
    <span class="pl-k">override</span> <span class="pl-k">val</span> <span class="pl-en">regionName</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>us-west-1<span class="pl-pds">"</span></span>
}

<span class="pl-k">val</span> <span class="pl-en">producer</span> <span class="pl-k">=</span> <span class="pl-en">RawKinesisStreamPublisher</span>(<span class="pl-s"><span class="pl-pds">"</span>my-stream-name<span class="pl-pds">"</span></span>, config)

<span class="pl-k">val</span> <span class="pl-en">futureResult</span> <span class="pl-k">=</span> producer.putRecord(<span class="pl-en">ByteBuffer</span>.wrap(<span class="pl-s"><span class="pl-pds">"</span>hello world<span class="pl-pds">"</span></span>.getBytes), )
                                      <span class="pl-en">PartitionKey</span>(<span class="pl-s"><span class="pl-pds">"</span>some partition key value<span class="pl-pds">"</span></span>))

<span class="pl-c">// Simple example only</span>
<span class="pl-k">val</span> <span class="pl-en">result</span> <span class="pl-k">=</span> <span class="pl-en">Await</span>.result(futureResult, <span class="pl-en">Duration</span>.<span class="pl-en">Inf</span>)</pre>
  </div> 
  <h2><a id="user-content-raw-stream-consumer" class="anchor" href="https://github.com/gilt/gfc-kinesis#raw-stream-consumer" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Raw Stream Consumer</h2> 
  <p>Package <code>com.gilt.gfc.kinesis.consumer</code> provides a lightweight wrapper for Amazon's Java client library (<code>IRecordProcessorFactory</code>, etc.) - this includes using DynamoDB for lease/checkpoint coordination of streams (and shards thereof).</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">config</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">KinesisConsumerConfig</span> {
    <span class="pl-k">override</span> <span class="pl-k">val</span> <span class="pl-en">appName</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>example-app-name<span class="pl-pds">"</span></span>
    <span class="pl-k">override</span> <span class="pl-k">val</span> <span class="pl-en">regionName</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>us-west-1<span class="pl-pds">"</span></span>
}

<span class="pl-k">val</span> <span class="pl-en">consumer</span> <span class="pl-k">=</span> <span class="pl-en">RawKinesisStreamConsumer</span>(<span class="pl-s"><span class="pl-pds">"</span>my-stream-name<span class="pl-pds">"</span></span>, config) {
    (recordBatch, checkpoint) <span class="pl-k">=&gt;</span>
        recordBatch.foreach { record <span class="pl-k">=&gt;</span>
           println(<span class="pl-k">new</span> <span class="pl-en">String</span>(record.getData.array))
        }

        <span class="pl-k">if</span> (checkpoint.age <span class="pl-k">&gt;</span> <span class="pl-c1">1.</span>minute) checkpoint()
}

consumer.start()</pre>
  </div> 
  <h2><a id="user-content-license" class="anchor" href="https://github.com/gilt/gfc-kinesis#license" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>License</h2> 
  <p>Copyright 2015 Gilt Groupe, Inc.</p> 
  <p>Licensed under the Apache License, Version 2.0: <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank">http://www.apache.org/licenses/LICENSE-2.0</a></p> 
 </article>
</div>