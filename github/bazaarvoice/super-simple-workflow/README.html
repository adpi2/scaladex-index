<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <p><a href="https://gitter.im/super-simple-workflow/Lobby?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge" target="_blank"><img src="https://camo.githubusercontent.com/1bee31ca340c9dd3ceb84d4d25403bc6e9c471bc/68747470733a2f2f6261646765732e6769747465722e696d2f73757065722d73696d706c652d776f726b666c6f772f4c6f6262792e737667" alt="Join the chat at https://gitter.im/super-simple-workflow/Lobby" data-canonical-src="https://badges.gitter.im/super-simple-workflow/Lobby.svg" style="max-width:100%;"></a> <a href="https://travis-ci.org/bazaarvoice/super-simple-workflow" target="_blank"><img src="https://camo.githubusercontent.com/f6fab7152ce82eb8c1f8149f939ce514e0000035/68747470733a2f2f7472617669732d63692e6f72672f62617a616172766f6963652f73757065722d73696d706c652d776f726b666c6f772e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/bazaarvoice/super-simple-workflow.svg?branch=master" style="max-width:100%;"></a></p> 
  <p>Simple Workflow is not simple. Let's really simplify it!</p> 
  <p>For a nice intro, check out the <a href="http://blog.vvcephei.org/super-simple-workflow" target="_blank">blog post</a>.</p> 
  <h1><a id="user-content-getting-started" class="anchor" href="https://github.com/bazaarvoice/super-simple-workflow#getting-started" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Getting Started</h1> 
  <p>Here's how it works:</p> 
  <ol> 
   <li>Define an <code>InputParser</code> class that tells sswf how to serialize your workflow input.</li> 
   <li>Define an Enum capturing all the potential steps of your workflow (extending <code>WorkflowStep</code>). These contain metadata about timeouts, etc.</li> 
   <li>Define a <code>WorkflowDefinition</code> class: 
    <ul> 
     <li>The <code>workflow</code> method returns a list of steps to execute. You get to look at the workflow input, but not the history. The idea is that you define a workflow that's easy to predict and consists of a series of steps to completion.</li> 
     <li>The <code>act</code> method specifies the behaviour for each step.</li> 
    </ul></li> 
   <li>Register and start your workflow using the <code>WorkflowManagement</code> class</li> 
  </ol> 
  <p>One big thing that sticks out here is that your workflow is just a sequence of steps. There's no branching or conditional execution of steps. In our experience, most workflows wind up being almost, if not entirely, linear. Deciding to just support that use case means that we can make it drop-dead simple.</p> 
  <p>If you're thinking that you need branching because some states don't need to execute sometimes, you can achieve the same effect by just having those states say <code>Success("Nothing to do!")</code>. You would only really need branching if you wanted to do one of two totally different things based on the result of some step.</p> 
  <h2><a id="user-content-working-example" class="anchor" href="https://github.com/bazaarvoice/super-simple-workflow#working-example" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Working example</h2> 
  <p>Run the example with <code>sbt example/run</code> or through IDEA by running <code>ExampleWorkflowService</code>. Note that you must have AWS credentials in your env: <code>AWS_ACCESS_KEY_ID</code>, <code>AWS_SECRET_KEY</code>.</p> 
  <p>Your AWS credentials must have access to at least the following <a href="http://docs.aws.amazon.com/amazonswf/latest/developerguide/swf-api-by-category.html" target="_blank">SWF actions</a>:</p> 
  <ul> 
   <li>PollForActivityTask</li> 
   <li>RespondActivityTaskCompleted</li> 
   <li>RecordActivityTaskHeartbeat</li> 
   <li>PollForDecisionTask</li> 
   <li>RespondDecisionTaskCompleted</li> 
   <li>RequestCancelWorkflowExecution</li> 
   <li>StartWorkflowExecution</li> 
   <li>SignalWorkflowExecution</li> 
   <li>TerminateWorkflowExecution</li> 
   <li>RegisterActivityTypef</li> 
   <li>RegisterWorkflowType</li> 
   <li>RegisterDomain</li> 
   <li>RequestCancelWorkflowExecution</li> 
   <li>TerminateWorkflowExecution</li> 
   <li>ListActivityTypes</li> 
   <li>DescribeWorkflowType</li> 
   <li>ListOpenWorkflowExecutions</li> 
   <li>ListClosedWorkflowExecutions</li> 
   <li>GetWorkflowExecutionHistory</li> 
   <li>DescribeDomain</li> 
  </ul> 
  <p>The example code is in <code>sswf-java-example/src/main/java/example</code>. This is everything you'll need to do to get up and running!</p> 
  <h2><a id="user-content-managing-versions-and-names-of-things" class="anchor" href="https://github.com/bazaarvoice/super-simple-workflow#managing-versions-and-names-of-things" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Managing Versions and Names of Things</h2> 
  <p>When you're dealing with SSWF, you have to contend with domains, workflows, task lists, steps, and versions of workflows and steps. So, what's the right way to think about and use these things?</p> 
  <ul> 
   <li><p>A <em>Domain</em> is just a handy way to group workflows. You probably just want one domain per project, even if your project has several workflows.</p></li> 
   <li><p>A <em>Workflow</em> is the logical high-level task you're trying to accomplish. So, if you have an ETL job to do, that's your workflow. You may start out with 3 steps and then add more later, but it's still the same workflow.</p></li> 
   <li><p>But if you add more steps, then the old workflow workers (who were compiled against the 3-step version) won't have a clue what to do with the new steps (read: <code>IllegalStateException</code>). This is where the <code>Workflow Version</code> comes in. Each worker is polling SWF for a specific version of the workflow, so as long as you bump the version whenever you change the workflow, you'll be golden.</p></li> 
   <li><p>The <em>Steps</em> are the (ahem) individual steps of the workflow. They are really just messages that the sswf workers will use to invoke your <code>WorkflowDefinition#act</code> method. We could use strings, but you define them in an enum so there is a clear symbolic way to reference them in code. They also contain a small amount of configuration, like how long sswf should let the step run before timing it out.</p></li> 
   <li><p>There are also <em>Task Lists</em>, which let you restrict workflow executions to particular environments. For example, you may have different data centers (like in the US and the EU), with different data in each data center. Let's say there's a particular workflow to run on new data being put into a datacenter. If new data is added to the EU center, you don't want the US worker picking up parts of the workflow. So, you'll have two task lists: one for the US and one for the EU. This can also be useful for confining workflow executions to dev, test, or prod environments.</p></li> 
  </ul> 
  <h2><a id="user-content-writing-steps" class="anchor" href="https://github.com/bazaarvoice/super-simple-workflow#writing-steps" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Writing Steps</h2> 
  <p>Every time a step executes, it returns one of three results: Success, Failure, or InProgress. They can all contain messages for reporting later.</p> 
  <p>The point here is simplicity. Make each Step idempotent, so if a Step takes an action and needs to wait for completion, make the Step check for completion <em>first</em>, returning one of the three results, and <em>then</em> evaluate if the step needs to execute. If so, execute it and return InProgress so the workflow will call the Step again.</p> 
  <p>This way, each step enforces an invariant rather than performing an action. You will have the comfort of knowing that it's always safe to re-start a workflow, since anything that doesn't need to run will simply pass through and anything in progress will wait for completion.</p> 
  <p>Example:</p> 
  <pre><code>    ExtractStep:
      - extractState := getExtractState()
      - if extractState.defined &amp;&amp; extractState.isRunning:
          return new InProgress("EXTRACT is running: " + extractState.status)
      - if extractState.defined &amp;&amp; extractState.isFailed:
          return new Failure("EXTRACT failed: " + extractState.errorMessage)
      - if extractState.defined &amp;&amp; extractState.isComplete:
          return new Success("EXTRACT done: " + extractState.summary)

      - needsExtract := decideWhetherWeNeedAnExtract():
      - if needsExtract:
          startExtract()
          return new InProgress("Started EXTRACT")
      - else:
          return new Success("Nothing to do!")

      - in case of any error:
          return new Failure("Unexpected error: " + error.message)
</code></pre> 
  <p>Notice how the ExtractStep code will always do its job without corrupting the system no matter how many times it's called and independent of whatever else has happened. This gives you the power to run, or re-run, the workflow any time and however often you like without worrying that it will do the wrong thing.</p> 
  <h2><a id="user-content-waiting-on-signals" class="anchor" href="https://github.com/bazaarvoice/super-simple-workflow#waiting-on-signals" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Waiting on Signals</h2> 
  <p>Sometimes, you ned a workflow to wait for some other system (or person) to complete an action. You can accomplish this by creating a signal, passing it to that other party, and then they can give it back to you when they are done.</p> 
  <p>The first step in using signals is to make a signal token by calling <code>WorkflowManagement#generateSignal()</code>. This gives you back a token you can wait on and which you can also use to send a signal. You will pass these signals on to the process that you intend to signal you. </p> 
  <p>A workflow step can wait on one or more of these signals by returning <code>new Wait(WAIT_TIMEOUT,SIGNAL_TOKEN)</code>.</p> 
  <p>The most convenient way to send the signal is implemented in <code>WorkflowManagement#signalWorkflow(SIGNAL_TOKEN)</code>. You could, for example, set up a web endpoint at <code>POST http://myservice/signal/{SIGNAL_TOKEN}</code>, which delegates to <code>signalWorkflow(SIGNAL_TOKEN)</code>.</p> 
  <p>If sending the signal from a JVM process is inconvenient, you can extract the workflowId, runId, and signalName from the token and just use the <a href="http://docs.aws.amazon.com/amazonswf/latest/developerguide/swf-dg-signals.html" target="_blank">SWF Signal API</a> directly. Here is the format of the tokens generated by <code>generateSignal()</code> (pipe delimited):</p> 
  <pre><code>WORKFLOW_ID|RUN_ID|SIGNAL_NAME
</code></pre> 
  <p>To send a signal, that is all the information you need. The <code>input</code> field of AWS signals is currently unused.</p> 
  <h1><a id="user-content-development" class="anchor" href="https://github.com/bazaarvoice/super-simple-workflow#development" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Development</h1> 
  <h2><a id="user-content-set-up-your-access-to-the-bv-maven-repo" class="anchor" href="https://github.com/bazaarvoice/super-simple-workflow#set-up-your-access-to-the-bv-maven-repo" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>set up your access to the BV maven repo:</h2> 
  <ol> 
   <li>For starters, install sbt.</li> 
   <li><p>Create a file <code>~/.sbt/repositories</code>:</p> <pre><code>[repositories]
  local
  bazaarvoice: https://repo.bazaarvoice.com:443/nexus/content/groups/bazaarvoice
</code></pre></li> 
   <li><p>Create a file <code>~/.sbt/.credentials</code>:</p> <pre><code>realm:Sonatype Nexus Repository Manager
host:repo.bazaarvoice.com
user:LDAP USERNAME
password:LDAP PASSWORD
</code></pre></li> 
  </ol> 
  <h2><a id="user-content-working-with-idea" class="anchor" href="https://github.com/bazaarvoice/super-simple-workflow#working-with-idea" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Working with IDEA</h2> 
  <p>The built-in scala and idea support should do you just fine.</p> 
  <h2><a id="user-content-build-the-project" class="anchor" href="https://github.com/bazaarvoice/super-simple-workflow#build-the-project" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>build the project:</h2> 
  <pre><code>sbt compile
# to run samples
sbt example/run 
# execute unit, integration, and end-to-end tests
sbt test-all
# to package
sbt publishLocal #(etc...)
</code></pre> 
  <p>Protip: Use a tilde (<code>sbt ~test</code>) to have sbt monitor the files and re-execute the task when anything changes.</p> 
  <p>To cross-build for scala 2.10 and scala 2.11 (note the '+'):</p> 
  <pre><code>sbt +compile
# to package
sbt +publishLocal #(etc...)
</code></pre> 
  <h2><a id="user-content-performing-a-release" class="anchor" href="https://github.com/bazaarvoice/super-simple-workflow#performing-a-release" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>performing a release</h2> 
  <p>We have a (private) jenkins job to do releases. It's <code>super-simple-workflow-release</code>.</p> 
 </article>
</div>