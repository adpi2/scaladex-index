<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a href="https://github.com/bmeg/ophion#ophion" aria-hidden="true" class="anchor" id="user-content-ophion" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>ophion</h1> 
  <p>Language for making graph queries from data</p> 
  <p><a href="https://github.com/bmeg/ophion/blob/master/resources/ophion.jpg" target="_blank"><img src="https://github.com/bmeg/ophion/raw/master/resources/ophion.jpg" alt="OPHION" style="max-width:100%;"></a></p> 
  <h2><a href="https://github.com/bmeg/ophion#usage" aria-hidden="true" class="anchor" id="user-content-usage" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h2> 
  <p>Given a graph adhering to the <a href="https://tinkerpop.apache.org/" target="_blank">tinkerpop</a> interface, we want to make remote queries against it without exposing a gremlin console. To this end, <strong>Ophion</strong> provides a json-encoded schema for making graph queries as data:</p> 
  <div class="highlight highlight-source-json">
   <pre>{<span class="pl-s"><span class="pl-pds">"</span>query<span class="pl-pds">"</span></span>:
 [{<span class="pl-s"><span class="pl-pds">"</span>label<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>person<span class="pl-pds">"</span></span>},
  {<span class="pl-s"><span class="pl-pds">"</span>as<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>people<span class="pl-pds">"</span></span>},
  {<span class="pl-s"><span class="pl-pds">"</span>outEdge<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>created<span class="pl-pds">"</span></span>},
  {<span class="pl-s"><span class="pl-pds">"</span>has<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>weight<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>within<span class="pl-pds">"</span></span>: [<span class="pl-c1">1.0</span>]},
  {<span class="pl-s"><span class="pl-pds">"</span>inVertex<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>software<span class="pl-pds">"</span></span>},
  {<span class="pl-s"><span class="pl-pds">"</span>as<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>software<span class="pl-pds">"</span></span>},
  {<span class="pl-s"><span class="pl-pds">"</span>select<span class="pl-pds">"</span></span>: [<span class="pl-s"><span class="pl-pds">"</span>people<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>software<span class="pl-pds">"</span></span>]}]}</pre>
  </div> 
  <p>Given some json like this, you can parse it into a program that executes the given query when run:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">ophion.Ophion.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">org.apache.tinkerpop.gremlin.tinkergraph.structure.</span><span class="pl-v">TinkerFactory</span>

<span class="pl-k">val</span> <span class="pl-en">graph</span> <span class="pl-k">=</span> <span class="pl-en">TinkerFactory</span>.createModern
<span class="pl-k">val</span> <span class="pl-en">traversal</span> <span class="pl-k">=</span> graph.traversal.<span class="pl-en">V</span>()

<span class="pl-k">val</span> <span class="pl-en">example</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"""</span>{"query":</span>
<span class="pl-s"> [{"label": "person"},</span>
<span class="pl-s">  {"as": "people"},</span>
<span class="pl-s">  {"outEdge": "created"},</span>
<span class="pl-s">  {"has": "weight", "within": [1.0]},</span>
<span class="pl-s">  {"inVertex": "software"},</span>
<span class="pl-s">  {"as": "software"},</span>
<span class="pl-s">  {"select": ["people", "software"]}]}<span class="pl-pds">"""</span></span>

<span class="pl-k">val</span> <span class="pl-en">query</span> <span class="pl-k">=</span> <span class="pl-en">Query</span>.fromString(example).compose
<span class="pl-k">val</span> <span class="pl-en">result</span> <span class="pl-k">=</span> query.foldMap(operationInterpreter(traversal)).head.toList</pre>
  </div> 
  <h2><a href="https://github.com/bmeg/ophion#gremlin-functionality-currently-supported" aria-hidden="true" class="anchor" id="user-content-gremlin-functionality-currently-supported" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Gremlin functionality currently supported:</h2> 
  <h3><a href="https://github.com/bmeg/ophion#selecting-vertexes-or-edges-by-label" aria-hidden="true" class="anchor" id="user-content-selecting-vertexes-or-edges-by-label" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>selecting vertexes or edges by label</h3> 
  <pre><code>{"label": "alphabet"}
</code></pre> 
  <h3><a href="https://github.com/bmeg/ophion#values---getting-just-certain-values-rather-than-the-whole-vertex-or-edge-property-map" aria-hidden="true" class="anchor" id="user-content-values---getting-just-certain-values-rather-than-the-whole-vertex-or-edge-property-map" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>values - getting just certain values rather than the whole vertex or edge property map</h3> 
  <pre><code>{"values": ["color", "pattern", "hair", "volume"]}
</code></pre> 
  <h3><a href="https://github.com/bmeg/ophion#limit-and-range" aria-hidden="true" class="anchor" id="user-content-limit-and-range" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>limit and range</h3> 
  <pre><code>{"limit": 13}
{"begin": 84, "end": 87}
</code></pre> 
  <h3><a href="https://github.com/bmeg/ophion#haswithin-predicates" aria-hidden="true" class="anchor" id="user-content-haswithin-predicates" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>has...within</code> predicates</h3> 
  <pre><code>{"has": "arrow", "within": ["feathered", "of time", "prehistoric", "guide"]}
</code></pre> 
  <h3><a href="https://github.com/bmeg/ophion#traversing-from-and-to-edges-and-vertexes" aria-hidden="true" class="anchor" id="user-content-traversing-from-and-to-edges-and-vertexes" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>traversing from and to edges and vertexes</h3> 
  <pre><code>{"in": "pointing at me"}
{"out": "who I'm pointing at"}
{"inEdge": "hop up to the edge"}
{"outEdge": "same but with outgoing"}
{"inVertex": "from an edge, go to the vertex at one end"}
{"outVertex": "go to the vertex on the other end"}
</code></pre> 
  <h3><a href="https://github.com/bmeg/ophion#count-and-counting-by-a-property" aria-hidden="true" class="anchor" id="user-content-count-and-counting-by-a-property" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>count and counting by a property</h3> 
  <pre><code>{"count": ""}
..., {"groupCount": ""}, {"by": "color"}, ...
</code></pre> 
  <p>You can label different group counts and retrieve them with <code>cap</code>:</p> 
  <pre><code>..., 
{"groupCount": "color"},
{"by": "color"},
{"groupCount": "faces"},
{"by": "faces"},
{"cap", ["color", "faces"]}, ...
</code></pre> 
  <h3><a href="https://github.com/bmeg/ophion#marking-a-point-in-a-traversal-with-as-and-selecting-those-points-at-the-end-of-the-traversal" aria-hidden="true" class="anchor" id="user-content-marking-a-point-in-a-traversal-with-as-and-selecting-those-points-at-the-end-of-the-traversal" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>marking a point in a traversal with <code>as</code> and <code>select</code>ing those points at the end of the traversal.</h3> 
  <pre><code>{"as": "birth place"}
... (do some stuff)
{"as": "resting place"}
{"select": ["birth place", "resting place"]} --&gt; just get the endpoints
</code></pre> 
  <p><strong>Ophion</strong> hopes to support the entire gremlin spec in the future, but for now these features already enable all of our current graph query use cases.</p> 
 </article>
</div>