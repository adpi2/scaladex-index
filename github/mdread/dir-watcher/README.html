<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-dir-watcher" class="anchor" href="https://github.com/mdread/dir-watcher#dir-watcher" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>dir-watcher</h1> 
  <p>Directory watcher let you set a watcher for a directory and listen to create, delete, and modify events, then execute the appropriate command.</p> 
  <p>This project can be used both as a stand-alone application, and as a <strong>Scala</strong> or <strong>Java</strong> library embedded into another project.</p> 
  <p>Usage as a library give more control over the implementation of listeners, but the stand-alone version is pretty flexible thanks to the use of a <em>Scala DSL</em> for configuration.</p> 
  <h2><a id="user-content-build-and-install" class="anchor" href="https://github.com/mdread/dir-watcher#build-and-install" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Build and install</h2> 
  <h3><a id="user-content-for-stand-alone-usage" class="anchor" href="https://github.com/mdread/dir-watcher#for-stand-alone-usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>for stand-alone usage</h3> 
  <p>There are two options:</p> 
  <ol> 
   <li><p>download the compiled jar to use it as a stand-alone application. it can be downloaded from the <a href="https://github.com/mdread/dir-watcher/tree/master/dist" target="_blank">dist</a> folder.</p></li> 
   <li><p>clone the project and build the stand-alone jar with <a href="http://www.scala-sbt.org/" target="_blank">sbt</a></p> 
    <div class="highlight highlight-source-shell">
     <pre>git clone https://github.com/mdread/dir-watcher.git
<span class="pl-c1">cd</span> dir-watcher
sbt assembly</pre>
    </div> <p>compiled jar will be in <strong>./target/scala-2.11</strong> directory</p></li> 
  </ol> 
  <h3><a id="user-content-for-usage-as-a-library" class="anchor" href="https://github.com/mdread/dir-watcher#for-usage-as-a-library" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>for usage as a library</h3> 
  <p>include it as a dependency from sbt / maven</p> 
  <p><strong>sbt</strong></p> 
  <pre><code>libraryDependencies += "net.caoticode.dirwatcher" %% "dir-watcher" % "0.1.0"
</code></pre> 
  <p><strong>maven</strong></p> 
  <div class="highlight highlight-text-xml">
   <pre>&lt;<span class="pl-ent">dependency</span>&gt;
  &lt;<span class="pl-ent">groupId</span>&gt;net.caoticode.dirwatcher&lt;/<span class="pl-ent">groupId</span>&gt;
  &lt;<span class="pl-ent">artifactId</span>&gt;dir-watcher_2.11&lt;/<span class="pl-ent">artifactId</span>&gt;
  &lt;<span class="pl-ent">version</span>&gt;0.1.0&lt;/<span class="pl-ent">version</span>&gt;
&lt;/<span class="pl-ent">dependency</span>&gt;</pre>
  </div> 
  <h2><a id="user-content-usage-as-stand-alone-application" class="anchor" href="https://github.com/mdread/dir-watcher#usage-as-stand-alone-application" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage as stand-alone application</h2> 
  <h3><a id="user-content-configuration" class="anchor" href="https://github.com/mdread/dir-watcher#configuration" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Configuration</h3> 
  <p>First thing is to create a configuration file to instruct <em>dir-watcher</em> which folders to watch for, and the actions to take when an event is fired. Next an example configuration file:</p> 
  <p><code>watcher.conf</code></p> 
  <pre><code>Watchers(
  watch("/home/mdread/Documents/test") listen Events(
    create { (root, file) =&gt;
      println("created - " + file.path)
    },
    delete { (root, file) =&gt;
      println("deleted - " + file.path)
    },
    modify { (root, file) =&gt;
      println("modified - " + file.path)
    }
  )
)
</code></pre> 
  <p>Configuration is actually done in Scala itself, with a small DSL for declaring directories to watch, and implement event listeners.</p> 
  <ul> 
   <li><code>Watchers</code> takes a list of <code>watch</code></li> 
   <li><code>watch</code> takes a path to the folder to watch for events (it is recursive)</li> 
   <li><code>Events</code> takes a list of events, possible options are: <code>create</code>, <code>delete</code> and <code>modify</code>. Each of those events is a function with two input parameters, <strong>root</strong> and <strong>file</strong>, representing the parent directory where the file lives, and the actual file for which the event has been fired.</li> 
   <li><strong>root</strong> and <strong>file</strong> are both <em>java.nio.file.Path objects</em>, with some shortcut methods added: 
    <ul> 
     <li><code>isDir</code> returns true if the path refers to a directory.</li> 
     <li><code>path</code> returns the string version of the full path.</li> 
     <li><code>exists</code> returns true if the file exists.</li> 
     <li><code>parent</code> returns a <em>nio.file.Path</em> object referencing the parent directory.</li> 
     <li><code>/</code> useful to build a new path from the previous one, for example <code>root / "myfile.jpg"</code> returns a <em>nio.file.Path</em> object referencing a <em>myfile.jpg</em> file in the <strong>root</strong> folder.</li> 
    </ul></li> 
  </ul> 
  <p>Also the <code>scala.sys.process</code> package gets imported automatically in the configuration file, this makes easy to call external processes on events, for more information on how to use it refer to the <a href="http://www.scala-lang.org/api/current/index.html#scala.sys.process.package" target="_blank">scaladoc</a></p> 
  <h3><a id="user-content-execution" class="anchor" href="https://github.com/mdread/dir-watcher#execution" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Execution</h3> 
  <p>Run it as any executable file, with the configuration file path as parameter. Ex:</p> 
  <div class="highlight highlight-source-shell">
   <pre>java -jar dir-watcher-assembly-0.1.0.jar watcher.conf</pre>
  </div> 
  <h2><a id="user-content-usage-as-library" class="anchor" href="https://github.com/mdread/dir-watcher#usage-as-library" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage as library</h2> 
  <h3><a id="user-content-scala" class="anchor" href="https://github.com/mdread/dir-watcher#scala" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Scala</h3> 
  <p>From Scala you can choose to implement <code>FSListener</code> trait, as shown in the following example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">net.caoticode.dirwatcher.</span><span class="pl-v">DirWatcher</span>
<span class="pl-k">import</span> <span class="pl-v">net.caoticode.dirwatcher.</span><span class="pl-v">FSListener</span>

<span class="pl-k">class</span> <span class="pl-en">LogListener</span> <span class="pl-k">extends</span> <span class="pl-e">FSListener</span> {
  <span class="pl-k">import</span> <span class="pl-v">java.nio.file.</span><span class="pl-v">Path</span>

  <span class="pl-k">override</span> <span class="pl-k">def</span> <span class="pl-en">onCreate</span>(<span class="pl-v">ref</span>: <span class="pl-en">Path</span>)<span class="pl-k">:</span> <span class="pl-k">Unit</span> <span class="pl-k">=</span> println(s<span class="pl-s"><span class="pl-pds">"</span>created $ref<span class="pl-pds">"</span></span>)
  <span class="pl-k">override</span> <span class="pl-k">def</span> <span class="pl-en">onDelete</span>(<span class="pl-v">ref</span>: <span class="pl-en">Path</span>)<span class="pl-k">:</span> <span class="pl-k">Unit</span> <span class="pl-k">=</span> println(s<span class="pl-s"><span class="pl-pds">"</span>deleted $ref<span class="pl-pds">"</span></span>)
  <span class="pl-k">override</span> <span class="pl-k">def</span> <span class="pl-en">onModify</span>(<span class="pl-v">ref</span>: <span class="pl-en">Path</span>)<span class="pl-k">:</span> <span class="pl-k">Unit</span> <span class="pl-k">=</span> println(s<span class="pl-s"><span class="pl-pds">"</span>modified $ref<span class="pl-pds">"</span></span>)
}

<span class="pl-k">object</span> <span class="pl-en">Main</span> <span class="pl-k">extends</span> <span class="pl-e">App</span> {
  <span class="pl-k">val</span> <span class="pl-en">directoryPath</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>/home/mdread/Documents/test<span class="pl-pds">"</span></span>

  <span class="pl-k">val</span> <span class="pl-en">watcher</span> <span class="pl-k">=</span> <span class="pl-en">DirWatcher</span>()
  watcher.watchFor(directoryPath, <span class="pl-k">new</span> <span class="pl-en">LogListener</span>())
  watcher.start()

  <span class="pl-c">// somewhere later ...</span>
  <span class="pl-en">DirWatcher</span>.shutdown()
}</pre>
  </div> 
  <p>or to use the helper methods on <code>Listener</code> object:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">net.caoticode.dirwatcher.</span><span class="pl-v">DirWatcher</span>
<span class="pl-k">import</span> <span class="pl-v">net.caoticode.dirwatcher.</span><span class="pl-v">Listener</span>

<span class="pl-k">object</span> <span class="pl-en">Main</span> <span class="pl-k">extends</span> <span class="pl-e">App</span> {
  <span class="pl-k">val</span> <span class="pl-en">directoryPath</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>/home/mdread/Documents/test<span class="pl-pds">"</span></span>

  <span class="pl-k">val</span> <span class="pl-en">watcher</span> <span class="pl-k">=</span> <span class="pl-en">DirWatcher</span>()

  watcher.watchFor(directoryPath,
      <span class="pl-en">Listener</span>.create{ file <span class="pl-k">=&gt;</span> println(s<span class="pl-s"><span class="pl-pds">"</span>created $file<span class="pl-pds">"</span></span>) },
      <span class="pl-en">Listener</span>.modify{ file <span class="pl-k">=&gt;</span> println(s<span class="pl-s"><span class="pl-pds">"</span>modified $file<span class="pl-pds">"</span></span>) },
      <span class="pl-en">Listener</span>.delete{ file <span class="pl-k">=&gt;</span> println(s<span class="pl-s"><span class="pl-pds">"</span>deleted $file<span class="pl-pds">"</span></span>) })

  watcher.start()

  <span class="pl-c">// somewhere later ...</span>
  <span class="pl-en">DirWatcher</span>.shutdown()
}</pre>
  </div> 
  <p>internally it uses <a href="https://docs.oracle.com/javase/tutorial/essential/io/notification.html" target="_blank">file change notification</a> implemented in <strong>java.nio.file</strong> package, and <a href="http://akka.io/" target="_blank">akka</a> to asyncronusly manage listeners. If you already use akka in your project, it is possible to pass the actor system object to DirWatcher class, just change the line</p> 
  <pre><code>val watcher = DirWatcher()
</code></pre> 
  <p>with</p> 
  <pre><code>val watcher = new DirWatcher(system)
</code></pre> 
  <p>because the watcher system manages a separate thread-pool (with akka) you need to <code>DirWatcher.shutdown()</code> it when you no longer need it.</p> 
  <h3><a id="user-content-java" class="anchor" href="https://github.com/mdread/dir-watcher#java" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Java</h3> 
  <p>Implement FSListener interface (alternatively extend FSListenerAdapter to override only the event you need)</p> 
  <div class="highlight highlight-source-java">
   <pre><span class="pl-k">import</span> <span class="pl-smi">java.nio.file.Path</span>;
<span class="pl-k">import</span> <span class="pl-smi">net.caoticode.dirwatcher.FSListener</span>;

<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">LogListener</span> <span class="pl-k">implements</span> <span class="pl-e">FSListener</span> {

    <span class="pl-k">@Override</span>
    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">onCreate</span>(<span class="pl-smi">Path</span> <span class="pl-v">ref</span>) {
        <span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>created <span class="pl-pds">"</span></span> <span class="pl-k">+</span> ref);
    }

    <span class="pl-k">@Override</span>
    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">onDelete</span>(<span class="pl-smi">Path</span> <span class="pl-v">ref</span>) {
        <span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>deleted <span class="pl-pds">"</span></span> <span class="pl-k">+</span> ref);
    }

    <span class="pl-k">@Override</span>
    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">onModify</span>(<span class="pl-smi">Path</span> <span class="pl-v">ref</span>) {
        <span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(<span class="pl-s"><span class="pl-pds">"</span>modified <span class="pl-pds">"</span></span> <span class="pl-k">+</span> ref);
    }
}</pre>
  </div> 
  <p>then use it with <code>DirWatcher</code> class</p> 
  <div class="highlight highlight-source-java">
   <pre><span class="pl-k">import</span> <span class="pl-smi">net.caoticode.dirwatcher.DirWatcher</span>;

<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">JavaTest</span> {

    <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">main</span>(<span class="pl-k">String</span>[] <span class="pl-v">args</span>) {
        <span class="pl-smi">String</span> directoryPath <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>/home/mdread/Documents/test<span class="pl-pds">"</span></span>;

        <span class="pl-smi">DirWatcher</span> watcher <span class="pl-k">=</span> <span class="pl-smi">DirWatcher</span><span class="pl-k">.</span>apply();
        watcher<span class="pl-k">.</span>watchFor(directoryPath, <span class="pl-k">new</span> <span class="pl-smi">LogListener</span>());
        watcher<span class="pl-k">.</span>start();

        <span class="pl-c">// somewhere later ...</span>
        <span class="pl-smi">DirWatcher</span><span class="pl-k">.</span>shutdown();
    }
}</pre>
  </div> 
 </article>
</div>