<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a href="https://github.com/vert-x/mod-mysql-postgresql#vertx-2x-is-deprecated---use-instead-httpvertxiodocsvertx-mysql-postgresql-clientjava" aria-hidden="true" class="anchor" id="user-content-vertx-2x-is-deprecated---use-instead-httpvertxiodocsvertx-mysql-postgresql-clientjava" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Vert.x 2.x is <strong>deprecated</strong> - use instead <a href="http://vertx.io/docs/vertx-mysql-postgresql-client/java/" target="_blank">http://vertx.io/docs/vertx-mysql-postgresql-client/java/</a></h1> 
  <h2><a href="https://github.com/vert-x/mod-mysql-postgresql#mod-mysql-postgresql" aria-hidden="true" class="anchor" id="user-content-mod-mysql-postgresql" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>mod-mysql-postgresql</h2> 
  <p>This Vert.x module uses the <a href="https://github.com/mauricio/postgresql-async" target="_blank">https://github.com/mauricio/postgresql-async</a> drivers to support a fully async module for MySQL and PostgreSQL.</p> 
  <h3><a href="https://github.com/vert-x/mod-mysql-postgresql#requirements" aria-hidden="true" class="anchor" id="user-content-requirements" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Requirements</h3> 
  <ul> 
   <li>Vert.x 2.1+ (with Scala language module v1.1.0+)</li> 
   <li>A working PostgreSQL or MySQL server</li> 
   <li>For testing PostgreSQL: A <code>testdb</code> database on a local PostgreSQL install and a user called <code>vertx</code></li> 
   <li>For testing MySQL: A <code>testdb</code> database on a local MySQL install and a user called <code>root</code></li> 
  </ul> 
  <h3><a href="https://github.com/vert-x/mod-mysql-postgresql#installation" aria-hidden="true" class="anchor" id="user-content-installation" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Installation</h3> 
  <p>Depending on your Scala version, you should download the specific version. If you're using Scala 2.10.x:</p> 
  <p><code>vertx install io.vertx~mod-mysql-postgresql_2.10~0.3.1</code></p> 
  <p>If you're using Scala 2.11.x:</p> 
  <p><code>vertx install io.vertx~mod-mysql-postgresql_2.11~0.3.1</code></p> 
  <p>If you get a "not found" exception, you might need to edit the repos.txt of your Vert.x installation to use https. See <a href="https://github.com/vert-x/mod-mysql-postgresql/issues/35" target="_blank">issue 35</a> (thanks, @dparshin!).</p> 
  <p>If you get <code>java.lang.ClassNotFoundException: org.vertx.scala.core.VertxAccess$class</code> please update your <code>langs.properties</code> scala entry to:</p> 
  <pre><code>scala=io.vertx~lang-scala_2.10~1.1.0-M1:org.vertx.scala.platform.impl.ScalaVerticleFactory
</code></pre> 
  <p>If you're using Scala in your own project and want to use Scala 2.11, you can change <code>lang-scala_2.10</code> to <code>lang-scala_2.11</code>.</p> 
  <h3><a href="https://github.com/vert-x/mod-mysql-postgresql#configuration" aria-hidden="true" class="anchor" id="user-content-configuration" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Configuration</h3> 
  <pre><code>{
  "address" : &lt;event-bus-addres-to-listen-on&gt;,
  "connection" : &lt;MySQL|PostgreSQL&gt;,
  "host" : &lt;your-host&gt;,
  "port" : &lt;your-port&gt;,
  "maxPoolSize" : &lt;maximum-number-of-open-connections&gt;,
  "username" : &lt;your-username&gt;,
  "password" : &lt;your-password&gt;,
  "database" : &lt;name-of-your-database&gt;
}
</code></pre> 
  <ul> 
   <li><code>address</code> - The address this module should register on the event bus. Defaults to <code>campudus.asyncdb</code></li> 
   <li><code>connection</code> - The database you want to use. Defaults to <code>PostgreSQL</code>.</li> 
   <li><code>host</code> - The host of the database. Defaults to <code>localhost</code>.</li> 
   <li><code>port</code> - The port of the database. Defaults to <code>5432</code> for PostgreSQL and <code>3306</code> for MySQL.</li> 
   <li><code>maxPoolSize</code> - The number of connections that may be kept open. Defaults to <code>10</code>.</li> 
   <li><code>username</code> - The username to connect to the database. Defaults to <code>postgres</code> for PostgreSQL and <code>root</code> for MySQL.</li> 
   <li><code>password</code> - The password to connect to the database. Default is not set, i.e. it uses no password.</li> 
   <li><code>database</code> - The name of the database you want to connect to. Defaults to <code>testdb</code>.</li> 
  </ul> 
  <h3><a href="https://github.com/vert-x/mod-mysql-postgresql#usage" aria-hidden="true" class="anchor" id="user-content-usage" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h3> 
  <p>All commands are relatively similar. Use JSON with the <code>action</code> field and add the needed parameters for each command.</p> 
  <p>There are only a few commands available currently, but in theory you should be able to invoke any command on the database with the <code>raw</code> action.</p> 
  <h4><a href="https://github.com/vert-x/mod-mysql-postgresql#reply-messages" aria-hidden="true" class="anchor" id="user-content-reply-messages" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Reply messages</h4> 
  <p>The module will reply to all requests. In the message, there will be either a <code>"status" : "ok"</code> or a <code>"status" : "error"</code>. If the request could be processed without problems, it will result in an "ok" status. See an example here:</p> 
  <pre><code>{
  "status" : "ok",
  "rows" : 2,
  "message" : "SELECT 2",
  "fields" : [ "name", "email", "is_male", "age", "money", "wedding_date" ],
  "results" : [
    ["Mr. Test", "mr-test@example.com", true, 32, 123.45, "2014-04-04"],
    ["Mrs. Test", "mrs-test@example.com", false, 16, 543.21, "2022-02-22"]
  ]
} 
</code></pre> 
  <ul> 
   <li><code>rows</code> gives you the number of rows affected by the statement sent to the server. Bear in mind that PostgreSQL 8.4 only shows a row count on changed rows (DELETE, UPDATE, INSERT statements) whereas PostgreSQL 9.x and MySQL also show the number of SELECTed rows here.</li> 
   <li><code>message</code> is a status message from the server.</li> 
   <li><code>fields</code> contains the list of fields of the selected table - Only present if the request resulted in a result set.</li> 
   <li><code>results</code> contains a list of rows - Only present if the request resulted in a result set.</li> 
  </ul> 
  <p>If the request resulted in an error, a possible reply message looks like this:</p> 
  <pre><code>{
  "status" : "error",
  "message" : "column \"ager\" does not exist"
}
</code></pre> 
  <h4><a href="https://github.com/vert-x/mod-mysql-postgresql#insert" aria-hidden="true" class="anchor" id="user-content-insert" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>insert</h4> 
  <p>Use this action to insert new rows into a table. You need to specify a table, the fields to insert and an array of rows to insert. The rows itself are an array of values.</p> 
  <pre><code>{
  "action" : "insert",
  "table" : "some_test",
  "fields" : ["name", "email", "is_male", "age", "money", "wedding_date"],
  "values" : [
    ["Mr. Test", "mr-test@example.com", true, 32, 123.45, "2014-04-04"],
    ["Mrs. Test", "mrs-test@example.com", false, 16, 543.21, "2022-02-22"]
  ]
}
</code></pre> 
  <h4><a href="https://github.com/vert-x/mod-mysql-postgresql#select" aria-hidden="true" class="anchor" id="user-content-select" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>select</h4> 
  <p>The <code>select</code> action creates a <code>SELECT</code> statement to get a projection from a table. You can filter the columns by providing a <code>fields</code> array. If you omit the <code>fields</code> array, it selects every column available in the table.</p> 
  <pre><code>{
  "action" : "select",
  "table" : "some_test",
  "fields" : ["name", "email", "is_male", "age", "money", "wedding_date"], // Optional
}
</code></pre> 
  <h4><a href="https://github.com/vert-x/mod-mysql-postgresql#prepared" aria-hidden="true" class="anchor" id="user-content-prepared" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>prepared</h4> 
  <p>Creates a prepared statement and lets you fill the <code>?</code> with values.</p> 
  <pre><code>{
  "action" : "prepared",
  "statement" : "SELECT * FROM some_test WHERE name=? AND money &gt; ?",
  "values" : ["Mr. Test", 15]
}
</code></pre> 
  <h4><a href="https://github.com/vert-x/mod-mysql-postgresql#raw---raw-commands" aria-hidden="true" class="anchor" id="user-content-raw---raw-commands" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>raw - Raw commands</h4> 
  <p>Use this action to send arbitrary commands to the database. You should be able to submit any query or insertion with this command.</p> 
  <p>Here is an example for creating a table in PostgreSQL:</p> 
  <pre><code>{
  "action" : "raw",
  "command" : "CREATE TABLE some_test (
                 id SERIAL,
                 name VARCHAR(255),
                 email VARCHAR(255),
                 is_male BOOLEAN,
                 age INT,
                 money FLOAT,
                 wedding_date DATE
               );"
}
</code></pre> 
  <p>And if you want to drop it again, you can send the following:</p> 
  <pre><code>    {
      "action" : "raw",
      "command" : "DROP TABLE some_test;"
    }
</code></pre> 
  <h4><a href="https://github.com/vert-x/mod-mysql-postgresql#transactions" aria-hidden="true" class="anchor" id="user-content-transactions" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Transactions</h4> 
  <p>These commands let you begin a transaction and send an arbitrary number of statements within the started transaction. You can then commit or rollback the transaction. Nested transactions are not possible until now!</p> 
  <p>Remember to reply to the messages after you send the <code>begin</code> command. Look in the docs how this works (e.g. for Java: <a href="http://vertx.io/core_manual_java.html#replying-to-messages" target="_blank">http://vertx.io/core_manual_java.html#replying-to-messages</a>). With replying to the messages, the module is able to send all statements within the same transaction. If you don't reply within the <code>timeoutTransaction</code> interval, the transaction will automatically fail and rollback.</p> 
  <h5><a href="https://github.com/vert-x/mod-mysql-postgresql#transaction-begin" aria-hidden="true" class="anchor" id="user-content-transaction-begin" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>transaction begin</h5> 
  <p>This command starts a transaction. You get an Ok message back to which you can then reply with more statements.</p> 
  <pre><code>{
    "action" : "begin"
}
</code></pre> 
  <h5><a href="https://github.com/vert-x/mod-mysql-postgresql#transaction-commit" aria-hidden="true" class="anchor" id="user-content-transaction-commit" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>transaction commit</h5> 
  <p>To commit a transaction you have to send the <code>commit</code> command.</p> 
  <pre><code>{
    "action" : "commit"
}
</code></pre> 
  <h5><a href="https://github.com/vert-x/mod-mysql-postgresql#transaction-rollback" aria-hidden="true" class="anchor" id="user-content-transaction-rollback" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>transaction rollback</h5> 
  <p>To rollback a transaction you have to send the <code>rollback</code> command.</p> 
  <pre><code>{
    "action" : "rollback"
}
</code></pre> 
  <h5><a href="https://github.com/vert-x/mod-mysql-postgresql#example-for-a-transaction" aria-hidden="true" class="anchor" id="user-content-example-for-a-transaction" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Example for a transaction</h5> 
  <p>Here is a small example on how a transaction works.</p> 
  <pre><code>{
    "action" : "begin"
}
</code></pre> 
  <p>This will start the transaction. You get this response:</p> 
  <pre><code>{
    "status" : "ok"
}
</code></pre> 
  <p>You can then reply to this message with the commands <code>select</code>, <code>prepared</code>, <code>insert</code> and <code>raw</code>. A possible reply could be this:</p> 
  <pre><code>{
    "action" : "raw",
    "command" : "UPDATE some_test SET email = 'foo@bar.com' WHERE id = 1"
}
</code></pre> 
  <p>You get a reply back depending on the statement you sent. In this case the answer would be:</p> 
  <pre><code>{
    "status" : "ok",
    "rows" : 1,
    "message" : "UPDATE 1"
}
</code></pre> 
  <p>If you want to make more statements you just have to reply to this message again with the next statement. When you have done all statements you can <code>commit</code> or <code>rollback</code> the transaction.</p> 
  <pre><code>{
    "action" : "commit"
}
</code></pre> 
  <p>If everything worked, the last answer will be:</p> 
  <pre><code>{
    "status" : "ok"
}
</code></pre> 
  <h5><a href="https://github.com/vert-x/mod-mysql-postgresql#old-transaction-command-deprecated-use-the-new-transaction-mechanism-with-begin-and-commit" aria-hidden="true" class="anchor" id="user-content-old-transaction-command-deprecated-use-the-new-transaction-mechanism-with-begin-and-commit" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>old transaction command (deprecated, use the new transaction mechanism with begin and commit)</h5> 
  <p>Takes several statements and wraps them into a single transaction for the server to process. Use <code>statement : [...actions...]</code> to create such a transaction. Only <code>select</code>, <code>insert</code> and <code>raw</code> commands are allowed right now.</p> 
  <pre><code>{
  "action" : "transaction",
  "statements" : [
    {
      "action" : "insert",
      "table" : "account",
      "fields" : ["name", "balance"],
      "values" : ["Mr. Test", "0"]
    },
    {
      "action" : "raw",
      "command" : "UPDATE account SET balance=balance+1 WHERE name='Mr. Test'",
    },
    {
      "action" : "prepared",
      "statement" : "UPDATE account SET balance=balance+? WHERE name=?",
      "values" : [25, 'Mr. Test']
    }
  ]
}
</code></pre> 
  <h3><a href="https://github.com/vert-x/mod-mysql-postgresql#planned-actions" aria-hidden="true" class="anchor" id="user-content-planned-actions" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Planned actions</h3> 
  <p>You can always use <code>raw</code> to do anything on the database. If the statement is a query, it will return its results just like a <code>select</code>.</p> 
  <p>The <code>select</code> and <code>insert</code> commands are just for you to be able to have a cross-database application in the end. If you do not use <code>raw</code>, these commands should create the needed statements for you.</p> 
  <ul> 
   <li><code>update</code> - Updates rows of a table</li> 
   <li><code>delete</code> - Deletes rows from a table</li> 
   <li><code>create</code> - Creates a table</li> 
   <li><code>drop</code> - Drops a table</li> 
  </ul> 
  <p>These actions are currently not available, but they should be implemented in the future. Please see the following examples and send feedback:</p> 
  <pre><code>{ // UPDATE some_test SET age=age+1 WHERE id=1
  "action" : "update",
  "table" : "some_test",
  "set" : {
    "age" : {$add : 1}
  },
  "conditions" : {
    "$eq" {
      "id" : 1
    }
  }
}

{ // DELETE FROM some_test WHERE id = 5
  "action" : "delete",
  "table" : "some_test",
  "conditions" : {
    "$eq" {
      "id" : 5
    }
  }
}

// SELECT name, email FROM some_test WHERE is_male=? AND money &gt;= ?
{
  "action" : "prepared",
  "statement" : "SELECT name, email FROM some_test WHERE is_male=? AND money &gt;= ?",
  "values" : [true,100]
}

// CREATE TABLE some_test (
//   id SERIAL,
//   name VARCHAR(255),
//   email VARCHAR(255),
//   age INTEGER
// );
{ 
  "action" : "create",
  "table" : "some_test",
  "fields" : ["id PRIMARY KEY", "name VARCHAR(255)", "email VARCHAR(255)", "age INTEGER"]
}

{ // DROP TABLE some_test
  "action" : "drop",
  "table" : "some_test",
}
</code></pre> 
 </article>
</div>