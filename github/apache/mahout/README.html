<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text"> 
  <h1><a id="user-content-welcome-to-apache-mahout" class="anchor" href="https://github.com/apache/mahout#welcome-to-apache-mahout" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Welcome to Apache Mahout!</h1> 
  <p>The Apache Mahout™ project's goal is to build an environment for quickly creating scalable performant machine learning applications.</p> 
  <p>For additional information about Mahout, visit the <a href="http://mahout.apache.org/" target="_blank">Mahout Home Page</a></p> 
  <h4><a id="user-content-setting-up-your-environment" class="anchor" href="https://github.com/apache/mahout#setting-up-your-environment" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Setting up your Environment</h4> 
  <p>Whether you are using Mahout's Shell, running command line jobs or using it as a library to build your own apps you'll need to setup several environment variables. Edit your environment in <code>~/.bash_profile</code> for Mac or <code>~/.bashrc</code> for many linux distributions. Add the following</p> 
  <pre><code>export MAHOUT_HOME=/path/to/mahout
export MAHOUT_LOCAL=true # for running standalone on your dev machine, 
# unset MAHOUT_LOCAL for running on a cluster
</code></pre> 
  <p>You will need a <code>$JAVA_HOME</code>, and if you are running on Spark, you will also need <code>$SPARK_HOME</code></p> 
  <h4><a id="user-content-using-mahout-as-a-library" class="anchor" href="https://github.com/apache/mahout#using-mahout-as-a-library" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Using Mahout as a Library</h4> 
  <p>Running any application that uses Mahout will require installing a binary or source version and setting the environment. To compile from source:</p> 
  <ul> 
   <li><code>mvn -DskipTests clean install</code></li> 
   <li>To run tests do <code>mvn test</code></li> 
   <li>To set up your IDE, do <code>mvn eclipse:eclipse</code> or <code>mvn idea:idea</code></li> 
  </ul> 
  <p>To use maven, add the appropriate setting to your pom.xml or build.sbt following the template below.</p> 
  <p>To use the Samsara environment you'll need to include both the engine neutral math-scala dependency:</p> 
  <pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.apache.mahout&lt;/groupId&gt;
    &lt;artifactId&gt;mahout-math-scala_2.10&lt;/artifactId&gt;
    &lt;version&gt;${mahout.version}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre> 
  <p>and a dependency for back end engine translation, e.g:</p> 
  <pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.apache.mahout&lt;/groupId&gt;
    &lt;artifactId&gt;mahout-spark_2.10&lt;/artifactId&gt;
    &lt;version&gt;${mahout.version}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre> 
  <h4><a id="user-content-building-from-source" class="anchor" href="https://github.com/apache/mahout#building-from-source" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Building From Source</h4> 
  <h6><a id="user-content-prerequisites" class="anchor" href="https://github.com/apache/mahout#prerequisites" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Prerequisites:</h6> 
  <p>Linux Environment (preferably Ubuntu 16.04.x) Note: Currently only the JVM-only build will work on a Mac. gcc &gt; 4.x NVIDIA Card (installed with OpenCL drivers alongside usual GPU drivers)</p> 
  <h6><a id="user-content-downloads" class="anchor" href="https://github.com/apache/mahout#downloads" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Downloads</h6> 
  <p>Install java 1.7+ in an easily accessible directory (for this example, ~/java/) <a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank">http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html</a></p> 
  <p>Create a directory ~/apache/ .</p> 
  <p>Download apache Maven 3.3.9 and un-tar/gunzip to ~/apache/apache-maven-3.3.9/ . <a href="https://maven.apache.org/download.cgi" target="_blank">https://maven.apache.org/download.cgi</a></p> 
  <p>Download and un-tar/gunzip Hadoop 2.4.1 to ~/apache/hadoop-2.4.1/ . <a href="https://archive.apache.org/dist/hadoop/common/hadoop-2.4.1/" target="_blank">https://archive.apache.org/dist/hadoop/common/hadoop-2.4.1/</a></p> 
  <p>Download and un-tar/gunzip spark-1.6.3-bin-hadoop2.4 to ~/apache/ . <a href="http://spark.apache.org/downloads.html" target="_blank">http://spark.apache.org/downloads.html</a> Choose release: Spark-1.6.3 (Nov 07 2016) Choose package type: Pre-Built for Hadoop 2.4</p> 
  <p>Install ViennaCL 1.7.0+ If running Ubuntu 16.04+</p> 
  <pre><code>sudo apt-get install libviennacl-dev
</code></pre> 
  <p>Otherwise if your distribution’s package manager does not have a viennniacl-dev package &gt;1.7.0, clone it directly into the directory which will be included in when being compiled by Mahout:</p> 
  <pre><code>mkdir ~/tmp
cd ~/tmp &amp;&amp; git clone https://github.com/viennacl/viennacl-dev.git
cp -r viennacl/ /usr/local/
cp -r CL/ /usr/local/
</code></pre> 
  <p>Ensure that the OpenCL 1.2+ drivers are installed (packed with most consumer grade NVIDIA drivers). Not sure about higher end cards.</p> 
  <p>Clone mahout repository into <code>~/apache</code>.</p> 
  <pre><code>git clone https://github.com/apache/mahout.git
</code></pre> 
  <h6><a id="user-content-configuration" class="anchor" href="https://github.com/apache/mahout#configuration" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Configuration</h6> 
  <p>When building mahout for a spark backend, we need four System Environment variables set:</p> 
  <pre><code>    export MAHOUT_HOME=/home/&lt;user&gt;/apache/mahout
    export HADOOP_HOME=/home/&lt;user&gt;/apache/hadoop-2.4.1
    export SPARK_HOME=/home/&lt;user&gt;/apache/spark-1.6.3-bin-hadoop2.4    
    export JAVA_HOME=/home/&lt;user&gt;/java/jdk-1.8.121
</code></pre> 
  <p>Mahout on Spark regularly uses one more env variable, the IP of the Spark cluster’s master node (usually the node which one would be logged into).</p> 
  <p>To use 4 local cores (Spark master need not be running)</p> 
  <pre><code>export MASTER=local[4]
</code></pre> 
  <p>To use all available local cores (again, Spark master need not be running)</p> 
  <pre><code>export MASTER=local[*]
</code></pre> 
  <p>To point to a cluster with spark running:</p> 
  <pre><code>export MASTER=spark://master.ip.address:7077
</code></pre> 
  <p>We then add these to the path:</p> 
  <pre><code>   PATH=$PATH$:MAHOUT_HOME/bin:$HADOOP_HOME/bin:$SPARK_HOME/bin:$JAVA_HOME/bin
</code></pre> 
  <p>These should be added to the your ~/.bashrc file.</p> 
  <h6><a id="user-content-building-mahout-with-apache-maven" class="anchor" href="https://github.com/apache/mahout#building-mahout-with-apache-maven" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Building Mahout with Apache Maven</h6> 
  <p>Currently Mahout has 3 builds. From the $MAHOUT_HOME directory we may issue the commands to build each using mvn profiles.</p> 
  <p>JVM only:</p> 
  <pre><code>mvn clean install -DskipTests
</code></pre> 
  <p>JVM with native OpenMP level 2 and level 3 matrix/vector Multiplication</p> 
  <pre><code>mvn clean install -Pviennacl-omp -Phadoop2 -DskipTests
</code></pre> 
  <p>JVM with native OpenMP and OpenCL for Level 2 and level 3 matrix/vector Multiplication. (GPU errors fall back to OpenMP, currently only a single GPU/node is supported).</p> 
  <pre><code>mvn clean install -Pviennacl -Phadoop2 -DskipTests
</code></pre> 
  <h4><a id="user-content-testing-the-mahout-environment" class="anchor" href="https://github.com/apache/mahout#testing-the-mahout-environment" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Testing the Mahout Environment</h4> 
  <p>Mahout provides an extension to the spark-shell, which is good for getting to know the language, testing partition loads, prototyping algorithms, etc..</p> 
  <p>To launch the shell in local mode with 2 threads: simply do the following:</p> 
  <pre><code>$ MASTER=local[2] mahout spark-shell
</code></pre> 
  <p>After a very verbose startup, a Mahout welcome screen will appear:</p> 
  <pre><code>Loading /home/andy/sandbox/apache-mahout-distribution-0.13.0/bin/load-shell.scala...
import org.apache.mahout.math._
import org.apache.mahout.math.scalabindings._
import org.apache.mahout.math.drm._
import org.apache.mahout.math.scalabindings.RLikeOps._
import org.apache.mahout.math.drm.RLikeDrmOps._
import org.apache.mahout.sparkbindings._
sdc: org.apache.mahout.sparkbindings.SparkDistributedContext = org.apache.mahout.sparkbindings.SparkDistributedContext@3ca1f0a4

                _                 _
_ __ ___   __ _| |__   ___  _   _| |_
 '_ ` _ \ / _` | '_ \ / _ \| | | | __|
 | | | | (_| | | | | (_) | |_| | |_
_| |_| |_|\__,_|_| |_|\___/ \__,_|\__|  version 0.13.0


That file does not exist


scala&gt;

At the scala&gt; prompt, enter: 
    
scala&gt; :load home/&lt;andy&gt;/apache/mahout/examples
                               /bin/SparseSparseDrmTimer.mscala

Which will load a matrix multiplication timer function definition. To run the matrix timer: 

        scala&gt; timeSparseDRMMMul(1000,1000,1000,1,.02,1234L)
            {...} res3: Long = 16321

We can see that the JVM only version is rather slow, thus our motive for GPU and Native Multithreading support.

To get an idea of what’s going on under the hood of the timer, we may examine the .mscala (mahout scala) code which is both fully functional scala and the Mahout R-Like DSL for tensor algebra:    




def timeSparseDRMMMul(m: Int, n: Int, s: Int, para: Int, pctDense: Double = .20, seed: Long = 1234L): Long = {
  val drmA = drmParallelizeEmpty(m , s, para).mapBlock(){
       case (keys,block:Matrix) =&gt;
           val R =  scala.util.Random
           R.setSeed(seed)
           val blockB = new SparseRowMatrix(block.nrow, block.ncol)
           blockB := {x =&gt; if (R.nextDouble &gt; pctDense) R.nextDouble else x }
       (keys -&gt; blockB)
  }

  val drmB = drmParallelizeEmpty(s , n, para).mapBlock(){
       case (keys,block:Matrix) =&gt;
           val R =  scala.util.Random
           R.setSeed(seed + 1)
           val blockB = new SparseRowMatrix(block.nrow, block.ncol)
           blockB := {x =&gt; if (R.nextDouble &gt; pctDense) R.nextDouble else x }
       (keys -&gt; blockB)
  }

  var time = System.currentTimeMillis()

  val drmC = drmA %*% drmB
 
  // trigger computation
  drmC.numRows()

  time = System.currentTimeMillis() - time

  time  
 
}
</code></pre> 
  <p>For more information please see the following references:</p> 
  <p><a href="http://mahout.apache.org/users/environment/in-core-reference.html" target="_blank">http://mahout.apache.org/users/environment/in-core-reference.html</a> <a href="http://mahout.apache.org/users/environment/out-of-core-reference.html" target="_blank">http://mahout.apache.org/users/environment/out-of-core-reference.html</a> <a href="http://mahout.apache.org/users/sparkbindings/play-with-shell.html" target="_blank">http://mahout.apache.org/users/sparkbindings/play-with-shell.html</a> <a href="http://mahout.apache.org/users/environment/classify-a-doc-from-the-shell.html" target="_blank">http://mahout.apache.org/users/environment/classify-a-doc-from-the-shell.html</a></p> 
  <p>Note that due to an intermittent out-of-memory bug in a Flink test we have disabled it from the binary releases. To use Flink please uncomment the line in the root pom.xml in the <code>&lt;modules&gt;</code> block so it reads <code>&lt;module&gt;flink&lt;/module&gt;</code>.</p> 
  <h4><a id="user-content-examples" class="anchor" href="https://github.com/apache/mahout#examples" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Examples</h4> 
  <p>For examples of how to use Mahout, see the examples directory located in <code>examples/bin</code></p> 
  <p>For information on how to contribute, visit the <a href="https://mahout.apache.org/developers/how-to-contribute.html" target="_blank">How to Contribute Page</a></p> 
  <h4><a id="user-content-legal" class="anchor" href="https://github.com/apache/mahout#legal" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Legal</h4> 
  <p>Please see the <code>NOTICE.txt</code> included in this directory for more information.</p> 
  <p><a href="https://travis-ci.org/apache/mahout" target="_blank"><img src="https://camo.githubusercontent.com/e93104027ac663368191794dc55bfe93a3de5791/68747470733a2f2f6170692e7472617669732d63692e6f72672f6170616368652f6d61686f75742e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://api.travis-ci.org/apache/mahout.svg?branch=master" style="max-width:100%;"></a></p> 
 </article>
</div>