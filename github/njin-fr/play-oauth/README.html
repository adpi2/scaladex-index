<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-oauth2-kit-for-play-framework-22--" class="anchor" href="https://github.com/njin-fr/play-oauth#oauth2-kit-for-play-framework-22--" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Oauth2 kit for Play! Framework 2.2 <a href="https://travis-ci.org/njin-fr/play-oauth" target="_blank"><img src="https://camo.githubusercontent.com/e35b777b893cd96e99db5c95082653f4f938beb4/68747470733a2f2f7472617669732d63692e6f72672f6e6a696e2d66722f706c61792d6f617574682e706e673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/njin-fr/play-oauth.png?branch=master" style="max-width:100%;"></a> <a href="https://coveralls.io/r/njin-fr/play-oauth" target="_blank"><img src="https://camo.githubusercontent.com/6bad373231e538246df8b970ff93685ee365ec82/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6e6a696e2d66722f706c61792d6f617574682f62616467652e706e67" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/njin-fr/play-oauth/badge.png" style="max-width:100%;"></a></h1> 
  <p>play-oauth is a type safe and reactive framework which allows you to create an <a href="http://oauth.net" target="_blank">Oauth2</a> authorization server with Play Framework 2 in scala. You can also integrate an Oauth2 authorization relatively easily in your project.</p> 
  <p>It also allows you to protect your resources.</p> 
  <h2><a id="user-content-features" class="anchor" href="https://github.com/njin-fr/play-oauth#features" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Features</h2> 
  <p>play-oauth implements the final version of the specification <a href="http://tools.ietf.org/html/rfc6749" target="_blank">http://tools.ietf.org/html/rfc6749</a>. Amongst others the following aspects of the protocol:</p> 
  <ul> 
   <li>Authorization Grant 
    <ul> 
     <li>Authorization Code Grant</li> 
     <li>Implicit Grant</li> 
     <li>Resource Owner Password Credentials Grant</li> 
     <li>Client Credentials Grant</li> 
    </ul></li> 
   <li>Issuing an Access Token</li> 
   <li>Refreshing an Access Token</li> 
   <li>Accessing Protected Resources</li> 
  </ul> 
  <p>Beyond the specification, play-oauth provided some helpers to protect the resources even if the authorization server is different from the resource server.</p> 
  <p>play-oauth is a fairly flexible framework</p> 
  <h2><a id="user-content-installation" class="anchor" href="https://github.com/njin-fr/play-oauth#installation" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Installation</h2> 
  <p>Add the framework to your dependencies</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-s"><span class="pl-pds">"</span>fr.njin<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>play-oauth<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>1.0.0<span class="pl-pds">"</span></span></pre>
  </div> 
  <h2><a id="user-content-scala-doc" class="anchor" href="https://github.com/njin-fr/play-oauth#scala-doc" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Scala doc</h2> 
  <p>The latest api documentation can be founded at <a href="http://njin-fr.github.io/play-oauth/latest/api/" target="_blank">http://njin-fr.github.io/play-oauth/latest/api/</a></p> 
  <p>For previous version, replace <code>latest</code> in the url with the desired version. Ex: <a href="http://njin-fr.github.io/play-oauth/1.0.0-SNAPSHOT/api/" target="_blank">http://njin-fr.github.io/play-oauth/<strong>1.0.0</strong>/api/</a></p> 
  <h2><a id="user-content-how-to-use-it" class="anchor" href="https://github.com/njin-fr/play-oauth#how-to-use-it" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>How to use it</h2> 
  <p>The framework is responsible for implementing the specification but leaves you free to create your authorization server. You have to provide your models (the most difficult part) and to create 2 controller actions representing the endpoints of the protocol, Authorization endpoint and Token endpoint.</p> 
  <h3><a id="user-content-models" class="anchor" href="https://github.com/njin-fr/play-oauth#models" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Models</h3> 
  <p>Except for <code>OauthResourceOwner</code>, the framework provides a base implementation for all of these models. You can use it as an example. Here is what you need to provide:</p> 
  <h4><a id="user-content-oauthresourceowner" class="anchor" href="https://github.com/njin-fr/play-oauth#oauthresourceowner" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>OauthResourceOwner</code></h4> 
  <p>An entity capable of granting access to a protected resource. Maybe the User of your application.</p> 
  <blockquote> 
   <p>Example</p> 
  </blockquote> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">User</span>(username<span class="pl-k">:</span><span class="pl-k">String</span>, 
                password<span class="pl-k">:</span><span class="pl-k">String</span>, 
                permissions<span class="pl-k">:</span><span class="pl-en">Map</span>[<span class="pl-en">BasicOauthClient</span>, <span class="pl-en">BasicOAuthPermission</span>[<span class="pl-en">BasicOauthClient</span>]]) <span class="pl-k">extends</span> <span class="pl-e">OauthResourceOwner</span></pre>
  </div> 
  <h4><a id="user-content-oauthclient" class="anchor" href="https://github.com/njin-fr/play-oauth#oauthclient" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>OauthClient</code></h4> 
  <p>An application making protected resource requests on behalf of the resource owner and with its authorization.</p> 
  <blockquote> 
   <p>Example</p> 
  </blockquote> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">BasicOauthClient</span>(<span class="pl-k">val</span> <span class="pl-en">id</span><span class="pl-k">:</span><span class="pl-k">String</span>,
                       <span class="pl-k">val</span> <span class="pl-en">secret</span><span class="pl-k">:</span><span class="pl-k">String</span>,
                       <span class="pl-k">val</span> <span class="pl-en">allowedResponseType</span><span class="pl-k">:</span> <span class="pl-en">Seq</span>[<span class="pl-k">String</span>],
                       <span class="pl-k">val</span> <span class="pl-en">allowedGrantType</span><span class="pl-k">:</span> <span class="pl-en">Seq</span>[<span class="pl-k">String</span>],
                       <span class="pl-k">val</span> <span class="pl-en">redirectUris</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-en">Seq</span>[<span class="pl-k">String</span>]] <span class="pl-k">=</span> <span class="pl-c1">None</span>,
                       <span class="pl-k">val</span> <span class="pl-en">authorized</span><span class="pl-k">:</span> <span class="pl-k">Boolean</span> <span class="pl-k">=</span> <span class="pl-c1">true</span>) <span class="pl-k">extends</span> <span class="pl-e">OauthClient</span> {

  <span class="pl-k">def</span> <span class="pl-en">redirectUri</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-k">String</span>] <span class="pl-k">=</span> redirectUris.flatMap(_.headOption)

}</pre>
  </div> 
  <ul> 
   <li><code>allowedResponseType</code> define the <a href="http://tools.ietf.org/html/rfc6749#section-3.1.1" target="_blank">allowed response types</a> for this client: <code>code</code> and/or <code>token</code></li> 
   <li><code>allowedGrantType</code> define the <a href="http://tools.ietf.org/html/rfc6749#section-4" target="_blank">allowed grant types</a> for the client: <code>authorization_code</code> for authorization code, <code>refresh_token</code> for refreshing an Access Token, <code>password</code> for resource owner password credentials, and <code>client_credentials</code> for client credentials</li> 
  </ul> 
  <h4><a id="user-content-oauthcode" class="anchor" href="https://github.com/njin-fr/play-oauth#oauthcode" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>OauthCode</code></h4> 
  <p>The authorization code <a href="http://tools.ietf.org/html/rfc6749#section-1.3.1" target="_blank">http://tools.ietf.org/html/rfc6749#section-1.3.1</a></p> 
  <p>The authorization code is created for the customer according to the permission granted by the resource owner. These two entities are required in this model.</p> 
  <blockquote> 
   <p>Example</p> 
  </blockquote> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">BasicOauthCode</span>[<span class="pl-en">RO</span> <span class="pl-k">&lt;</span><span class="pl-k">:</span> <span class="pl-en">OauthResourceOwner</span>, <span class="pl-en">C</span> <span class="pl-k">&lt;</span><span class="pl-k">:</span> <span class="pl-en">OauthClient</span>]
                    (<span class="pl-k">val</span> <span class="pl-en">value</span><span class="pl-k">:</span> <span class="pl-k">String</span>,
                     <span class="pl-k">val</span> <span class="pl-en">owner</span><span class="pl-k">:</span><span class="pl-en">RO</span>,
                     <span class="pl-k">val</span> <span class="pl-en">client</span><span class="pl-k">:</span> <span class="pl-en">C</span>,
                     <span class="pl-k">val</span> <span class="pl-en">issueAt</span><span class="pl-k">:</span> <span class="pl-k">Long</span>,
                     <span class="pl-k">val</span> <span class="pl-en">expireIn</span><span class="pl-k">:</span> <span class="pl-k">Long</span> <span class="pl-k">=</span> <span class="pl-en">OAuth</span>.<span class="pl-en">MaximumLifetime</span>.toMillis,
                     <span class="pl-k">val</span> <span class="pl-en">revoked</span><span class="pl-k">:</span> <span class="pl-k">Boolean</span> <span class="pl-k">=</span> <span class="pl-c1">false</span>,
                     <span class="pl-k">val</span> <span class="pl-en">redirectUri</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-k">String</span>] <span class="pl-k">=</span> <span class="pl-c1">None</span>,
                     <span class="pl-k">val</span> <span class="pl-en">scopes</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-en">Seq</span>[<span class="pl-k">String</span>]] <span class="pl-k">=</span> <span class="pl-c1">None</span>) <span class="pl-k">extends</span> <span class="pl-e">OauthCode</span>[<span class="pl-en">RO</span>, <span class="pl-en">C</span>]</pre>
  </div> 
  <h4><a id="user-content-oauthpermission" class="anchor" href="https://github.com/njin-fr/play-oauth#oauthpermission" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>OauthPermission</code></h4> 
  <p>Represents the authorization granted by the resource owner when the client requests the authorization code or token.</p> 
  <blockquote> 
   <p>Example</p> 
  </blockquote> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">BasicOAuthPermission</span>[<span class="pl-en">C</span> <span class="pl-k">&lt;</span><span class="pl-k">:</span> <span class="pl-en">OauthClient</span>](<span class="pl-k">val</span> <span class="pl-en">accepted</span><span class="pl-k">:</span> <span class="pl-k">Boolean</span>,
                                             <span class="pl-k">val</span> <span class="pl-en">client</span><span class="pl-k">:</span> <span class="pl-en">C</span>,
                                             <span class="pl-k">val</span> <span class="pl-en">scope</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-en">Seq</span>[<span class="pl-k">String</span>]],
                                             <span class="pl-k">val</span> <span class="pl-en">redirectUri</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-k">String</span>]) <span class="pl-k">extends</span> <span class="pl-e">OauthPermission</span>[<span class="pl-en">C</span>] {

  <span class="pl-k">def</span> <span class="pl-en">authorized</span>(<span class="pl-v">request</span>: <span class="pl-en">AuthzRequest</span>)<span class="pl-k">:</span> <span class="pl-k">Boolean</span> <span class="pl-k">=</span> accepted <span class="pl-k">&amp;&amp;</span> request.redirectUri <span class="pl-k">==</span> redirectUri

}</pre>
  </div> 
  <h4><a id="user-content-oauthtoken" class="anchor" href="https://github.com/njin-fr/play-oauth#oauthtoken" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>OauthToken</code></h4> 
  <p>Access tokens <a href="http://tools.ietf.org/html/rfc6749#section-1.4" target="_blank">http://tools.ietf.org/html/rfc6749#section-1.4</a></p> 
  <blockquote> 
   <p>Example</p> 
  </blockquote> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">BasicOauthToken</span>[<span class="pl-en">RO</span> <span class="pl-k">&lt;</span><span class="pl-k">:</span> <span class="pl-en">OauthResourceOwner</span>, <span class="pl-en">C</span> <span class="pl-k">&lt;</span><span class="pl-k">:</span> <span class="pl-en">OauthClient</span>](
                      <span class="pl-k">val</span> <span class="pl-en">owner</span><span class="pl-k">:</span> <span class="pl-en">RO</span>,
                      <span class="pl-k">val</span> <span class="pl-en">client</span><span class="pl-k">:</span> <span class="pl-en">C</span>,
                      <span class="pl-k">val</span> <span class="pl-en">accessToken</span><span class="pl-k">:</span> <span class="pl-k">String</span>,
                      <span class="pl-k">val</span> <span class="pl-en">tokenType</span><span class="pl-k">:</span> <span class="pl-k">String</span>,
                      <span class="pl-k">val</span> <span class="pl-en">revoked</span><span class="pl-k">:</span> <span class="pl-k">Boolean</span> <span class="pl-k">=</span> <span class="pl-c1">false</span>,
                      <span class="pl-k">val</span> <span class="pl-en">expiresIn</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-k">Long</span>] <span class="pl-k">=</span> <span class="pl-c1">None</span>,
                      <span class="pl-k">val</span> <span class="pl-en">refreshToken</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-k">String</span>] <span class="pl-k">=</span> <span class="pl-c1">None</span>,
                      <span class="pl-k">val</span> <span class="pl-en">scope</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-en">Seq</span>[<span class="pl-k">String</span>]] <span class="pl-k">=</span> <span class="pl-c1">None</span>) <span class="pl-k">extends</span> <span class="pl-e">OauthToken</span>[<span class="pl-en">RO</span>, <span class="pl-en">C</span>]</pre>
  </div> 
  <h4><a id="user-content-oauthscope" class="anchor" href="https://github.com/njin-fr/play-oauth#oauthscope" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>OauthScope</code></h4> 
  <p>Access Token Scope <a href="http://tools.ietf.org/html/rfc6749#section-3.3" target="_blank">http://tools.ietf.org/html/rfc6749#section-3.3</a></p> 
  <blockquote> 
   <p>Example</p> 
  </blockquote> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">BasicOauthScope</span>(<span class="pl-k">val</span> <span class="pl-en">id</span><span class="pl-k">:</span> <span class="pl-k">String</span>,
                      <span class="pl-k">val</span> <span class="pl-en">name</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-k">String</span>] <span class="pl-k">=</span> <span class="pl-c1">None</span>,
                      <span class="pl-k">val</span> <span class="pl-en">description</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-k">String</span>] <span class="pl-k">=</span> <span class="pl-c1">None</span>) <span class="pl-k">extends</span> <span class="pl-e">OauthScope</span></pre>
  </div> 
  <h3><a id="user-content-endpoints-dependencies" class="anchor" href="https://github.com/njin-fr/play-oauth#endpoints-dependencies" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Endpoints dependencies</h3> 
  <p>Before implementing the endpoints, you will need to prepare their dependencies. Endpoints need to create some of the models above (codes and tokens) and generally find them. To do this, it will be necessary to provide a series of "repository" and some "factory".</p> 
  <h4><a id="user-content-oauthcodefactory" class="anchor" href="https://github.com/njin-fr/play-oauth#oauthcodefactory" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>OauthCodeFactory</code></h4> 
  <p>Creates a <code>OauthCode</code> for the given resource owner and client. It is important to store the url redirection and scopes because they will be audited by the endpoint when generating the token.</p> 
  <blockquote> 
   <p>Beware, the created code must be persisted before being returned to the endpoint.</p> 
  </blockquote> 
  <h4><a id="user-content-oauthtokenfactory" class="anchor" href="https://github.com/njin-fr/play-oauth#oauthtokenfactory" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>OauthTokenFactory</code></h4> 
  <p>Creates a <code>OauthToken</code> for the given resource owner and client.</p> 
  <blockquote> 
   <p>Beware, the created token must be persisted before being returned to the endpoint.</p> 
  </blockquote> 
  <h4><a id="user-content-oauthclientrepository" class="anchor" href="https://github.com/njin-fr/play-oauth#oauthclientrepository" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>OauthClientRepository</code></h4> 
  <p>To retrieve a client from its identifier.</p> 
  <h4><a id="user-content-oauthscoperepository" class="anchor" href="https://github.com/njin-fr/play-oauth#oauthscoperepository" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>OauthScopeRepository</code></h4> 
  <p>Provides the scopes for the id list. The returned map contains the available scopes. If a scope is not in the map, the endpoint will refuse to create the code or token requested by the client.</p> 
  <h4><a id="user-content-oauthcoderepository" class="anchor" href="https://github.com/njin-fr/play-oauth#oauthcoderepository" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>OauthCodeRepository</code></h4> 
  <p>Provides a code from its value. Also allow to revoke a code before creating the token.</p> 
  <h4><a id="user-content-oauthtokenrepository" class="anchor" href="https://github.com/njin-fr/play-oauth#oauthtokenrepository" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>OauthTokenRepository</code></h4> 
  <p>Provides a token from its value or from its refresh token value. Also allow to revoke a token. A token is revoked before a new one is created from its refresh token value. </p> 
  <h4><a id="user-content-oauthresourceownerpermission" class="anchor" href="https://github.com/njin-fr/play-oauth#oauthresourceownerpermission" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>OauthResourceOwnerPermission</code></h4> 
  <p>Provides to the authorization endpoint the permission granted by the resource owner in order to create a code or a token for the client.</p> 
  <h3><a id="user-content-endpoints" class="anchor" href="https://github.com/njin-fr/play-oauth#endpoints" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Endpoints</h3> 
  <p>We now have what it takes to create our endpoint, the hardest has been done.</p> 
  <h4><a id="user-content-authorization-endpoint" class="anchor" href="https://github.com/njin-fr/play-oauth#authorization-endpoint" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Authorization Endpoint</h4> 
  <p>To create your authorization endpoint, instantiate an <code>AuthorizationEndpoint</code> and call the <code>authorize</code> method in your action.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">authorize</span>(owner<span class="pl-k">:</span>(<span class="pl-en">RequestHeader</span>) <span class="pl-k">=&gt;</span> <span class="pl-en">Option</span>[<span class="pl-en">RO</span>])
             (onUnauthenticated<span class="pl-k">:</span>(<span class="pl-en">AuthzRequest</span>, <span class="pl-en">C</span>) <span class="pl-k">=&gt;</span> <span class="pl-en">RequestHeader</span> <span class="pl-k">=&gt;</span> <span class="pl-en">Future</span>[<span class="pl-en">SimpleResult</span>],
              onUnauthorized<span class="pl-k">:</span>(<span class="pl-en">AuthzRequest</span>, <span class="pl-en">C</span>) <span class="pl-k">=&gt;</span> <span class="pl-en">RequestHeader</span> <span class="pl-k">=&gt;</span> <span class="pl-en">Future</span>[<span class="pl-en">SimpleResult</span>])
             (<span class="pl-k">implicit</span> ec<span class="pl-k">:</span><span class="pl-en">ExecutionContext</span>)<span class="pl-k">:</span> <span class="pl-en">RequestHeader</span> <span class="pl-k">=&gt;</span> <span class="pl-en">Future</span>[<span class="pl-en">SimpleResult</span>]</pre>
  </div> 
  <p>with the following parameters:</p> 
  <ul> 
   <li><p><code>owner:(RequestHeader) =&gt; Option[RO]</code> : A function that extract the current resource owner from the request. Return None if there is no resource owner.</p></li> 
   <li><p><code>onUnauthenticated:(AuthzRequest, C) =&gt; RequestHeader =&gt; Future[SimpleResult]</code> : A function called when no resource owner is found (when <code>owner</code> return None). You can use it to show a login page to the end user.</p></li> 
   <li><p><code>onUnauthorized:(AuthzRequest, C) =&gt; RequestHeader =&gt; Future[SimpleResult])</code> : A function called when the resource owner didn't allow the client to obtain a token (when <code>permissions</code> return None). You can use it to show a decision form to the end user then create a permission for the request.</p></li> 
  </ul> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">authz</span> <span class="pl-k">=</span> <span class="pl-en">Action</span>.async { request <span class="pl-k">=&gt;</span>
  <span class="pl-k">new</span> <span class="pl-en">AuthorizationEndpoint</span>(...).authorize(...)(..., ...).apply(request)
}</pre>
  </div> 
  <p><em>See the sample for a feature-rich authorization endpoint <a href="https://github.com/njin-fr/play-oauth/blob/master/play-oauth-server/app/controllers/Authorization.scala" target="_blank">play-oauth-server/app/controllers/Authorization.scala</a></em></p> 
  <blockquote> 
   <p><strong>Please notice</strong></p> 
   <p>The authorize endpoint don't use the request body. It's recommended that you pass an empty parser to your action <code>Action.async(parse.empty)</code></p> 
  </blockquote> 
  <h4><a id="user-content-token-endpoint" class="anchor" href="https://github.com/njin-fr/play-oauth#token-endpoint" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Token Endpoint</h4> 
  <p>To create your token endpoint, instantiate a <code>TokenEndpoint</code> and call the <code>token</code> method in your action after implementing the <code>authenticate</code> method. This method is use to authenticate the client of the request. See <a href="https://github.com/njin-fr/play-oauth#client-authentication" target="_blank">Client Authentication section</a> </p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">token</span>(<span class="pl-v">owner</span>: (<span class="pl-k">String</span>, <span class="pl-k">String</span>) <span class="pl-k">=&gt;</span> <span class="pl-en">Future</span>[<span class="pl-en">Option</span>[<span class="pl-en">RO</span>]], <span class="pl-v">clientOwner</span>: <span class="pl-en">C</span> <span class="pl-k">=&gt;</span> <span class="pl-en">Future</span>[<span class="pl-en">Option</span>[<span class="pl-en">RO</span>]])
         (<span class="pl-k">implicit</span> ec<span class="pl-k">:</span><span class="pl-en">ExecutionContext</span>, <span class="pl-v">writes</span>: <span class="pl-en">Writes</span>[<span class="pl-en">TokenResponse</span>], <span class="pl-v">errorWrites</span>: <span class="pl-en">Writes</span>[<span class="pl-en">OauthError</span>])<span class="pl-k">:</span> <span class="pl-en">Request</span>[<span class="pl-en">AnyContentAsFormUrlEncoded</span>] <span class="pl-k">=&gt;</span> <span class="pl-en">Future</span>[<span class="pl-en">SimpleResult</span>]</pre>
  </div> 
  <p>with the following parameters:</p> 
  <ul> 
   <li><code>owner: (String, String) =&gt; Future[Option[RO]]</code> : A function that return a resource owner for the given username &amp; password pair. This is used for the <em>password</em> grant type</li> 
   <li><code>clientOwner: C =&gt; Future[Option[RO]]</code>: A function that return the resource owner of the given client. This is used for the <em>client credential</em> grant type</li> 
  </ul> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">token</span> <span class="pl-k">=</span> <span class="pl-en">Action</span>.async(parse.urlFormEncoded.map(<span class="pl-k">new</span> <span class="pl-en">AnyContentAsFormUrlEncoded</span>(_))) { request <span class="pl-k">=&gt;</span>
  <span class="pl-k">new</span> <span class="pl-en">TokenEndpoint</span>().token(...,...).apply(request)
}</pre>
  </div> 
  <p><em>See the sample for a feature-rich token endpoint <a href="https://github.com/njin-fr/play-oauth/blob/master/play-oauth-server/app/controllers/Token.scala" target="_blank">play-oauth-server/app/controllers/Token.scala</a></em></p> 
  <blockquote> 
   <p><strong>Please notice</strong></p> 
   <p>The token endpoint use a form url encoded request body. You have to pass the appropriate parser to your action <code>Action.async(parse.urlFormEncoded.map(new AnyContentAsFormUrlEncoded(_)))</code></p> 
  </blockquote> 
  <h5><a id="user-content-client-authentication" class="anchor" href="https://github.com/njin-fr/play-oauth#client-authentication" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Client Authentication</h5> 
  <p>In order to issue the token to the correct client, the token endpoint need to authenticate the client from the request. You will have to extend your endpoint with a <code>ClientAuthentication</code></p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">trait</span> <span class="pl-en">ClientAuthentication</span>[<span class="pl-en">C</span> <span class="pl-k">&lt;</span><span class="pl-k">:</span> <span class="pl-en">OauthClient</span>] {
  <span class="pl-k">def</span> <span class="pl-en">authenticate</span>(<span class="pl-v">request</span>: <span class="pl-en">Request</span>[<span class="pl-en">AnyContentAsFormUrlEncoded</span>])<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">Either</span>[<span class="pl-en">Option</span>[<span class="pl-en">C</span>], <span class="pl-en">OauthError</span>]]
}</pre>
  </div> 
  <p>You can use the <code>SecretKeyClientAuthentication</code> which will bring to you the client id and secret key extracted from the request body.</p> 
  <p>Return either the client (none if not exist) or an error (ex : if credential don't match).</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">authenticate</span>(<span class="pl-v">id</span>: <span class="pl-k">String</span>, <span class="pl-v">secret</span>: <span class="pl-k">String</span>)<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">Either</span>[<span class="pl-en">Option</span>[<span class="pl-en">App</span>], <span class="pl-en">OauthError</span>]] <span class="pl-k">=</span>
    clientRepository.find(id).map(_.fold[<span class="pl-en">Either</span>[<span class="pl-en">Option</span>[<span class="pl-en">App</span>], <span class="pl-en">OauthError</span>]](<span class="pl-en">Left</span>(<span class="pl-c1">None</span>)) { app <span class="pl-k">=&gt;</span>
      <span class="pl-k">if</span>(app.secret <span class="pl-k">==</span> secret)
        <span class="pl-en">Left</span>(<span class="pl-en">Some</span>(app))
      <span class="pl-k">else</span>
        <span class="pl-en">Right</span>(<span class="pl-en">OauthError</span>.<span class="pl-en">InvalidClientError</span>(<span class="pl-en">Some</span>(<span class="pl-en">Messages</span>(<span class="pl-en">OAuth</span>.<span class="pl-en">ErrorClientCredentialsDontMatch</span>))))
    })</pre>
  </div> 
  <h3><a id="user-content-resource-protection" class="anchor" href="https://github.com/njin-fr/play-oauth#resource-protection" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Resource protection</h3> 
  <p>play-oauth gives you a helper to protect your resource. The <code>Oauth2Resource</code> object has a method <code>scoped</code> that you can compose with your action to get the resource owner for the request.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">scoped</span>[<span class="pl-en">U</span>](<span class="pl-v">scopes</span>: <span class="pl-k">String</span><span class="pl-k">*</span>)(<span class="pl-v">action</span>: <span class="pl-en">U</span> <span class="pl-k">=&gt;</span> <span class="pl-en">EssentialAction</span>)
             (<span class="pl-v">onUnauthorized</span>: <span class="pl-en">EssentialAction</span> <span class="pl-k">=</span> <span class="pl-en">Action</span> { <span class="pl-en">Unauthorized</span>(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>) },
              <span class="pl-v">onForbidden</span>: <span class="pl-en">Seq</span>[<span class="pl-k">String</span>] <span class="pl-k">=&gt;</span> <span class="pl-en">EssentialAction</span> <span class="pl-k">=</span> scopes <span class="pl-k">=&gt;</span> <span class="pl-en">Action</span> { <span class="pl-en">Forbidden</span>(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>) })
             (<span class="pl-k">implicit</span> <span class="pl-v">resourceOwner</span>: <span class="pl-en">Seq</span>[<span class="pl-k">String</span>] <span class="pl-k">=&gt;</span> <span class="pl-en">RequestHeader</span> <span class="pl-k">=&gt;</span> <span class="pl-en">Future</span>[<span class="pl-en">Either</span>[<span class="pl-en">Option</span>[<span class="pl-en">U</span>], <span class="pl-en">Seq</span>[<span class="pl-k">String</span>]]],
              <span class="pl-v">ec</span>: <span class="pl-en">ExecutionContext</span> <span class="pl-k">=</span> scala.concurrent.<span class="pl-en">ExecutionContext</span>.global)<span class="pl-k">:</span> <span class="pl-en">EssentialAction</span></pre>
  </div> 
  <p>This method extracts the resource owner from the request using the <code>resourceOwner</code> parameter. It is with this function that you extract the token from the request, verify the validity of the scope and get the user of the token. <code>Oauth2Resource</code> provides a function for this process, you just have to provide a way to retrieve the token value from the request (See some helpers in <a href="https://github.com/njin-fr/play-oauth/blob/master/play-oauth/src/main/scala/fr/njin/playoauth/Utils.scala" target="_blank">play-oauth/src/main/scala/fr/njin/playoauth/Utils.scala</a>, particularly the <code>parseBearer</code> function) and to retrieve the token locally with your tokenRepository or remotely using a WS call.</p> 
  <p>See an example from the sample where we use <code>Oauth2Resource</code> to create <code>[Resource](play-oauth-server/app/domain/oauth2/Resource.scala)</code> object to protect the <a href="https://github.com/njin-fr/play-oauth/blob/master/play-oauth-server/app/controllers/API.scala" target="_blank">API</a></p> 
  <h5><a id="user-content-token-info-endpoint" class="anchor" href="https://github.com/njin-fr/play-oauth#token-info-endpoint" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Token info endpoint</h5> 
  <p>If your Resource server differ to your Authorization server, you may need to bring a way for your Resource server to get information about a token. The token endpoint gives you a function for that. </p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">info</span>(<span class="pl-v">token</span>: <span class="pl-k">String</span>)
          (<span class="pl-v">authenticate</span>: <span class="pl-en">RequestHeader</span> <span class="pl-k">=&gt;</span> <span class="pl-en">Future</span>[<span class="pl-en">Option</span>[<span class="pl-en">C</span>]])
          (<span class="pl-v">ok</span>: <span class="pl-en">TO</span> <span class="pl-k">=&gt;</span> <span class="pl-en">Future</span>[<span class="pl-en">SimpleResult</span>])
          (<span class="pl-v">onUnauthorized</span>: <span class="pl-en">Future</span>[<span class="pl-en">SimpleResult</span>] <span class="pl-k">=</span> <span class="pl-en">Future</span>.successful(<span class="pl-en">Unauthorized</span>(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>)),
           <span class="pl-v">onTokenNotFound</span>: <span class="pl-en">Future</span>[<span class="pl-en">SimpleResult</span>] <span class="pl-k">=</span> <span class="pl-en">Future</span>.successful(<span class="pl-en">NotFound</span>(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>)),
           <span class="pl-v">onForbidden</span>: <span class="pl-en">Future</span>[<span class="pl-en">SimpleResult</span>] <span class="pl-k">=</span> <span class="pl-en">Future</span>.successful(<span class="pl-en">Forbidden</span>(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>)))
          (<span class="pl-k">implicit</span> <span class="pl-v">ec</span>: <span class="pl-en">ExecutionContext</span>)<span class="pl-k">:</span> <span class="pl-en">RequestHeader</span> <span class="pl-k">=&gt;</span> <span class="pl-en">Future</span>[<span class="pl-en">SimpleResult</span>]</pre>
  </div> 
  <p>Use this to create an action in your Authorization server then in your Resource server, use the <code>remoteResourceOwner</code> (or the <code>basicAuthRemoteResourceOwner</code>) to retrieve the token for your protected resource.</p> 
  <ul> 
   <li><code>authenticate: RequestHeader =&gt; Future[Option[C]]</code> extracts the client from the request. You can use the basic authentication parser from <a href="https://github.com/njin-fr/play-oauth/blob/master/play-oauth/src/main/scala/fr/njin/playoauth/Utils.scala" target="_blank">play-oauth/src/main/scala/fr/njin/playoauth/Utils.scala</a></li> 
   <li><code>ok: TO =&gt; Future[SimpleResult]</code> the callback used to send the token.</li> 
  </ul> 
  <blockquote> 
   <p>Example from the sample, in the controller <code>Token.scala</code>:</p> 
  </blockquote> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">info</span>(<span class="pl-v">value</span>: <span class="pl-k">String</span>) <span class="pl-k">=</span> <span class="pl-en">InTx</span> { <span class="pl-k">implicit</span> tx <span class="pl-k">=&gt;</span>
    <span class="pl-en">Action</span>.async { request <span class="pl-k">=&gt;</span>
      <span class="pl-k">new</span> <span class="pl-en">TokenEndpointController</span>().info(value){ request <span class="pl-k">=&gt;</span>
          <span class="pl-en">Utils</span>.parseBasicAuth(request).map{
            <span class="pl-k">case</span> (id, secret) <span class="pl-k">=&gt;</span> <span class="pl-en">App</span>.find(id).map(_.filter(_.secret <span class="pl-k">==</span> secret))
          }.getOrElse(<span class="pl-en">Future</span>.successful(<span class="pl-c1">None</span>))
      } { token <span class="pl-k">=&gt;</span>
        <span class="pl-en">Future</span>.successful(<span class="pl-en">Ok</span>(<span class="pl-en">Json</span>.toJson(token)))
      }().apply(request)
    }
  }</pre>
  </div> 
  <h3><a id="user-content-i18n" class="anchor" href="https://github.com/njin-fr/play-oauth#i18n" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>i18n</h3> 
  <blockquote> 
   <p>TODO</p> 
  </blockquote> 
  <h2><a id="user-content-development" class="anchor" href="https://github.com/njin-fr/play-oauth#development" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Development</h2> 
  <p><strong>sbt 0.13, scala 2.10 and play 2.2.x</strong></p> 
  <p>3 projects:</p> 
  <ul> 
   <li><em>play-oauth-common</em> : Common dependencies, domain objects</li> 
   <li><em>play-oauth</em> : The framework, endpoints implementations and the resource helpers</li> 
   <li><em>play-oauth-server</em> The sample</li> 
  </ul> 
  <p>To run the sample, you need a MySQL database (<a href="https://github.com/njin-fr/play-oauth/issues/4" target="_blank">version &gt; 5.5.25 see #4</a>).</p> 
  <ul> 
   <li>sbt</li> 
   <li>project play-oauth-server</li> 
   <li>play</li> 
   <li>run </li> 
  </ul> 
  <p>Don't forget to edit the configuration file for your database settings.</p> 
  <p>Scaladoc</p> 
  <ul> 
   <li>sbt</li> 
   <li>unidoc</li> 
  </ul> 
  <p>The scala doc is generated in play-oauth/target/scala.../unidoc/</p> 
 </article>
</div>