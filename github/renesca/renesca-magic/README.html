<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a href="https://github.com/renesca/renesca-magic#renesca-magic" aria-hidden="true" class="anchor" id="user-content-renesca-magic" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>renesca-magic</h1> 
  <p><a href="https://travis-ci.org/renesca/renesca-magic" target="_blank"><img src="https://camo.githubusercontent.com/85d95b646cd93cce62a68f50d5c3e4bfc3158fff/68747470733a2f2f7472617669732d63692e6f72672f72656e657363612f72656e657363612d6d616769632e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/renesca/renesca-magic.svg?branch=master" style="max-width:100%;"></a> <a href="https://coveralls.io/r/renesca/renesca-magic?branch=master" target="_blank"><img src="https://camo.githubusercontent.com/426a38ee21e6c518e4e9840aa5c5d96dd6a60f6b/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f72656e657363612f72656e657363612d6d616769632f62616467652e7376673f6272616e63683d6d6173746572" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/renesca/renesca-magic/badge.svg?branch=master" style="max-width:100%;"></a></p> 
  <p>renesca-magic is an abstraction layer for <a href="https://github.com/renesca/renesca" target="_blank">renesca</a>, which generates typesafe graph database schemas for the Neo4j database using scala macros.</p> 
  <h2><a href="https://github.com/renesca/renesca-magic#academic-article" aria-hidden="true" class="anchor" id="user-content-academic-article" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Academic Article</h2> 
  <p>There is also an academic article about renesca and renesca-magic: <a href="https://link.springer.com/chapter/10.1007/978-3-319-45507-5_14" target="_blank">An Open-Source Object-Graph-Mapping Framework for Neo4j and Scala: Renesca</a>. Feel free to use these libraries in any of your projects. If you use them in an academic setting, we appreciate if you cite this article.</p> 
  <blockquote> 
   <p>Dietze, F., Karoff, J., Calero Valdez, A. , Ziefle, M., Greven, C., &amp; Schroeder, U. (2016, August). An Open-Source Object-Graph-Mapping Framework for Neo4j and Scala: Renesca. <em>In International Conference on Availability, Reliability, and Security</em> (pp. 204-218). Springer International Publishing.</p> 
  </blockquote> 
  <h2><a href="https://github.com/renesca/renesca-magic#feature-summary" aria-hidden="true" class="anchor" id="user-content-feature-summary" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Feature summary</h2> 
  <ul> 
   <li>Generate boilerplate classes and factories to wrap Nodes, Relations and Graphs</li> 
   <li>Generate boilerplate for handling HyperRelations <code>(n)-[]-&gt;(hyperRelation)-[]-&gt;(m)</code></li> 
   <li>Generate getters, setters and factories for properties (primitives, optional primitives, default values)</li> 
   <li>Generate accessors for neighbours on Nodes, over Relations and HyperRelations</li> 
   <li>Node and Relation traits with multiple inheritance for labels and properties</li> 
   <li>Generate filtered set accessors for Nodes, Relations and traits in a Graph</li> 
   <li>Graph can inherit Nodes from multiple other Graphs</li> 
   <li>View generated code in <code>/magic</code> of your sbt project root. (you should add it to your <code>.gitignore</code>)</li> 
  </ul> 
  <h2><a href="https://github.com/renesca/renesca-magic#installation" aria-hidden="true" class="anchor" id="user-content-installation" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Installation</h2> 
  <p>To use renesca-magic in your sbt project, add these dependencies and the marco compiler plugin to your <code>build.sbt</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>com.github.renesca<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>renesca-magic<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.3.4-1<span class="pl-pds">"</span></span>

addCompilerPlugin(<span class="pl-s"><span class="pl-pds">"</span>org.scalamacros<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>paradise<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>2.1.0<span class="pl-pds">"</span></span> cross <span class="pl-en">CrossVersion</span>.full)</pre>
  </div> 
  <h2><a href="https://github.com/renesca/renesca-magic#feedback" aria-hidden="true" class="anchor" id="user-content-feedback" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Feedback</h2> 
  <p>Please don't hesitate to create issues about anything. Ideas, questions, bugs, feature requests, criticism, missing documentation, confusing examples, ... . Are you stuck with renesca or renesca-magic for some time? Is there something in this README that is unclear? Anything else? This means something does not work as intended or the API is not intuitive. Contact us and let's fix this together.</p> 
  <h2><a href="https://github.com/renesca/renesca-magic#usage-examples" aria-hidden="true" class="anchor" id="user-content-usage-examples" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage Examples</h2> 
  <p>You can find all of these examples available as sbt project: <a href="https://github.com/renesca/renesca-magic-example" target="_blank">renesca/renesca-magic-example</a>. You can also have a look at the generated code: <a href="https://github.com/renesca/renesca-magic-example/tree/master/magic" target="_blank">renesca-magic-example/magic</a></p> 
  <h3><a href="https://github.com/renesca/renesca-magic#wrapping-low-level-entities" aria-hidden="true" class="anchor" id="user-content-wrapping-low-level-entities" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Wrapping low level entities</h3> 
  <p>In <a href="https://github.com/renesca/renesca" target="_blank">renesca</a>, nodes represent low level graph database entities from the property graph model. This is a bit annoying to work with when you have a schema in mind. For example, when we have types of nodes that have a specific label, we always access neighbours with another specific label. The same holds for properties for specific labels.</p> 
  <p>We can wrap our low-level nodes and relations in classes that take care of and hide the boilerplate. In the following example we provide some hand-written boilerplate to demonstrate this.</p> 
  <p>Here we have two nodes <code>Animal</code> and <code>Food</code>, connected with the relation <code>Eats</code>. The nodes have getters and setters for their properties and accessors to their neighbours. There are also Factories to wrap low level entities or create new ones.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">renesca.graph.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">renesca.parameter.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">renesca.parameter.implicits.</span><span class="pl-v">_</span>

<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Animal</span>(<span class="pl-v">node</span>: <span class="pl-en">Node</span>) {
  <span class="pl-k">val</span> <span class="pl-en">label</span> <span class="pl-k">=</span> <span class="pl-en">Label</span>(<span class="pl-s"><span class="pl-pds">"</span>ANIMAL<span class="pl-pds">"</span></span>)
  <span class="pl-k">def</span> <span class="pl-en">eats</span><span class="pl-k">:</span> <span class="pl-en">Set</span>[<span class="pl-en">Food</span>] <span class="pl-k">=</span> node.outRelations.
    filter(_.relationType <span class="pl-k">==</span> <span class="pl-en">Eats</span>.relationType).map(_.endNode).
    filter(_.labels.contains(<span class="pl-en">Food</span>.label)).map(<span class="pl-en">Food</span>.wrap).toSet
  <span class="pl-k">def</span> <span class="pl-en">name</span><span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> node.properties(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>).<span class="pl-c1">asInstanceOf</span>[<span class="pl-en">StringPropertyValue</span>]
}

<span class="pl-k">object</span> <span class="pl-en">Animal</span> {
  <span class="pl-k">val</span> <span class="pl-en">label</span> <span class="pl-k">=</span> <span class="pl-en">Label</span>(<span class="pl-s"><span class="pl-pds">"</span>ANIMAL<span class="pl-pds">"</span></span>)
  <span class="pl-k">def</span> <span class="pl-en">wrap</span>(<span class="pl-v">node</span>: <span class="pl-en">Node</span>) <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Animal</span>(node)
  <span class="pl-k">def</span> <span class="pl-en">create</span>(<span class="pl-v">name</span>: <span class="pl-k">String</span>)<span class="pl-k">:</span> <span class="pl-en">Animal</span> <span class="pl-k">=</span> {
    <span class="pl-k">val</span> <span class="pl-en">wrapped</span> <span class="pl-k">=</span> wrap(<span class="pl-en">Node</span>.create(<span class="pl-en">List</span>(label)))
    wrapped.node.properties.update(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>, name)
    wrapped
  }
}

...</pre>
  </div> 
  <p>See the full boilerplate example at <a href="https://github.com/renesca/renesca-example/blob/master/src/main/scala/renesca/example/Schema.scala" target="_blank">renesca-example/.../Schema.scala</a>.</p> 
  <p>This is a lot of code for a single relation between two nodes. Writing this by hand for a larger schema takes a lot of time and is very error prone. We can use renesca-magic to generate this for us. Simply write:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">renesca.schema.</span><span class="pl-v">macros</span>

<span class="pl-k">@</span>macros.<span class="pl-en">GraphSchema</span>
<span class="pl-k">object</span> <span class="pl-en">ExampleSchemaWrapping</span> {
  <span class="pl-c"><span class="pl-c">//</span> Nodes get their class name as uppercase label</span>
  <span class="pl-k">@</span><span class="pl-en">Node</span> <span class="pl-k">class</span> <span class="pl-en">Animal</span> { <span class="pl-k">val</span> <span class="pl-en">name</span><span class="pl-k">:</span> <span class="pl-k">String</span> }
  <span class="pl-k">@</span><span class="pl-en">Node</span> <span class="pl-k">class</span> <span class="pl-en">Food</span> {
    <span class="pl-k">val</span> <span class="pl-en">name</span><span class="pl-k">:</span> <span class="pl-k">String</span>
    <span class="pl-k">var</span> <span class="pl-en">amount</span><span class="pl-k">:</span> <span class="pl-k">Long</span>
  }
  <span class="pl-c"><span class="pl-c">//</span> Relations get their class name as uppercase relationType</span>
  <span class="pl-k">@</span><span class="pl-en">Relation</span> <span class="pl-k">class</span> <span class="pl-en">Eats</span>(<span class="pl-v">startNode</span>: <span class="pl-en">Animal</span>, <span class="pl-v">endNode</span>: <span class="pl-en">Food</span>)
}

<span class="pl-k">import</span> <span class="pl-v">ExampleSchemaWrapping.</span><span class="pl-v">_</span>

<span class="pl-k">val</span> <span class="pl-en">snake</span> <span class="pl-k">=</span> <span class="pl-en">Animal</span>.create(<span class="pl-s"><span class="pl-pds">"</span>snake<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">cake</span> <span class="pl-k">=</span> <span class="pl-en">Food</span>.create(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>cake<span class="pl-pds">"</span></span>, amount <span class="pl-k">=</span> <span class="pl-c1">1000</span>)
<span class="pl-k">val</span> <span class="pl-en">eats</span> <span class="pl-k">=</span> <span class="pl-en">Eats</span>.create(snake, cake)

cake.amount <span class="pl-k">-</span><span class="pl-k">=</span> <span class="pl-c1">100</span></pre>
  </div> 
  <p>Note that <code>Food.name</code> is a <code>val</code> and only generates a getter. <code>Food.amount</code> is a <code>var</code> and therefore generates a getter and a setter.</p> 
  <p>You can have a look at the generated code in the folder <code>/magic</code> created at the root of your sbt project. Files created in <code>/magic</code> are not needed for compilation. You can safely delete them and put the folder into your <code>.gitignore</code>.</p> 
  <h3><a href="https://github.com/renesca/renesca-magic#wrapping-induced-subgraphs" aria-hidden="true" class="anchor" id="user-content-wrapping-induced-subgraphs" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Wrapping induced subgraphs</h3> 
  <p>Use the <code>@Graph</code> annotation to wrap a subgraph. This generates filtered Set accessors for each Node and Relation type.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">renesca.schema.</span><span class="pl-v">macros</span>

<span class="pl-k">@</span>macros.<span class="pl-en">GraphSchema</span>
<span class="pl-k">object</span> <span class="pl-en">ExampleSchemaSubgraph</span> {
  <span class="pl-k">@</span><span class="pl-en">Node</span> <span class="pl-k">class</span> <span class="pl-en">Animal</span> { <span class="pl-k">val</span> <span class="pl-en">name</span><span class="pl-k">:</span> <span class="pl-k">String</span> }
  <span class="pl-k">@</span><span class="pl-en">Node</span> <span class="pl-k">class</span> <span class="pl-en">Food</span> {
    <span class="pl-k">val</span> <span class="pl-en">name</span><span class="pl-k">:</span> <span class="pl-k">String</span>
    <span class="pl-k">var</span> <span class="pl-en">amount</span><span class="pl-k">:</span> <span class="pl-k">Long</span>
  }
  <span class="pl-k">@</span><span class="pl-en">Relation</span> <span class="pl-k">class</span> <span class="pl-en">Eats</span>(<span class="pl-v">startNode</span>: <span class="pl-en">Animal</span>, <span class="pl-v">endNode</span>: <span class="pl-en">Food</span>)

  <span class="pl-c"><span class="pl-c">//</span> Relations between specified nodes will be induced</span>
  <span class="pl-k">@</span><span class="pl-en">Graph</span> <span class="pl-k">trait</span> <span class="pl-en">Zoo</span> { <span class="pl-en">Nodes</span>(<span class="pl-en">Animal</span>, <span class="pl-en">Food</span>) }
}

<span class="pl-k">import</span> <span class="pl-v">ExampleSchemaSubgraph.</span><span class="pl-v">_</span>

<span class="pl-k">val</span> <span class="pl-en">zoo</span> <span class="pl-k">=</span> <span class="pl-en">Zoo</span>(db.queryGraph(<span class="pl-s"><span class="pl-pds">"</span>MATCH (a:ANIMAL)-[e:EATS]-&gt;(f:FOOD) RETURN a,e,f<span class="pl-pds">"</span></span>))
<span class="pl-k">val</span> <span class="pl-en">elefant</span> <span class="pl-k">=</span> <span class="pl-en">Animal</span>.create(<span class="pl-s"><span class="pl-pds">"</span>elefant<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">pizza</span> <span class="pl-k">=</span> <span class="pl-en">Food</span>.create(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>pizza<span class="pl-pds">"</span></span>, amount <span class="pl-k">=</span> <span class="pl-c1">2</span>)
zoo.add(<span class="pl-en">Eats</span>.create(elefant, pizza))
zoo.animals <span class="pl-c"><span class="pl-c">//</span> Set(elefant)</span>
zoo.relations <span class="pl-c"><span class="pl-c">//</span> Set(elefant eats pizza)</span>
db.persistChanges(zoo)</pre>
  </div> 
  <h3><a href="https://github.com/renesca/renesca-magic#traits-and-relations-to-traits" aria-hidden="true" class="anchor" id="user-content-traits-and-relations-to-traits" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Traits and relations to traits</h3> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">@</span>macros.<span class="pl-en">GraphSchema</span>
<span class="pl-k">object</span> <span class="pl-en">ExampleSchemaTraits</span> {
  <span class="pl-c"><span class="pl-c">//</span> Inheriting Nodes receive their name as additional label</span>
  <span class="pl-k">@</span><span class="pl-en">Node</span> <span class="pl-k">trait</span> <span class="pl-en">Animal</span> { <span class="pl-k">val</span> <span class="pl-en">name</span><span class="pl-k">:</span> <span class="pl-k">String</span> }

  <span class="pl-c"><span class="pl-c">//</span> Node with labels FISH and ANIMAL</span>
  <span class="pl-k">@</span><span class="pl-en">Node</span> <span class="pl-k">class</span> <span class="pl-en">Fish</span> <span class="pl-k">extends</span> <span class="pl-e">Animal</span>
  <span class="pl-k">@</span><span class="pl-en">Node</span> <span class="pl-k">class</span> <span class="pl-en">Dog</span> <span class="pl-k">extends</span> <span class="pl-e">Animal</span>

  <span class="pl-k">@</span><span class="pl-en">Relation</span> <span class="pl-k">trait</span> <span class="pl-en">Consumes</span> { <span class="pl-k">val</span> <span class="pl-en">funny</span><span class="pl-k">:</span><span class="pl-k">Boolean</span> }

  <span class="pl-c"><span class="pl-c">//</span> Relations can connect Node traits</span>
  <span class="pl-c"><span class="pl-c">//</span> instead of defining relations for Fish and Dog explicitly</span>
  <span class="pl-k">@</span><span class="pl-en">Relation</span> <span class="pl-k">class</span> <span class="pl-en">Eats</span>(<span class="pl-v">startNode</span>: <span class="pl-en">Animal</span>, <span class="pl-v">endNode</span>: <span class="pl-en">Animal</span>) <span class="pl-k">extends</span> <span class="pl-e">Consumes</span>
  <span class="pl-k">@</span><span class="pl-en">Relation</span> <span class="pl-k">class</span> <span class="pl-en">Drinks</span>(<span class="pl-v">startNode</span>: <span class="pl-en">Animal</span>, <span class="pl-v">endNode</span>: <span class="pl-en">Animal</span>) <span class="pl-k">extends</span> <span class="pl-e">Consumes</span>

  <span class="pl-c"><span class="pl-c">//</span> Zoo contains all Animals (Animal expands to all subNodes)</span>
  <span class="pl-k">@</span><span class="pl-en">Graph</span> <span class="pl-k">trait</span> <span class="pl-en">Zoo</span> { <span class="pl-en">Nodes</span>(<span class="pl-en">Animal</span>) }
}

<span class="pl-k">import</span> <span class="pl-v">ExampleSchemaTraits.</span><span class="pl-v">_</span>

<span class="pl-k">val</span> <span class="pl-en">zoo</span> <span class="pl-k">=</span> <span class="pl-en">Zoo</span>.empty
<span class="pl-c"><span class="pl-c">//</span> merge dog and fish on the name property</span>
<span class="pl-c"><span class="pl-c">//</span> (creates the animal if it does not exist, otherwise the existing animal is matched)</span>
<span class="pl-k">val</span> <span class="pl-en">bello</span> <span class="pl-k">=</span> <span class="pl-en">Dog</span>.merge(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>bello<span class="pl-pds">"</span></span>, merge <span class="pl-k">=</span> <span class="pl-en">Set</span>(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>))
<span class="pl-k">val</span> <span class="pl-en">wanda</span> <span class="pl-k">=</span> <span class="pl-en">Fish</span>.merge(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>wanda<span class="pl-pds">"</span></span>, merge <span class="pl-k">=</span> <span class="pl-en">Set</span>(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>))

zoo.add(bello)
zoo.add(wanda)
zoo.animals <span class="pl-c"><span class="pl-c">//</span> Set(bello, wanda)</span>

<span class="pl-c"><span class="pl-c">//</span> We can connect any node extending the trait Animal</span>
zoo.add(<span class="pl-en">Eats</span>.create(bello, wanda, funny <span class="pl-k">=</span> <span class="pl-c1">false</span>))
zoo.add(<span class="pl-en">Drinks</span>.create(wanda, bello, funny <span class="pl-k">=</span> <span class="pl-c1">true</span>))</pre>
  </div> 
  <h3><a href="https://github.com/renesca/renesca-magic#multiple-inheritance-multiple-node-labels" aria-hidden="true" class="anchor" id="user-content-multiple-inheritance-multiple-node-labels" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Multiple inheritance, multiple Node labels</h3> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">@</span>macros.<span class="pl-en">GraphSchema</span>
<span class="pl-k">object</span> <span class="pl-en">ExampleSchemaMultipleInheritance</span> {
    <span class="pl-c"><span class="pl-c">//</span> Assignments are default values for properties</span>
    <span class="pl-c"><span class="pl-c">//</span> They can also be arbitrary statements</span>
    <span class="pl-k">@</span><span class="pl-en">Node</span> <span class="pl-k">trait</span> <span class="pl-en">Uuid</span> { <span class="pl-k">val</span> <span class="pl-en">uuid</span><span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> java.util.<span class="pl-en">UUID</span>.randomUUID.toString }
    <span class="pl-k">@</span><span class="pl-en">Node</span> <span class="pl-k">trait</span> <span class="pl-en">Timestamp</span> { <span class="pl-k">val</span> <span class="pl-en">timestamp</span><span class="pl-k">:</span> <span class="pl-k">Long</span> <span class="pl-k">=</span> <span class="pl-en">System</span>.currentTimeMillis }
    <span class="pl-k">@</span><span class="pl-en">Node</span> <span class="pl-k">trait</span> <span class="pl-en">Taggable</span>

    <span class="pl-k">@</span><span class="pl-en">Node</span> <span class="pl-k">class</span> <span class="pl-en">Article</span> <span class="pl-k">extends</span> <span class="pl-e">Uuid</span> <span class="pl-k">with</span> <span class="pl-e">Timestamp</span> <span class="pl-k">with</span> <span class="pl-e">Taggable</span> {
    <span class="pl-k">val</span> <span class="pl-en">content</span><span class="pl-k">:</span><span class="pl-k">String</span>
    }
    <span class="pl-k">@</span><span class="pl-en">Node</span> <span class="pl-k">class</span> <span class="pl-en">Tag</span> <span class="pl-k">extends</span> <span class="pl-e">Uuid</span> { <span class="pl-k">val</span> <span class="pl-en">name</span><span class="pl-k">:</span><span class="pl-k">String</span> }
    <span class="pl-k">@</span><span class="pl-en">Relation</span> <span class="pl-k">class</span> <span class="pl-en">Categorizes</span>(startNode<span class="pl-k">:</span><span class="pl-en">Tag</span>, endNode<span class="pl-k">:</span><span class="pl-en">Taggable</span>)

    <span class="pl-k">@</span><span class="pl-en">Graph</span> <span class="pl-k">trait</span> <span class="pl-en">Blog</span> {<span class="pl-en">Nodes</span>(<span class="pl-en">Article</span>, <span class="pl-en">Tag</span>)}
}

<span class="pl-k">import</span> <span class="pl-v">ExampleSchemaMultipleInheritance.</span><span class="pl-v">_</span>

<span class="pl-k">val</span> <span class="pl-en">initGraph</span> <span class="pl-k">=</span> <span class="pl-en">Blog</span>.empty
initGraph.add(<span class="pl-en">Tag</span>.create(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>useful<span class="pl-pds">"</span></span>))
initGraph.add(<span class="pl-en">Tag</span>.create(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>important<span class="pl-pds">"</span></span>))
db.persistChanges(initGraph)

<span class="pl-k">val</span> <span class="pl-en">blog</span> <span class="pl-k">=</span> <span class="pl-en">Blog</span>.empty

<span class="pl-c"><span class="pl-c">//</span> match the previously created tags</span>
blog.add(<span class="pl-en">Tag</span>.matches(name <span class="pl-k">=</span> <span class="pl-en">Some</span>(<span class="pl-s"><span class="pl-pds">"</span>useful<span class="pl-pds">"</span></span>), matches <span class="pl-k">=</span> <span class="pl-en">Set</span>(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>)))
blog.add(<span class="pl-en">Tag</span>.matches(name <span class="pl-k">=</span> <span class="pl-en">Some</span>(<span class="pl-s"><span class="pl-pds">"</span>important<span class="pl-pds">"</span></span>), matches <span class="pl-k">=</span> <span class="pl-en">Set</span>(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>)))

<span class="pl-c"><span class="pl-c">//</span> automatically set uuid and timestamp</span>
<span class="pl-k">val</span> <span class="pl-en">article</span> <span class="pl-k">=</span> <span class="pl-en">Article</span>.create(content <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Some useful and important content<span class="pl-pds">"</span></span>)
blog.add(article)

<span class="pl-c"><span class="pl-c">//</span> set all tags on the article</span>
blog.tags.foreach{ tag <span class="pl-k">=&gt;</span>
    blog.add(<span class="pl-en">Categorizes</span>.create(tag, article))
}

blog.taggables <span class="pl-c"><span class="pl-c">//</span> Set(article)</span>
article.rev_categorizes <span class="pl-c"><span class="pl-c">//</span> blog.tags</span>

db.persistChanges(blog)</pre>
  </div> 
  <h3><a href="https://github.com/renesca/renesca-magic#hyperrelations" aria-hidden="true" class="anchor" id="user-content-hyperrelations" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>HyperRelations</h3> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">@</span>macros.<span class="pl-en">GraphSchema</span>
<span class="pl-k">object</span> <span class="pl-en">ExampleSchemaHyperRelations</span> {
  <span class="pl-k">@</span><span class="pl-en">Node</span> <span class="pl-k">trait</span> <span class="pl-en">Uuid</span> { <span class="pl-k">val</span> <span class="pl-en">uuid</span><span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> java.util.<span class="pl-en">UUID</span>.randomUUID.toString }
  <span class="pl-k">@</span><span class="pl-en">Node</span> <span class="pl-k">trait</span> <span class="pl-en">Taggable</span>
  <span class="pl-k">@</span><span class="pl-en">Node</span> <span class="pl-k">class</span> <span class="pl-en">Tag</span> <span class="pl-k">extends</span> <span class="pl-e">Uuid</span> { <span class="pl-k">val</span> <span class="pl-en">name</span><span class="pl-k">:</span><span class="pl-k">String</span> }
  <span class="pl-k">@</span><span class="pl-en">Node</span> <span class="pl-k">class</span> <span class="pl-en">User</span> <span class="pl-k">extends</span> <span class="pl-e">Uuid</span> { <span class="pl-k">val</span> <span class="pl-en">name</span><span class="pl-k">:</span><span class="pl-k">String</span> }
  <span class="pl-k">@</span><span class="pl-en">Node</span> <span class="pl-k">class</span> <span class="pl-en">Article</span> <span class="pl-k">extends</span> <span class="pl-e">Uuid</span> <span class="pl-k">with</span> <span class="pl-e">Taggable</span> { <span class="pl-k">val</span> <span class="pl-en">content</span><span class="pl-k">:</span><span class="pl-k">String</span> }

  <span class="pl-c"><span class="pl-c">//</span> A HyperRelation is a node representing a relation:</span>
  <span class="pl-c"><span class="pl-c">//</span> (n)-[]-&gt;(hyperRelation)-[]-&gt;(m)</span>
  <span class="pl-c"><span class="pl-c">//</span> It behaves like node and relation at the same time</span>
  <span class="pl-c"><span class="pl-c">//</span> and therefore can extend node and relation traits</span>
  <span class="pl-k">@</span><span class="pl-en">HyperRelation</span> <span class="pl-k">class</span> <span class="pl-en">Tags</span>(<span class="pl-v">startNode</span>: <span class="pl-en">Tag</span>, <span class="pl-v">endNode</span>: <span class="pl-en">Taggable</span>) <span class="pl-k">extends</span> <span class="pl-e">Uuid</span>
  <span class="pl-c"><span class="pl-c">//</span> Because these are nodes, we can connect a HyperRelation with another Node</span>
  <span class="pl-k">@</span><span class="pl-en">Relation</span> <span class="pl-k">class</span> <span class="pl-en">Supports</span>(<span class="pl-v">startNode</span>: <span class="pl-en">User</span>, <span class="pl-v">endNode</span>: <span class="pl-en">Tags</span>)
}

<span class="pl-k">import</span> <span class="pl-v">ExampleSchemaHyperRelations.</span><span class="pl-v">_</span>
<span class="pl-k">val</span> <span class="pl-en">user</span> <span class="pl-k">=</span> <span class="pl-en">User</span>.create(name<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>pumuckl<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">helpful</span> <span class="pl-k">=</span> <span class="pl-en">Tag</span>.create(name<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>helpful<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">article</span> <span class="pl-k">=</span> <span class="pl-en">Article</span>.create(content<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Dog eats Snake<span class="pl-pds">"</span></span>)

<span class="pl-k">val</span> <span class="pl-en">tags</span> <span class="pl-k">=</span> <span class="pl-en">Tags</span>.create(helpful, article) <span class="pl-c"><span class="pl-c">//</span> HyperRelation</span>
<span class="pl-k">val</span> <span class="pl-en">supports</span> <span class="pl-k">=</span> <span class="pl-en">Supports</span>.create(user, tags) <span class="pl-c"><span class="pl-c">//</span> Relation from user to HyperRelation</span></pre>
  </div> 
  <h2><a href="https://github.com/renesca/renesca-magic#license" aria-hidden="true" class="anchor" id="user-content-license" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>License</h2> 
  <p>renesca-magic is free software released under the <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank">Apache License, Version 2.0</a></p> 
 </article>
</div>