<div class="announce instapaper_body adoc" data-path="readme.adoc" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-json-randomizer" class="anchor" href="https://github.com/damianmcdonald/json-randomizer#json-randomizer" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>json-randomizer</h1> 
  <div id="user-content-preamble"> 
   <div> 
    <div> 
     <p><a href="https://travis-ci.org/damianmcdonald/currencytrade-spray" target="_blank"><img src="https://camo.githubusercontent.com/e175264ce74742f0114158574c5dfbc3d5c31bf4/68747470733a2f2f7472617669732d63692e6f72672f64616d69616e6d63646f6e616c642f63757272656e637974726164652d73707261792e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/damianmcdonald/currencytrade-spray.svg?branch=master" style="max-width:100%;"></a> <a href="https://maven-badges.herokuapp.com/maven-central/com.github.damianmcdonald/json-randomizer_2.11" target="_blank"><img src="https://camo.githubusercontent.com/9e960806579d2b78e5449cdac17bfbfb77e04340/68747470733a2f2f6d6176656e2d6261646765732e6865726f6b756170702e636f6d2f6d6176656e2d63656e7472616c2f636f6d2e6769746875622e64616d69616e6d63646f6e616c642f6a736f6e2d72616e646f6d697a65725f322e31312f62616467652e737667" alt="Maven Central" data-canonical-src="https://maven-badges.herokuapp.com/maven-central/com.github.damianmcdonald/json-randomizer_2.11/badge.svg" style="max-width:100%;"></a> <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank"><img src="https://camo.githubusercontent.com/bcf0a9b297fd9c67e07123c40d1c8aa3c467075f/68747470733a2f2f676f2d736869656c64732e6865726f6b756170702e636f6d2f6c6963656e73652d617061636865322d626c75652e706e67" alt="License Apache2" data-canonical-src="https://go-shields.herokuapp.com/license-apache2-blue.png" style="max-width:100%;"></a></p> 
    </div> 
    <div> 
     <p><code>json-randomizer</code> is a <a href="http://www.scala-lang.org/" target="_blank">Scala</a> library that generates random values for structured JSON.</p> 
    </div> 
    <div> 
     <p>It is intended to be used to performance and load test JSON web services. In a few short steps you can define your JSON structure and then fire thousands of unique JSON requests at your API.</p> 
    </div> 
    <div> 
     <p><code>json-randomizer</code> can generate random values for the following JSON data types:</p> 
    </div> 
    <div> 
     <ul> 
      <li> <p>Number - corresponding to scala.Int, scala.Long or scala.Double</p> </li> 
      <li> <p>String</p> </li> 
      <li> <p>Boolean</p> </li> 
      <li> <p>Array</p> </li> 
      <li> <p>Object</p> </li> 
      <li> <p>null</p> </li> 
     </ul> 
    </div> 
    <div> 
     <p>Default random value generation strategies are provided for all types (except Object, a user defined construct, and null). In cases where custom value generation is required, such as a random string constrained to a finite list of status values, custom strategies can be provided.</p> 
    </div> 
    <div> 
     <p>The library was built using the following toolchain:</p> 
    </div> 
    <div> 
     <ul> 
      <li> <p><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_blank">Java Oracle JDK 1.8</a></p> </li> 
      <li> <p><a href="http://www.scala-lang.org/download/all.html" target="_blank">Scala 2.11.6</a></p> </li> 
      <li> <p><a href="http://www.scala-sbt.org/download.html" target="_blank">SBT 0.13.8</a></p> </li> 
     </ul> 
    </div> 
    <div> 
     <p>The library has also been built against the <code>OpenJDK 1.8</code> but is less thoroughly tested so in general your mileage may vary if you attempt to use the library with versions different than the ones specified above.</p> 
    </div> 
   </div> 
  </div> 
  <div> 
   <h2 id="user-content-adding-the-library"><a id="user-content-adding-the-library" class="anchor" href="https://github.com/damianmcdonald/json-randomizer#adding-the-library" aria-hidden="true" target="_blank">
     <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
      <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
     </svg></a>Adding the library</h2> 
   <div> 
    <div> 
     <p>The first step is to add <code>json-randomizer</code> to your project.</p> 
    </div> 
    <div> 
     <h3 id="user-content-maven-dependency"><a id="user-content-maven-dependency" class="anchor" href="https://github.com/damianmcdonald/json-randomizer#maven-dependency" aria-hidden="true" target="_blank">
       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
        <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
       </svg></a>Maven dependency</h3> 
     <div> 
      <div> 
       <div class="highlight highlight-text-xml">
        <pre>&lt;<span class="pl-ent">dependency</span>&gt;
    &lt;<span class="pl-ent">groupId</span>&gt;com.github.damianmcdonald&lt;/<span class="pl-ent">groupId</span>&gt;
    &lt;<span class="pl-ent">artifactId</span>&gt;json-randomizer_2.11&lt;/<span class="pl-ent">artifactId</span>&gt;
    &lt;<span class="pl-ent">version</span>&gt;0.1&lt;/<span class="pl-ent">version</span>&gt;
&lt;/<span class="pl-ent">dependency</span>&gt;</pre>
       </div> 
      </div> 
     </div> 
    </div> 
    <div> 
     <h3 id="user-content-sbt-dependency"><a id="user-content-sbt-dependency" class="anchor" href="https://github.com/damianmcdonald/json-randomizer#sbt-dependency" aria-hidden="true" target="_blank">
       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
        <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
       </svg></a>SBT dependency</h3> 
     <div> 
      <div> 
       <div class="highlight highlight-source-scala">
        <pre>libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>com.github.damianmcdonald<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>json-randomizer_2.11<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.1<span class="pl-pds">"</span></span></pre>
       </div> 
      </div> 
     </div> 
    </div> 
    <div> 
     <h3 id="user-content-jar-file"><a id="user-content-jar-file" class="anchor" href="https://github.com/damianmcdonald/json-randomizer#jar-file" aria-hidden="true" target="_blank">
       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
        <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
       </svg></a>Jar file</h3> 
     <div> 
      <p>If you prefer to go old-school and manually add the jar file to your project, you can grab it <a href="http://central.maven.org/maven2/com/github/damianmcdonald/json-randomizer_2.11/0.1/json-randomizer_2.11-0.1.jar" target="_blank">here</a>.</p> 
     </div> 
    </div> 
   </div> 
  </div> 
  <div> 
   <h2 id="user-content-usage"><a id="user-content-usage" class="anchor" href="https://github.com/damianmcdonald/json-randomizer#usage" aria-hidden="true" target="_blank">
     <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
      <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
     </svg></a>Usage</h2> 
   <div> 
    <div> 
     <p>Begin by mixing in the <code>JsonApiRequestor</code> trait. This also includes the <code>JsonRandomizer</code> trait and will allow you to both generate random values for your JSON structures and test them against your JSON web services.</p> 
    </div> 
    <div> 
     <div> 
      <div class="highlight highlight-source-scala">
       <pre><span class="pl-k">import</span> <span class="pl-v">com.github.damianmcdonald.jsonrandomizer.</span><span class="pl-v">JsonApiRequestor</span>
<span class="pl-k">import</span> <span class="pl-v">com.github.damianmcdonald.jsonrandomizer.</span><span class="pl-v">JsonDouble</span>
<span class="pl-k">import</span> <span class="pl-v">com.github.damianmcdonald.jsonrandomizer.</span><span class="pl-v">JsonInt</span>
<span class="pl-k">import</span> <span class="pl-v">com.github.damianmcdonald.jsonrandomizer.</span><span class="pl-v">JsonRandomizer</span>
<span class="pl-k">import</span> <span class="pl-v">com.github.damianmcdonald.jsonrandomizer.</span><span class="pl-v">JsonString</span>

<span class="pl-k">object</span> <span class="pl-en">MyJsonRequestRunner</span> <span class="pl-k">extends</span> <span class="pl-e">Application</span> <span class="pl-k">with</span> <span class="pl-e">JsonApiRequestor</span> {

}</pre>
      </div> 
     </div> 
    </div> 
    <div> 
     <p>The next step is to define your JSON structure.</p> 
    </div> 
    <div> 
     <p>To put this is in a more real-world context, let’s assume that you want to generate a randomized version of the JSON structure below:</p> 
    </div> 
    <div> 
     <div> 
      <div class="highlight highlight-source-json">
       <pre>{
    <span class="pl-s"><span class="pl-pds">"</span>item:id<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>X-Wing<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>in_stock<span class="pl-pds">"</span></span>: <span class="pl-c1">true</span>,
    <span class="pl-s"><span class="pl-pds">"</span>price<span class="pl-pds">"</span></span>: <span class="pl-c1">4567.31</span>,
    <span class="pl-s"><span class="pl-pds">"</span>quantity<span class="pl-pds">"</span></span>: <span class="pl-c1">23</span>
}</pre>
      </div> 
     </div> 
    </div> 
    <div> 
     <p>We can create this example as follows:</p> 
    </div> 
    <div> 
     <div> 
      <div class="highlight highlight-source-scala">
       <pre><span class="pl-k">val</span> <span class="pl-en">jsonStructure</span> <span class="pl-k">=</span> <span class="pl-en">Map</span>(
  <span class="pl-s"><span class="pl-pds">"</span>item_id<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonString</span>(<span class="pl-c1">10</span>),
  <span class="pl-s"><span class="pl-pds">"</span>in_stock<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonBoolean</span>(),
  <span class="pl-s"><span class="pl-pds">"</span>price<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonDouble</span>(<span class="pl-c1">100</span>, <span class="pl-c1">1000</span>, <span class="pl-c1">2</span>),
  <span class="pl-s"><span class="pl-pds">"</span>quantity<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonInt</span>(<span class="pl-c1">5</span>, <span class="pl-c1">25</span>)
)</pre>
      </div> 
     </div> 
    </div> 
    <div> 
     <p>Let’s examine what is going on.</p> 
    </div> 
    <div> 
     <p>The JSON structure is defined in a Map that contains a key-value pairing of <code>String</code> → <code>JsonDataType</code>.</p> 
    </div> 
    <div> 
     <p>The <code>String</code> values are the id’s of your JSON.</p> 
    </div> 
    <div> 
     <p>The <code>JsonDataType</code> will be a sub type (examples shown below) that represents the type of JSON data that you wish to randomize.</p> 
    </div> 
    <div> 
     <div> 
      <div class="highlight highlight-source-scala">
       <pre><span class="pl-c">// Random String with a length of 10</span>
<span class="pl-en">JsonString</span>(<span class="pl-c1">10</span>)

<span class="pl-c">// Random Boolean</span>
<span class="pl-en">JsonBoolean</span>()

<span class="pl-c">// Random Number of type Int between range 25 to 5000</span>
<span class="pl-en">JsonInt</span>(<span class="pl-c1">25</span>,<span class="pl-c1">5000</span>)

<span class="pl-c">// Random Number of type Long between range 542525 to 635235323543223L</span>
<span class="pl-en">JsonLong</span>(<span class="pl-c1">542525</span>,<span class="pl-c1">635235323543223L</span>)

<span class="pl-c">// Random Number of type Double between 150 to 10000 to 4 decimal places</span>
<span class="pl-en">JsonDouble</span>(<span class="pl-c1">150</span>, <span class="pl-c1">10000</span>, <span class="pl-c1">4</span>)

<span class="pl-c">// Random Null</span>
<span class="pl-en">JsonNull</span>()

<span class="pl-c">// Array containing 15 elements of one of the JsonDataTypes</span>
<span class="pl-en">JsonArray</span>(<span class="pl-en">JsonString</span>(<span class="pl-c1">8</span>), <span class="pl-c1">15</span>)

<span class="pl-c">// JSON custom object containing the types described above</span>
<span class="pl-en">JsonObject</span>(<span class="pl-en">Map</span>(
  <span class="pl-s"><span class="pl-pds">"</span>stringVal<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonString</span>(<span class="pl-c1">10</span>),
  <span class="pl-s"><span class="pl-pds">"</span>booleanVal<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonBoolean</span>(),
  <span class="pl-s"><span class="pl-pds">"</span>intVal<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonInt</span>(<span class="pl-c1">25</span>,<span class="pl-c1">5000</span>))
)</pre>
      </div> 
     </div> 
    </div> 
    <div> 
     <p>Now that the JSON structure is defined, a web service can be tested as follows:</p> 
    </div> 
    <div> 
     <div> 
      <div class="highlight highlight-source-scala">
       <pre><span class="pl-k">import</span> <span class="pl-v">com.github.damianmcdonald.jsonrandomizer.</span><span class="pl-v">JsonApiRequestor</span>
<span class="pl-k">import</span> <span class="pl-v">com.github.damianmcdonald.jsonrandomizer.</span><span class="pl-v">JsonBoolean</span>
<span class="pl-k">import</span> <span class="pl-v">com.github.damianmcdonald.jsonrandomizer.</span><span class="pl-v">JsonDouble</span>
<span class="pl-k">import</span> <span class="pl-v">com.github.damianmcdonald.jsonrandomizer.</span><span class="pl-v">JsonInt</span>
<span class="pl-k">import</span> <span class="pl-v">com.github.damianmcdonald.jsonrandomizer.</span><span class="pl-v">JsonRandomizer</span>
<span class="pl-k">import</span> <span class="pl-v">com.github.damianmcdonald.jsonrandomizer.</span><span class="pl-v">JsonString</span>

<span class="pl-k">object</span> <span class="pl-en">MyJsonRequestRunner</span> <span class="pl-k">extends</span> <span class="pl-e">Application</span> <span class="pl-k">with</span> <span class="pl-e">JsonApiRequestor</span> {

  <span class="pl-k">val</span> <span class="pl-en">jsonStructure</span> <span class="pl-k">=</span> <span class="pl-en">Map</span>(
    <span class="pl-s"><span class="pl-pds">"</span>item_id<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonString</span>(<span class="pl-c1">10</span>),
    <span class="pl-s"><span class="pl-pds">"</span>in_stock<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonBoolean</span>(),
    <span class="pl-s"><span class="pl-pds">"</span>price<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonDouble</span>(<span class="pl-c1">100</span>, <span class="pl-c1">1000</span>, <span class="pl-c1">2</span>),
    <span class="pl-s"><span class="pl-pds">"</span>quantity<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonInt</span>(<span class="pl-c1">5</span>, <span class="pl-c1">25</span>)
  )

  <span class="pl-c">// this will make 50 unique requests to the defined web service using the Post http method</span>
  fireAndForgetResponse(<span class="pl-en">Post</span>(<span class="pl-s"><span class="pl-pds">"</span>http://mywebservice/apiroute<span class="pl-pds">"</span></span>), <span class="pl-c1">50</span>, jsonStructure)

  <span class="pl-c">// this will make 50 unique requests to the defined web service using the Put http method</span>
  <span class="pl-c">// additionally, this method will evaluate each response from the web service using a</span>
  <span class="pl-c">// default response evaluator which checks that the http response status code == 200 OK</span>
  fireAndEvaluateResponse(<span class="pl-en">Put</span>(<span class="pl-s"><span class="pl-pds">"</span>http://mywebservice/apiroute<span class="pl-pds">"</span></span>), <span class="pl-c1">50</span>, jsonStructure)

}</pre>
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
  <div> 
   <h2 id="user-content-advanced-usage"><a id="user-content-advanced-usage" class="anchor" href="https://github.com/damianmcdonald/json-randomizer#advanced-usage" aria-hidden="true" target="_blank">
     <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
      <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
     </svg></a>Advanced usage</h2> 
   <div> 
    <div> 
     <p>For certain scenarios, the default usage of <code>json-randomizer</code> will not be sufficient.</p> 
    </div> 
    <div> 
     <p>In most cases you will need to:</p> 
    </div> 
    <div> 
     <ul> 
      <li> <p>generate JSON values according to a custom strategy</p> </li> 
      <li> <p>evaluate web service responses according to a custom strategy</p> </li> 
     </ul> 
    </div> 
    <div> 
     <p>The following JsonDataTypes support a custom generation strategy</p> 
    </div> 
    <table> 
     <thead> 
      <tr> 
       <th>JsonDataType</th> 
       <th>Function signature</th> 
       <th>Example</th> 
      </tr> 
     </thead> 
     <tbody> 
      <tr> 
       <td><p>JsonString</p></td> 
       <td><p>(Int) ⇒ String</p></td> 
       <td>
        <div>
         <div> 
          <div> 
           <div class="highlight highlight-source-scala">
            <pre>(<span class="pl-v">length</span>: <span class="pl-k">Int</span>) <span class="pl-k">=&gt;</span> {
  <span class="pl-k">val</span> <span class="pl-en">x</span> <span class="pl-k">=</span> <span class="pl-en">Random</span>.alphanumeric
  x take max mkString (<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>)
}</pre>
           </div> 
          </div> 
         </div>
        </div></td> 
      </tr> 
      <tr> 
       <td><p>JsonBoolean</p></td> 
       <td><p>() ⇒ Boolean</p></td> 
       <td>
        <div>
         <div> 
          <div> 
           <div class="highlight highlight-source-scala">
            <pre>() <span class="pl-k">=&gt;</span> <span class="pl-k">Boolean</span> <span class="pl-k">=</span> <span class="pl-en">Random</span>.nextBoolean</pre>
           </div> 
          </div> 
         </div>
        </div></td> 
      </tr> 
      <tr> 
       <td><p>JsonInt</p></td> 
       <td><p>(Int, Int) ⇒ Int</p></td> 
       <td>
        <div>
         <div> 
          <div> 
           <div class="highlight highlight-source-scala">
            <pre>(<span class="pl-v">x</span>: <span class="pl-k">Int</span>, <span class="pl-v">y</span>: <span class="pl-k">Int</span>) <span class="pl-k">=&gt;</span> {
  <span class="pl-en">Random</span>.nextInt((y <span class="pl-k">-</span> x) <span class="pl-k">+</span> <span class="pl-c1">1</span>) <span class="pl-k">+</span> x
}</pre>
           </div> 
          </div> 
         </div>
        </div></td> 
      </tr> 
      <tr> 
       <td><p>JsonLong</p></td> 
       <td><p>(Long, Long) ⇒ Long</p></td> 
       <td>
        <div>
         <div> 
          <div> 
           <div class="highlight highlight-source-scala">
            <pre>(<span class="pl-v">x</span>: <span class="pl-k">Long</span>, <span class="pl-v">y</span>: <span class="pl-k">Long</span>) <span class="pl-k">=&gt;</span> {
  (x <span class="pl-k">+</span> (<span class="pl-en">Random</span>.nextDouble() <span class="pl-k">*</span>
              (y <span class="pl-k">-</span> x))).toLong
}</pre>
           </div> 
          </div> 
         </div>
        </div></td> 
      </tr> 
      <tr> 
       <td><p>JsonDouble</p></td> 
       <td><p>(Int, Int, Int) ⇒ Double</p></td> 
       <td>
        <div>
         <div> 
          <div> 
           <div class="highlight highlight-source-scala">
            <pre>(<span class="pl-v">x</span>: <span class="pl-k">Int</span>, <span class="pl-v">y</span>: <span class="pl-k">Int</span>, <span class="pl-v">z</span>: <span class="pl-k">Int</span>) <span class="pl-k">=&gt;</span> {
  <span class="pl-k">val</span> <span class="pl-en">double</span> <span class="pl-k">=</span> (x <span class="pl-k">+</span> (y <span class="pl-k">-</span> x)) <span class="pl-k">*</span>
              <span class="pl-en">Random</span>.nextDouble

  <span class="pl-en">BigDecimal</span>(double).setScale(
    z, <span class="pl-en">BigDecimal</span>.<span class="pl-en">RoundingMode</span>.<span class="pl-en">CEILING</span>
   ).toDouble
}</pre>
           </div> 
          </div> 
         </div>
        </div></td> 
      </tr> 
     </tbody> 
    </table> 
    <div> 
     <p>In order to describe how <code>json-randomizer</code> can be used to support custom scenarios, we will examine how it was used to test <a href="https://github.com/damianmcdonald/currencytrade-spray" target="_blank">currencytrade-spray</a>.</p> 
    </div> 
    <div> 
     <p>The full test class can be viewed at <a href="https://github.com/damianmcdonald/json-randomizer/blob/master/src/test/scala/com/github/damianmcdonald/jsonrandomizer/JsonApiRequestorTest.scala" target="_blank">JsonApiRequestorTest.scala</a>.</p> 
    </div> 
    <div> 
     <p>The JSON structured required:</p> 
    </div> 
    <div> 
     <div> 
      <div class="highlight highlight-source-json">
       <pre>{
    <span class="pl-s"><span class="pl-pds">"</span>userId<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>134256<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>currencyFrom<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>EUR<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>currencyTo<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>GBP<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>amountSell<span class="pl-pds">"</span></span>: <span class="pl-c1">1000</span>,
    <span class="pl-s"><span class="pl-pds">"</span>amountBuy<span class="pl-pds">"</span></span>: <span class="pl-c1">747.1</span>,
    <span class="pl-s"><span class="pl-pds">"</span>rate<span class="pl-pds">"</span></span>: <span class="pl-c1">0.7471</span>,
    <span class="pl-s"><span class="pl-pds">"</span>timePlaced<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>24-JAN-15 10:27:44<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>originatingCountry<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>FR<span class="pl-pds">"</span></span>
}</pre>
      </div> 
     </div> 
    </div> 
    <div> 
     <p>The JSON fields, <code>currencyForm</code>, <code>currencyTo</code>, <code>timePlaced</code> and <code>originatingCountry</code> require constrained values.</p> 
    </div> 
    <div> 
     <ul> 
      <li> <p><code>currencyForm</code> and <code>currencyTo</code> require a valid 3 digit currency code</p> </li> 
      <li> <p><code>timePlaced</code> requires a datetime String using pattern: dd-MMM-yy HH:mm:ss</p> </li> 
      <li> <p><code>originatingCountry</code> requires a 2 digit country code</p> </li> 
     </ul> 
    </div> 
    <div> 
     <p>This JSON structure was defined as follows:</p> 
    </div> 
    <div> 
     <div> 
      <div class="highlight highlight-source-scala">
       <pre><span class="pl-c">// define a custom generation strategy for the currencyFrom field</span>
<span class="pl-k">val</span> <span class="pl-en">f1</span> <span class="pl-k">=</span> (<span class="pl-v">max</span>: <span class="pl-k">Int</span>) <span class="pl-k">=&gt;</span> {
  <span class="pl-k">import</span> <span class="pl-v">scala.util.</span><span class="pl-v">Random</span>
  <span class="pl-k">val</span> <span class="pl-en">xs</span> <span class="pl-k">=</span> <span class="pl-en">List</span>(<span class="pl-s"><span class="pl-pds">"</span>EUR<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>AUD<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>ARS<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>BRC<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>CNY<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>GBP<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>HKD<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>INR<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>KWD<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>NOK<span class="pl-pds">"</span></span>)
  <span class="pl-k">val</span> <span class="pl-en">i</span> <span class="pl-k">=</span> <span class="pl-en">Random</span>.nextInt((xs.length <span class="pl-k">-</span> <span class="pl-c1">1</span> <span class="pl-k">-</span> <span class="pl-c1">0</span>) <span class="pl-k">+</span> <span class="pl-c1">1</span>) <span class="pl-k">+</span> <span class="pl-c1">0</span>
  xs(i)
}

<span class="pl-c">// define a custom generation strategy for the currencyTo field</span>
<span class="pl-k">val</span> <span class="pl-en">f2</span> <span class="pl-k">=</span> (<span class="pl-v">max</span>: <span class="pl-k">Int</span>) <span class="pl-k">=&gt;</span> {
  <span class="pl-k">import</span> <span class="pl-v">scala.util.</span><span class="pl-v">Random</span>
  <span class="pl-k">val</span> <span class="pl-en">xs</span> <span class="pl-k">=</span> <span class="pl-en">List</span>(<span class="pl-s"><span class="pl-pds">"</span>USD<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>NZD<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>CAD<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>RUB<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>SGD<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>ZAR<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>CHF<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>TRL<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>AED<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>MXP<span class="pl-pds">"</span></span>)
  <span class="pl-k">val</span> <span class="pl-en">i</span> <span class="pl-k">=</span> <span class="pl-en">Random</span>.nextInt((xs.length <span class="pl-k">-</span> <span class="pl-c1">1</span> <span class="pl-k">-</span> <span class="pl-c1">0</span>) <span class="pl-k">+</span> <span class="pl-c1">1</span>) <span class="pl-k">+</span> <span class="pl-c1">0</span>
  xs(i)
}

<span class="pl-c">// define a custom generation strategy for the originatingCountry field</span>
<span class="pl-k">val</span> <span class="pl-en">f3</span> <span class="pl-k">=</span> (<span class="pl-v">max</span>: <span class="pl-k">Int</span>) <span class="pl-k">=&gt;</span> {
  <span class="pl-k">import</span> <span class="pl-v">scala.util.</span><span class="pl-v">Random</span>
  <span class="pl-k">val</span> <span class="pl-en">xs</span> <span class="pl-k">=</span> <span class="pl-en">List</span>(<span class="pl-s"><span class="pl-pds">"</span>US<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>NZ<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>CA<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>RU<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>SG<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>ZA<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>CH<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>TR<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>AE<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>MX<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>ES<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>AU<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>AR<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>BR<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>CN<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>HKD<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>IN<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>KW<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>NO<span class="pl-pds">"</span></span>)
  <span class="pl-k">val</span> <span class="pl-en">i</span> <span class="pl-k">=</span> <span class="pl-en">Random</span>.nextInt((xs.length <span class="pl-k">-</span> <span class="pl-c1">1</span> <span class="pl-k">-</span> <span class="pl-c1">0</span>) <span class="pl-k">+</span> <span class="pl-c1">1</span>) <span class="pl-k">+</span> <span class="pl-c1">0</span>
  xs(i)
}

<span class="pl-c">// define a custom generation strategy for the timePlaced field</span>
<span class="pl-k">val</span> <span class="pl-en">f4</span> <span class="pl-k">=</span> (<span class="pl-v">max</span>: <span class="pl-k">Int</span>) <span class="pl-k">=&gt;</span> {
  <span class="pl-k">import</span> <span class="pl-v">scala.util.</span><span class="pl-v">Random</span>
  <span class="pl-k">val</span> <span class="pl-en">xs</span> <span class="pl-k">=</span> <span class="pl-en">List</span>(<span class="pl-s"><span class="pl-pds">"</span>24-JAN-15 10:27:44<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>12-FEB-15 18:55:44<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>13-MAR-15 08:12:44<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>05-APR-15 09:27:44<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>15-MAY-15 11:27:44<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>18-JUN-15 12:27:44<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>27-JUL-15 13:27:44<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>22-AUG-15 14:27:44<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>30-SEP-15 15:27:44<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>08-OCT-15 16:27:44<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>09-NOV-15 17:27:44<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>10-DEC-15 19:27:44<span class="pl-pds">"</span></span>)
  <span class="pl-k">val</span> <span class="pl-en">i</span> <span class="pl-k">=</span> <span class="pl-en">Random</span>.nextInt((xs.length <span class="pl-k">-</span> <span class="pl-c1">1</span> <span class="pl-k">-</span> <span class="pl-c1">0</span>) <span class="pl-k">+</span> <span class="pl-c1">1</span>) <span class="pl-k">+</span> <span class="pl-c1">0</span>
  xs(i)
}

<span class="pl-k">val</span> <span class="pl-en">m</span> <span class="pl-k">=</span> <span class="pl-en">Map</span>(
  <span class="pl-s"><span class="pl-pds">"</span>userId<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonString</span>(<span class="pl-c1">8</span>),
  <span class="pl-s"><span class="pl-pds">"</span>currencyFrom<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonString</span>(<span class="pl-c1">3</span>, f1),       <span class="pl-c">// use custom generation strategy</span>
  <span class="pl-s"><span class="pl-pds">"</span>currencyTo<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonString</span>(<span class="pl-c1">3</span>, f2),         <span class="pl-c">// use custom generation strategy</span>
  <span class="pl-s"><span class="pl-pds">"</span>amountSell<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonDouble</span>(<span class="pl-c1">250</span>, <span class="pl-c1">25000</span>, <span class="pl-c1">2</span>),
  <span class="pl-s"><span class="pl-pds">"</span>amountBuy<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonDouble</span>(<span class="pl-c1">250</span>, <span class="pl-c1">25000</span>, <span class="pl-c1">2</span>),
  <span class="pl-s"><span class="pl-pds">"</span>rate<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonDouble</span>(<span class="pl-c1">0</span>, <span class="pl-c1">1</span>, <span class="pl-c1">4</span>),
  <span class="pl-s"><span class="pl-pds">"</span>timePlaced<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonString</span>(<span class="pl-c1">18</span>, f4),       <span class="pl-c">// use custom generation strategy</span>
  <span class="pl-s"><span class="pl-pds">"</span>originatingCountry<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">JsonString</span>(<span class="pl-c1">2</span>, f3) <span class="pl-c">// use custom generation strategy</span>
)</pre>
      </div> 
     </div> 
    </div> 
    <div> 
     <p>Now that our JSON structure is defined, the JSON web service can be tested.</p> 
    </div> 
    <div> 
     <div> 
      <div class="highlight highlight-source-scala">
       <pre><span class="pl-c">// if a different content type is required, it can overridden</span>
<span class="pl-c">// override lazy val contentType = `application/json`</span>

<span class="pl-c">// if a custom response evaluator is required, we can override the</span>
<span class="pl-c">// default defined in the JsonApiRequestor trait</span>
<span class="pl-k">override</span> <span class="pl-k">lazy</span> <span class="pl-k">val</span> <span class="pl-en">responseEvaluator</span> <span class="pl-k">=</span> (<span class="pl-v">res</span>: <span class="pl-en">HttpResponse</span>) <span class="pl-k">=&gt;</span> {
  <span class="pl-k">val</span> <span class="pl-en">isCodeValid</span> <span class="pl-k">=</span> res.status <span class="pl-k">==</span> <span class="pl-en">StatusCodes</span>.<span class="pl-en">OK</span>
  <span class="pl-k">val</span> <span class="pl-en">isResponseValid</span><span class="pl-k">:</span> <span class="pl-k">Boolean</span> <span class="pl-k">=</span> {
    <span class="pl-c">// regex to check that the response contains a valid MongoDB object id</span>
    <span class="pl-s"><span class="pl-pds">"</span>^[a-f<span class="pl-cce">\\</span>d]{24}$<span class="pl-pds">"</span></span>.r findFirstIn res.entity.asString <span class="pl-k">match</span> {
	  <span class="pl-k">case</span> <span class="pl-en">Some</span>(_) <span class="pl-k">=&gt;</span> <span class="pl-c1">true</span>
	  <span class="pl-k">case</span> <span class="pl-c1">None</span> <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span>
    }
  }
  <span class="pl-k">if</span> (isCodeValid <span class="pl-k">&amp;&amp;</span> isResponseValid) <span class="pl-c1">true</span> <span class="pl-k">else</span> <span class="pl-c1">false</span>
})

<span class="pl-c">// this will make 50 unique requests to the defined web service using the Post http method.</span>
<span class="pl-c">// given that we have overridden responseEvaluator, this function will be used to</span>
<span class="pl-c">// evaluate the responses from the web service. If an evaluation fails, an AssertionError</span>
<span class="pl-c">// will be thrown</span>
fireAndEvaluateResponse(<span class="pl-en">Put</span>(<span class="pl-s"><span class="pl-pds">"</span>http://mywebservice/apiroute<span class="pl-pds">"</span></span>), <span class="pl-c1">50</span>, jsonStructure)</pre>
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
  <div> 
   <h2 id="user-content-shutting-down-the-actorsystem"><a id="user-content-shutting-down-the-actorsystem" class="anchor" href="https://github.com/damianmcdonald/json-randomizer#shutting-down-the-actorsystem" aria-hidden="true" target="_blank">
     <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
      <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
     </svg></a>Shutting down the ActorSystem</h2> 
   <div> 
    <div> 
     <p>Internally, <code>json-randomizer</code> uses <a href="http://spray.io/documentation/1.2.2/spray-client/" target="_blank">spray-client</a> to make http requests. Spray-client uses an Akka ActorSystem which needs to be stopped following the completion of the API requests.</p> 
    </div> 
    <div> 
     <p>Given that the API requests are made in an asynchronous manner, a <code>TerminatorActor</code> is included that can be queried to determine when the API requests have completed.</p> 
    </div> 
    <div> 
     <p>The following code should be added to an appropriate position within your class (at the end of a class or in an <em>after</em> hook for a test class).</p> 
    </div> 
    <div> 
     <div> 
      <div class="highlight highlight-source-scala">
       <pre><span class="pl-k">import</span> <span class="pl-v">scala.concurrent.duration.</span><span class="pl-v">_</span>
<span class="pl-c">// sleep this thread to give the actor system,</span>
<span class="pl-c">// started by JsonApiRequestor, a chance to fire up</span>
<span class="pl-en">Thread</span>.sleep(<span class="pl-c1">3000L</span>)

<span class="pl-c">// grab a reference to the TerminatorActor</span>
<span class="pl-k">val</span> <span class="pl-en">terminator</span> <span class="pl-k">=</span> system.actorSelection(<span class="pl-s"><span class="pl-pds">"</span>/user/terminator<span class="pl-pds">"</span></span>)

<span class="pl-c">// define an implicit Timeout value, required by the ask pattern Future</span>
<span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">timeout</span> <span class="pl-k">=</span> <span class="pl-en">Timeout</span>(<span class="pl-c1">5</span> seconds)

<span class="pl-c">/**</span>
<span class="pl-c"> * Checks if the API request set has completed.</span>
<span class="pl-c"> * If completed: shut down the ActorSystem</span>
<span class="pl-c"> * if not completed: sleep the Thread before asking the TerminatorActor again.</span>
<span class="pl-c"> *</span>
<span class="pl-c"> * <span class="pl-k">@param</span> <span class="pl-v">b</span> true means the API set has completed, false means that the API set has not completed</span>
<span class="pl-c"> * <span class="pl-k">@param</span> <span class="pl-v">sha1</span> the SHA-1 hash that represents the API request set</span>
<span class="pl-c"> * <span class="pl-k">@return</span> Unit</span>
<span class="pl-c"> */</span>
<span class="pl-k">def</span> <span class="pl-en">checkTerminate</span>(<span class="pl-v">b</span>: <span class="pl-k">Boolean</span>, <span class="pl-v">sha1</span>: <span class="pl-k">String</span>)<span class="pl-k">:</span> <span class="pl-k">Unit</span> <span class="pl-k">=</span> {
  b <span class="pl-k">match</span> {
	<span class="pl-k">case</span> <span class="pl-c1">true</span> <span class="pl-k">=&gt;</span> {
	  log.debug(<span class="pl-s"><span class="pl-pds">"</span>ActorSystem can be shutdown<span class="pl-pds">"</span></span>)
	  system.actorSelection(<span class="pl-s"><span class="pl-pds">"</span>/user/*<span class="pl-pds">"</span></span>) <span class="pl-k">!</span> <span class="pl-en">PoisonPill</span>
	  system.shutdown
	}
	<span class="pl-k">case</span> <span class="pl-c1">false</span> <span class="pl-k">=&gt;</span> {
	  log.debug(<span class="pl-s"><span class="pl-pds">"</span>ActorSystem can not be shutdown<span class="pl-pds">"</span></span>)
	  <span class="pl-en">Thread</span>.sleep(<span class="pl-c1">3000L</span>) <span class="pl-c">// sleep the thread before asking again</span>
	  <span class="pl-k">val</span> <span class="pl-en">future</span> <span class="pl-k">=</span> terminator <span class="pl-k">?</span> <span class="pl-en">Terminator</span>.<span class="pl-en">AskTerminate</span>(sha1)
	  <span class="pl-k">val</span> <span class="pl-en">result</span> <span class="pl-k">=</span> <span class="pl-en">Await</span>.result(future, <span class="pl-c1">5</span> seconds).<span class="pl-c1">asInstanceOf</span>[<span class="pl-k">Boolean</span>]
	  log.debug(<span class="pl-s"><span class="pl-pds">"</span>Terimator.AskTerminate response is: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> result)
	  checkTerminate(result, sha1)
	}
  }
}
<span class="pl-c">// call checkTerminate with initial values</span>
checkTerminate(<span class="pl-c1">false</span>, test1Sha)</pre>
      </div> 
     </div> 
    </div> 
   </div> 
  </div>
 </article>
</div>