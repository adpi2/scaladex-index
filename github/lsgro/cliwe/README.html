<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-cliwe" class="anchor" href="https://github.com/lsgro/cliwe#cliwe" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>cliwe</h1> 
  <p>A Play 2 module providing Command Line Interface to web applications.</p> 
  <p>A powerful way to interact with the backend of your application from a terminal window in the browser.</p> 
  <p>Features:</p> 
  <ul> 
   <li>Javascript running on the server</li> 
   <li>Access to all server-side classes</li> 
   <li>Optionally expose server side live objects</li> 
   <li>HTML console allows for customized graphic output</li> 
   <li>Customizable code completion dialog</li> 
   <li>All interaction happens by issuing commands in the terminals</li> 
  </ul> 
  <h2><a id="user-content-run-the-sample-application" class="anchor" href="https://github.com/lsgro/cliwe#run-the-sample-application" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Run the sample application</h2> 
  <p>Clone the source repository:</p> 
  <pre><code>git clone https://github.com/lsgro/cliwe.git
</code></pre> 
  <p>enter the sample application root directory</p> 
  <pre><code>cd cliwe/cliwe-sample/
</code></pre> 
  <p>in <code>build.sbt</code> change the dependency on cliwe to the latest release available on public repository:</p> 
  <pre><code>....
libraryDependencies += "com.github.lsgro" % "cliwe_2.10" % "1.1.1"
....
</code></pre> 
  <p>(alternatively compile the library and publish to your local repository)</p> 
  <p>run sbt and then start the application:</p> 
  <pre><code>sbt
[cliwe-sample] $ run
</code></pre> 
  <p>point the browser to <code>http://localhost:9000</code></p> 
  <h2><a id="user-content-usage" class="anchor" href="https://github.com/lsgro/cliwe#usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h2> 
  <p>cliwe is currently available in compiled form only for Scala 2.10. Compile from the source if you need to use it with another Scala version.</p> 
  <h3><a id="user-content-adding-the-dependency" class="anchor" href="https://github.com/lsgro/cliwe#adding-the-dependency" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Adding the dependency</h3> 
  <p>In your <code>build.sbt</code> add the following lines:</p> 
  <pre><code>resolvers += Resolver.sonatypeRepo("public")
</code></pre> 
  <p>to add the Sonatype repository.</p> 
  <pre><code>libraryDependencies += "com.github.lsgro" % "cliwe_2.10" % "1.1"
</code></pre> 
  <p>to depend on cliwe.</p> 
  <h3><a id="user-content-adding-a-console-to-an-html-page-in-the-client-application" class="anchor" href="https://github.com/lsgro/cliwe#adding-a-console-to-an-html-page-in-the-client-application" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Adding a console to an HTML page in the client application</h3> 
  <p>Add the following DIVs:</p> 
  <pre><code>&lt;div class="cliwe-terminal"&gt;&lt;/div&gt;
</code></pre> 
  <p>and</p> 
  <pre><code>&lt;div class="cliwe-pin-board"&gt;&lt;/div&gt;
</code></pre> 
  <p>and initialise the cliwe terminal by instantiating the JQuery component:</p> 
  <pre><code>&lt;script type="text/javascript"&gt;$(function(){$(".cliwe-terminal").cliwe()})&lt;/script&gt;
</code></pre> 
  <h3><a id="user-content-mixing-in-cliwe-in-your-web-application" class="anchor" href="https://github.com/lsgro/cliwe#mixing-in-cliwe-in-your-web-application" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Mixing-in cliwe in your web application</h3> 
  <p>Mix the trait <code>CliweShell</code> in your Play 2 Controller. Depending on the level of functionality to integrate, choose one of the following options:</p> 
  <h4><a id="user-content-javascript-shell" class="anchor" href="https://github.com/lsgro/cliwe#javascript-shell" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Javascript shell</h4> 
  <p>The JDK 1.7+ comes with an embedded JavaScript interpreter, available through the Java Scripting API <code>javax.script</code>. The trait <code>JavaScriptEngine</code> provides an adapter to use it with cliwe. Mix the traits <code>CliweShell</code> and <code>JavaScriptEngine</code> in your Play 2 Controller:</p> 
  <pre><code>object Application extends Controller with CliweShell with JavaScriptEngine { ... }
</code></pre> 
  <p>Implement the abstract methods, which are divided in the following concerns:</p> 
  <h5><a id="user-content-persistence" class="anchor" href="https://github.com/lsgro/cliwe#persistence" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Persistence</h5> 
  <p>The script context and last script result number (an integer) must be available to the HTTP session. The client application must therefore implement the following methods:</p> 
  <pre><code>def loadLastResultNumber(sessionUniqueId: String): Option[Int]
def saveLastResultNumber(sessionUniqueId: String, n: Int): Unit
def loadScriptContext(sessionUniqueId: String): Option[ScriptContext]
def saveScriptContext(sessionUniqueId: String, context: ScriptContext): Unit
</code></pre> 
  <p>To simplify prototyping and to build a sample application without having to deal with real persistence, a trait providing an implementation of these four methods is available with the sample application package: <code>DevCacheOnlyPersistence</code>. As it can be guessed by the name, this trait uses the Play Cache API, and therefore it should not be used for real applications, since it could forget and the session script context, depending on the cache implementation.</p> 
  <h5><a id="user-content-initialisation" class="anchor" href="https://github.com/lsgro/cliwe#initialisation" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Initialisation</h5> 
  <p>Any object that must be available in the script context can be passed in a map, indexed by the identifier in the context, by this method:</p> 
  <pre><code>def scriptContextInitializers: Seq[(String, Any)]
</code></pre> 
  <p>A trivial implementation is <code>Nil</code>.</p> 
  <h5><a id="user-content-code-completion" class="anchor" href="https://github.com/lsgro/cliwe#code-completion" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Code completion</h5> 
  <p>At every keystroke, a message is sent to the script engine, to allow for the generation of code completion suggestions, that are made available to the console in a context menu by the press of CTRL+SPACE. To generate the code completion, the client application must implement the following methods:</p> 
  <pre><code>def generateTopLevelCompletions(fragment: String): Seq[CompletionFragment]
def generateCompletions(value: Any, trailingFragment: String): Seq[CompletionFragment]
</code></pre> 
  <p>The first method is for top-level objects, available in any scope of the script. The second method should generate code completions based on a dotted syntax. The first argument: <code>value</code> is the object on which the property or method is being accessed, i.e. the value before the dot. The second argument is the attribute or method name typed so far, after the dot. For example, at this point of the script editing:</p> 
  <pre><code>var d = new Packages.model.Duck()
d.qua
</code></pre> 
  <p>the method <code>generateCompletions</code> will be called with the following arguments:</p> 
  <ul> 
   <li>value = d (a model.Duck instance)</li> 
   <li>trailingFragment = "qua"</li> 
  </ul> 
  <p>For both method, a trivial implementation would be <code>Nil</code>, for no code completion.</p> 
  <h5><a id="user-content-personalised-rendering" class="anchor" href="https://github.com/lsgro/cliwe#personalised-rendering" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Personalised rendering</h5> 
  <p>When a value is returned by the script engine, for example as the evaluation of an object variable, the client code has the option of intercepting the rendering of the value in the console, and provide a personalised view for it. This is achieved by the implementation of the method:</p> 
  <pre><code>def renderResult: PartialFunction[ResultWithId, Html]
</code></pre> 
  <p>If the provided partial function is defined for a specific value, its output will be sent to the console in the browser, instead of the default rendering, obtained by calling <code>toString</code> on it. A trivial implementation, which doesn't provide any personalised rendering, is <code>PartialFunction.empty</code>.</p> 
  <h4><a id="user-content-raw-shell" class="anchor" href="https://github.com/lsgro/cliwe#raw-shell" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Raw shell</h4> 
  <p>With this minimal level of functionality, you have to provide an interpreter for the command line interface. For example attaching a Python or Scala engine, instead of the stock JavaScript available with the <code>JavaScriptEngine</code> trait. Mix-in only the <code>CliweShell</code> trait:</p> 
  <pre><code>object Application extends Controller with CliweShell { ... }
</code></pre> 
  <p>and implement the abstract methods:</p> 
  <pre><code>def generateScriptResponse(fragment: String, sessionUniqueId: String): ScriptResponse

def renderResult: PartialFunction[ResultWithId, Html]
</code></pre> 
  <p>The first method is the heart of the shell, and it is invoked for each keystroke in the client console. The return type <code>ScriptResponse</code> can be one of two classes:</p> 
  <pre><code>case class ScriptResult(value: AnyRef, id: String, stderr: String, stdout: String) extends ScriptResponse
</code></pre> 
  <p>used to return a command result, when the fragment entered is ended by a <code>'\f'</code> character.</p> 
  <pre><code>case class ScriptCompletions(fragments: Seq[CompletionFragment]) extends ScriptResponse
</code></pre> 
  <p>to return script completions, when the fragment entered is incomplete.</p> 
  <p>The second method, <code>renderResult</code>, has been discussed above.</p> 
  <h3><a id="user-content-implementing-the-assetsat-method-in-the-client-controller" class="anchor" href="https://github.com/lsgro/cliwe#implementing-the-assetsat-method-in-the-client-controller" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Implementing the <code>assetsAt</code> method in the client controller</h3> 
  <p>Implement the abstract method:</p> 
  <pre><code>override def assetsAt: String =&gt; Call = routes.Assets.at _
</code></pre> 
  <p>In fact the cliwe module doesn't specify a Router class, leaving this to the client application. This seems to be necessary to avoid having two <code>routes</code> reverse routing classes in the classpath.</p> 
 </article>
</div>