<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-spray-integration---" class="anchor" href="https://github.com/kamon-io/kamon-spray#spray-integration---" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Spray Integration <a href="https://camo.githubusercontent.com/5bf782560c27de2ab2cecd635954a99b310cd3ab/68747470733a2f2f7472617669732d63692e6f72672f6b616d6f6e2d696f2f6b616d6f6e2d73707261792e7376673f6272616e63683d6d6173746572" target="_blank"><img src="https://camo.githubusercontent.com/5bf782560c27de2ab2cecd635954a99b310cd3ab/68747470733a2f2f7472617669732d63692e6f72672f6b616d6f6e2d696f2f6b616d6f6e2d73707261792e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/kamon-io/kamon-spray.svg?branch=master" style="max-width:100%;"></a></h1> 
  <p><a href="https://gitter.im/kamon-io/Kamon?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge" target="_blank"><img src="https://camo.githubusercontent.com/da2edb525cde1455a622c58c0effc3a90b9a181c/68747470733a2f2f6261646765732e6769747465722e696d2f4a6f696e253230436861742e737667" alt="Gitter" data-canonical-src="https://badges.gitter.im/Join%20Chat.svg" style="max-width:100%;"></a> <a href="https://maven-badges.herokuapp.com/maven-central/io.kamon/kamon-spray_2.11" target="_blank"><img src="https://camo.githubusercontent.com/9a084bac5e3fa31d6890ce8052250b0602c235da/68747470733a2f2f6d6176656e2d6261646765732e6865726f6b756170702e636f6d2f6d6176656e2d63656e7472616c2f696f2e6b616d6f6e2f6b616d6f6e2d706c61792d32355f322e31312f62616467652e737667" alt="Maven Central" data-canonical-src="https://maven-badges.herokuapp.com/maven-central/io.kamon/kamon-play-25_2.11/badge.svg" style="max-width:100%;"></a></p> 
  <h1><a id="user-content-spray-integration" class="anchor" href="https://github.com/kamon-io/kamon-spray#spray-integration" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Spray Integration</h1> 
  <p>The <code>kamon-spray</code> module brings bytecode instrumentation and tools that provide what we consider base functionality for a supported HTTP toolkit.</p> 
  <p>The <b>kamon-spray</b> module requires you to start your application using the AspectJ Weaver Agent. Kamon will warn you at startup if you failed to do so.</p> 
  <h3><a id="user-content-getting-started" class="anchor" href="https://github.com/kamon-io/kamon-spray#getting-started" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Getting Started</h3> 
  <p>Kamon spray module is currently available for Scala 2.10, 2.11.</p> 
  <p>Supported releases and dependencies are shown below.</p> 
  <table> 
   <thead> 
    <tr> 
     <th align="center">kamon-spray</th> 
     <th align="center">status</th> 
     <th align="center">jdk</th> 
     <th>scala</th> 
     <th align="center">akka</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td align="center">0.6.6</td> 
     <td align="center">stable</td> 
     <td align="center">1.7+, 1.8+</td> 
     <td>2.10, 2.11</td> 
     <td align="center">2.3.x, 2.4.x</td> 
    </tr>
   </tbody>
  </table> 
  <p>To get started with SBT, simply add the following to your <code>build.sbt</code> file:</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>io.kamon<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>kamon-spray<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.6.6<span class="pl-pds">"</span></span></pre>
  </div> 
  <h2><a id="user-content-server-side-tools" class="anchor" href="https://github.com/kamon-io/kamon-spray#server-side-tools" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Server Side Tools</h2> 
  <p>One of the main goals in our Spray integration is to measure the behavior of your HTTP server and for that, we automatically start and finish traces for you, but there is one caveat here, though. When you start traces with Kamon you need to provide a name for it and that name will be used for metric tracking purposes; it is really important that you give a meaningful name to your traces, but our integration the traces are not started by a piece of code that you can control but rather by instrumentation injected in Spray's internals, so you need to ensure that a proper name is assigned to the traces for them to be really useful.</p> 
  <h2><a id="user-content-client-side-tools" class="anchor" href="https://github.com/kamon-io/kamon-spray#client-side-tools" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Client Side Tools</h2> 
  <p>If you are using <code>spray-client</code> to send HTTP requests to other services then we also have something to offer on this side. The bytecode instrumentation provided by the <code>kamon-spray</code> module hooks into Spray's internals to automatically start and finish segments for requests that are issued within a trace. This translates into you having metrics about how the services you are calling are behaving.</p> 
  <p>As you might already know, <code>spray-client</code> comes with three different levels of abstraction that can be used to issue HTTP requests, namely the Request-level API, the Host-level API and the Connection-level API. If you are using any of the first two options, then our instrumentation can automatically create and finish segments for you, whereas if you are using the Connection-level API you will need to manage segments on your own.</p> 
  <p>Since each of the client API levels provided in Spray builds on top of the previous level, you will beed to use the <code>kamon.spray.client.instrumentation-level</code> configuration key to tell Kamon at which level you want the segments to be measured. The available options are:</p> 
  <ul> 
   <li> <p><strong>request-level</strong>: measures the time during which the user application code is waiting for a <code>spray-client</code> request to complete, by attaching a callback to the Future[HttpResponse] returned by <code>spray.client.pipelining.sendReceive</code>. If <code>spray.client.pipelining.sendReceive</code> is not used, the segment measurement wont be performed.</p> </li> 
   <li> <p><strong>host-level</strong>: measures the internal time taken by spray-client to finish a request. Sometimes the user application code has a finite future timeout (like when using <code>spray.client.pipelining.sendReceive</code>) that doesn't match the actual amount of time spray might take internally to resolve a request, counting retries, redirects, connection timeouts and so on. If using the host level instrumentation, the measured time will include the entire time since the request has been received by the corresponding <code>HttpHostConnector</code> until a response is sent back to the requester.</p> </li> 
  </ul> 
 </article>
</div>