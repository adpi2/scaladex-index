<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-entitytled" class="anchor" href="https://github.com/rsschermer/entitytled#entitytled" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Entitytled</h1> 
  <p>Entitytled is an ORM-like data access and persistence library build on top of <a href="http://slick.typesafe.com/" target="_blank">Scala Slick</a>. Entitytled adds "entity" and "relationship" concepts, with the aims of improving structure and consistency, and eliminating boilerplate.</p> 
  <p><a href="https://travis-ci.org/RSSchermer/entitytled" target="_blank"><img src="https://camo.githubusercontent.com/10bcc32d40f97e47776cb3441e971a9ff1d74312/68747470733a2f2f7472617669732d63692e6f72672f525353636865726d65722f656e74697479746c65642e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/RSSchermer/entitytled.svg?branch=master" style="max-width:100%;"></a></p> 
  <h2><a id="user-content-table-of-contents" class="anchor" href="https://github.com/rsschermer/entitytled#table-of-contents" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Table of contents</h2> 
  <ul> 
   <li><a href="https://github.com/rsschermer/entitytled#artifact-installation" target="_blank">Artifact installation</a></li> 
   <li><a href="https://github.com/rsschermer/entitytled#defining-an-entity-type" target="_blank">Defining an Entity type</a> 
    <ul> 
     <li><a href="https://github.com/rsschermer/entitytled#importing-a-profile" target="_blank">Importing a profile</a></li> 
     <li><a href="https://github.com/rsschermer/entitytled#defining-the-entity-type" target="_blank">Defining the Entity type</a></li> 
     <li><a href="https://github.com/rsschermer/entitytled#defining-the-companion-object" target="_blank">Defining the companion object</a></li> 
     <li><a href="https://github.com/rsschermer/entitytled#safer-ids" target="_blank">Safer IDs</a></li> 
    </ul></li> 
   <li><a href="https://github.com/rsschermer/entitytled#defining-direct-relationships" target="_blank">Defining direct relationships</a> 
    <ul> 
     <li><a href="https://github.com/rsschermer/entitytled#direct-to-one-relationships" target="_blank">Direct 'to one' relationships</a></li> 
     <li><a href="https://github.com/rsschermer/entitytled#direct-to-many-relationships" target="_blank">Direct 'to many' relationships</a></li> 
    </ul></li> 
   <li><a href="https://github.com/rsschermer/entitytled#defining-indirect-relationships-many-to-many" target="_blank">Defining indirect relationships (many-to-many)</a></li> 
   <li><a href="https://github.com/rsschermer/entitytled#composing-relationships" target="_blank">Composing relationships</a></li> 
   <li><a href="https://github.com/rsschermer/entitytled#querying-an-entity-set" target="_blank">Querying an entity set</a> 
    <ul> 
     <li><a href="https://github.com/rsschermer/entitytled#building-read-actions" target="_blank">Building read actions</a></li> 
     <li><a href="https://github.com/rsschermer/entitytled#creating-an-insert-action" target="_blank">Creating an insert action</a></li> 
     <li><a href="https://github.com/rsschermer/entitytled#creating-an-update-action" target="_blank">Creating an update action</a></li> 
     <li><a href="https://github.com/rsschermer/entitytled#creating-a-delete-action" target="_blank">Creating a delete action</a></li> 
    </ul></li> 
   <li><a href="https://github.com/rsschermer/entitytled#navigating-relationship-values" target="_blank">Navigating relationship values</a></li> 
   <li><a href="https://github.com/rsschermer/entitytled#play-framework" target="_blank">Play Framework</a> 
    <ul> 
     <li><a href="https://github.com/rsschermer/entitytled#activator-template" target="_blank">Activator Template</a></li> 
    </ul></li> 
  </ul> 
  <h2><a id="user-content-artifact-installation" class="anchor" href="https://github.com/rsschermer/entitytled#artifact-installation" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Artifact installation</h2> 
  <p>The Entitytled artifact is available on Sonatype's central repository and is cross-build for Scala 2.10 and Scala 2.11.</p> 
  <p>To make SBT automatically use the correct build based on your project's Scala version, add the following to your build file:</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>com.github.rsschermer<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>entitytled-core<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.8.0<span class="pl-pds">"</span></span></pre>
  </div> 
  <p>To use the 2.10 build explicitly, add:</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>com.github.rsschermer<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>entitytled-core_2.10<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.8.0<span class="pl-pds">"</span></span></pre>
  </div> 
  <p>To use the 2.11 build explicitly, add:</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>com.github.rsschermer<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>entitytled-core_2.11<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.8.0<span class="pl-pds">"</span></span></pre>
  </div> 
  <h2><a id="user-content-defining-an-entity-type" class="anchor" href="https://github.com/rsschermer/entitytled#defining-an-entity-type" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Defining an Entity type</h2> 
  <p>In Entitytled, entity types are case classes which extend the <code>Entity</code> base class. They need to be accompanied by an <code>EntityTable</code> definition, which describes the schema for the entity. They may additionally by accompanied by an <code>EntityCompanion</code> object, which provides a default set of methods for querying and persisting entities.</p> 
  <p>This example defines a Director entity, which models a movie director:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">entitytled.profile.H2Profile.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">entitytled.profile.H2Profile.driver.api.</span><span class="pl-v">_</span>

<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Director</span>(
    <span class="pl-v">id</span>: <span class="pl-en">Option</span>[<span class="pl-k">Long</span>],
    <span class="pl-v">name</span>: <span class="pl-k">String</span>,
    <span class="pl-v">age</span>: <span class="pl-k">Int</span>)
  <span class="pl-k">extends</span> <span class="pl-e">Entity</span>[<span class="pl-en">Director</span>, <span class="pl-k">Long</span>]

<span class="pl-k">object</span> <span class="pl-en">Director</span> <span class="pl-k">extends</span> <span class="pl-e">EntityCompanion</span>[<span class="pl-en">Directors</span>, <span class="pl-en">Director</span>, <span class="pl-k">Long</span>]

<span class="pl-k">class</span> <span class="pl-en">Directors</span>(<span class="pl-v">tag</span>: <span class="pl-en">Tag</span>) <span class="pl-k">extends</span> <span class="pl-e">EntityTable</span>[<span class="pl-en">Director</span>, <span class="pl-k">Long</span>](tag, <span class="pl-s"><span class="pl-pds">"</span>DIRECTORS<span class="pl-pds">"</span></span>) {
  <span class="pl-k">def</span> <span class="pl-en">id</span> <span class="pl-k">=</span> column[<span class="pl-k">Long</span>](<span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>, <span class="pl-en">O</span>.<span class="pl-en">PrimaryKey</span>, <span class="pl-en">O</span>.<span class="pl-en">AutoInc</span>)
  <span class="pl-k">def</span> <span class="pl-en">name</span> <span class="pl-k">=</span> column[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>)
  <span class="pl-k">def</span> <span class="pl-en">age</span> <span class="pl-k">=</span> column[<span class="pl-k">Int</span>](<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>)

  <span class="pl-k">def</span> <span class="pl-en">*</span> <span class="pl-k">=</span> (id.<span class="pl-k">?</span>, name) <span class="pl-k">&lt;&gt;</span> ((<span class="pl-en">Director</span>.apply _).tupled, <span class="pl-en">Director</span>.unapply)
}</pre>
  </div> 
  <p>Lets break this example up and take a closer look at the individual pieces.</p> 
  <h3><a id="user-content-importing-a-profile" class="anchor" href="https://github.com/rsschermer/entitytled#importing-a-profile" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Importing a profile</h3> 
  <p>Slick provides drivers for multiple databases. Entitytled can be used with any driver that implements <code>scala.slick.driver.JdbcProfile</code>. The Director example uses a predefined profile for the <a href="http://www.h2database.com" target="_blank">H2 database</a>:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">entitytled.profile.H2Profile.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">entitytled.profile.H2Profile.driver.api.</span><span class="pl-v">_</span></pre>
  </div> 
  <p>The first line imports Entitytled's functionality for Slick's H2 driver and the second line imports Slick's own functionality for the H2 driver. (Note: Entitytled also supports dependency injection via the cake pattern. However, these examples will use hard-coded import statements instead, as the cake pattern adds a certain amount of complexity.) </p> 
  <p>Predefined profiles exist for several other databases:</p> 
  <ul> 
   <li><code>entitytled.profile.PostgresProfile</code> for use with <a href="http://www.postgresql.org" target="_blank">PostgreSQL</a>.</li> 
   <li><code>entitytled.profile.MySQLProfile</code> for use with <a href="http://www.mysql.com" target="_blank">MySQL</a>.</li> 
   <li><code>entitytled.profile.SQLiteProfile</code> for use with <a href="https://sqlite.org" target="_blank">SQLite</a>.</li> 
   <li><code>entitytled.profile.DerbyProfile</code> for use with <a href="https://db.apache.org/derby" target="_blank">Apache Derby</a>.</li> 
   <li><code>entitytled.profile.HsqldbProfile</code> for use with <a href="http://hsqldb.org" target="_blank">HyperSQL DataBase</a>.</li> 
  </ul> 
  <p>To use e.g. PostgreSQL instead of H2 use:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">entitytled.profile.PostgresProfile.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">entitytled.profile.PostgresProfile.driver.api.</span><span class="pl-v">_</span></pre>
  </div> 
  <p>You may also define your own profile for a driver that is not included in the standard distribution of Slick:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">package</span> <span class="pl-en">models.meta</span>

<span class="pl-k">import</span> <span class="pl-v">entitytled.</span><span class="pl-v">Entitytled</span>
<span class="pl-k">import</span> <span class="pl-v">my.driver.</span><span class="pl-v">MyDriver</span>

<span class="pl-k">trait</span> <span class="pl-en">MyProfile</span> <span class="pl-k">extends</span> <span class="pl-e">Entitytled</span> {
  <span class="pl-k">val</span> <span class="pl-en">driver</span><span class="pl-k">:</span> <span class="pl-en">MyDriver</span> <span class="pl-k">=</span> <span class="pl-en">MyDriver</span>
}

<span class="pl-k">object</span> <span class="pl-en">MyProfile</span> <span class="pl-k">extends</span> <span class="pl-e">MyProfile</span></pre>
  </div> 
  <p>And use it like this:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">models.meta.MyProfile.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">models.meta.MyProfile.driver.api.</span><span class="pl-v">_</span></pre>
  </div> 
  <h3><a id="user-content-defining-the-entity-type" class="anchor" href="https://github.com/rsschermer/entitytled#defining-the-entity-type" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Defining the Entity type</h3> 
  <p>The second segment of interest in the Director example is the definition of the <code>Director</code> case class:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Director</span>(
    <span class="pl-v">id</span>: <span class="pl-en">Option</span>[<span class="pl-k">Long</span>],
    <span class="pl-v">name</span>: <span class="pl-k">String</span>,
    <span class="pl-v">age</span>: <span class="pl-k">Int</span>)
  <span class="pl-k">extends</span> <span class="pl-e">Entity</span>[<span class="pl-en">Director</span>, <span class="pl-k">Long</span>]</pre>
  </div> 
  <p>The <code>Director</code> case class extends the <code>Entity</code> base class, which takes two type parameters: the <code>Director</code> type itself (a self bound), and the type of its ID:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">extends</span> <span class="pl-e">Entity</span>[<span class="pl-en">Director</span>, <span class="pl-k">Long</span>]</pre>
  </div> 
  <p>The <code>id</code> field then needs to be of type <code>Option[IdType]</code>, which in this case means it needs to be of type <code>Option[Long]</code>.</p> 
  <h3><a id="user-content-defining-the-companion-object" class="anchor" href="https://github.com/rsschermer/entitytled#defining-the-companion-object" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Defining the companion object</h3> 
  <p>Next the Director example defines a <code>Director</code> companion object for the <code>Director</code> case class: </p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">object</span> <span class="pl-en">Director</span> <span class="pl-k">extends</span> <span class="pl-e">EntityCompanion</span>[<span class="pl-en">Directors</span>, <span class="pl-en">Director</span>, <span class="pl-k">Long</span>]</pre>
  </div> 
  <p>This companion object will be our entry point for querying and persisting directors. It extends <code>EntityCompanion</code> which takes the table type (<code>Directors</code>), the entity type (<code>Director</code>), and the entity's ID type (<code>Long</code>) as type parameters.</p> 
  <h3><a id="user-content-defining-the-table-type" class="anchor" href="https://github.com/rsschermer/entitytled#defining-the-table-type" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Defining the table type</h3> 
  <p>The final part of the Director example defines the <code>Directors</code> table:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">Directors</span>(<span class="pl-v">tag</span>: <span class="pl-en">Tag</span>) <span class="pl-k">extends</span> <span class="pl-e">EntityTable</span>[<span class="pl-en">Director</span>, <span class="pl-k">Long</span>](tag, <span class="pl-s"><span class="pl-pds">"</span>DIRECTORS<span class="pl-pds">"</span></span>) {
  <span class="pl-k">def</span> <span class="pl-en">id</span> <span class="pl-k">=</span> column[<span class="pl-k">Long</span>](<span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>, <span class="pl-en">O</span>.<span class="pl-en">PrimaryKey</span>, <span class="pl-en">O</span>.<span class="pl-en">AutoInc</span>)
  <span class="pl-k">def</span> <span class="pl-en">name</span> <span class="pl-k">=</span> column[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>)
  <span class="pl-k">def</span> <span class="pl-en">age</span> <span class="pl-k">=</span> column[<span class="pl-k">Int</span>](<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>)

  <span class="pl-k">def</span> <span class="pl-en">*</span> <span class="pl-k">=</span> (id.<span class="pl-k">?</span>, name, age) <span class="pl-k">&lt;&gt;</span> ((<span class="pl-en">Director</span>.apply _).tupled, <span class="pl-en">Director</span>.unapply)
}</pre>
  </div> 
  <p>Table definition is essentially the same as it is in Slick and you can find more details in <a href="http://slick.typesafe.com/doc/3.0.0/schemas.html" target="_blank">Slick's documentation on schemas</a>. Instead of extending a regular <code>Table</code>, a table definition for an entity needs to extend the <code>EntityTable</code> base class. The <code>EntityTable</code> base class takes two type parameters, the entity type and the ID type, and requires that you at least define an <code>id</code> method that returns a value of type <code>Column[IdType]</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">id</span> <span class="pl-k">=</span> column[<span class="pl-k">Long</span>](<span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>, <span class="pl-en">O</span>.<span class="pl-en">PrimaryKey</span>, <span class="pl-en">O</span>.<span class="pl-en">AutoInc</span>)</pre>
  </div> 
  <p>Usually the <code>id</code> column is also the primary key of an entity table.</p> 
  <h3><a id="user-content-safer-ids" class="anchor" href="https://github.com/rsschermer/entitytled#safer-ids" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Safer IDs</h3> 
  <p>To keep this example simple, the ID type was specified simply as <code>Long</code>. However, if we'd also have a <code>Producer</code> entity type, which also specified its ID type as a simple <code>Long</code>, we could be at risk of mixing up our director IDs with our producer IDs. Slick also supports using more precise types that wrap a primitive type. We could make use of this to make our <code>id</code> field a bit safer:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">DirectorID</span>(<span class="pl-v">value</span>: <span class="pl-k">Long</span>) <span class="pl-k">extends</span> <span class="pl-e">MappedTo</span>[<span class="pl-k">Long</span>]</pre>
  </div> 
  <p>We'd then have to update our <code>Director</code> entity definition as follows:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Director</span>(
    <span class="pl-v">id</span>: <span class="pl-en">Option</span>[<span class="pl-en">DirectorID</span>],
    <span class="pl-v">name</span>: <span class="pl-k">String</span>,
    <span class="pl-v">age</span>: <span class="pl-k">Int</span>)
  <span class="pl-k">extends</span> <span class="pl-e">Entity</span>[<span class="pl-en">Director</span>, <span class="pl-en">DirectorID</span>]

<span class="pl-k">object</span> <span class="pl-en">Director</span> <span class="pl-k">extends</span> <span class="pl-e">EntityCompanion</span>[<span class="pl-en">Directors</span>, <span class="pl-en">Director</span>, <span class="pl-en">DirectorID</span>]

<span class="pl-k">class</span> <span class="pl-en">Directors</span>(<span class="pl-v">tag</span>: <span class="pl-en">Tag</span>) <span class="pl-k">extends</span> <span class="pl-e">EntityTable</span>[<span class="pl-en">Director</span>, <span class="pl-en">DirectorID</span>](tag, <span class="pl-s"><span class="pl-pds">"</span>DIRECTORS<span class="pl-pds">"</span></span>) {
  <span class="pl-k">def</span> <span class="pl-en">id</span> <span class="pl-k">=</span> column[<span class="pl-en">DirectorID</span>](<span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>, <span class="pl-en">O</span>.<span class="pl-en">PrimaryKey</span>, <span class="pl-en">O</span>.<span class="pl-en">AutoInc</span>)
  <span class="pl-k">def</span> <span class="pl-en">name</span> <span class="pl-k">=</span> column[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>)
  <span class="pl-k">def</span> <span class="pl-en">age</span> <span class="pl-k">=</span> column[<span class="pl-k">Int</span>](<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>)

  <span class="pl-k">def</span> <span class="pl-en">*</span> <span class="pl-k">=</span> (id.<span class="pl-k">?</span>, name) <span class="pl-k">&lt;&gt;</span> ((<span class="pl-en">Director</span>.apply _).tupled, <span class="pl-en">Director</span>.unapply)
}</pre>
  </div> 
  <p>The <a href="https://github.com/rsschermer/entitytled/blob/master/test/src/test/scala/entitytled/test/holywood" target="_blank">Holywood example used for testing</a> also uses this safer way of handling IDs.</p> 
  <h2><a id="user-content-defining-direct-relationships" class="anchor" href="https://github.com/rsschermer/entitytled#defining-direct-relationships" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Defining direct relationships</h2> 
  <p>Direct relationships are relationships that involve at most two tables: one table for the owner entity type and one table for the target relation. The relationship is defined by a foreign key, either on the owner or the target.</p> 
  <h3><a id="user-content-direct-to-one-relationships" class="anchor" href="https://github.com/rsschermer/entitytled#direct-to-one-relationships" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Direct 'to one' relationships</h3> 
  <p>Let's define a <code>Movie</code> entity type which has a 'to one' relationship with the <code>Director</code> entity type:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Movie</span>(
    <span class="pl-v">id</span>: <span class="pl-en">Option</span>[<span class="pl-k">Long</span>],
    <span class="pl-v">title</span>: <span class="pl-k">String</span>,
    <span class="pl-v">directorID</span>: <span class="pl-k">Long</span>)(<span class="pl-k">implicit</span> <span class="pl-v">includes</span>: <span class="pl-en">Includes</span>[<span class="pl-en">Movie</span>])
  <span class="pl-k">extends</span> <span class="pl-e">Entity</span>[<span class="pl-en">Movie</span>, <span class="pl-k">Long</span>]
{
  <span class="pl-k">val</span> <span class="pl-en">director</span> <span class="pl-k">=</span> one(<span class="pl-en">Movie</span>.director)
}

<span class="pl-k">object</span> <span class="pl-en">Movie</span> <span class="pl-k">extends</span> <span class="pl-e">EntityCompanion</span>[<span class="pl-en">Movies</span>, <span class="pl-en">Movie</span>, <span class="pl-k">Long</span>] {
  <span class="pl-k">val</span> <span class="pl-en">director</span> <span class="pl-k">=</span> toOne[<span class="pl-en">Directors</span>, <span class="pl-en">Director</span>]
}

<span class="pl-k">class</span> <span class="pl-en">Movies</span>(<span class="pl-v">tag</span>: <span class="pl-en">Tag</span>) <span class="pl-k">extends</span> <span class="pl-e">EntityTable</span>[<span class="pl-en">Movie</span>, <span class="pl-k">Long</span>](tag, <span class="pl-s"><span class="pl-pds">"</span>MOVIES<span class="pl-pds">"</span></span>) {
  <span class="pl-k">def</span> <span class="pl-en">id</span> <span class="pl-k">=</span> column[<span class="pl-k">Long</span>](<span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>, <span class="pl-en">O</span>.<span class="pl-en">PrimaryKey</span>, <span class="pl-en">O</span>.<span class="pl-en">AutoInc</span>)
  <span class="pl-k">def</span> <span class="pl-en">title</span> <span class="pl-k">=</span> column[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>)
  <span class="pl-k">def</span> <span class="pl-en">directorID</span> <span class="pl-k">=</span> column[<span class="pl-k">Long</span>](<span class="pl-s"><span class="pl-pds">"</span>director_id<span class="pl-pds">"</span></span>)

  <span class="pl-k">def</span> <span class="pl-en">*</span> <span class="pl-k">=</span> (id.<span class="pl-k">?</span>, title, directorID) <span class="pl-k">&lt;&gt;</span> ((<span class="pl-en">Movie</span>.apply _).tupled, <span class="pl-en">Movie</span>.unapply)

  <span class="pl-k">def</span> <span class="pl-en">director</span> <span class="pl-k">=</span> foreignKey(<span class="pl-s"><span class="pl-pds">"</span>MOVIES_DIRECTOR_FK<span class="pl-pds">"</span></span>, directorID, <span class="pl-en">TableQuery</span>[<span class="pl-en">Directors</span>])(_.id)
}</pre>
  </div> 
  <p>The <code>Movie</code> 'to one' <code>Director</code> relationship in this example is a direct relationship; the foreign key in this example is the <code>directorID</code> field on the <code>Movie</code> entity type. We've also specified a foreign key constraint in our table definition (see <a href="http://slick.typesafe.com/doc/2.1.0/schemas.html" target="_blank">Slick's documentation for more details on table definition</a>):</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">director</span> <span class="pl-k">=</span> foreignKey(<span class="pl-s"><span class="pl-pds">"</span>MOVIES_DIRECTOR_FK<span class="pl-pds">"</span></span>, directorID, <span class="pl-en">TableQuery</span>[<span class="pl-en">Directors</span>])(_.id)</pre>
  </div> 
  <p>Apart from having a foreign key field, <code>Movie</code> differs in some other ways from the simpler <code>Director</code> example that did not have any relationships. The first is the addition of an implicit <code>includes</code> parameter to the case class constructor:</p> 
  <div class="highlight highlight-source-scala">
   <pre>(<span class="pl-k">implicit</span> <span class="pl-v">includes</span>: <span class="pl-en">Includes</span>[<span class="pl-en">Movie</span>])</pre>
  </div> 
  <p>This is to support eager-loading (a topic discussed in more detail in the "Querying an Entity set" section of this guide). It does not have to be named <code>includes</code>, but it does need to be of type <code>Includes[EntityType]</code>, which in this case means it has to be of type <code>Includes[Movie]</code>.</p> 
  <p>The second difference is the addition of a <code>director</code> field in the case class body:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">director</span> <span class="pl-k">=</span> one(<span class="pl-en">Movie</span>.director)</pre>
  </div> 
  <p>Let's skip that difference for a second and look at the third difference first, the addition of a <code>director</code> field on the companion object:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">director</span> <span class="pl-k">=</span> toOne[<span class="pl-en">Directors</span>, <span class="pl-en">Director</span>]</pre>
  </div> 
  <p>This defines the relationship by calling the <code>toOne</code> function. The <code>toOne</code> function takes two type parameters: the target table type (<code>Directors</code> in this case) and the target type (<code>Director</code> in this case). You can also specify two optional parameters:</p> 
  <ul> 
   <li><code>toQuery</code>: a query identifying the set of all target relations of the target type that could possibly be related to a movie. In this case the target type is <code>Director</code>, so the <code>toQuery</code> must identify a set of directors.</li> 
   <li><code>joinCondition</code>: the condition that joins a specific owner instance to the subset of relations identified by <code>toQuery</code> that belong to it. If you don't specify this parameter, Entitytled will attempt to infer a join condition at compile time, based on the foreign keys you defined on the owner table type and the target table type. For Entitytled to be able to do this, there must be exactly one candidate foreign key (a foreign from the owner table to the target table, or from the target table to the owner table). If there's more than one candidate, or if you did not define any candidate foreign keys, you will get a compiler error. You can always resolve this error by providing a join condition explicitly.</li> 
  </ul> 
  <p>The example just uses the defaults for these parameters, which is essentially equivalent to:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">director</span> <span class="pl-k">=</span> toOne[<span class="pl-en">Directors</span>, <span class="pl-en">Director</span>](
  toQuery       <span class="pl-k">=</span> <span class="pl-en">TableQuery</span>[<span class="pl-en">Directors</span>],
  joinCondition <span class="pl-k">=</span> (<span class="pl-v">m</span>: <span class="pl-en">Movies</span>, <span class="pl-v">d</span>: <span class="pl-en">Directors</span>) <span class="pl-k">=&gt;</span> m.directorID <span class="pl-k">===</span> d.id
)</pre>
  </div> 
  <p>The default <code>toQuery</code> allows any director to be a target for this relationship and the default join condition states that a director is related to a movie if the movie's <code>directorID</code> equals the director's <code>id</code> (which is exactly what the foreign key constraint we defined on the table describes).</p> 
  <p>Now, let's take another look at the <code>director</code> field on our <code>Movie</code> case class:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">director</span> <span class="pl-k">=</span> one(<span class="pl-en">Movie</span>.director)</pre>
  </div> 
  <p>This calls the <code>one</code> function, which takes the relationship we defined in the companion object as an argument. If we have a specific movie instance, this field will represent the related director:</p> 
  <div class="highlight highlight-source-scala">
   <pre>titanic.director <span class="pl-c"><span class="pl-c">//</span> James Cameron</span></pre>
  </div> 
  <p>Navigating relationships is described in more detail in its own section.</p> 
  <h3><a id="user-content-direct-to-many-relationships" class="anchor" href="https://github.com/rsschermer/entitytled#direct-to-many-relationships" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Direct 'to many' relationships</h3> 
  <p>Direct 'to many' relationships are very similar to 'to one' relationships. Here's a modified version of the simple <code>Director</code> example, except now with a 'to many' relationship to the <code>Movie</code> type:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Director</span>(
    <span class="pl-v">id</span>: <span class="pl-en">Option</span>[<span class="pl-k">Long</span>],
    <span class="pl-v">name</span>: <span class="pl-k">String</span>,
    <span class="pl-v">age</span>: <span class="pl-k">Int</span>)(<span class="pl-k">implicit</span> <span class="pl-v">includes</span>: <span class="pl-en">Includes</span>[<span class="pl-en">Director</span>])
  <span class="pl-k">extends</span> <span class="pl-e">Entity</span>[<span class="pl-en">Director</span>, <span class="pl-k">Long</span>]
{
  <span class="pl-k">val</span> <span class="pl-en">movies</span> <span class="pl-k">=</span> many(<span class="pl-en">Director</span>.movies)
}

<span class="pl-k">object</span> <span class="pl-en">Director</span> <span class="pl-k">extends</span> <span class="pl-e">EntityCompanion</span>[<span class="pl-en">Directors</span>, <span class="pl-en">Director</span>, <span class="pl-k">Long</span>] {  
  <span class="pl-k">val</span> <span class="pl-en">movies</span> <span class="pl-k">=</span> toMany[<span class="pl-en">Movies</span>, <span class="pl-en">Movie</span>]
}

<span class="pl-k">class</span> <span class="pl-en">Directors</span>(<span class="pl-v">tag</span>: <span class="pl-en">Tag</span>) <span class="pl-k">extends</span> <span class="pl-e">EntityTable</span>[<span class="pl-en">Director</span>, <span class="pl-k">Long</span>](tag, <span class="pl-s"><span class="pl-pds">"</span>DIRECTORS<span class="pl-pds">"</span></span>) {
  <span class="pl-k">def</span> <span class="pl-en">id</span> <span class="pl-k">=</span> column[<span class="pl-k">Long</span>](<span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>, <span class="pl-en">O</span>.<span class="pl-en">PrimaryKey</span>, <span class="pl-en">O</span>.<span class="pl-en">AutoInc</span>)
  <span class="pl-k">def</span> <span class="pl-en">name</span> <span class="pl-k">=</span> column[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>)
  <span class="pl-k">def</span> <span class="pl-en">age</span> <span class="pl-k">=</span> column[<span class="pl-k">Int</span>](<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>)

  <span class="pl-k">def</span> <span class="pl-en">*</span> <span class="pl-k">=</span> (id.<span class="pl-k">?</span>, name, age) <span class="pl-k">&lt;&gt;</span> ((<span class="pl-en">Director</span>.apply _).tupled, <span class="pl-en">Director</span>.unapply)
}</pre>
  </div> 
  <p>There's no foreign key field here, that's already covered by the foreign key on the <code>Movie</code> type. Just as with the <code>Movie</code> type, an implicit <code>includes</code> constructor argument was added to the case class to enable eager-loading. </p> 
  <p>We've added a <code>movies</code> field to case class body, except this time it calls the <code>many</code> function instead of the <code>one</code> function:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">movies</span> <span class="pl-k">=</span> many(<span class="pl-en">Director</span>.movies)</pre>
  </div> 
  <p><code>many</code> works exactly the same as <code>one</code>, except it is used for representing a related collection, instead of a single related instance.</p> 
  <p>The last change made, is the addition of the <code>movies</code> field on the companion object:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">movies</span> <span class="pl-k">=</span> toMany[<span class="pl-en">Movies</span>, <span class="pl-en">Movie</span>]</pre>
  </div> 
  <p>This is basically the inverse of the <code>director</code> field on the <code>Movie</code> companion object described in the previous section. Together, this 'to many' relationship definition and the 'to one' relationship on the <code>Movie</code> companion object, form the full '<code>Director</code> one-to-many <code>Movie</code>' relationship.</p> 
  <p>One thing better illustrated for a 'to many' relationship (but technically also possible for a 'to one' relationship) is that we can further constrain the set of possible related instances via the optional <code>toQuery</code> argument. We might for example define a relationship for only black-and-white movies:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">blackAndWhiteMovies</span> <span class="pl-k">=</span> toMany[<span class="pl-en">Movies</span>, <span class="pl-en">Movie</span>](
  toQuery <span class="pl-k">=</span> <span class="pl-en">TableQuery</span>[<span class="pl-en">Movies</span>].filter(_.color <span class="pl-k">===</span> <span class="pl-c1">false</span>)
)</pre>
  </div> 
  <h2><a id="user-content-defining-indirect-relationships-many-to-many" class="anchor" href="https://github.com/rsschermer/entitytled#defining-indirect-relationships-many-to-many" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Defining indirect relationships (many-to-many)</h2> 
  <p>Indirect relationships rely on a 'join table'. Instead of one of the tables for the two related types defining a foreign key, a separate table is responsible for recording the relationships between these types. This is typically how 'many-to-many' relationships are defined.</p> 
  <p>As an example we'll set up a many-to-many relationship between the <code>Movie</code> type (which we already used in the direct relationships example) and a new <code>Star</code> type, which describes a movie star. This is what the join table looks like:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">MoviesStars</span>(<span class="pl-v">tag</span>: <span class="pl-en">Tag</span>) <span class="pl-k">extends</span> <span class="pl-e">Table</span>[(<span class="pl-k">Long</span>, <span class="pl-k">Long</span>)](tag, <span class="pl-s"><span class="pl-pds">"</span>MOVIES_STARS<span class="pl-pds">"</span></span>) {
  <span class="pl-k">def</span> <span class="pl-en">movieID</span> <span class="pl-k">=</span> column[<span class="pl-k">Long</span>](<span class="pl-s"><span class="pl-pds">"</span>movie_id<span class="pl-pds">"</span></span>)
  <span class="pl-k">def</span> <span class="pl-en">starID</span> <span class="pl-k">=</span> column[<span class="pl-k">Long</span>](<span class="pl-s"><span class="pl-pds">"</span>star_id<span class="pl-pds">"</span></span>)

  <span class="pl-k">def</span> <span class="pl-en">*</span> <span class="pl-k">=</span> (movieID, starID)

  <span class="pl-k">def</span> <span class="pl-en">pk</span> <span class="pl-k">=</span> primaryKey(<span class="pl-s"><span class="pl-pds">"</span>MOVIES_STARS_PK<span class="pl-pds">"</span></span>, (movieID, starID))
  <span class="pl-k">def</span> <span class="pl-en">movie</span> <span class="pl-k">=</span> foreignKey(<span class="pl-s"><span class="pl-pds">"</span>MOVIES_STARS_MOVIE_FK<span class="pl-pds">"</span></span>, movieID, <span class="pl-en">TableQuery</span>[<span class="pl-en">Movies</span>])(_.id)
  <span class="pl-k">def</span> <span class="pl-en">star</span> <span class="pl-k">=</span> foreignKey(<span class="pl-s"><span class="pl-pds">"</span>MOVIES_STARS_STAR_FK<span class="pl-pds">"</span></span>, starID, <span class="pl-en">TableQuery</span>[<span class="pl-en">Stars</span>])(_.id)
}</pre>
  </div> 
  <p>Note that this does not extend <code>EntityTable</code>, it just extends Slick's plain old <code>Table</code>. That's because the rows in this table do not represent entities, it exists only so we can describe our many-to-many relationship. There are 2 foreign keys, one for the star's ID and one for the movie's ID, and the <code>(movieID, starID)</code> pairing of these foreign keys makes up the table's primary key.</p> 
  <p>Now for the <code>Movie</code> type:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Movie</span>(
    <span class="pl-v">id</span>: <span class="pl-en">Option</span>[<span class="pl-k">Long</span>],
    <span class="pl-v">title</span>: <span class="pl-k">String</span>)(<span class="pl-k">implicit</span> <span class="pl-v">includes</span>: <span class="pl-en">Includes</span>[<span class="pl-en">Movie</span>])
  <span class="pl-k">extends</span> <span class="pl-e">Entity</span>[<span class="pl-en">Movie</span>, <span class="pl-k">Long</span>]
{
  <span class="pl-k">val</span> <span class="pl-en">stars</span> <span class="pl-k">=</span> many(<span class="pl-en">Movie</span>.stars)
}

<span class="pl-k">object</span> <span class="pl-en">Movie</span> <span class="pl-k">extends</span> <span class="pl-e">EntityCompanion</span>[<span class="pl-en">Movies</span>, <span class="pl-en">Movie</span>, <span class="pl-k">Long</span>] {  
  <span class="pl-k">val</span> <span class="pl-en">stars</span> <span class="pl-k">=</span> toManyThrough[<span class="pl-en">Stars</span>, <span class="pl-en">MoviesStars</span>, <span class="pl-en">Star</span>]
}

<span class="pl-k">class</span> <span class="pl-en">Movies</span>(<span class="pl-v">tag</span>: <span class="pl-en">Tag</span>) <span class="pl-k">extends</span> <span class="pl-e">EntityTable</span>[<span class="pl-en">Movie</span>, <span class="pl-k">Long</span>](tag, <span class="pl-s"><span class="pl-pds">"</span>MOVIES<span class="pl-pds">"</span></span>) {
  <span class="pl-k">def</span> <span class="pl-en">id</span> <span class="pl-k">=</span> column[<span class="pl-k">Long</span>](<span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>, <span class="pl-en">O</span>.<span class="pl-en">PrimaryKey</span>, <span class="pl-en">O</span>.<span class="pl-en">AutoInc</span>)
  <span class="pl-k">def</span> <span class="pl-en">title</span> <span class="pl-k">=</span> column[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>)

  <span class="pl-k">def</span> <span class="pl-en">*</span> <span class="pl-k">=</span> (id.<span class="pl-k">?</span>, title) <span class="pl-k">&lt;&gt;</span> ((<span class="pl-en">Movie</span>.apply _).tupled, <span class="pl-en">Movie</span>.unapply)
}</pre>
  </div> 
  <p>It's very similar to the <code>Movie</code> type definition in the Direct relationships example. The <code>Director</code> relationship stuff (the foreign key and <code>director</code> fields on the case class and companion object) has been removed to keep it simple.</p> 
  <p>We've added a <code>stars</code> field to the case class body so we can navigate the relationship again:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">stars</span> <span class="pl-k">=</span> many(<span class="pl-en">Movie</span>.stars)</pre>
  </div> 
  <p>This works exactly the same for indirect 'to many' relationships as it does for direct 'to many' relationships.</p> 
  <p>The only real difference comes with the <code>stars</code> field on the companion object:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">stars</span> <span class="pl-k">=</span> toManyThrough[<span class="pl-en">Stars</span>, <span class="pl-en">MoviesStars</span>, <span class="pl-en">Star</span>]</pre>
  </div> 
  <p>Instead of calling <code>toMany</code> as we would do for a direct relationship, we call <code>toManyThrough</code>. <code>toManyThrough</code> takes 3 type parameters: the target table type (<code>Stars</code>), the join table type (<code>MoviesStars</code>) and the target type (<code>Star</code>).</p> 
  <p>Just as with direct relationships, <code>toManyThrough</code> may optionally be given a <code>toQuery</code> argument and a <code>joinCondition</code> argument. The above example is essentially equivalent to: </p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">stars</span> <span class="pl-k">=</span> toManyThrough[<span class="pl-en">Stars</span>, <span class="pl-en">MoviesStars</span>, <span class="pl-en">Star</span>](
  toQuery       <span class="pl-k">=</span> <span class="pl-en">TableQuery</span>[<span class="pl-en">MoviesStars</span>] join <span class="pl-en">TableQuery</span>[<span class="pl-en">Stars</span>] on(_.starID <span class="pl-k">===</span> _.id),
  joinCondition <span class="pl-k">=</span> (<span class="pl-v">m</span>: <span class="pl-en">Movies</span>, <span class="pl-v">t</span>: (<span class="pl-en">MovieStars</span>, <span class="pl-en">Stars</span>)) <span class="pl-k">=&gt;</span> m.id <span class="pl-k">===</span> t._1.movieID
)</pre>
  </div> 
  <p>With indirect relationships, the <code>toQuery</code> argument's type is a bit more complicated. Instead of a query that represents a set of target instances, the <code>toQuery</code> for an indirect relationship represents a set of <code>(JoinType, TargetType)</code> pairs, in this case <code>(MoviesStars, Stars)</code>. This is achieved by joining the join table onto the target table:</p> 
  <div class="highlight highlight-source-scala">
   <pre>toQuery <span class="pl-k">=</span> <span class="pl-en">TableQuery</span>[<span class="pl-en">MoviesStars</span>] join <span class="pl-en">TableQuery</span>[<span class="pl-en">Stars</span>] on(_.starID <span class="pl-k">===</span> _.id)</pre>
  </div> 
  <p>If you don't specify the <code>toQuery</code> argument explicitly, Entitytled will attempt to infer a default <code>toQuery</code> at compile time by examining the foreign keys that were defined on the join table and the target table. For Entitytled to be able to do this, there must be exactly 1 candidate foreign key (a foreign key from the join table to the target table, or from the target table to the join table). If there's more than one candidate foreign key or if no candidate foreign keys were defined, a compiler error is raised. You can always resolve these errors by providing the <code>toQuery</code> explicitly.</p> 
  <p>The <code>joinCondition</code> argument is also slightly more complicated for indirect relationships. Instead of simply joining the owner type to the target type as with direct relationships, it now has to join the owner type to this joined <code>(JoinType, TargetType)</code> pair:</p> 
  <div class="highlight highlight-source-scala">
   <pre>joinCondition <span class="pl-k">=</span> (<span class="pl-v">m</span>: <span class="pl-en">Movies</span>, <span class="pl-v">t</span>: (<span class="pl-en">MovieStars</span>, <span class="pl-en">Stars</span>)) <span class="pl-k">=&gt;</span> m.id <span class="pl-k">===</span> t._1.movieID</pre>
  </div> 
  <p>If you don't specify the <code>joinCondition</code> argument explicitly, Entitytled will attempt to infer a default <code>joinCondition</code> at compile time by examining the foreign keys that were defined on the owner table and the join table. For Entitytled to be able to do this, there must be exactly 1 candidate foreign key (a foreign key from the owner table to the join table, or from the join table to the owner table). Again, if there's more than one candidate foreign key or if no candidate foreign keys were defined, a compiler error is raised, which can always be resolved by providing the <code>joinCondition</code> explicitly.</p> 
  <p>To complete the example, here's the definition of the <code>Star</code> type:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Star</span>(
    <span class="pl-v">id</span>: <span class="pl-en">Option</span>[<span class="pl-k">Long</span>],
    <span class="pl-v">name</span>: <span class="pl-k">String</span>)(<span class="pl-k">implicit</span> <span class="pl-v">includes</span>: <span class="pl-en">Includes</span>[<span class="pl-en">Star</span>])
  <span class="pl-k">extends</span> <span class="pl-e">Entity</span>[<span class="pl-en">Star</span>, <span class="pl-k">Long</span>]
{
  <span class="pl-k">val</span> <span class="pl-en">movies</span> <span class="pl-k">=</span> many(<span class="pl-en">Star</span>.movies)
}

<span class="pl-k">object</span> <span class="pl-en">Star</span> <span class="pl-k">extends</span> <span class="pl-e">EntityCompanion</span>[<span class="pl-en">Stars</span>, <span class="pl-en">Star</span>, <span class="pl-k">Long</span>] {
  <span class="pl-k">val</span> <span class="pl-en">movies</span> <span class="pl-k">=</span> toManyThrough[<span class="pl-en">Movies</span>, <span class="pl-en">MoviesStars</span>, <span class="pl-en">Movie</span>]
}

<span class="pl-k">class</span> <span class="pl-en">Stars</span>(<span class="pl-v">tag</span>: <span class="pl-en">Tag</span>) <span class="pl-k">extends</span> <span class="pl-e">EntityTable</span>[<span class="pl-en">Star</span>, <span class="pl-k">Long</span>](tag, <span class="pl-s"><span class="pl-pds">"</span>STARS<span class="pl-pds">"</span></span>) {
  <span class="pl-k">def</span> <span class="pl-en">id</span> <span class="pl-k">=</span> column[<span class="pl-k">Long</span>](<span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>, <span class="pl-en">O</span>.<span class="pl-en">PrimaryKey</span>, <span class="pl-en">O</span>.<span class="pl-en">AutoInc</span>)
  <span class="pl-k">def</span> <span class="pl-en">name</span> <span class="pl-k">=</span> column[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>)

  <span class="pl-k">def</span> <span class="pl-en">*</span> <span class="pl-k">=</span> (id.<span class="pl-k">?</span>, name) <span class="pl-k">&lt;&gt;</span> ((<span class="pl-en">Star</span>.apply _).tupled, <span class="pl-en">Star</span>.unapply)
}</pre>
  </div> 
  <p>There's nothing new going on here, it just defines the inverse relationship to complete the full many-to-many relationship.</p> 
  <h2><a id="user-content-composing-relationships" class="anchor" href="https://github.com/rsschermer/entitytled#composing-relationships" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Composing relationships</h2> 
  <p>You may wish to define relationships that span across several tables. One option is to use an indirect relationship for this with a custom <code>toQuery</code>. If, for example, you want to define a relationship from stars to directors, via the movies they're both related to, you could add the following relationship definition to the <code>Star</code> companion object:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">object</span> <span class="pl-en">Star</span> <span class="pl-k">extends</span> <span class="pl-e">EntityCompanion</span>[<span class="pl-en">Stars</span>, <span class="pl-en">Star</span>, <span class="pl-k">Long</span>] {
  <span class="pl-k">val</span> <span class="pl-en">movies</span> <span class="pl-k">=</span> toManyThrough[<span class="pl-en">Movies</span>, <span class="pl-en">MoviesStars</span>, <span class="pl-en">Movie</span>]

  <span class="pl-c"><span class="pl-c">//</span> Relationship with director using an indirect relationship with a custom toQuery</span>
  <span class="pl-k">val</span> <span class="pl-en">directors</span> <span class="pl-k">=</span> toManyThrough[<span class="pl-en">Directors</span>, <span class="pl-en">MoviesStars</span>, <span class="pl-en">Director</span>](
    toQuery <span class="pl-k">=</span> <span class="pl-en">TableQuery</span>[<span class="pl-en">MoviesStars</span>].join(<span class="pl-en">TableQuery</span>[<span class="pl-en">Movies</span>]).on(_.movieID <span class="pl-k">===</span> _.id)
      .join(<span class="pl-en">TableQuery</span>[<span class="pl-en">Directors</span>]).on(_._2.directorID <span class="pl-k">===</span> _.id)
      .map(join <span class="pl-k">=&gt;</span> (join._1._1, join._2))
  )
}</pre>
  </div> 
  <p>We've joined together the <code>MoviesStars</code>, <code>Movies</code> and <code>Directors</code> tables using their foreign keys. This resulted in <code>((MoviesStars, Movies), Directors)</code> pairs which we then mapped back to <code>(MoviesStars, Directors)</code> pairs, which conforms to the required query type for this relationship's <code>toQuery</code>.</p> 
  <p>This works, but since we've already defined both a <code>movies</code> relationship on the <code>Star</code> companion object, and a <code>director</code> relationship on the <code>Movie</code> companion object, we can achieve the same result in a more convenient way: relationship composition. Instead of defining a complicated <code>toQuery</code> as we did earlier, we could do the following:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">object</span> <span class="pl-en">Star</span> <span class="pl-k">extends</span> <span class="pl-e">EntityCompanion</span>[<span class="pl-en">Stars</span>, <span class="pl-en">Star</span>, <span class="pl-k">Long</span>] {
  <span class="pl-k">val</span> <span class="pl-en">movies</span> <span class="pl-k">=</span> toManyThrough[<span class="pl-en">Movies</span>, <span class="pl-en">MoviesStars</span>, <span class="pl-en">Movie</span>]

  <span class="pl-c"><span class="pl-c">//</span> Composed relationship</span>
  <span class="pl-k">val</span> <span class="pl-en">directors</span> <span class="pl-k">=</span> movies compose <span class="pl-en">Movie</span>.director
}</pre>
  </div> 
  <p>We've composed the <code>movies</code> relationship with the <code>Movie.director</code> relationship. Composing a 'to many' relationship with a 'to one' relationship will result in a new 'to many' relationship. Composing two 'to many' relationships will also result in a new 'to many' relationship. Composing two 'to one' relationships will result in a new 'to one' relationship.</p> 
  <p>Composed relationships behave just like normal relationships. We can add a <code>directors</code> field on the <code>Star</code> case class for navigating this relationship:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Star</span>(
    <span class="pl-v">id</span>: <span class="pl-en">Option</span>[<span class="pl-k">Long</span>],
    <span class="pl-v">name</span>: <span class="pl-k">String</span>)(<span class="pl-k">implicit</span> <span class="pl-v">includes</span>: <span class="pl-en">Includes</span>[<span class="pl-en">Star</span>])
  <span class="pl-k">extends</span> <span class="pl-e">Entity</span>[<span class="pl-en">Star</span>, <span class="pl-k">Long</span>]
{
  <span class="pl-k">val</span> <span class="pl-en">movies</span> <span class="pl-k">=</span> many(<span class="pl-en">Star</span>.movies)
  <span class="pl-k">val</span> <span class="pl-en">directors</span> <span class="pl-k">=</span> many(<span class="pl-en">Star</span>.directors)
}</pre>
  </div> 
  <p>It's also possible to further compose composed relationships with other relationships (although at some point the queries for retrieving the composed relationship will become so monstrous, that you may want to consider creating a new join table to cache the relationship to improve performance).</p> 
  <h2><a id="user-content-querying-an-entity-set" class="anchor" href="https://github.com/rsschermer/entitytled#querying-an-entity-set" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Querying an entity set</h2> 
  <p>The entry point for an entity query is the companion object for that entity. Although you may also use Slick's <code>TableQuery</code> directly, the companion object adds some additional functionality for working with entities.</p> 
  <p>As of Slick 3.0, all interactions with the database happen via a database I/O actions (<code>DBIOAction</code>). A <code>DBIOAction</code> represents one or more operations that are to be executed on a database, such as a read query, inserting a new record,<br> or deleting a record. You then use a specific database definition to run such<br> an action, which will produce a future holding the action's result:</p> 
  <div class="highlight highlight-source-scala">
   <pre>db.run(someAction) <span class="pl-c"><span class="pl-c">//</span> Future holding the action's result</span></pre>
  </div> 
  <p>If you're not familiar with Slick, I recommend you take some time to read the following chapters from Slick's documentation before you proceed:</p> 
  <ul> 
   <li><a href="http://slick.typesafe.com/doc/3.0.0/database.html" target="_blank">Database configuration</a> to learn how to setup a database definition with which you can run actions.</li> 
   <li><a href="http://slick.typesafe.com/doc/3.0.0/dbio.html" target="_blank">Database I/O actions</a> to learn the basics about database I/O actions.</li> 
   <li><a href="http://slick.typesafe.com/doc/3.0.0/queries.html" target="_blank">Queries</a> to learn the basics about querying in Slick.</li> 
  </ul> 
  <h3><a id="user-content-building-read-actions" class="anchor" href="https://github.com/rsschermer/entitytled#building-read-actions" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Building read actions</h3> 
  <p>The companion object defines 2 methods which can be used to start building a read action:</p> 
  <ul> 
   <li><p><code>all</code> returns an intermediate query for all entities of this type:</p> 
    <div class="highlight highlight-source-scala">
     <pre><span class="pl-en">Movie</span>.all <span class="pl-c"><span class="pl-c">//</span> Intermediate query for all movies</span></pre>
    </div></li> 
   <li><p><code>one</code> takes an entity ID as its argument and returns an intermediate query for the specific entity with that ID:</p> 
    <div class="highlight highlight-source-scala">
     <pre><span class="pl-en">Movie</span>.one(<span class="pl-c1">193</span>) <span class="pl-c"><span class="pl-c">//</span> Intermediate query for the movie with ID 193</span></pre>
    </div></li> 
  </ul> 
  <p>Both produce intermediate query results which can be modified further. This works exactly the same as it does in Slick and you have access to all of Slick's result modifying operations (e.g. <code>filter</code>, <code>sortBy</code>, <code>map</code>, <code>take</code>, etc.). If, for example, you want to build a query for the top 10 movies with the highest rating, you could do this:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">topTenMoviesQuery</span> <span class="pl-k">=</span> <span class="pl-en">Movie</span>.all.sortBy(_.rating.asc).take(<span class="pl-c1">10</span>)</pre>
  </div> 
  <p>Just as in Slick, calling <code>result</code> on an query will build a database I/O action that can be run on the database:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">topTenMoviesAction</span> <span class="pl-k">=</span> topTenMoviesQuery.result
<span class="pl-k">val</span> <span class="pl-en">topTenMovies</span><span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">Seq</span>[<span class="pl-en">Movie</span>]] <span class="pl-k">=</span> db.run(topTenMoviesAction)</pre>
  </div> 
  <p>Entitytled adds one special result modifying operation: <code>include</code>. <code>include</code> can be used to eager-load relationships. Eager-loading is a way to solve the <code>n + 1</code> query problem:</p> 
  <div class="highlight highlight-source-scala">
   <pre>db.run(<span class="pl-en">Movie</span>.all.result).onSuccess { _.foreach { m <span class="pl-k">=&gt;</span> 
    println(s<span class="pl-s"><span class="pl-pds">"</span>${m.name} was directed by:<span class="pl-pds">"</span></span>)
    println(m.director.map(_.name).getOrElse(<span class="pl-s"><span class="pl-pds">"</span>Unknown<span class="pl-pds">"</span></span>))
  }
}</pre>
  </div> 
  <p>This snippet runs a database I/O action which will produce a future holding all movies. If this future runs successfully, it will print out each movie's name and the name of the director who directed it. If there are 1000 movies, this will execute 1001 queries: 1 to retrieve all movies and then one for each movie to retrieve its director. This is obviously not desirable. </p> 
  <p>The solution to this problem is to eager-load the directors with <code>include</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre>db.run(<span class="pl-en">Movie</span>.all.include(<span class="pl-en">Movie</span>.director).result).onSuccess { _.foreach { m <span class="pl-k">=&gt;</span>
    println(s<span class="pl-s"><span class="pl-pds">"</span>${m.name} was directed by:<span class="pl-pds">"</span></span>)
    println(m.director.map(_.name).getOrElse(<span class="pl-s"><span class="pl-pds">"</span>Unknown<span class="pl-pds">"</span></span>))
  }
}</pre>
  </div> 
  <p>This modified version using <code>include</code> will execute only 2 queries: one to retrieve all the movies and one to retrieve all the directors related to these movies.</p> 
  <p>You may eager-load multiple relationships:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">Movie</span>.all.include(<span class="pl-en">Movie</span>.director, <span class="pl-en">Movie</span>.stars)</pre>
  </div> 
  <p>Nested eager-loading is also possible:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">Director</span>.all.include(<span class="pl-en">Director</span>.movies.include(<span class="pl-en">Movie</span>.stars))</pre>
  </div> 
  <p>You can eager-load an arbitrary number of relationships and nest eager-loads to arbitrary depth. The current implementation will execute one additional query for every eager-loaded relationship (both for sibling eager-loads and nested eager-loads).</p> 
  <p><code>include</code> can be chained onto any query that produces an entity result:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">oldestTenMaleDirectorsWithMovies</span> <span class="pl-k">=</span> 
  <span class="pl-en">Director</span>.all
    .filter(_.male <span class="pl-k">===</span> <span class="pl-c1">true</span>)
    .sortBy(_.age.asc)
    .take(<span class="pl-c1">10</span>)
    .include(<span class="pl-en">Director</span>.movies)
    .result</pre>
  </div> 
  <p><code>include</code> cannot be chained onto queries that don't produce an entity result (e.g. <code>Director.all.size</code>, which will produce an integer result, not an entity result). </p> 
  <p>Actions that do eager-loading cannot be streamed.</p> 
  <h3><a id="user-content-creating-an-insert-action" class="anchor" href="https://github.com/rsschermer/entitytled#creating-an-insert-action" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Creating an insert action</h3> 
  <p>An insert action can be created by calling the <code>insert</code> method on the companion object, which takes the new entity as an argument:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">insertAction</span> <span class="pl-k">=</span> <span class="pl-en">Star</span>.insert(<span class="pl-en">Star</span>(<span class="pl-c1">None</span>, <span class="pl-s"><span class="pl-pds">"</span>Marlon Brando<span class="pl-pds">"</span></span>))</pre>
  </div> 
  <p>This action's result value will be the id of the newly inserted entity:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">id</span><span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-k">Long</span>] <span class="pl-k">=</span> db.run(insertAction)</pre>
  </div> 
  <h3><a id="user-content-creating-an-update-action" class="anchor" href="https://github.com/rsschermer/entitytled#creating-an-update-action" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Creating an update action</h3> 
  <p>An update action can be created by calling the <code>update</code> method on the companion object, which takes the updated entity as an argument:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">updateAction</span> <span class="pl-k">=</span> <span class="pl-en">Director</span>.update(martinScorsese.copy(age <span class="pl-k">=</span> <span class="pl-c1">72</span>))</pre>
  </div> 
  <p>Only entity instances with an ID (the ID is not <code>None</code>) can be updated, otherwise an exception will be thrown.</p> 
  <h3><a id="user-content-creating-a-delete-action" class="anchor" href="https://github.com/rsschermer/entitytled#creating-a-delete-action" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Creating a delete action</h3> 
  <p>A delete action can be created by calling the <code>delete</code> method on the companion object, which takes the ID of the entity to be deleted as an argument:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">deleteAction</span> <span class="pl-k">=</span> <span class="pl-en">Movie</span>.delete(<span class="pl-c1">38</span>)</pre>
  </div> 
  <h2><a id="user-content-navigating-relationship-values" class="anchor" href="https://github.com/rsschermer/entitytled#navigating-relationship-values" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Navigating relationship values</h2> 
  <p>'To one' relationships (both direct and indirect) can be used as values of type <code>Option[RelatedType]</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">director</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-en">Director</span>] <span class="pl-k">=</span> someMovie.director</pre>
  </div> 
  <p>'To many' relationships (both direct and indirect) can be used as values of type <code>Seq[RelatedType]</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">stars</span><span class="pl-k">:</span> <span class="pl-en">Seq</span>[<span class="pl-en">Star</span>] <span class="pl-k">=</span> someMovie.stars</pre>
  </div> 
  <p>This behaviour is achieved through implicit conversions. In reality, eager-loaded relationship values are wrapped in <code>OneFetched</code> or <code>ManyFetched</code> for 'to one' and 'to many' relationships respectively; relationships that have not yet been loaded are represented by <code>OneUnfetched</code> or <code>ManyUnfetched</code> for 'to one' and 'to many' relationships respectively. These wrappers are collectively referred to as 'relationship value representations'.</p> 
  <p>Both fetched and unfetched relationship value representations expose the <code>valueAction</code> method, which returns a database I/O action which, when run, will result in a future holding the relationship's value:</p> 
  <div class="highlight highlight-source-scala">
   <pre>db.run(someMovie.director.valueAction) <span class="pl-c"><span class="pl-c">//</span> Future[Option[Director]]</span></pre>
  </div> 
  <p>However, for relationship values that were prefetched with <code>include</code>, this won't actually run a database query, but will simply return the prefetched value without making an extra round trip to the database.</p> 
  <p>The aforementioned implicit conversion will run this <code>valueAction</code> for you and then wait for the resulting future to resolve. For this to work, your database definition must be available as an implicit value in the current context:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">MyProfile.driver.api.</span><span class="pl-v">Database</span>

<span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">db</span><span class="pl-k">:</span> <span class="pl-en">Database</span> <span class="pl-k">=</span> ...

<span class="pl-k">val</span> <span class="pl-en">movieDirector</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-en">Director</span>] <span class="pl-k">=</span> someMovie.director</pre>
  </div> 
  <p>The above example using the implicit conversion, is essentially equivalent to the following explicit example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">scala.concurrent.</span><span class="pl-v">Await</span>
<span class="pl-k">import</span> <span class="pl-v">MyProfile.driver.api.</span><span class="pl-v">Database</span>

<span class="pl-k">val</span> <span class="pl-en">db</span><span class="pl-k">:</span> <span class="pl-en">Database</span> <span class="pl-k">=</span> ...

<span class="pl-k">val</span> <span class="pl-en">movieDirector</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-en">Director</span>] <span class="pl-k">=</span> <span class="pl-en">Await</span>.result(db.run(someMovie.director.valueAction))</pre>
  </div> 
  <p>As in this explicit example, using the implicit conversion will block thread execution while it is waiting for the future result to resolve. When this is not desirable, it's best to run the <code>valueAction</code> explicitly and to handle the future result asynchronously:</p> 
  <div class="highlight highlight-source-scala">
   <pre>db.run(someMovie.director.valueAction).onSuccess { director <span class="pl-k">=&gt;</span>
  ...
}</pre>
  </div> 
  <p>Note however, that if you prefetched the relationship value with <code>include</code>, the <code>valueAction</code> will not actually result in a database round trip and the future will resolve immediately. In short: if you know upfront which relationship values you need, prefetch them with <code>include</code> and you can use the implicit conversions without worrying about blocking thread execution; if for some reason you can't prefetch the relationship values, consider running the <code>valueAction</code> explicitly and handling its future result asynchronously.</p> 
  <p>If you want to execute different code paths depending on whether or not the value was prefetched, you can pattern-match against the relationship value representation:</p> 
  <div class="highlight highlight-source-scala">
   <pre>someMovie.director <span class="pl-k">match</span> {
  <span class="pl-k">case</span> <span class="pl-en">OneFetched</span>(relationship, value, ownerID) <span class="pl-k">=&gt;</span>
    println(s<span class="pl-s"><span class="pl-pds">"</span>The director was eager-loaded: ${value.name}!<span class="pl-pds">"</span></span>)
  <span class="pl-k">case</span> _ <span class="pl-k">=&gt;</span>
    println(<span class="pl-s"><span class="pl-pds">"</span>The director hasn't been loaded yet...<span class="pl-pds">"</span></span>)
}</pre>
  </div> 
  <p>If you want to force the execution of a new query to retrieve a fresh value, regardless of whether it was already prefetched or not, first call <code>asUnfetched</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span> Will run a new database query, regardless of whether the director value was </span>
<span class="pl-c"><span class="pl-c">//</span> already prefetched</span>
<span class="pl-k">val</span> <span class="pl-en">movieDirector</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-en">Director</span>] <span class="pl-k">=</span> someMovie.director.asUnfetched</pre>
  </div> 
  <h2><a id="user-content-play-framework" class="anchor" href="https://github.com/rsschermer/entitytled#play-framework" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Play Framework</h2> 
  <p>Entitytled does not yet provide specific integration with Play Framework. However, using it together with <a href="https://github.com/playframework/play-slick" target="_blank">play-slick</a> is relatively straightforward. Add a play-slick dependency to your build for a matching version of Slick:</p> 
  <table>
   <thead> 
    <tr> 
     <th>Entitytled version</th> 
     <th>Slick version</th> 
    </tr> 
   </thead>
   <tbody> 
    <tr> 
     <td>&lt;= 0.5.x</td> 
     <td>2.1.x</td> 
    </tr> 
    <tr> 
     <td>&gt;= 0.6.0 &lt; 0.8.0</td> 
     <td>3.0.0</td> 
    </tr> 
    <tr> 
     <td>&gt;= 0.8.0</td> 
     <td>3.1.0</td> 
    </tr> 
   </tbody>
  </table> 
  <p>(The <a href="https://github.com/playframework/play-slick/blob/master/README.md#versioning" target="_blank">play-slick readme</a> provides a table matching versions of the plugin to versions of Slick and versions of Play.)</p> 
  <p>Then define a profile as follows:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">package</span> <span class="pl-en">models.meta</span>

<span class="pl-k">import</span> <span class="pl-v">entitytled.</span><span class="pl-v">Entitytled</span>
<span class="pl-k">import</span> <span class="pl-v">play.api.db.slick.</span><span class="pl-v">DatabaseConfigProvider</span>

<span class="pl-k">trait</span> <span class="pl-en">Profile</span> <span class="pl-k">extends</span> <span class="pl-e">Entitytled</span> {
  <span class="pl-k">val</span> <span class="pl-en">dbConfig</span> <span class="pl-k">=</span> <span class="pl-en">DatabaseConfigProvider</span>.get[<span class="pl-en">JdbcProfile</span>](<span class="pl-en">Play</span>.current)

  <span class="pl-k">val</span> <span class="pl-en">driver</span> <span class="pl-k">=</span> dbConfig.driver
}

<span class="pl-k">object</span> <span class="pl-en">Profile</span> <span class="pl-k">extends</span> <span class="pl-e">Profile</span></pre>
  </div> 
  <p>And use it like this:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">models.meta.Profile.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">models.meta.Profile.driver.api.</span><span class="pl-v">_</span></pre>
  </div> 
  <p>This will make Entitytled use the Slick driver you've configured in your Play config file.</p> 
  <h3><a id="user-content-activator-template" class="anchor" href="https://github.com/rsschermer/entitytled#activator-template" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Activator template</h3> 
  <p>The <a href="https://typesafe.com/activator/template/play-entitytled-simple" target="_blank">simple activator sample</a> gives an example of using Entitytled with Play Framework.</p> 
 </article>
</div>