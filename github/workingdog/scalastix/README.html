<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h2><a href="https://github.com/workingdog/scalastix#stix-21-protocol-in-scala" aria-hidden="true" class="anchor" id="user-content-stix-21-protocol-in-scala" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>STIX 2.1 protocol in Scala</h2> 
  <p><a href="https://oasis-open.github.io/cti-documentation/" target="_blank">[1]</a> "Structured Threat Information Expression [STIXâ„¢] is a language and serialization format used to exchange <a href="https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=cti" target="_blank">cyber threat intelligence (CTI)</a>. STIX enables organizations to share CTI with one another in a consistent and machine readable manner, allowing security communities to better understand what computer-based attacks they are most likely to see and to anticipate and/or respond to those attacks faster and more effectively. STIX is designed to improve many different capabilities, such as collaborative threat analysis, automated threat exchange, automated detection and response, and more."</p> 
  <p>This library <strong>ScalaStix</strong> is a <a href="https://www.scala-lang.org/" target="_blank">Scala</a> and <a href="https://www.scala-js.org/" target="_blank">Scala.js</a> library of classes and methods for STIX Domain Objects (SDO) and associated data types. It is an API for serializing and de-serializing STIX 2.1 JSON content. It includes all SDO, SRO, Observables, OpenVocab, Markings and supporting data types.</p> 
  <h4><a href="https://github.com/workingdog/scalastix#note" aria-hidden="true" class="anchor" id="user-content-note" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Note</h4> 
  <p>The older <strong>ScalaStix</strong> version 0.1 uses <a href="https://github.com/circe/circe" target="_blank">circe</a> for JSON serialization and de-serialization.</p> 
  <p><strong>ScalaStix</strong> versions &gt;= 0.2 use the <a href="https://github.com/playframework/play-json" target="_blank">Play JSON</a> library to provide the JSON serialization and de-serialization. See also the <a href="https://www.playframework.com/documentation/2.6.x/ScalaJson" target="_blank">Play Framwork documentation</a> for how to use Play JSON.</p> 
  <h3><a href="https://github.com/workingdog/scalastix#references" aria-hidden="true" class="anchor" id="user-content-references" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>References</h3> 
  <ol> 
   <li><a href="https://oasis-open.github.io/cti-documentation/" target="_blank">STIX 2.1 Specification</a></li> 
  </ol> 
  <h3><a href="https://github.com/workingdog/scalastix#dependencies" aria-hidden="true" class="anchor" id="user-content-dependencies" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Dependencies</h3> 
  <ol> 
   <li><a href="https://github.com/playframework/play-json" target="_blank">Play JSON</a> library providing the JSON serialization and de-serialization.</li> 
   <li><a href="https://github.com/cquiroz/scala-java-time" target="_blank">Scala Java-Time</a> provides an implementation of the java.time package.</li> 
  </ol> 
  <h3><a href="https://github.com/workingdog/scalastix#installation-and-packaging" aria-hidden="true" class="anchor" id="user-content-installation-and-packaging" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Installation and packaging</h3> 
  <p>To use the latest release add the following dependency to your build.sbt:</p> 
  <pre><code>libraryDependencies += "com.github.workingDog" %% "scalastix" % "0.5"
</code></pre> 
  <p>The best way to compile and package <strong>ScalaStix</strong> from source is to use <a href="http://www.scala-sbt.org/" target="_blank">SBT</a>. To compile and generate a jar file from source:</p> 
  <pre><code>sbt package
</code></pre> 
  <p>This will produce a jar file "scalastix_2.12-0.6-SNAPSHOT.jar" in the "./jvm/target/scala-2.12" directory for use in Scala applications, and "scalastix_sjs0.6_2.12-0.6-SNAPSHOT.jar" in the "./js/target/scala-2.12" directory for use in Scala.js applications.</p> 
  <p>To publish the libraries to your local (Ivy) repository, simply type:</p> 
  <pre><code>sbt publishLocal
</code></pre> 
  <p>Then put this in your Scala app build.sbt file</p> 
  <pre><code>libraryDependencies += "com.github.workingDog" %% "scalastix" % "0.6-SNAPSHOT" 
</code></pre> 
  <h3><a href="https://github.com/workingdog/scalastix#conventions" aria-hidden="true" class="anchor" id="user-content-conventions" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Conventions</h3> 
  <p>All Stix objects have their required parameters listed first, followed by the optionals.</p> 
  <p>All SDO and SRO constructors start with the "type" parameter of the class, if omitted, the type is auto-generated. The "id" parameter is second, if omitted a random id is auto-generated. This is followed by the "created" and "modified" parameters, if omitted a current timestamp is auto-generated for those.</p> 
  <p>Similarly for bundle, "type" and "spec_version" are set automatically, "id" can also be auto-generated if desired.</p> 
  <p>Custom properties can be added to any Scala SDO or Observable objects via the field name "custom".</p> 
  <h3><a href="https://github.com/workingdog/scalastix#usage" aria-hidden="true" class="anchor" id="user-content-usage" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h3> 
  <p>In a Scala application the creation of a Stix object can be done as follows:</p> 
  <pre><code>import StixImplicits._

// create an SDO, the type, id, created and modified are auto-generated
val attack = new AttackPattern(name = "Spear Phishing",
                  kill_chain_phases = List(KillChainPhase("Kill", "Bill")),
                  external_references = List(ExternalReference("a-source-name")),
                  object_marking_refs = List(Identifier(Campaign.`type`)),
                  custom = CustomProps(Map("x_test" -&gt; JsString("test1"))))
                  
// convert to json
val attackjson = Json.toJson(attack)
// add to a bundle
val bundle = Bundle(attack)
// convert to json
val bundlejson = Json.toJson(bundle)
</code></pre> 
  <p>Reading STIX-2 bundles:</p> 
  <pre><code> // read a STIX-2 bundle from a file
 val jsondoc = Source.fromFile("./stixfiles/test1.json").mkString
 // create a bundle object from it
 Json.fromJson[Bundle](Json.parse(jsondoc)).asOpt match {
   case Some(bundle) =&gt;
     // print all individual sdo
     bundle.objects.foreach(sdo =&gt; println("sdo: " + sdo))
     // get all attack pattern
     val allAttacks = bundle.objects.filter(_.`type` == AttackPattern.`type`)
     allAttacks.foreach(x =&gt; println("attack: " + x))
     // convert them to json and print
     allAttacks.foreach(x =&gt; println(Json.prettyPrint(Json.toJson(x))))

   case None =&gt; println("invalid JSON")
 }
</code></pre> 
  <h3><a href="https://github.com/workingdog/scalastix#status" aria-hidden="true" class="anchor" id="user-content-status" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Status</h3> 
  <p>Work in progress</p> 
  <p>Only very basic testing done.</p> 
 </article>
</div>