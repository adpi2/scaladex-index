<div class="announce instapaper_body markdown" data-path="README.markdown" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-mobile-notifications-api-client" class="anchor" href="https://github.com/guardian/mobile-notifications-api-client#mobile-notifications-api-client" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Mobile Notifications API Client</h1> 
  <p><a href="https://maven-badges.herokuapp.com/maven-central/com.gu/mobile-notifications-client_2.11" target="_blank"><img src="https://camo.githubusercontent.com/cbaabdc6467e1cb64a79cf836184cf2bb0f67db2/68747470733a2f2f696d672e736869656c64732e696f2f6d6176656e2d63656e7472616c2f762f636f6d2e67752f6d6f62696c652d6e6f74696669636174696f6e732d636c69656e745f322e31312e737667" alt="Maven Central" data-canonical-src="https://img.shields.io/maven-central/v/com.gu/mobile-notifications-client_2.11.svg" style="max-width:100%;"></a> <a href="https://github.com/guardian/mobile-notifications-api-client#status" target="_blank"><img src="https://camo.githubusercontent.com/8ed5ef79fffe4effb5533ff9c3fcb88f647c10c3/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f7374617475732d6163746976652d627269676874677265656e2e737667" alt="Project status" data-canonical-src="https://img.shields.io/badge/status-active-brightgreen.svg" style="max-width:100%;"></a></p> 
  <p>Scala client for the Guardian Mobile Notifications API.</p> 
  <h2><a id="user-content-integrating-with-your-application" class="anchor" href="https://github.com/guardian/mobile-notifications-api-client#integrating-with-your-application" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Integrating with your application</h2> 
  <p>Add to build.sbt: <code>libraryDependencies += "com.gu" % "mobile-notifications-client_2.11" % "0.5.11"</code></p> 
  <h2><a id="user-content-configure-api-client" class="anchor" href="https://github.com/guardian/mobile-notifications-api-client#configure-api-client" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Configure API Client</h2> 
  <h3><a id="user-content-implement-httpprovider-trait-methods" class="anchor" href="https://github.com/guardian/mobile-notifications-api-client#implement-httpprovider-trait-methods" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Implement <code>HttpProvider</code> trait methods.</h3> 
  <p>This provider will be used by API Client to make an actual calls from your service. Example trait implementation:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.gu.mobile.notifications.client.</span><span class="pl-v">HttpProvider</span>

<span class="pl-k">object</span> <span class="pl-en">NotificationHttpProvider</span> <span class="pl-k">extends</span> <span class="pl-e">HttpProvider</span> {

  <span class="pl-k">private</span> <span class="pl-k">def</span> <span class="pl-en">extract</span>(<span class="pl-v">response</span>: <span class="pl-en">Response</span>)<span class="pl-k">:</span> <span class="pl-en">HttpResponse</span> <span class="pl-k">=</span> {
    <span class="pl-k">if</span> (response.status <span class="pl-k">&gt;=</span> <span class="pl-c1">200</span> <span class="pl-k">&amp;&amp;</span> response.status <span class="pl-k">&lt;</span> <span class="pl-c1">300</span>)
      <span class="pl-en">HttpOk</span>(response.status, response.body)
    <span class="pl-k">else</span>
      <span class="pl-en">HttpError</span>(response.status.response.body)
  }

  <span class="pl-k">override</span> <span class="pl-k">def</span> <span class="pl-en">post</span>(<span class="pl-v">url</span>: <span class="pl-k">String</span>, <span class="pl-v">contentType</span>: <span class="pl-en">ContentType</span>, <span class="pl-v">body</span>: <span class="pl-en">Array</span>[<span class="pl-k">Byte</span>])<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">HttpResponse</span>] <span class="pl-k">=</span> {
    <span class="pl-en">WS</span>.url(url)
      .withHeaders(<span class="pl-s"><span class="pl-pds">"</span>Content-Type<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> s<span class="pl-s"><span class="pl-pds">"</span>${contentType.mediaType}; charset=${contentType.charset}<span class="pl-pds">"</span></span>)
      .post(body)
      .map(extract)
  }

  <span class="pl-k">override</span> <span class="pl-k">def</span> <span class="pl-en">get</span>(<span class="pl-v">url</span>: <span class="pl-k">String</span>)<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">HttpResponse</span>] <span class="pl-k">=</span> <span class="pl-en">WS</span>.url(url).get().map(extract)
}</pre>
  </div> 
  <p>Hint: <em>it is recommended to prefix name of this implementation with your application/service/artifact name to avoid name collisions</em>.</p> 
  <h3><a id="user-content-create-configured-notifications-api-client" class="anchor" href="https://github.com/guardian/mobile-notifications-api-client#create-configured-notifications-api-client" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Create configured Notifications API Client</h3> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.gu.mobile.notifications.client.</span><span class="pl-v">ApiClient</span>

<span class="pl-k">val</span> <span class="pl-en">httpProvider</span> <span class="pl-k">=</span> &lt;<span class="pl-ent">your</span> http provider instance&gt;
<span class="pl-k">val</span> <span class="pl-en">client</span> <span class="pl-k">=</span> <span class="pl-en">ApiClient</span>(
  host <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>http://notifications-host.com<span class="pl-pds">"</span></span>, 
  apiKey <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>API-KEY<span class="pl-pds">"</span></span>, 
  httpProvider <span class="pl-k">=</span> httpProvider, 
  legacyHost <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>http://old-notifications-host.com<span class="pl-pds">"</span></span>,
  legacyApiKey <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>OLD-API-KEY<span class="pl-pds">"</span></span>
)</pre>
  </div> 
  <h2><a id="user-content-using-client" class="anchor" href="https://github.com/guardian/mobile-notifications-api-client#using-client" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Using client</h2> 
  <h3><a id="user-content-sending-notification" class="anchor" href="https://github.com/guardian/mobile-notifications-api-client#sending-notification" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Sending notification</h3> 
  <p>You have to construct notification payload using one of the case classes from <code>com.gu.mobile.notifications.client.models.NotificationPayload</code> hierarchy and send that object through the wire using <code>ApiClient.send</code> method. </p> 
  <h4><a id="user-content-example-sending-breaking-news-alert" class="anchor" href="https://github.com/guardian/mobile-notifications-api-client#example-sending-breaking-news-alert" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Example: sending Breaking News alert</h4> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">payload</span> <span class="pl-k">=</span> <span class="pl-en">BreakingNewsPayload</span>(
  message <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>195 countries and nearly 150 world leaders including Barack Obama and Xi Jinping meet in Paris for COP21 UN climate change conference<span class="pl-pds">"</span></span>,
  sender <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>test sender<span class="pl-pds">"</span></span>,
  imageUrl <span class="pl-k">=</span> <span class="pl-c1">None</span>,
  thumbnailUrl <span class="pl-k">=</span> <span class="pl-c1">None</span>,
  link <span class="pl-k">=</span> <span class="pl-en">ExternalLink</span>(<span class="pl-s"><span class="pl-pds">"</span>http://mylink<span class="pl-pds">"</span></span>),
  importance <span class="pl-k">=</span> <span class="pl-en">Importance</span>.<span class="pl-en">Major</span>,
  topic <span class="pl-k">=</span> <span class="pl-en">Set</span>(<span class="pl-en">BreakingNewsUk</span>, <span class="pl-s"><span class="pl-pds">"</span>environment/climate-change<span class="pl-pds">"</span></span>))
)

client.send(payload)</pre>
  </div> 
  <h3><a id="user-content-error-handling" class="anchor" href="https://github.com/guardian/mobile-notifications-api-client#error-handling" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Error handling</h3> 
  <p>If you take a look at <code>ApiClient.send</code> method signature, you can spot its return type:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">send</span>(<span class="pl-v">notificationPayload</span>: <span class="pl-en">NotificationPayload</span>)<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">Either</span>[<span class="pl-en">ApiClientError</span>, <span class="pl-k">Unit</span>]]</pre>
  </div> 
  <p>If you're interesed in root error cause, you can pattern match on Either's <code>Left</code> side and errors from <code>com.gu.mobile.notifications.client.ApiClientError</code> hierarchy. For instance:</p> 
  <div class="highlight highlight-source-scala">
   <pre>client.send(...).map { <span class="pl-k">case</span> <span class="pl-en">Left</span>(<span class="pl-v">e</span>: <span class="pl-en">CompositeApiError</span>) <span class="pl-k">=&gt;</span> ... }</pre>
  </div> 
  <h2><a id="user-content-releasing-the-library" class="anchor" href="https://github.com/guardian/mobile-notifications-api-client#releasing-the-library" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Releasing the library</h2> 
  <p>Because of the incompatibility of the play-json module between version 2.3 and 2.4, a different branch has been created. Each change that has been merged into <code>master</code> MUST be merged into the <code>play-2.4</code> branch</p> 
  <p>Once this is done, make sure to run <code>sbt release</code> on both branches</p> 
 </article>
</div>