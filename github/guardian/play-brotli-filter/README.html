<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-brotli-filter-for-play" class="anchor" href="https://github.com/guardian/play-brotli-filter#brotli-filter-for-play" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Brotli filter for play</h1> 
  <p><a href="https://maven-badges.herokuapp.com/maven-central/com.gu/play-brotli-filter_2.11" target="_blank"><img src="https://camo.githubusercontent.com/a22bccdc358f6defc20d8f138491e1bf5d51df9c/68747470733a2f2f6d6176656e2d6261646765732e6865726f6b756170702e636f6d2f6d6176656e2d63656e7472616c2f636f6d2e67752f706c61792d62726f746c692d66696c7465725f322e31312f62616467652e737667" alt="Maven Central" data-canonical-src="https://maven-badges.herokuapp.com/maven-central/com.gu/play-brotli-filter_2.11/badge.svg" style="max-width:100%;"></a> <a href="https://travis-ci.org/guardian/play-brotli-filter" target="_blank"><img src="https://camo.githubusercontent.com/a9467739a3555369b245d6ace57764aef10c9fec/68747470733a2f2f7472617669732d63692e6f72672f677561726469616e2f706c61792d62726f746c692d66696c7465722e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/guardian/play-brotli-filter.svg?branch=master" style="max-width:100%;"></a> <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank"><img src="https://camo.githubusercontent.com/83afcd38107f8d6aad9b0e5270bb4295eaba0385/68747470733a2f2f696d672e736869656c64732e696f2f3a6c6963656e73652d417061636865253230322e302d626c75652e737667" alt="License" data-canonical-src="https://img.shields.io/:license-Apache%202.0-blue.svg" style="max-width:100%;"></a></p> 
  <p>A <a href="https://opensource.googleblog.com/2015/09/introducing-brotli-new-compression.html" target="_blank">Brotli</a> filter for the <a href="https://www.playframework.com/" target="_blank">playframework</a></p> 
  <h2><a id="user-content-install" class="anchor" href="https://github.com/guardian/play-brotli-filter#install" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Install</h2> 
  <p>Add <code>jbrotli</code> bintray as a resolver:</p> 
  <div class="highlight highlight-source-scala">
   <pre>resolvers <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>JBrotli Bintray Repository<span class="pl-pds">"</span></span> at <span class="pl-s"><span class="pl-pds">"</span>https://dl.bintray.com/nitram509/jbrotli/<span class="pl-pds">"</span></span></pre>
  </div> 
  <p>Add <code>play-brotli-filter</code> as a dependency:</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">++</span><span class="pl-k">=</span> <span class="pl-en">Seq</span>(
 <span class="pl-s"><span class="pl-pds">"</span>com.gu<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>play-brotli-filter<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.1<span class="pl-pds">"</span></span>,
 <span class="pl-s"><span class="pl-pds">"</span>org.meteogroup.jbrotli<span class="pl-pds">"</span></span> <span class="pl-k">%</span> brotliNativeArtefact <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.5.0<span class="pl-pds">"</span></span>,
)</pre>
  </div> 
  <p><code>brotliNativeArtefact</code> is dependent of your target platform and can not be resolved transparently as sbt does not support activating maven profile (as far as I am aware).</p> 
  <p>Below is a workaround that should allow to have the correct artefact name depending on your platform:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">brotliNativeArtefact</span> <span class="pl-k">=</span> {

  <span class="pl-k">val</span> <span class="pl-en">osName</span> <span class="pl-k">=</span> <span class="pl-en">System</span>.getProperty(<span class="pl-s"><span class="pl-pds">"</span>os.name<span class="pl-pds">"</span></span>).toLowerCase
  <span class="pl-k">val</span> <span class="pl-en">osArch</span> <span class="pl-k">=</span> <span class="pl-en">System</span>.getProperty(<span class="pl-s"><span class="pl-pds">"</span>os.arch<span class="pl-pds">"</span></span>).toLowerCase
  
  <span class="pl-k">val</span> <span class="pl-en">family</span> <span class="pl-k">=</span> <span class="pl-k">if</span> (osName.startsWith(<span class="pl-s"><span class="pl-pds">"</span>linux<span class="pl-pds">"</span></span>)) {
    <span class="pl-s"><span class="pl-pds">"</span>linux<span class="pl-pds">"</span></span>
    } <span class="pl-k">else</span> <span class="pl-k">if</span> (osName.startsWith(<span class="pl-s"><span class="pl-pds">"</span>mac os x<span class="pl-pds">"</span></span>) <span class="pl-k">||</span> osName.startsWith(<span class="pl-s"><span class="pl-pds">"</span>darwin<span class="pl-pds">"</span></span>)) {
      <span class="pl-s"><span class="pl-pds">"</span>darwin<span class="pl-pds">"</span></span>
    } <span class="pl-k">else</span> {
      <span class="pl-s"><span class="pl-pds">"</span>win32<span class="pl-pds">"</span></span>
  }

  <span class="pl-k">val</span> <span class="pl-en">arch</span> <span class="pl-k">=</span> <span class="pl-k">if</span> (family <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>darwin<span class="pl-pds">"</span></span>) {
      <span class="pl-s"><span class="pl-pds">"</span>x86-amd64<span class="pl-pds">"</span></span>
    } <span class="pl-k">else</span> <span class="pl-k">if</span> (osArch <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>i386<span class="pl-pds">"</span></span> <span class="pl-k">||</span> osArch <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>i486<span class="pl-pds">"</span></span> <span class="pl-k">||</span> osArch <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>i586<span class="pl-pds">"</span></span> <span class="pl-k">||</span> osArch <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>i686<span class="pl-pds">"</span></span>) {
      <span class="pl-s"><span class="pl-pds">"</span>x86<span class="pl-pds">"</span></span>
    } <span class="pl-k">else</span> <span class="pl-k">if</span> (osArch <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>amd64<span class="pl-pds">"</span></span> <span class="pl-k">||</span> osArch <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>x86-64<span class="pl-pds">"</span></span> <span class="pl-k">||</span> osArch <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>x64<span class="pl-pds">"</span></span>) {
      <span class="pl-s"><span class="pl-pds">"</span>x86-amd64<span class="pl-pds">"</span></span>
    } <span class="pl-k">else</span> <span class="pl-k">if</span> (family <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>linux<span class="pl-pds">"</span></span> <span class="pl-k">&amp;&amp;</span> osArch.startsWith(<span class="pl-s"><span class="pl-pds">"</span>arm<span class="pl-pds">"</span></span>)) {
      <span class="pl-s"><span class="pl-pds">"</span>arm32-vfp-hflt<span class="pl-pds">"</span></span>
  }

  s<span class="pl-s"><span class="pl-pds">"</span>jbrotli-native-$family-$arch<span class="pl-pds">"</span></span>
}</pre>
  </div> 
  <h2><a id="user-content-configure" class="anchor" href="https://github.com/guardian/play-brotli-filter#configure" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Configure</h2> 
  <p>Currently the only parameter you can configure is quality, which defaults to <code>5</code>.</p> 
  <pre><code>play.filters {

  # Brotli filter configuration
  brotli {

    # The compression-speed vs compression-density tradeoffs. The higher the quality, the slower the compression. Range is 0 to 11
    quality = 5

  }
}
</code></pre> 
 </article>
</div>