<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-spray-gun" class="anchor" href="https://github.com/ddelautre/spray-gun#spray-gun" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>spray-gun</h1> 
  <p>A wrapper around spray-can to build a simple HTTP server</p> 
  <h2><a id="user-content-installation" class="anchor" href="https://github.com/ddelautre/spray-gun#installation" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Installation</h2> 
  <p>Add this to your libraryDependencies: <code>"spray-gun" %% "spray-gun" % "1.1.0"</code></p> 
  <h2><a id="user-content-usage" class="anchor" href="https://github.com/ddelautre/spray-gun#usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h2> 
  <h3><a id="user-content-create-a-server" class="anchor" href="https://github.com/ddelautre/spray-gun#create-a-server" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Create a Server</h3> 
  <p>The first thing you need to do is create a server.</p> 
  <p>You have 3 possibilities:</p> 
  <h4><a id="user-content-1-simple-server" class="anchor" href="https://github.com/ddelautre/spray-gun#1-simple-server" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>1. Simple Server</h4> 
  <p>The simplest way to create a Server is with the <code>simpleServer</code> method on the <code>Server</code> object.</p> 
  <p>The <code>simpleServer</code> method has 4 parameters:<br> 1. <code>interface: String</code> is the interface on which the server will listen. For example <code>"localhost"</code> to listen only requests on localhost or <code>"0.0.0.0"</code> to listen on all the network interfaces<br> 2. <code>port: Int</code> is the port on which the server will listen. For example: <code>8080</code><br> 3. <code>contentType: spray.http.ContentType</code> is the content type of the response returned by this server. For example <code>text/plain(UTF-8)</code><br> 4. <code>content: String</code> is the body content returned by all the responses from this server </p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.ilunin.spray.gun.</span><span class="pl-v">Server</span>
<span class="pl-k">import</span> <span class="pl-v">spray.http.</span><span class="pl-v">ContentTypes</span>

<span class="pl-en">Server</span>.simpleServer(<span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-c1">8080</span>, <span class="pl-en">ContentTypes</span>.`application<span class="pl-k">/</span>json`, <span class="pl-s"><span class="pl-pds">"""</span>{"JSONCode": true}<span class="pl-pds">"""</span></span>)</pre>
  </div> 
  <p>This will create a Server that will listen on port 8080 on localhost and always return the JSON response <code>{"JSONCode": true}</code></p> 
  <p>This is really useful for tests where you need to create a server quickly that just need to always return the same response.</p> 
  <p><code>simpleServer</code> support default values for <code>interface</code>, <code>port</code> and <code>contentType</code> parameters.<br> The default value for <code>interface</code> is <code>0.0.0.0</code><br> The default value for <code>port</code> is <code>8080</code><br> The default value for <code>contentType</code> is <code>text/plain(UTF-8)</code> </p> 
  <p>So you can just specify the content for example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.ilunin.spray.gun.</span><span class="pl-v">Server</span>

<span class="pl-en">Server</span>.simpleServer(content <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>OK<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>This will create a server that listens on all interface on port 8080 and returns a <code>text/plain</code> response: <code>"OK"</code></p> 
  <h4><a id="user-content-2-sync-server" class="anchor" href="https://github.com/ddelautre/spray-gun#2-sync-server" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>2. Sync Server</h4> 
  <p>A more useful way to create a server is to create it with a function <code>HttpRequest =&gt; HttpResponse</code> with the <code>syncServer</code> method on the <code>Server</code> object.</p> 
  <p>The <code>syncServer</code> method has 3 parameters (in 2 parameters sets):<br> 1. <code>interface: String</code> is the interface on which the server will listen. For example <code>"localhost"</code> to listen only requests on localhost or <code>"0.0.0.0"</code> to listen on all the network interfaces<br> 2. <code>port: Int</code> is the port on which the server will listen. For example: <code>8080</code><br> 3. <code>handler: PartialFunction[spray.http.HttpRequest, spray.http.HttpResponse]</code> is the function that need to handle the HTTP request and return the HTTP response.</p> 
  <p>Example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.ilunin.spray.gun.</span><span class="pl-v">Server</span>
<span class="pl-k">import</span> <span class="pl-v">spray.http.</span>{<span class="pl-v">ContentTypes</span>, <span class="pl-v">HttpRequest</span>, <span class="pl-v">HttpResponse</span>, <span class="pl-v">StatusCodes</span>, <span class="pl-v">HttpProtocols</span>}

<span class="pl-en">Server</span>.syncServer(<span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-c1">8080</span>) {
  <span class="pl-k">case</span> <span class="pl-v">request</span>: <span class="pl-en">HttpRequest</span> <span class="pl-k">=&gt;</span> <span class="pl-en">HttpResponse</span>(<span class="pl-en">StatusCodes</span>.<span class="pl-en">OK</span>, request.entity, <span class="pl-en">List</span>.empty, <span class="pl-en">HttpProtocols</span>.`<span class="pl-en">HTTP</span><span class="pl-k">/</span><span class="pl-c1">1.1</span>`)
}</pre>
  </div> 
  <p>This will create a server that will listen on port 8080 on localhost and return a <code>200 OK</code> response with the same body as the request and no specific headers.</p> 
  <p><code>syncServer</code> takes a <code>PartialFunction</code> as a parameter. If this function is not defined for a <code>HttpRequest</code> it will return a <code>404 Not Found</code> response.</p> 
  <p>For example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.ilunin.spray.gun.</span><span class="pl-v">Server</span>
<span class="pl-k">import</span> <span class="pl-v">spray.http.</span>{<span class="pl-v">HttpRequest</span>, <span class="pl-v">HttpResponse</span>, <span class="pl-v">StatusCodes</span>, <span class="pl-v">Uri</span>}

<span class="pl-en">Server</span>.syncServer(<span class="pl-s"><span class="pl-pds">"</span>0.0.0.0<span class="pl-pds">"</span></span>, <span class="pl-c1">8080</span>) {
  <span class="pl-k">case</span> <span class="pl-en">HttpRequest</span>(_, <span class="pl-en">Uri</span>.<span class="pl-en">Path</span>(<span class="pl-s"><span class="pl-pds">"</span>/test<span class="pl-pds">"</span></span>), _, _, _) <span class="pl-k">=&gt;</span> <span class="pl-en">HttpResponse</span>(<span class="pl-en">StatusCodes</span>.<span class="pl-en">OK</span>)
}</pre>
  </div> 
  <p>This will return a <code>200 OK</code> response for the path <code>/test</code> but will return a <code>404 Not Found</code> for every other path.</p> 
  <p><code>syncServer</code> support default values for <code>interface</code> and <code>port</code> parameters.<br> The default value for <code>interface</code> is <code>0.0.0.0</code><br> The default value for <code>port</code> is <code>8080</code> </p> 
  <p>So you can write the same example as above simply as:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.ilunin.spray.gun.</span><span class="pl-v">Server</span>
<span class="pl-k">import</span> <span class="pl-v">spray.http.</span>{<span class="pl-v">HttpRequest</span>, <span class="pl-v">HttpResponse</span>, <span class="pl-v">StatusCodes</span>, <span class="pl-v">Uri</span>}

<span class="pl-en">Server</span>.syncServer() {
  <span class="pl-k">case</span> <span class="pl-en">HttpRequest</span>(_, <span class="pl-en">Uri</span>.<span class="pl-en">Path</span>(<span class="pl-s"><span class="pl-pds">"</span>/test<span class="pl-pds">"</span></span>), _, _, _) <span class="pl-k">=&gt;</span> <span class="pl-en">HttpResponse</span>(<span class="pl-en">StatusCodes</span>.<span class="pl-en">OK</span>)
}</pre>
  </div> 
  <h4><a id="user-content-3-async-server" class="anchor" href="https://github.com/ddelautre/spray-gun#3-async-server" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>3. Async Server</h4> 
  <p>The <code>asyncServer</code> method on the <code>Server</code> object behaves like the <code>syncServer</code> method, except that instead of taking a <code>PartialFunction[spray.http.HttpRequest, spray.http.HttpResponse]</code> it takes a <code>PartialFunction[spray.http.HttpRequest, Future[spray.http.HttpResponse]]</code></p> 
  <p>This method is used when you need to use asynchronous functions to compute the response (like for example if you need to call another web service to generate your response)</p> 
  <p>Example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.ilunin.spray.gun.</span><span class="pl-v">Server</span>
<span class="pl-k">import</span> <span class="pl-v">spray.http.</span>{<span class="pl-v">HttpRequest</span>, <span class="pl-v">HttpResponse</span>, <span class="pl-v">StatusCode</span>, <span class="pl-v">Uri</span>}
<span class="pl-k">import</span> <span class="pl-v">scala.concurrent.</span><span class="pl-v">Future</span>

<span class="pl-en">Server</span>.syncServer() {
  <span class="pl-k">case</span> <span class="pl-en">HttpRequest</span>(_, <span class="pl-en">Uri</span>.<span class="pl-en">Path</span>(<span class="pl-s"><span class="pl-pds">"</span>/test<span class="pl-pds">"</span></span>), _, _, _) <span class="pl-k">=&gt;</span> {
    <span class="pl-k">val</span> <span class="pl-en">statusCode</span><span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">StatusCode</span>] <span class="pl-k">=</span> <span class="pl-k">???</span> <span class="pl-c">// code that get the status code of another web service for example</span>
    statusCode.map(<span class="pl-en">HttpResponse</span>(_))
  }
}</pre>
  </div> 
  <h3><a id="user-content-running-the-server" class="anchor" href="https://github.com/ddelautre/spray-gun#running-the-server" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Running the server</h3> 
  <p>For starting the server, simply call the <code>start()</code> method on the <code>Server</code> instance that you have created.</p> 
  <p>For stopping the server, simply call the <code>stop()</code> method on the <code>Server</code> instance that you have created.</p> 
  <p>Example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.ilunin.spray.gun.</span><span class="pl-v">Server</span>
<span class="pl-k">import</span> <span class="pl-v">spray.http.</span><span class="pl-v">ContentTypes</span>

<span class="pl-k">val</span> <span class="pl-en">server</span> <span class="pl-k">=</span> <span class="pl-en">Server</span>.simpleServer(<span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-c1">8080</span>, <span class="pl-en">ContentTypes</span>.`application<span class="pl-k">/</span>json`, <span class="pl-s"><span class="pl-pds">"""</span>{"JSONCode": true}<span class="pl-pds">"""</span></span>)
server.start()

<span class="pl-c">// Some code...</span>

server.stop()</pre>
  </div> 
  <p>You can also use the <code>executeWhileRunning</code> method on the <code>Server</code> object that takes an instance of <code>Server</code> and a block of code. The server is automatically started at the start of the block of code and stopped at its end.</p> 
  <p>Example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.ilunin.spray.gun.</span><span class="pl-v">Server</span>
<span class="pl-k">import</span> <span class="pl-v">spray.http.</span><span class="pl-v">ContentTypes</span>

<span class="pl-k">val</span> <span class="pl-en">server</span> <span class="pl-k">=</span> <span class="pl-en">Server</span>.simpleServer(<span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-c1">8080</span>, <span class="pl-en">ContentTypes</span>.`application<span class="pl-k">/</span>json`, <span class="pl-s"><span class="pl-pds">"""</span>{"JSONCode": true}<span class="pl-pds">"""</span></span>)
<span class="pl-k">val</span> <span class="pl-en">result</span><span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> <span class="pl-en">Server</span>.executeWhileRunning(server) {
 <span class="pl-k">val</span> <span class="pl-en">json</span><span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> <span class="pl-k">???</span> <span class="pl-c">// Some code that do a reqest on http://localhost:8080 and get the body</span>
 json
}</pre>
  </div> 
 </article>
</div>