<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a href="https://github.com/tek/xpct#xpct" aria-hidden="true" class="anchor" id="user-content-xpct" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>xpct</h1> 
  <p>This package provides an algebra for the abstraction of simultaneous assertion of conditions and extraction of a value from heterogeneous effects, all contained in a computation effect.</p> 
  <p>In more concrete terms, you can sequence <code>IO</code>s in a for-comprehension, adding a spec expectation to each step, while extracting values contained in <code>Option</code>s or <code>Either</code>s through typeclass based matchers:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">for</span> {
  a <span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-en">IO</span>.pure(<span class="pl-en">Either</span>.right(<span class="pl-s"><span class="pl-pds">"</span>test<span class="pl-pds">"</span></span>)) must contain(<span class="pl-s"><span class="pl-pds">"</span>test<span class="pl-pds">"</span></span>)
  b <span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-en">IO</span>.pure(<span class="pl-en">Option</span>(<span class="pl-c1">5</span>)) must beSome(be_<span class="pl-k">&gt;=</span>(<span class="pl-c1">2</span>))
  _ <span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-en">IO</span>.pure(s<span class="pl-s"><span class="pl-pds">"</span>$a $b<span class="pl-pds">"</span></span>) must_<span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>test 5<span class="pl-pds">"</span></span>
} <span class="pl-k">yield</span> ()
</pre>
  </div> 
  <h1><a href="https://github.com/tek/xpct#module-ids" aria-hidden="true" class="anchor" id="user-content-module-ids" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Module IDs</h1> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">++</span><span class="pl-k">=</span> <span class="pl-en">List</span>(
  <span class="pl-s"><span class="pl-pds">"</span>io.tryp<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>xpct-specs2<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.1.2<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>io.tryp<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>xpct-fs2<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.1.2<span class="pl-pds">"</span></span>
)</pre>
  </div> 
  <h1><a href="https://github.com/tek/xpct#features" aria-hidden="true" class="anchor" id="user-content-features" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Features</h1> 
  <ul> 
   <li><a href="https://github.com/tek/xpct#matching-and-extracting" target="_blank">typeclass based matchers</a></li> 
   <li><a href="https://github.com/tek/xpct#matching-and-extracting" target="_blank">monadic extraction of tested values</a></li> 
   <li><a href="https://github.com/tek/xpct#matching-and-extracting" target="_blank">arbitrary matcher nesting</a></li> 
   <li><a href="https://github.com/tek/xpct#io-and-retrying" target="_blank">parameterized IO for the main effect</a></li> 
   <li><a href="https://github.com/tek/xpct#io-and-retrying" target="_blank">transparent sleep/retry mechanism</a></li> 
   <li><a href="https://github.com/tek/xpct#spec-frameworks" target="_blank">integration with spec frameworks</a></li> 
   <li><a href="https://github.com/typelevel/cats" target="_blank">cats</a> based</li> 
  </ul> 
  <h1><a href="https://github.com/tek/xpct#matching-and-extracting" aria-hidden="true" class="anchor" id="user-content-matching-and-extracting" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Matching and extracting</h1> 
  <p>Matches are based on the typeclass <code>Match</code>, where <code>G[_]</code> is an arbitrary data type that represents a specific condition, like <code>IsSome[Int](5)</code> (here <code>B</code> is <code>Int</code>):</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">trait</span> <span class="pl-en">Match</span>[<span class="pl-en">A</span>, <span class="pl-en">G</span>[_], <span class="pl-en">B</span>, <span class="pl-en">C</span>]
{
  <span class="pl-k">def</span> <span class="pl-en">apply</span>(<span class="pl-v">a</span>: <span class="pl-en">A</span>, <span class="pl-v">fb</span>: <span class="pl-en">G</span>[<span class="pl-en">B</span>])<span class="pl-k">:</span> <span class="pl-en">Either</span>[<span class="pl-k">String</span>, <span class="pl-en">C</span>]
}</pre>
  </div> 
  <p><code>A</code> is the expectable value; matches can be performed on differing types, producing a third type <code>C</code> that is extracted monadically. When a <code>G[B]</code> value is passed to the implicit <code>must</code> method on the expectable, an <code>Xpct</code> instance is produced, which uses the <code>C</code> value returned from <code>Match.apply</code> for monadic composition, allowing to use the expectation in a for-comprehension regardless of the type of <code>A</code>.</p> 
  <p>Nesting matchers is a mechanism that is implemented in an ad-hoc way in common spec frameworks. With <strong>xpct</strong>, a separate instance of <code>Match</code> can be defined that has another matcher type as its <code>B</code>, allowing arbitrary nesting.</p> 
  <h1><a href="https://github.com/tek/xpct#io-and-retrying" aria-hidden="true" class="anchor" id="user-content-io-and-retrying" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>IO and retrying</h1> 
  <p>When testing asynchronous programs, especially UIs, it is not unusual to wait for a condition to become fulfilled. In frameworks like <strong>specs2</strong> and <strong>scalatest</strong>, this feature is implemented as a special case with severe limitations on composability. <strong>xpct</strong> treats retrying as a first class operation, allowing to retry a sequence of expectations with the same semantics as strict operations:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">for</span> {
  text <span class="pl-k">&lt;</span><span class="pl-k">-</span> {
    <span class="pl-k">for</span> {
      elem <span class="pl-k">&lt;</span><span class="pl-k">-</span> getUiElement(<span class="pl-c1">5</span>) must beASome[<span class="pl-en">Text</span>]
      text <span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-en">IO</span>.pure(elem) must containText(<span class="pl-s"><span class="pl-pds">"</span>Cancel<span class="pl-pds">"</span></span>)
    } <span class="pl-k">yield</span> text
  }.retryEvery(<span class="pl-c1">10</span>, <span class="pl-c1">100.</span>milliseconds)
  _ <span class="pl-k">&lt;</span><span class="pl-k">-</span> setUiElementText(<span class="pl-c1">6</span>, text) must beRight
} <span class="pl-k">yield</span> ()</pre>
  </div> 
  <p>Aside from <code>cats.effect.IO</code>, arbitrary async effects can be used, as long as they implement the typeclass <code>EvalXpct</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">trait</span> <span class="pl-en">EvalXpct</span>[<span class="pl-en">F</span>[_]]
{
  <span class="pl-k">def</span> <span class="pl-en">sync</span>[<span class="pl-en">A</span>](<span class="pl-v">fa</span>: <span class="pl-en">F</span>[<span class="pl-en">A</span>])<span class="pl-k">:</span> <span class="pl-en">A</span>
}</pre>
  </div> 
  <p>For the retry operation, an additional typeclass instance is required:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">trait</span> <span class="pl-en">Sleep</span>[<span class="pl-en">F</span>[_]]
{
  <span class="pl-k">def</span> <span class="pl-en">sleep</span>(<span class="pl-v">d</span>: <span class="pl-en">FiniteDuration</span>)<span class="pl-k">:</span> <span class="pl-en">F</span>[<span class="pl-k">Unit</span>]
}</pre>
  </div> 
  <h1><a href="https://github.com/tek/xpct#spec-frameworks" aria-hidden="true" class="anchor" id="user-content-spec-frameworks" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Spec frameworks</h1> 
  <h2><a href="https://github.com/tek/xpct#specs2" aria-hidden="true" class="anchor" id="user-content-specs2" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>specs2</h2> 
  <p>For <a href="https://github.com/etorreborre/specs2" target="_blank">specs2</a> integration, the <code>xpct-specs2</code> package contains an instance of <code>AsResult[Xpct]</code>, which is sufficient for automatic conversion of <code>Xpct</code> values to specs2 <code>Fragment</code>s.</p> 
  <p>A convenience trait <code>XpctSpec</code> is provided, which includes the implicit conversion to the extension class with <code>must</code> methods.</p> 
  <h2><a href="https://github.com/tek/xpct#scalatest" aria-hidden="true" class="anchor" id="user-content-scalatest" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>scalatest</h2> 
  <p>For <a href="https://github.com/scalatest/scalatest" target="_blank">scalatest</a> integration, the <code>xpct-scalatest</code> package contains the trait <code>XpctSpec</code>, providing a helper function <code>xpct</code> that converts an <code>Xpct</code> to a <code>TestFailedException</code>.</p> 
  <h2><a href="https://github.com/tek/xpct#utest" aria-hidden="true" class="anchor" id="user-content-utest" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>utest</h2> 
  <p>For <a href="https://github.com/lihaoyi/utest" target="_blank">utest</a> integration, the <code>xpct-utest</code> package contains the trait <code>XpctSpec</code>, providing a helper function <code>xpct</code> that converts an <code>Xpct</code> to an exception.</p> 
 </article>
</div>