<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-rprng" class="anchor" href="https://github.com/jejking/rprng#rprng" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>rprng</h1> 
  <p><a href="https://travis-ci.org/jejking/rprng" target="_blank"><img src="https://camo.githubusercontent.com/fddfa6338210515a585ccff7af50cf0893ecd038/68747470733a2f2f7472617669732d63692e6f72672f6a656a6b696e672f7270726e672e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/jejking/rprng.svg?branch=master" style="max-width:100%;"></a></p> 
  <p><em>A reactive pseudo-RNG web service built on commons math and akka</em></p> 
  <h2><a id="user-content-run-the-server" class="anchor" href="https://github.com/jejking/rprng#run-the-server" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Run the server</h2> 
  <p>You can start the web application interactively <code>sbt</code> or an IDE. For now we assume that the server is running on <code>localhost</code> on port 8080.</p> 
  <p><code>sbt assembly</code> will produce a fat JAR that can be run directly from the command line using <code>java</code>.</p> 
  <h3><a id="user-content-getting-bytes" class="anchor" href="https://github.com/jejking/rprng#getting-bytes" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Getting bytes</h3> 
  <p>You can obtain bytes in two different styles:</p> 
  <ul> 
   <li>fixed size blocks 
    <ul> 
     <li><code>http://localhost:8080/byte/block</code> will deliver 1024 bytes of pseudo-randomness</li> 
     <li><code>http://localhost:8080/byte/block/${blockSize}</code> will deliver <code>${blockSize</code> bytes of pseudo-randomness. The path variable must be a positive integer greater than zero.</li> 
    </ul></li> 
   <li>stream 
    <ul> 
     <li><code>http:localhost:8080/byte/stream</code> will deliver a continuous stream of randomness in chunks of 1024 bytes until the connection is closed</li> 
    </ul></li> 
  </ul> 
  <p>In both cases, the content type is <code>application/octet-stream</code>. </p> 
  <h3><a id="user-content-getting-integers" class="anchor" href="https://github.com/jejking/rprng#getting-integers" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Getting integers</h3> 
  <p>You can also obtain collections of integers grouped in either lists or sets.</p> 
  <ul> 
   <li><code>http://localhost:8080/int/list</code></li> 
   <li><code>http://localhost:8080/int/set</code></li> 
  </ul> 
  <p>In both cases, the following query parameters may be specified:</p> 
  <ul> 
   <li><code>size</code>. The size of the collection to return. Must be a positive integer greater than zero. Defaults to 100.</li> 
   <li><code>count</code>. The number of collections of the specified size to return. Must be a positive integer greater than zero. Defaults to 1.</li> 
   <li><code>min</code>. The lowest bound (inclusive) of members of the collection(s) to return. Defaults to Java's <code>Integer.MIN_VALUE</code>. Must be an integer (in the Java sense).</li> 
   <li><code>max</code>. The top bound (inclusive) of members of the collection(s) to return. Defaults to Java's <code>Integer.MAX_VALUE</code>. Must be an integer (in the Java sense). It must also (obviously) be greater than <code>min</code> and, if as a set is being requested, the span between <code>min</code> and <code>max</code> must be greater than <code>size</code>. (Set shuffling is not implemented yet).</li> 
  </ul> 
  <p>A JSON object is returned and the collections are mapped as JSON arrays under the key <code>content</code>. </p> 
  <h2><a id="user-content-design-overview" class="anchor" href="https://github.com/jejking/rprng#design-overview" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Design Overview</h2> 
  <p>The program is built up in a relatively simple fashion, the main idea being to provide a modular design, to make it difficult to observer the service and draw conclusions about the PRNGs in use and to provide a service that draws on reactive principles to provide a robust, non-blocking service.</p> 
  <ul> 
   <li><code>RandomSource</code>, a trait defining some simple methods to obtain a random array of bytes, integers, longs and to reseed some underlying PRNG. It is assumed that implementations will use a deterministic PRNG.</li> 
   <li><code>SecureSeeder</code>, a trait defining a method to obtain a random long. The idea is that the seeding results from high-quality entropy to make it hard to predict how any subsequent output from a PRNG.</li> 
   <li><code>SecureRandomSeeder</code>, an implementation of <code>SecureSeeder</code> that uses Java's <code>SecureRandom.generateSeed()</code> method which will (normally) delegate to a good quality source of randomness such as <code>/dev/random</code>.</li> 
   <li><code>RandomGenerator</code> from Apache Commons Math. The web application uses the <a href="http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math3/random/ISAACRandom.html" target="_blank">IsaacRandom</a> PRNG.</li> 
   <li><code>RandomGeneratorSource</code>, an implementation of <code>RandomSource</code> that wraps a <code>RandomGenerator</code> </li> 
   <li><code>RandomSourceActor</code>, an actor that wraps a <code>RandomGeneratorSource</code> and ensures a number of things: 
    <ul> 
     <li>before starting, obtains and sets seed</li> 
     <li>schedules reseeding at a random interval between a configurable min and max duration which default to 1 hour and 8 hours respectively. As obtaining high quality entropy is blocking, obtaining seed is executed in another thread and the result sent, on completion, back to the actor</li> 
     <li>handles incoming messages, as an actor does: 
      <ul> 
       <li>request for given number of bytes</li> 
       <li>request for integer in a given range</li> 
       <li>new seed, in which case the underlying <code>RandomSource</code> is reseeded and a new reseeding is randomly scheduled</li> 
       <li>instruction to obtain new seed (sent by scheduler)</li> 
      </ul></li> 
    </ul></li> 
   <li>random router over a configurable number of <code>RandomSourceActor</code> instances. This router is addressed when handling incoming requests.</li> 
   <li><code>RandomIntActorPublisher</code> - a reactive streams <code>Publisher</code> that is created to handle requests for collections of integers and exposes a stream of integers (of appropriately constrained range) obtained from the random router that delegates to the underlying <code>RandomSourceActor</code> instances</li> 
   <li><code>RandomByteStringActorPublisher</code> - which does the same for requests for bytes. </li> 
  </ul> 
  <p>Collections of integers are assembled using Akka Streams. A custom <code>PushPullStage</code> allows a stream of integers to be mapped to a stream of set of integers. Requests for lists are simply processed by obtaining a list and grouping it appropriately.</p> 
  <p>JSON mapping is carried out simply with Spray JSON.</p> 
  <h2><a id="user-content-configuration" class="anchor" href="https://github.com/jejking/rprng#configuration" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Configuration</h2> 
  <p>Akka has not been specifically configured for the system except for some basic logging settings.</p> 
  <p>An Typesafe Config <code>application.conf</code> file has been supplied with some options for the port for the web listener, the number of <code>RandomSourceActor</code> instances to be created and the min and max times between actor reseeding.</p> 
  <p>The following optional environment variables can be set:</p> 
  <ul> 
   <li><code>RPRNG_HTTP_PORT</code>, the http port</li> 
   <li><code>RPRNG_ACTOR_COUNT</code>, the number of <code>RandomSourceActor</code> instances to create</li> 
   <li><code>RPRNG_RESEED_MIN</code>, the minimum duration to a reseeding, must be a Typesafe config duration.</li> 
   <li><code>RPRNG_RESEED_MAX</code>, the maximum duration to a reseeding, must be a Typesafe config duration, and, longer than the minimum duration</li> 
  </ul> 
  <h2><a id="user-content-load-testing" class="anchor" href="https://github.com/jejking/rprng#load-testing" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Load Testing</h2> 
  <p>A Gatling scenario is provided in the <code>gatling</code> directory which can be tweaked as needed.</p> 
 </article>
</div>