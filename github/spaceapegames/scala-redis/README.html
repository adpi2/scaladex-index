<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a href="https://github.com/spaceapegames/scala-redis#redis-scala-client" aria-hidden="true" class="anchor" id="user-content-redis-scala-client" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Redis Scala client</h1> 
  <h2><a href="https://github.com/spaceapegames/scala-redis#key-features-of-the-library" aria-hidden="true" class="anchor" id="user-content-key-features-of-the-library" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Key features of the library</h2> 
  <ul> 
   <li>Native Scala types Set and List responses.</li> 
   <li>Transparent serialization</li> 
   <li>Connection pooling</li> 
   <li>Consistent Hashing on the client.</li> 
   <li>Support for basic Redis sharding. <a href="http://redis.io/topics/partitioning" target="_blank">http://redis.io/topics/partitioning</a></li> 
   <li>Support for Redis Sentinel</li> 
  </ul> 
  <h2><a href="https://github.com/spaceapegames/scala-redis#information-about-redis" aria-hidden="true" class="anchor" id="user-content-information-about-redis" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Information about redis</h2> 
  <p>Redis is a key-value database. It is similar to memcached but the dataset is not volatile, and values can be strings, exactly like in memcached, but also lists and sets with atomic operations to push/pop elements.</p> 
  <p><a href="http://redis.io" target="_blank">http://redis.io</a></p> 
  <h2><a href="https://github.com/spaceapegames/scala-redis#requirements" aria-hidden="true" class="anchor" id="user-content-requirements" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Requirements</h2> 
  <ul> 
   <li> <p>maven</p> <pre><code>  &lt;dependency&gt;
  	&lt;groupId&gt;org.redis&lt;/groupId&gt;
  	&lt;artifactId&gt;scala-redis_${scala.version}&lt;/artifactId&gt;
  	&lt;version&gt;${scalaredis.version}&lt;/version&gt;
  &lt;/dependency&gt;
</code></pre> </li> 
  </ul> 
  <h2><a href="https://github.com/spaceapegames/scala-redis#usage" aria-hidden="true" class="anchor" id="user-content-usage" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h2> 
  <p>Start your redis instance (usually redis-server will do it)</p> 
  <p>And you are ready to start issuing commands to the server(s)</p> 
  <p>Redis 2 implements a new protocol for binary safe commands and replies</p> 
  <p>Let us connect and get a key:</p> 
  <pre><code>scala&gt; import com.redis._
import com.redis._

scala&gt; val r = new RedisClient("localhost", 6379)
r: com.redis.RedisClient = localhost:6379

scala&gt; r.set("key", "some value")
res3: Boolean = true

scala&gt; r.get("key")
res4: Option[String] = Some(some value)
</code></pre> 
  <p>Let us try out some List operations:</p> 
  <pre><code>scala&gt; r.lpush("list-1", "foo")
res0: Option[Int] = Some(1)

scala&gt; r.rpush("list-1", "bar")
res1: Option[Int] = Some(2)

scala&gt; r.llen("list-1")
res2: Option[Int] = Some(2)
</code></pre> 
  <p>Let us look at some serialization stuff:</p> 
  <pre><code>scala&gt; import serialization._
import serialization._

scala&gt; import Parse.Implicits._
import Parse.Implicits._

scala&gt; r.hmset("hash", Map("field1" -&gt; "1", "field2" -&gt; 2))
res0: Boolean = true

scala&gt; r.hmget[String,String]("hash", "field1", "field2")
res1: Option[Map[String,String]] = Some(Map(field1 -&gt; 1, field2 -&gt; 2))

scala&gt; r.hmget[String,Int]("hash", "field1", "field2")
res2: Option[Map[String,Int]] = Some(Map(field1 -&gt; 1, field2 -&gt; 2))

scala&gt; val x = "debasish".getBytes("UTF-8")
x: Array[Byte] = Array(100, 101, 98, 97, 115, 105, 115, 104)

scala&gt; r.set("key", x)
res3: Boolean = true

scala&gt; import Parse.Implicits.parseByteArray
import Parse.Implicits.parseByteArray

scala&gt; val s = r.get[Array[Byte]]("key")
s: Option[Array[Byte]] = Some([B@6e8d02)

scala&gt; new String(s.get)
res4: java.lang.String = debasish

scala&gt; r.get[Array[Byte]]("keey")
res5: Option[Array[Byte]] = None
</code></pre> 
  <h2><a href="https://github.com/spaceapegames/scala-redis#using-client-pooling" aria-hidden="true" class="anchor" id="user-content-using-client-pooling" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Using Client Pooling</h2> 
  <p>scala-redis is a blocking client, which serves the purpose in most of the cases since Redis is also single threaded. But there may be situations when clients need to manage multiple RedisClients to ensure thread-safe programming.</p> 
  <p>scala-redis includes a Pool implementation which can be used to serve this purpose. Based on Apache Commons Pool implementation, RedisClientPool maintains a pool of instances of RedisClient, which can grow based on demand. Here's a sample usage ..</p> 
  <pre><code>val clients = new RedisClientPool("localhost", 6379)
def lp(msgs: List[String]) = {
  clients.withClient {
    client =&gt; {
      msgs.foreach(client.lpush("list-l", _))
      client.llen("list-l")
    }
  }
}
</code></pre> 
  <p>Using a combination of pooling and futures, scala-redis can be throttled for more parallelism. This is the typical recommended strategy if you are looking forward to scale up using this redis client. Here's a sample usage .. we are doing a parallel throttle of an lpush, rpush and set operations in redis, each repeated a number of times ..</p> 
  <p>If we have a pool initialized, then we can use the pool to repeat the following operations.</p> 
  <pre><code>// lpush
def lp(msgs: List[String]) = {
  clients.withClient {
    client =&gt; {
      msgs.foreach(client.lpush("list-l", _))
      client.llen("list-l")
    }
  }
}

// rpush
def rp(msgs: List[String]) = {
  clients.withClient {
    client =&gt; {
      msgs.foreach(client.rpush("list-r", _))
      client.llen("list-r")
    }
  }
}

// set
def set(msgs: List[String]) = {
  clients.withClient {
    client =&gt; {
      var i = 0
      msgs.foreach { v =&gt;
        client.set("key-%d".format(i), v)
        i += 1
      }
      Some(1000)
    }
  }
}
</code></pre> 
  <p>And here's the snippet that throttles our redis server with the above operations in a non blocking mode using Scala futures:</p> 
  <pre><code>val l = (0 until 5000).map(_.toString).toList
val fns = List[List[String] =&gt; Option[Int]](lp, rp, set)
val tasks = fns map (fn =&gt; scala.actors.Futures.future { fn(l) })
val results = tasks map (future =&gt; future.apply())
</code></pre> 
  <h2><a href="https://github.com/spaceapegames/scala-redis#redis-with-sentinel" aria-hidden="true" class="anchor" id="user-content-redis-with-sentinel" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Redis with Sentinel</h2> 
  <p>Redis client can be managed by a sentinel cluster. A sentinel cluster can be initialized either by the list of sentinel addresses in the cluster</p> 
  <pre><code>val sentinels = Set(
      SentinelAddress("sandbox-sentinel-i-dd71f533.use1a.apelabs.net", 26379),
      SentinelAddress("sandbox-sentinel-i-7c877c92.use1a.apelabs.net", 26379),
      SentinelAddress("sandbox-sentinel-i-7f877c91.use1a.apelabs.net", 26379))


SentinelClusterBuilder(SentinelClusterConfig(), sentinels)
</code></pre> 
  <p>or a load balancer of sentinel cluster</p> 
  <pre><code>SentinelClusterBuilder(SentinelClusterConfig(), SentinelAddress("internal-sandbox-sentinel-test-1813530000.us-east-1.elb.amazonaws.com", 26379), Set("test-service", "test-service-2"))
</code></pre> 
  <p>If the sentinel cluster is initialized by a load balancer, you must provide the master names managed in this cluster so that sentinel cluster client can auto discover all sentinel instances behind the load balancer.</p> 
  <p>Once a sentinel cluster is created, you could create standalone redis client</p> 
  <pre><code> new RedisClientBySentinel("test-service", sentinelCluster, (redisNode: RedisNode) =&gt; {})
</code></pre> 
  <p>or a redis client pool</p> 
  <pre><code> new RedisPoolStorage(new RedisClientPoolBySentinel(configuration.name, sentinelCluster))
</code></pre> 
  <p>or a redis client cluster</p> 
  <pre><code> new RedisShards(clusteredHosts) with NoOpKeyTagPolicy with PoolCreationBySentinel
</code></pre> 
  <h2><a href="https://github.com/spaceapegames/scala-redis#license" aria-hidden="true" class="anchor" id="user-content-license" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>License</h2> 
  <p>This software is licensed under the Apache 2 license, quoted below.</p> 
  <p>Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p> 
  <pre><code>http://www.apache.org/licenses/LICENSE-2.0
</code></pre> 
  <p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p> 
 </article>
</div>