<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-playinzoo-configuration-management" class="anchor" href="https://github.com/agolubev/playinzoo#playinzoo-configuration-management" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>PlayInZoo configuration management</h1> 
  <p><a href="https://travis-ci.org/agolubev/playinzoo" target="_blank"><img src="https://camo.githubusercontent.com/cf00c20bbd7e948905a02a5768630527a2f68ac9/68747470733a2f2f7472617669732d63692e6f72672f61676f6c756265762f706c6179696e7a6f6f2e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/agolubev/playinzoo.svg?branch=master" style="max-width:100%;"></a> <a href="https://coveralls.io/r/agolubev/playinzoo?branch=master" target="_blank"><img src="https://camo.githubusercontent.com/cb4f59ae9ac461946c30e13c61a0954e5a026f71/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f61676f6c756265762f706c6179696e7a6f6f2f62616467652e7376673f6272616e63683d6d6173746572" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/agolubev/playinzoo/badge.svg?branch=master" style="max-width:100%;"></a></p> 
  <p>This is a helper for play application to load configuration from zookeeper on server startup. It's extremely useful for cloud solutions to store configuration in one place to be available from anywhere.</p> 
  <p>Scala 2.10, 2.11; Play 2.2, 2.3 compliant.</p> 
  <p><strong>Any suggestions about additional features are welcome.</strong></p> 
  <h2><a id="user-content-feature" class="anchor" href="https://github.com/agolubev/playinzoo#feature" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Feature</h2> 
  <ul> 
   <li>load nodes and their data as play configuration</li> 
   <li>configuration loaded from zookeeper can be used by plugins, application or play itself</li> 
   <li>you can ask to load from multiple paths</li> 
   <li>support Zookeeper authentication</li> 
   <li>can load nodes recursively</li> 
   <li>supports several threads to load configuration - single thread loads by default</li> 
   <li>zookeeper node names convert to path expressions (per TypeSafe Config) and node data can be boolean, int, long, double, string</li> 
  </ul> 
  <h2><a id="user-content-configure-your-application-to-use-playinzoo" class="anchor" href="https://github.com/agolubev/playinzoo#configure-your-application-to-use-playinzoo" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Configure your application to use PlayInZoo</h2> 
  <p>You need to define Zookeeper hosts and paths you need to load configuration from</p> 
  <pre><code>playinzoo.hosts=127.0.0.1:3000,127.0.0.1:3001,127.0.0.1:3002
playinzoo.paths=/domain/data_center/client
</code></pre> 
  <p>You can set these properties in application.conf or system properties.</p> 
  <p>If you defined path as <code>/domain/data_center/client</code> than all nodes that are direct children of <code>client</code> node will be loaded along with their values and shared as play configuration</p> 
  <p>To make it work you also need to add to Global object following</p> 
  <div class="highlight highlight-source-scala">
   <pre> <span class="pl-k">override</span> <span class="pl-k">def</span> <span class="pl-en">onLoadConfig</span>(<span class="pl-v">config</span>: <span class="pl-en">Configuration</span>, <span class="pl-v">path</span>: <span class="pl-en">File</span>, 
        <span class="pl-v">classloader</span>: <span class="pl-en">ClassLoader</span>, <span class="pl-v">mode</span>: <span class="pl-en">Mode</span>)<span class="pl-k">:</span> <span class="pl-en">Configuration</span> <span class="pl-k">=</span> {
    config <span class="pl-k">++</span> <span class="pl-en">PlayInZoo</span>.loadConfiguration(config)
  }</pre>
  </div> 
  <h2><a id="user-content-add-playinzoo-to-your-dependencies" class="anchor" href="https://github.com/agolubev/playinzoo#add-playinzoo-to-your-dependencies" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Add PlayInZoo to your dependencies</h2> 
  <p>In your project/Build.scala:</p> 
  <div class="highlight highlight-source-scala">
   <pre>resolvers <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Sonatype Releases<span class="pl-pds">"</span></span> at <span class="pl-s"><span class="pl-pds">"</span>http://oss.sonatype.org/content/repositories/releases<span class="pl-pds">"</span></span>
libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>com.github.agolubev<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>play-in-zoo<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.3<span class="pl-pds">"</span></span></pre>
  </div> 
  <h2><a id="user-content-authentication" class="anchor" href="https://github.com/agolubev/playinzoo#authentication" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Authentication</h2> 
  <p>You can add settings with authentication information if required:</p> 
  <pre><code>playinzoo.schema=digest
playinzoo.auth="me:pass"
</code></pre> 
  <h2><a id="user-content-loading-with-multiple-threads" class="anchor" href="https://github.com/agolubev/playinzoo#loading-with-multiple-threads" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Loading with multiple threads</h2> 
  <p>To load configuration by multiple threads you can specify number of threads in pool</p> 
  <pre><code>playinzoo.threadpool.size=3
</code></pre> 
  <p>By default it's one thread doing loading</p> 
  <h2><a id="user-content-recursive-loading" class="anchor" href="https://github.com/agolubev/playinzoo#recursive-loading" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Recursive loading</h2> 
  <p>You can load configuration from the whole subtree. To do this you need to add <code>**</code> to the end of a path, like <code>/domain/data_center/org/**</code>. If zookeeper node has children it consider as folder - only leafs are loading as name-value configuration properties.</p> 
  <h2><a id="user-content-attributes-overriding---sequential-and-parallel-loading" class="anchor" href="https://github.com/agolubev/playinzoo#attributes-overriding---sequential-and-parallel-loading" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Attributes overriding - sequential and parallel loading</h2> 
  <p>Obviously attributes with the same name will override each other and it depends on loading order who wins. You can ask to load configuration from zk folders in parallel by dividing paths with coma, or specify to load sequentially by using "-&gt;".</p> 
  <p>In following example <code>default_log</code> and <code>default_int</code> will be loaded in parallel. Then configuration for http_service will be loaded and override attributes from default settings.</p> 
  <pre><code>playinzoo.paths="/org/cluster/default_log,/org/cluster/default_int-&gt;/org/cluster/http_service"
</code></pre> 
  <h2><a id="user-content-string-encoding" class="anchor" href="https://github.com/agolubev/playinzoo#string-encoding" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>String Encoding</h2> 
  <p>As zookeeper node data is byte[] there is configuration attribute <code>playinzoo.encoding</code> that defines charset for string values. Default encoding is UTF-8.</p> 
  <h2><a id="user-content-example" class="anchor" href="https://github.com/agolubev/playinzoo#example" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Example</h2> 
  <p>Having following structure in Zookeeper</p> 
  <pre><code>org - cluster + default + region (value: US)
              |         | language (value: en)
              |
              | service + name (value: Mobile REST)
                        | timeout(value: 3000)
</code></pre> 
  <p>you can load it into play config with paths setting:</p> 
  <pre><code>playinzoo.paths=/org/cluster/**
</code></pre> 
  <p>In play config following attributes will appear:</p> 
  <pre><code>region="US"
language="en"
name="Mobile REST"
value=3000 //integer
</code></pre> 
 </article>
</div>