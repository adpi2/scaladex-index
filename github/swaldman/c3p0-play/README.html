<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a href="https://github.com/swaldman/c3p0-play#c3p0-play" aria-hidden="true" class="anchor" id="user-content-c3p0-play" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>c3p0-play</h1> 
  <p><a href="http://www.playframework.com/" target="_blank">Play Framework</a> integrates the excellent <a href="http://jolbox.com/" target="_blank">Bone CP</a> as its default JDBC Connection pool. However, some users or applications may prefer to use other Connection pools for a variety of reasons. This plug-in enables the use of <a href="http://www.mchange.com/projects/c3p0/" target="_blank">c3p0</a> as an effortless first-class alternative to Play's built-in pool.</p> 
  <ul> 
   <li><a href="https://github.com/swaldman/c3p0-play#quickstart" target="_blank">Quickstart</a></li> 
   <li><a href="https://github.com/swaldman/c3p0-play#basic-configuration" target="_blank">Basic configuration</a></li> 
   <li><a href="https://github.com/swaldman/c3p0-play#advanced-configuration" target="_blank">Advanced configuration</a></li> 
   <li><a href="https://github.com/swaldman/c3p0-play#c3p0-play-specific-configuration-parameters" target="_blank">c3p0-play-specific configuration parameters</a></li> 
   <li><a href="https://github.com/swaldman/c3p0-play#alternatives-and-inspirations" target="_blank">Alternatives and inspirations</a></li> 
   <li><a href="https://github.com/swaldman/c3p0-play#contact-and-copyright" target="_blank">Contact and copyright</a></li> 
   <li><a href="https://github.com/swaldman/c3p0-play#appendix-mapping-play-native--bone-cp-config-parameters-to-c3p0" target="_blank">Appendix: Mapping Play-native / Bone CP config parameters to c3p0</a></li> 
  </ul> 
  <h3><a href="https://github.com/swaldman/c3p0-play#quickstart" aria-hidden="true" class="anchor" id="user-content-quickstart" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Quickstart</h3> 
  <ul> 
   <li>Configure your DataSources in the <a href="http://www.playframework.com/documentation/2.2.x/SettingsJDBC" target="_blank">ordinary Play way</a>.</li> 
   <li>Add the c3p0-play plug-in to your Play project's build.sbt as a libraryDependency:</li> 
  </ul> 
  <pre><code>libraryDependencies += "com.mchange" %%  "c3p0-play"  % "0.1.3"
</code></pre> 
  <ul> 
   <li>Disable the default pool and enable c3p0 in your Play application's <code>conf/application.conf</code> file.</li> 
  </ul> 
  <pre><code>dbplugin=disabled
c3p0.play.enabled=true
</code></pre> 
  <ul> 
   <li>Congratulations! You're app will now use c3p0. Please see below for configuration details.</li> 
  </ul> 
  <h3><a href="https://github.com/swaldman/c3p0-play#basic-configuration" aria-hidden="true" class="anchor" id="user-content-basic-configuration" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Basic configuration</h3> 
  <p>The c3p0-play plugin is designed to make it extremely easy to "drop-in" c3p0, to drop-back to the default BoneCP pool, or to mix the two pools. To enable that...</p> 
  <ol> 
   <li>c3p0-play reads Play's default DataSource configuration and translates it to c3p0 configuration. Some (not so common) BoneCP configuration properties do not easily map to c3p0. Those will be ignored with a warning in the logs upon initiatlization. (They are also documented below.)</li> 
   <li><a href="http://www.mchange.com/projects/c3p0/#configuration_properties" target="_blank"><em>All</em> c3p0 configuration</a> can be embedded directly in your <code>conf/application.conf</code> file. c3p0-native configuration will take precedence over play-style configuration for c3p0 pools. Dynamic reloading of configuration on application restart is supported.</li> 
  </ol> 
  <p>For example, the following configuration infomration...</p> 
  <pre><code>dbplugin=disabled
c3p0.play.enabled=true

db.default.driver=org.h2.Driver
db.default.url="jdbc:h2:mem:play"
db.default.user=sa
db.default.password=secret

db.default.acquireIncrement=1
db.default.testConnectionOnCheckout=true

c3p0.acquireIncrement=5
c3p0.minPoolSize=10
c3p0.maxPoolSize=30
</code></pre> 
  <p>would configure a c3p0 DataSource named <code>default</code> using the driver, url, and authentication information given.</p> 
  <ul> 
   <li> <p><code>acquireIncrement</code> (a configuration parameter shared by c3p0 and BoneCP) is configured twice, once in Play-typical format and once in c3p0-native format. The value in c3p0-native format overrides and is used in preference to the value in Play format when both are present. This usefully allows users to maintain distinct configrations for BoneCP and c3p0 while users profile and experiment with the two libraries.</p> </li> 
   <li> <p><code>testConnectionOnCheckout</code> is a c3p0 parameter. It is translated from Play format and used as-is, since there is no c3p0-native value to override it.</p> </li> 
   <li> <p><code>minPoolSize</code> and <code>maxPoolSize</code> are included in c3p0-native and conflict with nothing. Unsurprisingly, those values will be used by c3p0 DataSources.</p> </li> 
  </ul> 
  <h3><a href="https://github.com/swaldman/c3p0-play#advanced-configuration" aria-hidden="true" class="anchor" id="user-content-advanced-configuration" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Advanced configuration</h3> 
  <p>Play permits, and c3p0 supports, the definition and configuration of multiple DataSources by name:</p> 
  <pre><code>dbplugin=disabled
c3p0.play.enabled=true

db.default.driver=org.h2.Driver
db.default.url="jdbc:h2:mem:play"
db.default.user=sa
db.default.password=secret

db.awesome.driver=org.postgresql.Driver
db.awesome.url="jdbc:postgresql://localhost/awesomedb"
db.awesome.user=superlative
db.awesome.password=hushhush

c3p0.minPoolSize=2
c3p0.maxPoolSize=10
</code></pre> 
  <p>Very often, you will want to provide distinct configuration for the two DataSources. You can do that Play-style, as long as there are no conflicts with c3p0-style config:</p> 
  <pre><code>db.default.testConnectionOnCheckout=false
db.awesome.testConnectionOnCheckout=true
</code></pre> 
  <p>You can also embed <a href="http://www.mchange.com/projects/c3p0/#named_configurations" target="_blank">c3p0-standard <em>Named Configurations</em></a> directly in <code>application.conf</code>:</p> 
  <pre><code>dbplugin=disabled
c3p0.play.enabled=true

db.default.driver=org.h2.Driver
db.default.url="jdbc:h2:mem:play"
db.default.user=sa
db.default.password=secret

db.awesome.driver=org.postgresql.Driver
db.awesome.url="jdbc:postgresql://localhost/awesomedb"
db.awesome.user=superlative
db.awesome.password=hushhush

c3p0.minPoolSize=2
c3p0.maxPoolSize=10
c3p0.testConnectionOnCheckout=false

c3p0.named-configs.awesome {
  minPoolSize=10
  maxPoolSize=30
  testConnectionsOnCheckout=true
  preferredTestQuery="SELECT 1"
}
</code></pre> 
  <p>You can configure as many DataSources as you like, and in any valid format for <code>conf/application.conf</code>. For example, the following is the same configuration as the one above:</p> 
  <pre><code>dbplugin=disabled
c3p0.play.enabled=true

db.default.driver=org.h2.Driver
db.default.url="jdbc:h2:mem:play"
db.default.user=sa
db.default.password=secret

db.awesome.driver=org.postgresql.Driver
db.awesome.url="jdbc:postgresql://localhost/awesomedb"
db.awesome.user=superlative
db.awesome.password=hushhush

c3p0 {
  minPoolSize=2
  maxPoolSize=10
  testConnectionOnCheckout=false

  named-configs {
    awesome {
      minPoolSize=10
      maxPoolSize=30
      testConnectionsOnCheckout=true
      preferredTestQuery="SELECT 1"
    }
  }
}
</code></pre> 
  <h5><a href="https://github.com/swaldman/c3p0-play#time-denominated-configuration" aria-hidden="true" class="anchor" id="user-content-time-denominated-configuration" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Time-denominated configuration</h5> 
  <p>For time-denominated c3p0 config parameters (<code>acquireRetryDelay</code>, <code>checkoutTimeout</code>, <code>idleConnectionTestPeriod</code>, <code>maxAdministrativeTaskTime</code>, <code>maxConnectionAge</code>, <code>maxIdleTime</code>, <code>maxIdleTimeExcessConnections</code>, <code>propertyCycle</code>, <code>unreturnedConnectionTimeout</code>), <a href="https://github.com/typesafehub/config/blob/master/HOCON.md#duration-format" target="_blank">HOCON-standard duration units</a> are supported.</p> 
  <p>For example, the following are equivalent ways of specifying <a href="http://www.mchange.com/projects/c3p0/#idleConnectionTestPeriod" target="_blank">idleConnectionTestPeriod</a>, whose natural unit is seconds:</p> 
  <pre><code>c3p0.idleConnectionTestPeriod=30
c3p0.idleConnectionTestPeriod=30 seconds
c3p0.idleConnectionTestPeriod=3000 ms
</code></pre> 
  <h3><a href="https://github.com/swaldman/c3p0-play#c3p0-play-specific-configuration-parameters" aria-hidden="true" class="anchor" id="user-content-c3p0-play-specific-configuration-parameters" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>c3p0-play-specific configuration parameters</h3> 
  <p>For the most part, c3p0-play can be configured exactly as <a href="http://www.mchange.com/projects/c3p0/" target="_blank">documented for the main c3p0 library</a>. Play's "<a href="https://github.com/typesafehub/config/blob/master/HOCON.md" target="_blank">HOCON</a>" <code>application.conf</code> file format is now <a href="http://www.mchange.com/projects/c3p0/#c3p0_conf" target="_blank">natively supported by c3p0</a>. All standard c3p0 configuration is supported.</p> 
  <p>There are a few configuration parameters specific to the c3p0-play plugin:</p> 
  <ul> 
   <li><code>c3p0.play.dataSourceNames</code>: [a comma separated String or HOCON list of Strings, default in names read from play-style config] If you wish to configure DaraSource purely in c3p0 native format, you can declare DataSource here. Each name will be mapped to a single DataSource that will be made available at runtime.</li> 
   <li><code>c3p0.play.eager</code>: [boolean value, default is <code>true</code>] If <code>true</code> (or unset), the plugin will create and destroy a Connection on startupt to eagerly initialize Connection pools in c3p0 DataSources. If <code>false</code>, the plugin will immediately prepare DataSources, but the pool initialization and the overhead of pool maintenance will be deferred until the first client request.</li> 
   <li><code>c3p0.play.enabled</code>: [boolean value, default is <code>true</code>] The plugin will function and create c3p0 DataSources if <code>true</code> (or unset). The plugin will do nothing if this value is <code>false</code>.</li> 
   <li><code>c3p0.play.importPlayStyleConfig</code>: [boolean value, default is <code>true</code>, <strong>very rarely used</strong>] If set to <code>false</code>, c3p0 will <em>not</em> try to transalte and import Play-style config. This is useful if you wish to run your app in mixed mode, with some c3p0 DataSources and some BoneCP DataSources. You can configure c3p0 DataSources with <code>c3p0.play.dataSourceNames</code> and leave the standard Play configurtion style to BoneCP.</li> 
  </ul> 
  <h3><a href="https://github.com/swaldman/c3p0-play#alternatives-and-inspirations" aria-hidden="true" class="anchor" id="user-content-alternatives-and-inspirations" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Alternatives and inspirations</h3> 
  <p>There have been at least two other projects aimed at bringing c3p0 to Play, Ivan Meredith's <a href="https://github.com/hadashi/play2-c3p0-plugin" target="_blank">play2-c3p0-plugin</a> and FuRyu's <a href="https://github.com/Furyu/play-c3p0-plugin" target="_blank">play-c3p0-plugin</a>. This current project borrowed a great deal from <a href="https://github.com/playframework/playframework/blob/2.2.x/framework/src/play-jdbc/src/main/scala/play/api/db/DB.scala" target="_blank">DB.scala</a> in the Play framework's source, which includes the default BoneCPPlugin plugin class.</p> 
  <h3><a href="https://github.com/swaldman/c3p0-play#contact-and-copyright" aria-hidden="true" class="anchor" id="user-content-contact-and-copyright" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Contact and copyright</h3> 
  <p>This library was authored by Steve Waldman &lt;<a href="mailto:swaldman@mchange.com" target="_blank">swaldman@mchange.com</a>&gt;. Your feedback is appreciated. The author monitors the <a href="http://stackoverflow.com/questions/tagged/c3p0" target="_blank">c3p0 tag on stackoverflow</a>, which is probably your best bet for support.</p> 
  <p>Copyright (C) 2013 by Machinery For Change, Inc. All rights reserved. This library is offered to you under EITHER i) The <a href="http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html" target="_blank">GNU Lesser General Public License (LGPL), version 2.1</a> or ii) The <a href="http://www.eclipse.org/org/documents/epl-v10.php" target="_blank">Eclipse Public License (EPL), version 1.0</a>, at your option.</p> 
  <h3><a href="https://github.com/swaldman/c3p0-play#appendix-mapping-play-native--bone-cp-config-parameters-to-c3p0" aria-hidden="true" class="anchor" id="user-content-appendix-mapping-play-native--bone-cp-config-parameters-to-c3p0" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Appendix: Mapping Play-native / Bone CP config parameters to c3p0</h3> 
  <p>The following properties are mapped from Play config to c3p0 parameters without modification:</p> 
  <pre><code>Play/BoneCP                      c3p0
=======================          ========================
driver                    --&gt;    driverClass
url                       --&gt;    jdbcUrl
user                      --&gt;    user
password                  --&gt;    password
acquireIncrement          --&gt;    acquireIncrement
acquireRetryAttempts      --&gt;    acquireRetryAttempts
acquireRetryDelay         --&gt;    acquireRetryDelay
idleConnectionTestPeriod  --&gt;    idleConnectionTestPeriod
maxConnectionAge          --&gt;    maxConnectionAge
</code></pre> 
  <p>The Play/BoneCP parameter <code>connectionTimeout</code> is mapped to th c3p0 parameter <code>clientTimeout</code>, but BoneCP's expected seconds to c3p0's expected milliseconds if no <a href="https://github.com/swaldman/c3p0-play#time-denominated-configuration" target="_blank">time unit is specified</a>.</p> 
  <p>The following Play/BoneCP configuration properties are supported via automatic installation of a <code>ConnectionCustomizer</code>: <code>autocommit</code>, <code>defaultConfig</code>, <code>initSQL</code>, <code>isolation</code>. They work fine, but if a conflicting <code>connectionCustomizerClassName</code> while any of these parameters are set, a configuration error will be signalled.</p> 
  <p>The <code>jndiName</code> parameter, which has no c3p0-native equivalent, is supported by the plug-in.</p> 
  <p>BoneCP and c3p0 define pool sizing very differently. For any DataSource (or at the top level), if any of c3p0 pool size parameters <code>minPoolSize</code> and <code>maxPoolSize</code> are set, they will be used (along with c3p0 defaults if one of the parameters is missing). <strong>If and only if there is no c3p0-style pool-size information in scope for a DataSource</strong>, then c3p0 will try to infer appropriate size information from BoneCP parameters <code>partitionCount</code>, <code>minConnectionsPerPartition</code>, <code>maxConnectionsPerPartition</code>:</p> 
  <pre><code>minPoolSize = partitionCount x minConnectionsPerPartition
maxPoolSize = partitionCount x maxConnectionsPerPartition
</code></pre> 
  <p>The plugin will warn (in logs at <code>INFO</code>) if BoneCP-style parameters are present and shadowed by c3p0-style parameters.</p> 
  <p>The following Play/BoneCP paramaters are <em>not supported and ignored</em>. Warnings will appear in your log files to remind you that they are ignored: <code>idleMaxAge</code>, <code>logStatements</code>, <code>statisticsEnabled</code></p> 
 </article>
</div>