<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h2><a id="user-content-macro-peg-peg-with-macro-like-rules" class="anchor" href="https://github.com/kmizu/hopeg#macro-peg-peg-with-macro-like-rules" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Macro PEG: PEG with macro-like rules</h2> 
  <p><a href="https://gitter.im/kmizu/macro_peg?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge" target="_blank"><img src="https://camo.githubusercontent.com/f943ace93ace4b7d82fcbad136dbff5e9ade01d5/68747470733a2f2f6261646765732e6769747465722e696d2f6b6d697a752f6d6163726f5f7065672e737667" alt="Gitter" data-canonical-src="https://badges.gitter.im/kmizu/macro_peg.svg" style="max-width:100%;"></a> <a href="https://travis-ci.org/kmizu/macro_peg" target="_blank"><img src="https://camo.githubusercontent.com/3520f7457861c23cf681248a87f65e139b0cd408/68747470733a2f2f7472617669732d63692e6f72672f6b6d697a752f6d6163726f5f7065672e706e673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/kmizu/macro_peg.png?branch=master" style="max-width:100%;"></a> <a href="https://maven-badges.herokuapp.com/maven-central/com.github.kmizu/macro_peg_2.11" target="_blank"><img src="https://camo.githubusercontent.com/8f67dff2688fc697310fe00378d7fb355eb45866/68747470733a2f2f6d6176656e2d6261646765732e6865726f6b756170702e636f6d2f6d6176656e2d63656e7472616c2f636f6d2e6769746875622e6b6d697a752f6d6163726f5f7065675f322e31312f62616467652e737667" alt="Maven Central" data-canonical-src="https://maven-badges.herokuapp.com/maven-central/com.github.kmizu/macro_peg_2.11/badge.svg" style="max-width:100%;"></a> <a href="http://javadoc-badge.appspot.com/com.github.kmizu/macro_peg_2.11/index.html#com.github.kmizu.macro_peg.package" target="_blank"><img src="https://camo.githubusercontent.com/15f5334f892f6093d78abcef4860f28b2b20e173/687474703a2f2f6a617661646f632d62616467652e61707073706f742e636f6d2f636f6d2e6769746875622e6b6d697a752f6d6163726f5f7065675f322e31312e7376673f6c6162656c3d7363616c61646f63" alt="Scaladoc" data-canonical-src="http://javadoc-badge.appspot.com/com.github.kmizu/macro_peg_2.11.svg?label=scaladoc" style="max-width:100%;"></a> <a href="https://www.versioneye.com/java/com.github.kmizu:macro_peg_2.11/references" target="_blank"><img src="https://camo.githubusercontent.com/24fbda86b180c53e556d3cfe64e9ae2b5b1aaf90/68747470733a2f2f7777772e76657273696f6e6579652e636f6d2f6a6176612f636f6d2e6769746875622e6b6d697a753a6d6163726f5f7065675f322e31312f7265666572656e63655f62616467652e7376673f7374796c653d666c6174" alt="Reference Status" data-canonical-src="https://www.versioneye.com/java/com.github.kmizu:macro_peg_2.11/reference_badge.svg?style=flat" style="max-width:100%;"></a></p> 
  <p>Macro PEG is an extended PEG by macro-like rules. It seems that expressiveness of Macro PEG is greather than traditional PEG since Macro PEG can express palindromes. This repository implements a Macro PEG interpreter (or matcher).</p> 
  <h3><a id="user-content-grammar-of-macro-peg-in-pseudo-peg" class="anchor" href="https://github.com/kmizu/hopeg#grammar-of-macro-peg-in-pseudo-peg" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Grammar of Macro PEG in Pseudo PEG</h3> 
  <p>Note that spacing is ommited.</p> 
  <pre><code>Grammer &lt;- Rule* ";";

Rule &lt;- Identifier ("(" Identifier ("," Identifer)* ")")? "=" Expression ";";

Expression &lt;- Sequence ("/" Sequence)*;

Sequence &lt;- Prefix+;

Prefix &lt;-  ("&amp;" / "!") Suffix;

Suffix &lt;- Primary "+"
        /  Primary "*"
        /  Primary "?"
        /  Primary;

Primary &lt;- "(" Expression ")"
         /  Call
         / Debug
         / Identifier
         / StringLiteral
         / CharacterClass;
         
Debug &lt;- "Debug" "(" Expression ")";

StringLiteral &lt;- "\\" (!"\\" .) "\\";

Call &lt;- Identifier "(" Expression ("," Expression)* ")";

Identifier &lt;- [a-zA-Z_] ([a-zA-Z0-9_])*;

CharacterClass &lt;- "[" "^"? (!"[" .)+ "]"
</code></pre> 
  <h3><a id="user-content-release-note" class="anchor" href="https://github.com/kmizu/hopeg#release-note" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Release Note</h3> 
  <h4><a id="user-content-009" class="anchor" href="https://github.com/kmizu/hopeg#009" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>0.0.9</h4> 
  <ul> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/fd4525f86d30b3dd6573f33deebdc5f00a08c9a3" target="_blank">Generalize evalCC combinator.</a></li> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/bbfc7b1bd9c4fdabac9a45050cbe1416ff09db7e" target="_blank">'undefined variable is parse error' example.</a></li> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/187e4489d062286a66c6dc39c73bd559543d746c" target="_blank">Fix bug of + combinator.</a></li> 
  </ul> 
  <h4><a id="user-content-008" class="anchor" href="https://github.com/kmizu/hopeg#008" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>0.0.8</h4> 
  <ul> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/91154c8da2148f38434bb91b292b202429d21de1" target="_blank">Introduce backreference as <code>evalCC</code> method.</a></li> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/e5195caaa0248e8a05233326081de0296ce3dc26" target="_blank">pfun -&gt; delayedParser, which is better naming than before(breaking change)</a></li> 
  </ul> 
  <h4><a id="user-content-007" class="anchor" href="https://github.com/kmizu/hopeg#007" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>0.0.7</h4> 
  <ul> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/3866502bf699ff6aac2426fc21a9fa6e97c00d09" target="_blank">Introduce MacroParsers, parser combinator library for Macro PEG.</a> 
    <ul> 
     <li>See <a href="https://github.com/kmizu/macro_peg/blob/3866502bf699ff6aac2426fc21a9fa6e97c00d09/src/test/scala/com/github/kmizu/macro_peg/MacroParsersSpec.scala" target="_blank">tests</a></li> 
    </ul> </li> 
  </ul> 
  <h4><a id="user-content-006" class="anchor" href="https://github.com/kmizu/hopeg#006" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>0.0.6</h4> 
  <ul> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/40f9c1198127307f6f8e7f151c2fa216b0d6dca0" target="_blank">More accurate ParseException</a></li> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/cceaf815debc5995d88b8019479bf156e0047016" target="_blank">EvaluationException is thrown when arity of function is not equal to passed params.</a></li> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/4038366c73086c7ef50384e39db6e004f88b34cd" target="_blank">Improved Parser</a></li> 
  </ul> 
  <h4><a id="user-content-005" class="anchor" href="https://github.com/kmizu/hopeg#005" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>0.0.5</h4> 
  <ul> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/c6fcd9c77174400c5629cc3ee5f243ff174f5ea2" target="_blank">subtract and exponent example</a></li> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/753dbca88a64bbba1dd57e4f9ca29e763f25c570" target="_blank">Character class support!</a></li> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/11bc7037d5699f9fb4a168aa9801f3f6251f8c8a" target="_blank">| is now alias of /</a></li> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/2d523000782ea0b9b3deca3d54cc7fb3cded7657" target="_blank">Modifiers + Scope</a></li> 
  </ul> 
  <h4><a id="user-content-004" class="anchor" href="https://github.com/kmizu/hopeg#004" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>0.0.4</h4> 
  <ul> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/8bd5129ccb6268d09b72ef7460e16b873f0fc3f3" target="_blank">HOPEG is now Macro PEG</a></li> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/d013760105974a8446da023147f0cade10679c8a" target="_blank">Debug expression is implemented</a></li> 
  </ul> 
  <h4><a id="user-content-003" class="anchor" href="https://github.com/kmizu/hopeg#003" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>0.0.3</h4> 
  <ul> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/86b7c43ef52b9a6d2e81fcb541aca93e89b276ae" target="_blank">Fix bug of MacroPEGEvaluator</a></li> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/00221379bec06ddf3392e50803f6bf5d1316b579" target="_blank">Modifier HOPEG example</a></li> 
  </ul> 
  <h4><a id="user-content-002" class="anchor" href="https://github.com/kmizu/hopeg#002" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>0.0.2</h4> 
  <ul> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/a7a72bcffd22401b9fec7a71ff2a5992e6fe7448" target="_blank">Fix bug of HOPEGParser</a></li> 
   <li><a href="https://github.com/kmizu/macro_peg/commit/1aadc5585490a13e6eb7cdbf60547eea1b424052" target="_blank">Arithmetic HOPEG example</a></li> 
  </ul> 
  <h3><a id="user-content-usage" class="anchor" href="https://github.com/kmizu/hopeg#usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h3> 
  <p>Note that the behaviour could change.</p> 
  <p>Add the following lines to your build.sbt file:</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>com.github.kmizu<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>macro_peg<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.0.10<span class="pl-pds">"</span></span></pre>
  </div> 
  <p>Then, you can use <code>MacroPEGParser</code> and <code>MacroPEGEvaluator</code> as the followings:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.github.kmizu.macro_peg.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">MacroPEGRunner.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">MacroPEGParser.</span><span class="pl-v">_</span>
<span class="pl-k">val</span> <span class="pl-en">grammar</span> <span class="pl-k">=</span> parse(
  <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">        |S = P("") !.; P(r) = "a" P("a" r) / "b" P("b" r) / r;</span>
<span class="pl-s">  <span class="pl-pds">"""</span></span>.stripMargin
)
<span class="pl-k">val</span> <span class="pl-en">evaluator</span> <span class="pl-k">=</span> <span class="pl-en">MacroPEGEvaluator</span>(grammar)</pre>
  </div> 
  <div class="highlight highlight-source-scala">
   <pre>scala<span class="pl-k">&gt;</span> <span class="pl-k">val</span> <span class="pl-en">inputs</span> <span class="pl-k">=</span> <span class="pl-en">List</span>(
     <span class="pl-k">|</span>   <span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>b<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>aa<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>bb<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>ab<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>ba<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>aaa<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>bbb<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>aba<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>bab<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>abb<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>baa<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>aab<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>bba<span class="pl-pds">"</span></span>,
     <span class="pl-k">|</span>   <span class="pl-s"><span class="pl-pds">"</span>aaaa<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>bbbb<span class="pl-pds">"</span></span>, 
     <span class="pl-k">|</span>   <span class="pl-s"><span class="pl-pds">"</span>aaab<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>aaba<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>abaa<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>baaa<span class="pl-pds">"</span></span>,
     <span class="pl-k">|</span>   <span class="pl-s"><span class="pl-pds">"</span>bbba<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>bbab<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>babb<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>abbb<span class="pl-pds">"</span></span>,
     <span class="pl-k">|</span>   <span class="pl-s"><span class="pl-pds">"</span>aabb<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>abba<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>bbaa<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>baab<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>abab<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>baba<span class="pl-pds">"</span></span>
     <span class="pl-k">|</span> )
inputs<span class="pl-k">:</span> <span class="pl-en">List</span>[<span class="pl-k">String</span>] <span class="pl-k">=</span> <span class="pl-en">List</span>(a, b, aa, bb, ab, ba, aaa, bbb, aba, bab, abb, baa, aab, bba, aaaa, bbbb, aaab, aaba, abaa, baaa, bbba, bbab, babb, abbb, aabb, abba, bbaa, baab, abab, baba)

scala<span class="pl-k">&gt;</span> inputs.map{input <span class="pl-k">=&gt;</span> s<span class="pl-s"><span class="pl-pds">"</span>${input} =&gt; ${evaluator.evaluate(input, 'S)}<span class="pl-pds">"</span></span>}.mkString(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\n</span><span class="pl-pds">"</span></span>)
res0<span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span>
a <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
b <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
aa <span class="pl-k">=&gt;</span> <span class="pl-en">Some</span>(aa)
bb <span class="pl-k">=&gt;</span> <span class="pl-en">Some</span>(bb)
ab <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
ba <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
aaa <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
bbb <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
aba <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
bab <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
abb <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
baa <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
aab <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
bba <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
aaaa <span class="pl-k">=&gt;</span> <span class="pl-en">Some</span>(aaaa)
bbbb <span class="pl-k">=&gt;</span> <span class="pl-en">Some</span>(bbbb)
aaab <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
aaba <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
abaa <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
baaa <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
bbba <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
bbab <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
babb <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
abbb <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
aabb <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
abba <span class="pl-k">=&gt;</span> <span class="pl-en">Some</span>(abba)
bbaa <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
baab <span class="pl-k">=&gt;</span> <span class="pl-en">Some</span>(baab)
abab <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
baba <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span></pre>
  </div> 
  <div class="highlight highlight-source-scala">
   <pre>scala<span class="pl-k">&gt;</span> tryGrammar(
     <span class="pl-k">|</span>       <span class="pl-s"><span class="pl-pds">"</span>modifiers<span class="pl-pds">"</span></span>,
     <span class="pl-k">|</span>       <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">     |     |S = Modifiers(!"", "") !.;</span>
<span class="pl-s">     |     |Modifiers(AlreadyLooked, Scope) = (!AlreadyLooked) (</span>
<span class="pl-s">     |     |    &amp;(Scope) Token("public") Modifiers(AlreadyLooked / "public", "public")</span>
<span class="pl-s">     |     |  / &amp;(Scope) Token("protected") Modifiers(AlreadyLooked / "protected", "protected")</span>
<span class="pl-s">     |     |  / &amp;(Scope) Token("private") Modifiers(AlreadyLooked / "private", "private")</span>
<span class="pl-s">     |     |  / Token("static") Modifiers(AlreadyLooked / "static", Scope)</span>
<span class="pl-s">     |     |  / Token("final") Modifiers(AlreadyLooked / "final", Scope)</span>
<span class="pl-s">     |     |  / ""</span>
<span class="pl-s">     |     |);</span>
<span class="pl-s">     |     |Token(t) = t Spacing;</span>
<span class="pl-s">     |     |Spacing = " "*;</span>
<span class="pl-s">     |     <span class="pl-pds">"""</span></span>.stripMargin, <span class="pl-s"><span class="pl-pds">"</span>public static final<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>public public<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>public static public<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>final static public<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>final final<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>public private<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>protected public<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>public static<span class="pl-pds">"</span></span>)
grammar<span class="pl-k">:</span> modifiers

input<span class="pl-k">:</span>public static <span class="pl-k">final</span>
matched to public static <span class="pl-k">final</span>

input<span class="pl-k">:</span>public public
not matched to public public

input<span class="pl-k">:</span>public static public
not matched to public static public

input<span class="pl-k">:</span><span class="pl-k">final</span> static public
matched to <span class="pl-k">final</span> static public

input<span class="pl-k">:</span><span class="pl-k">final</span> <span class="pl-k">final</span>
not matched to <span class="pl-k">final</span> <span class="pl-k">final</span>

input<span class="pl-k">:</span>public <span class="pl-k">private</span>
not matched to public <span class="pl-k">private</span>

input<span class="pl-k">:</span><span class="pl-k">protected</span> public
not matched to <span class="pl-k">protected</span> public

input<span class="pl-k">:</span>public static
matched to public static
</pre>
  </div> 
  <div class="highlight highlight-source-scala">
   <pre>scala<span class="pl-k">&gt;</span> tryGrammar(
     <span class="pl-k">|</span>       <span class="pl-s"><span class="pl-pds">"</span>subtract<span class="pl-pds">"</span></span>,
     <span class="pl-k">|</span>         <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">     |       |S = ReadRight("") !.;</span>
<span class="pl-s">     |       |// the number of occurence of '1 represents a natural number.</span>
<span class="pl-s">     |       |// a-b=c</span>
<span class="pl-s">     |       |// Essentially, this checks a=b+c.</span>
<span class="pl-s">     |       |ReadRight(Right)</span>
<span class="pl-s">     |       |  = &amp;("1"* "-" Right "1") ReadRight(Right "1")</span>
<span class="pl-s">     |       |  / &amp;("1"* "-" Right "=") ReadDiff(Right, "");</span>
<span class="pl-s">     |       |</span>
<span class="pl-s">     |       |ReadDiff(Right, Diff)</span>
<span class="pl-s">     |       |  = &amp;("1"* "-" Right "=" Diff "1") ReadDiff(Right, Diff "1")</span>
<span class="pl-s">     |       |  / &amp;("1"* "-" Right "=" Diff !.) Check(Right, Diff);</span>
<span class="pl-s">     |       |</span>
<span class="pl-s">     |       |Check(Right, Diff)</span>
<span class="pl-s">     |       |  = Right Diff "-" Right "=" Diff;</span>
<span class="pl-s">     |       <span class="pl-pds">"""</span></span>.stripMargin,
     <span class="pl-k">|</span>       <span class="pl-s"><span class="pl-pds">"</span>11-1=1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>1-1=<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>111-11=1<span class="pl-pds">"</span></span>, <span class="pl-c"><span class="pl-c">//</span> should match</span>
     <span class="pl-k">|</span>       <span class="pl-s"><span class="pl-pds">"</span>111-1=1<span class="pl-pds">"</span></span>,  <span class="pl-s"><span class="pl-pds">"</span>111-1=111<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>1-11=<span class="pl-pds">"</span></span> <span class="pl-c"><span class="pl-c">//</span> should not match</span>
     <span class="pl-k">|</span>     )
grammar<span class="pl-k">:</span> subtract

input<span class="pl-k">:</span><span class="pl-c1">11</span><span class="pl-k">-</span><span class="pl-c1">1</span><span class="pl-k">=</span><span class="pl-c1">1</span>
matched to <span class="pl-c1">11</span><span class="pl-k">-</span><span class="pl-c1">1</span><span class="pl-k">=</span><span class="pl-c1">1</span>

input<span class="pl-k">:</span><span class="pl-c1">1</span><span class="pl-k">-</span><span class="pl-c1">1</span><span class="pl-k">=</span>
matched to <span class="pl-c1">1</span><span class="pl-k">-</span><span class="pl-c1">1</span><span class="pl-k">=</span>

input<span class="pl-k">:</span><span class="pl-c1">111</span><span class="pl-k">-</span><span class="pl-c1">11</span><span class="pl-k">=</span><span class="pl-c1">1</span>
matched to <span class="pl-c1">111</span><span class="pl-k">-</span><span class="pl-c1">11</span><span class="pl-k">=</span><span class="pl-c1">1</span>

input<span class="pl-k">:</span><span class="pl-c1">111</span><span class="pl-k">-</span><span class="pl-c1">1</span><span class="pl-k">=</span><span class="pl-c1">1</span>
not matched to <span class="pl-c1">111</span><span class="pl-k">-</span><span class="pl-c1">1</span><span class="pl-k">=</span><span class="pl-c1">1</span>

input<span class="pl-k">:</span><span class="pl-c1">111</span><span class="pl-k">-</span><span class="pl-c1">1</span><span class="pl-k">=</span><span class="pl-c1">111</span>
not matched to <span class="pl-c1">111</span><span class="pl-k">-</span><span class="pl-c1">1</span><span class="pl-k">=</span><span class="pl-c1">111</span>

input<span class="pl-k">:</span><span class="pl-c1">1</span><span class="pl-k">-</span><span class="pl-c1">11</span><span class="pl-k">=</span>
not matched to <span class="pl-c1">1</span><span class="pl-k">-</span><span class="pl-c1">11</span><span class="pl-k">=</span>
</pre>
  </div> 
  <div class="highlight highlight-source-scala">
   <pre>scala<span class="pl-k">&gt;</span>     tryGrammar(
     <span class="pl-k">|</span>       <span class="pl-s"><span class="pl-pds">"</span>exponent<span class="pl-pds">"</span></span>,
     <span class="pl-k">|</span>         <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">     |       |S = ReadLeft("", "") !.;</span>
<span class="pl-s">     |       |// the number of occurence of '1 represents a natural number.</span>
<span class="pl-s">     |       |// |Seq| is the length of a sequence Seq.</span>
<span class="pl-s">     |       |// ^ is exponent operator</span>
<span class="pl-s">     |       |// ReadLeft("", "") checks input is a correct expression a^b=c.</span>
<span class="pl-s">     |       |</span>
<span class="pl-s">     |       |// Read a.</span>
<span class="pl-s">     |       |// LeftAsOnes is a sequence of "1" where |LeftAsOnes| = |a|.</span>
<span class="pl-s">     |       |// LeftAsDots is a sequence of . where |LeftAsDots| = |a|.</span>
<span class="pl-s">     |       |ReadLeft(LeftAsOnes, LeftAsDots)</span>
<span class="pl-s">     |       |  = &amp;(LeftAsOnes "1") ReadLeft(LeftAsOnes "1", LeftAsDots .)</span>
<span class="pl-s">     |       |  / &amp;(LeftAsOnes "^") ComputePadding(LeftAsOnes, LeftAsDots, "");</span>
<span class="pl-s">     |       |</span>
<span class="pl-s">     |       |// Compute Padding which is a sequene of .</span>
<span class="pl-s">     |       |// where |Padding| + |LeftAsDots| = |Input|</span>
<span class="pl-s">     |       |ComputePadding(LeftAsOnes, LeftAsDots, Padding)</span>
<span class="pl-s">     |       |  = &amp;(Padding LeftAsDots .) ComputePadding(LeftAsOnes, LeftAsDots, Padding .)</span>
<span class="pl-s">     |       |  / &amp;(Padding LeftAsDots !.) ReadRight(LeftAsOnes, Padding, "", "1");</span>
<span class="pl-s">     |       |</span>
<span class="pl-s">     |       |// Read b.</span>
<span class="pl-s">     |       |// Exp = a^Right.</span>
<span class="pl-s">     |       |ReadRight(Left, Padding, Right, Exp)</span>
<span class="pl-s">     |       |  = &amp;(Left "^" Right "1") Multiply(Left, Padding, Right "1", Exp, "", "")</span>
<span class="pl-s">     |       |  / &amp;(Left "^" Right "=") Check(Left, Right, Exp);</span>
<span class="pl-s">     |       |</span>
<span class="pl-s">     |       |// Compute Left * OldExp.</span>
<span class="pl-s">     |       |// This adds OldExp Left times into Exp.</span>
<span class="pl-s">     |       |// I is a loop counter.</span>
<span class="pl-s">     |       |Multiply(Left, Padding, Right, OldExp, Exp, I)</span>
<span class="pl-s">     |       |  = &amp;(Padding I .) Multiply(Left, Padding, Right, OldExp, Exp OldExp, I .)</span>
<span class="pl-s">     |       |  / &amp;(Padding I !.) ReadRight(Left, Padding, Right, Exp);</span>
<span class="pl-s">     |       |</span>
<span class="pl-s">     |       |// Check whole input.</span>
<span class="pl-s">     |       |Check(Left, Right, Exp)</span>
<span class="pl-s">     |       |  = Left "^" Right "=" Exp;</span>
<span class="pl-s">     |       <span class="pl-pds">"""</span></span>.stripMargin,
     <span class="pl-k">|</span>       <span class="pl-s"><span class="pl-pds">"</span>11^111=11111111<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>11^=1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>1^11=1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>^11=<span class="pl-pds">"</span></span>, <span class="pl-c"><span class="pl-c">//</span> should match</span>
     <span class="pl-k">|</span>       <span class="pl-s"><span class="pl-pds">"</span>11^111=1111111<span class="pl-pds">"</span></span>,  <span class="pl-s"><span class="pl-pds">"</span>11^111=111111111<span class="pl-pds">"</span></span> <span class="pl-c"><span class="pl-c">//</span> should not match</span>
     <span class="pl-k">|</span>     )
grammar<span class="pl-k">:</span> exponent

input<span class="pl-k">:</span><span class="pl-c1">11</span>^<span class="pl-c1">111</span><span class="pl-k">=</span><span class="pl-c1">11111111</span>
matched to <span class="pl-c1">11</span>^<span class="pl-c1">111</span><span class="pl-k">=</span><span class="pl-c1">11111111</span>

input<span class="pl-k">:</span><span class="pl-c1">11</span>^<span class="pl-k">=</span><span class="pl-c1">1</span>
matched to <span class="pl-c1">11</span>^<span class="pl-k">=</span><span class="pl-c1">1</span>

input<span class="pl-k">:</span><span class="pl-c1">1</span>^<span class="pl-c1">11</span><span class="pl-k">=</span><span class="pl-c1">1</span>
matched to <span class="pl-c1">1</span>^<span class="pl-c1">11</span><span class="pl-k">=</span><span class="pl-c1">1</span>

input<span class="pl-k">:</span>^<span class="pl-c1">11</span><span class="pl-k">=</span>
matched to ^<span class="pl-c1">11</span><span class="pl-k">=</span>

input<span class="pl-k">:</span><span class="pl-c1">11</span>^<span class="pl-c1">111</span><span class="pl-k">=</span><span class="pl-c1">1111111</span>
not matched to <span class="pl-c1">11</span>^<span class="pl-c1">111</span><span class="pl-k">=</span><span class="pl-c1">1111111</span>

input<span class="pl-k">:</span><span class="pl-c1">11</span>^<span class="pl-c1">111</span><span class="pl-k">=</span><span class="pl-c1">111111111</span>
not matched to <span class="pl-c1">11</span>^<span class="pl-c1">111</span><span class="pl-k">=</span><span class="pl-c1">111111111</span>
</pre>
  </div> 
  <div class="highlight highlight-source-scala">
   <pre>scala<span class="pl-k">&gt;</span>     tryGrammar(
     <span class="pl-k">|</span>       <span class="pl-s"><span class="pl-pds">"</span>identifier<span class="pl-pds">"</span></span>,
     <span class="pl-k">|</span>       <span class="pl-s"><span class="pl-pds">"""</span>S = [a-zA-Z_][a-zA-Z0-9_]*;<span class="pl-pds">"""</span></span>,
     <span class="pl-k">|</span>       <span class="pl-s"><span class="pl-pds">"</span>hoge<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>hoge1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>foo1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>1foo<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>2hoge<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>123<span class="pl-pds">"</span></span>
     <span class="pl-k">|</span>     )
grammar<span class="pl-k">:</span> identifier

input<span class="pl-k">:</span>hoge
matched to hoge

input<span class="pl-k">:</span>foo
matched to foo

input<span class="pl-k">:</span>hoge1
matched to hoge1

input<span class="pl-k">:</span>foo1
matched to foo1

input<span class="pl-k">:</span>1foo
not matched to 1foo

input<span class="pl-k">:</span>2hoge
not matched to 2hoge

input<span class="pl-k">:</span><span class="pl-c1">123</span>
not matched to <span class="pl-c1">123</span>
</pre>
  </div> 
  <div class="highlight highlight-source-scala">
   <pre>scala<span class="pl-k">&gt;</span>     tryGrammar(
     <span class="pl-k">|</span>       <span class="pl-s"><span class="pl-pds">"</span>string macro<span class="pl-pds">"</span></span>,
     <span class="pl-k">|</span>       <span class="pl-s"><span class="pl-pds">"""</span></span>
<span class="pl-s">     |       |S = STRING;</span>
<span class="pl-s">     |       |STRING = STRING_MACRO("\"") / STRING_MACRO("'");</span>
<span class="pl-s">     |       |STRING_MACRO(Q) = Q (!(Q / "<span class="pl-cce">\\</span>") . / "<span class="pl-cce">\\</span>" .)* Q;<span class="pl-pds">"""</span></span>.stripMargin,
     <span class="pl-k">|</span>       <span class="pl-s"><span class="pl-pds">"</span>'foo'<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>'foo<span class="pl-pds">"</span></span>
     <span class="pl-k">|</span>     )
grammar<span class="pl-k">:</span> string macro

input<span class="pl-k">:</span><span class="pl-c1">'<span class="pl-ii">foo</span>'</span>
matched to <span class="pl-c1">'<span class="pl-ii">foo</span>'</span>

input<span class="pl-k">:</span><span class="pl-en">'foo</span>
not matched to <span class="pl-en">'foo</span>
</pre>
  </div> 
 </article>
</div>