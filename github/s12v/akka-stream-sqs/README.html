<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <p><a href="https://travis-ci.org/s12v/akka-stream-sqs" target="_blank"><img src="https://camo.githubusercontent.com/2ac6cbc0d36b41bffe102c81f77bd4c360321df9/68747470733a2f2f7472617669732d63692e6f72672f733132762f616b6b612d73747265616d2d7371732e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/s12v/akka-stream-sqs.svg?branch=master" style="max-width:100%;"></a> <a href="http://search.maven.org/#search%7Cga%7C1%7Ca%3A%22akka-stream-sqs_2.11%22" target="_blank"><img src="https://camo.githubusercontent.com/876309af6005d3d8a94c87893b10aa59f1d77f74/68747470733a2f2f696d672e736869656c64732e696f2f6d6176656e2d63656e7472616c2f762f6d652e736e6f762f616b6b612d73747265616d2d7371735f322e31312e7376673f6d61784167653d32353932303030" alt="Maven Central" data-canonical-src="https://img.shields.io/maven-central/v/me.snov/akka-stream-sqs_2.11.svg?maxAge=2592000" style="max-width:100%;"></a> <a href="https://codecov.io/gh/s12v/akka-stream-sqs" target="_blank"><img src="https://camo.githubusercontent.com/7963f947fe919302faa5a2dff5a1d485ce154848/68747470733a2f2f636f6465636f762e696f2f67682f733132762f616b6b612d73747265616d2d7371732f6272616e63682f6d61737465722f67726170682f62616467652e737667" alt="codecov" data-canonical-src="https://codecov.io/gh/s12v/akka-stream-sqs/branch/master/graph/badge.svg" style="max-width:100%;"></a></p> 
  <h1><a id="user-content-akka-stream-sqs" class="anchor" href="https://github.com/s12v/akka-stream-sqs#akka-stream-sqs" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>akka-stream-sqs</h1> 
  <p>Reactive SQS implementation for <a href="http://doc.akka.io/docs/akka/current/scala/stream/" target="_blank">Akka streams</a> powered by <a href="http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/overview-summary.html" target="_blank">AWS SDK for Java</a></p> 
  <p>Available at Maven Central for Scala 2.11:</p> 
  <pre><code>libraryDependencies += "me.snov" % "akka-stream-sqs_2.11" % "0.1.0"
</code></pre> 
  <h2><a id="user-content-overview" class="anchor" href="https://github.com/s12v/akka-stream-sqs#overview" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Overview</h2> 
  <ul> 
   <li>Provides building blocks (partial graphs) for Akka streams integration with SQS</li> 
   <li>Based on AWS SDK for Java and operates with raw objects from the SDK</li> 
   <li>Lightweight, no unnecessary layers over AWS SDK</li> 
   <li>Supports Typesafe config</li> 
   <li>Consumer automatically reconnects on failure</li> 
   <li>Supports delayed message requeue</li> 
  </ul> 
  <h2><a id="user-content-quick-example" class="anchor" href="https://github.com/s12v/akka-stream-sqs#quick-example" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Quick example</h2> 
  <h3><a id="user-content-message-processing-with-acknowledgement" class="anchor" href="https://github.com/s12v/akka-stream-sqs#message-processing-with-acknowledgement" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Message processing with acknowledgement</h3> 
  <p>Read SQS configuration from config file, pull messages from the queue, process, and acknowledge. This stream listens for new messages and never stops.</p> 
  <pre><code>val sqsSettings = SqsSettings(system) // use existing ActorSystem
Source.fromGraph(SqsSourceShape(settings))
    .mapAsync(parallelism = 4)({ message: Message =&gt; Future {
        println(s"Processing ${message.getMessageId}")

        (message, Ack())
      }
    })
    .runWith(Sink.fromGraph(SqsAckSinkShape(settings)))
</code></pre> 
  <h3><a id="user-content-send-a-message" class="anchor" href="https://github.com/s12v/akka-stream-sqs#send-a-message" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Send a message</h3> 
  <p>Send "hello" to the queue and wait for result.</p> 
  <pre><code>val sqsSettings = SqsSettings(system) // use existing ActorSystem
val future = Source.single(new SendMessageRequest().withMessageBody("test"))
    .runWith(Sink.fromGraph(SqsPublishSinkShape(sqsSettings)))
Await.ready(future, 1.second)   
</code></pre> 
  <h2><a id="user-content-components" class="anchor" href="https://github.com/s12v/akka-stream-sqs#components" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Components</h2> 
  <h3><a id="user-content-sqssourceshape" class="anchor" href="https://github.com/s12v/akka-stream-sqs#sqssourceshape" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>SqsSourceShape</h3> 
  <ul> 
   <li>Type: Source</li> 
   <li>Emits <code>com.amazonaws.services.sqs.model.Message</code></li> 
  </ul> 
  <p>Infinite source of SQS messages. Only queries Amazon services when there's demand from upstream (i.e. all previous messages have been consumed). Messages are loaded in batches by <code>maxNumberOfMessages</code> and pushed one by one.</p> 
  <p>When SQS is not available, it tries to reconnect infinitely.</p> 
  <h3><a id="user-content-sqsacksinkshape" class="anchor" href="https://github.com/s12v/akka-stream-sqs#sqsacksinkshape" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>SqsAckSinkShape</h3> 
  <ul> 
   <li>Type: Sink</li> 
   <li>Accepts <code>(com.amazonaws.services.sqs.model.Message, MessageAction)</code></li> 
   <li>Materialized value: <code>Future[Done]</code></li> 
  </ul> 
  <p>Acknowledges processed messages. Completes with <code>Done</code> when all messages are processed or <code>Failure</code> on upstream failure.</p> 
  <p>Your flow must decide which action to take and push it with message:</p> 
  <ul> 
   <li><code>Ack</code> - delete message from the queue.</li> 
   <li><code>RequeueWithDelay(delaySeconds: Int)</code> - schedule a retry.</li> 
  </ul> 
  <h3><a id="user-content-sqspublishsinkshape" class="anchor" href="https://github.com/s12v/akka-stream-sqs#sqspublishsinkshape" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>SqsPublishSinkShape</h3> 
  <ul> 
   <li>Type: Sink</li> 
   <li>Accepts <code>com.amazonaws.services.sqs.model.SendMessageRequest</code></li> 
   <li>Materialized value: <code>Future[Done]</code></li> 
  </ul> 
  <p>Publishes messages to the Amazon service. Completes with <code>Done</code> when all messages are processed or <code>Failure</code> on upstream failure.</p> 
  <h3><a id="user-content-types" class="anchor" href="https://github.com/s12v/akka-stream-sqs#types" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Types</h3> 
  <p><code>akka-stream-sqs</code> uses raw types from AWS SDK when possible. </p> 
  <ul> 
   <li><code>SqsMessageWithAction</code> - alias for <code>(SqsMessage, MessageAction)</code></li> 
   <li><code>MessageActionPair</code> - either <code>Ack</code> which means "delete message" or <code>RequeueWithDelay(delaySeconds: Int)</code> which means "requeue and try later"</li> 
  </ul> 
  <h2><a id="user-content-configuration" class="anchor" href="https://github.com/s12v/akka-stream-sqs#configuration" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Configuration</h2> 
  <h3><a id="user-content-typesafe-configuration" class="anchor" href="https://github.com/s12v/akka-stream-sqs#typesafe-configuration" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Typesafe configuration</h3> 
  <p>If you provide <code>ActorSystem</code> to <code>SqsSettings</code>, it will read your configuration file:</p> 
  <pre><code>akka-stream-sqs {

  # QueueUrl
  #
  # The URL of the Amazon SQS queue to take action on.
  queue-url = "http://localhost:9324/queue/queue1"

  # MaxNumberOfMessages
  #
  # The maximum number of messages to return. Amazon SQS never returns more messages than this value
  # but may return fewer. Values can be from 1 to 10.
  # Default: 10
  max-number-of-messages = 10

  # WaitTimeSeconds
  #
  # The duration (in seconds) for which the call will wait for a message to arrive in the queue
  # before returning. If a message is available, the call will return sooner than WaitTimeSeconds.
  # Default: 10
  wait-time-seconds = 10

  # VisibilityTimeout
  #
  # The duration (in seconds) that the received messages are hidden from subsequent retrieve requests
  # after being retrieved by a ReceiveMessage request.
  # Optional
  # visibility-timeout = 60

  # AWS endpoint override.
  #
  # Optional
  # endpoint = "http://localhost:9324/"

}
</code></pre> 
  <h3><a id="user-content-sqssettings" class="anchor" href="https://github.com/s12v/akka-stream-sqs#sqssettings" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>SqsSettings</h3> 
  <p>Wrapper for AWS SDK settings. You can override client and its configuration, credentials provider, and queue options.</p> 
  <ul> 
   <li><code>awsClient</code> - <code>AmazonSQSAsync</code>, by default, <code>AmazonSQSAsyncClient</code> is used</li> 
   <li><code>awsCredentialsProvider</code> - <code>AWSCredentialsProvider</code>, by default <a href="http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/auth/DefaultAWSCredentialsProviderChain.html" target="_blank"><code>DefaultAWSCredentialsProviderChain</code></a> is used</li> 
   <li><code>awsClientConfiguration</code> - <code>ClientConfiguration</code>, by default <code>ClientConfiguration</code></li> 
   <li><code>queueUrl</code> - The URL of the Amazon SQS queue to take action on. Queue URLs are case-sensitive.</li> 
   <li><code>maxNumberOfMessages</code> - The maximum number of messages to return. Amazon SQS never returns more messages than this value but may return fewer. Values can be from 1 to 10. Default is 1. All of the messages are not necessarily returned. Default is <code>10</code></li> 
   <li><code>waitTimeSeconds</code> - The duration (in seconds) for which the call will wait for a message to arrive in the queue before returning. If a message is available, the call will return sooner than WaitTimeSeconds. Default is '10'</li> 
   <li><code>visibilityTimeout</code> - The duration (in seconds) that the received messages are hidden from subsequent retrieve requests after being retrieved by a ReceiveMessage request.</li> 
  </ul> 
  <p>For more information, please refer to <a href="http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/overview-summary.html" target="_blank">AWS SDK for Java</a></p> 
 </article>
</div>