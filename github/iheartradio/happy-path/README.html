<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <p><a href="https://travis-ci.org/iheartradio/happy-path" target="_blank"><img src="https://camo.githubusercontent.com/9c81ed97f5edea2ca46d73875124b54f626c2408/68747470733a2f2f7472617669732d63692e6f72672f696865617274726164696f2f68617070792d706174682e737667" alt="Build Status" data-canonical-src="https://travis-ci.org/iheartradio/happy-path.svg" style="max-width:100%;"></a> <a href="https://www.codacy.com/app/iheartradio/happy-path" target="_blank"><img src="https://camo.githubusercontent.com/65fd4a274219235e3b17d1006259b19b83983621/68747470733a2f2f6170692e636f646163792e636f6d2f70726f6a6563742f62616467652f67726164652f3439386132383364656230633433353262623334393733386263333231393365" alt="Codacy Badge" data-canonical-src="https://api.codacy.com/project/badge/grade/498a283deb0c4352bb349738bc32193e" style="max-width:100%;"></a> <a href="https://www.codacy.com/app/iheartradio/happy-path" target="_blank"><img src="https://camo.githubusercontent.com/8e9847b3754646869245dda2626a8e223c831b0c/68747470733a2f2f6170692e636f646163792e636f6d2f70726f6a6563742f62616467652f636f7665726167652f3439386132383364656230633433353262623334393733386263333231393365" alt="Codacy Badge" data-canonical-src="https://api.codacy.com/project/badge/coverage/498a283deb0c4352bb349738bc32193e" style="max-width:100%;"></a> <a href="https://bintray.com/iheartradio/maven/happy-path/_latestVersion" target="_blank"> <img src="https://camo.githubusercontent.com/fb0dfdec6aa548b9619e906f3f43a109f28d2aca/68747470733a2f2f6170692e62696e747261792e636f6d2f7061636b616765732f696865617274726164696f2f6d6176656e2f68617070792d706174682f696d616765732f646f776e6c6f61642e737667" alt="Download" data-canonical-src="https://api.bintray.com/packages/iheartradio/maven/happy-path/images/download.svg" style="max-width:100%;"> </a></p> 
  <h1><a id="user-content-happypath" class="anchor" href="https://github.com/iheartradio/happy-path#happypath" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>HappyPath</h1> 
  <h2><a id="user-content-futureeither" class="anchor" href="https://github.com/iheartradio/happy-path#futureeither" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>FutureEither</h2> 
  <p><code>FutureEither</code> is to unify <code>Future</code>s of different types (e.g., <code>Future[T]</code>, <code>Future[Option[T]]</code>, <code>Future[Try[T]]</code>, <code>Future[Boolean]</code>). It can be seen as a wrapper around <code>Future[Either[_, _]]</code>, where the <code>Right</code> side of the <code>Either</code> is the successful result <code>T</code> and the <code>Left</code> side is a <code>Reason</code> explaining why the computation failed.</p> 
  <h3><a id="user-content-example-usage" class="anchor" href="https://github.com/iheartradio/happy-path#example-usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Example usage</h3> 
  <p>To use <code>FutureEither</code>, it's recommended to use the wildcard import,</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.iheart.happy.path.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">com.iheart.happy.path.FutureEither.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">concurrent.</span>{<span class="pl-v">Future</span>, <span class="pl-v">duration</span>}<span class="pl-v">, </span><span class="pl-v">duration.</span><span class="pl-v">_</span></pre>
  </div> 
  <p>This provides all the instances needed for things such as <code>map</code>/<code>flatMap</code> (otherwise you might see various <code>could not find implicit value</code> compilation errors).</p> 
  <p>Once imported, you can use various helpers:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">scala.util.</span><span class="pl-v">Success</span>

<span class="pl-c">// The expressions below each yield a `FutureEither[Int]` containing a `Right(1)`</span>
<span class="pl-k">val</span> <span class="pl-en">f1</span> <span class="pl-k">=</span> right(<span class="pl-c1">1</span>)
<span class="pl-k">val</span> <span class="pl-en">f2</span> <span class="pl-k">=</span> ofFuture(<span class="pl-en">Future</span>.successful(<span class="pl-c1">1</span>))
<span class="pl-k">val</span> <span class="pl-en">f3</span> <span class="pl-k">=</span> ofTry(<span class="pl-en">Success</span>(<span class="pl-c1">1</span>))
<span class="pl-k">val</span> <span class="pl-en">f4</span> <span class="pl-k">=</span> ofOption(<span class="pl-en">Some</span>(<span class="pl-c1">1</span>))
<span class="pl-k">val</span> <span class="pl-en">f5</span> <span class="pl-k">=</span> ofFutureOption(<span class="pl-en">Future</span>.successful(<span class="pl-en">Some</span>(<span class="pl-c1">1</span>)))

<span class="pl-c">// If we wanted to add some of these futures together:</span>
<span class="pl-k">val</span> <span class="pl-en">f123</span> <span class="pl-k">=</span> <span class="pl-k">for</span> {
  v1 <span class="pl-k">&lt;</span><span class="pl-k">-</span> f1
  v2 <span class="pl-k">&lt;</span><span class="pl-k">-</span> f2
  v3 <span class="pl-k">&lt;</span><span class="pl-k">-</span> f3
} <span class="pl-k">yield</span> v1 <span class="pl-k">+</span> v2 <span class="pl-k">+</span> v3</pre>
  </div> 
  <div class="highlight highlight-source-scala">
   <pre>scala<span class="pl-k">&gt;</span> <span class="pl-k">import</span> <span class="pl-v">concurrent.</span><span class="pl-v">Await </span><span class="pl-c">//only to show result, don't use Await in real code</span>
<span class="pl-k">import</span> <span class="pl-v">concurrent.</span><span class="pl-v">Await</span>

scala<span class="pl-k">&gt;</span> <span class="pl-en">Await</span>.result(f123.toEither, <span class="pl-c1">10.</span>seconds)
res4<span class="pl-k">:</span> <span class="pl-en">Either</span>[com.iheart.happy.path.<span class="pl-en">Reason</span>,<span class="pl-k">Int</span>] <span class="pl-k">=</span> <span class="pl-en">Right</span>(<span class="pl-c1">3</span>)</pre>
  </div> 
  <p><code>f123</code> is a <code>FutureEither[Int]</code> containing the results of <code>f1</code>, <code>f2</code>, <code>f3</code> added together (3).</p> 
  <p>Now let's say somewhere we encounter a failure:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">failedF</span><span class="pl-k">:</span> <span class="pl-en">FutureEither</span>[<span class="pl-k">Int</span>] <span class="pl-k">=</span> left(<span class="pl-en">RegularReason</span>(<span class="pl-s"><span class="pl-pds">"</span>Something happened<span class="pl-pds">"</span></span>))

<span class="pl-k">val</span> <span class="pl-en">f45</span> <span class="pl-k">=</span> <span class="pl-k">for</span> {
  v4 <span class="pl-k">&lt;</span><span class="pl-k">-</span> f4
  failed <span class="pl-k">&lt;</span><span class="pl-k">-</span> failedF
  v5 <span class="pl-k">&lt;</span><span class="pl-k">-</span> f5
} <span class="pl-k">yield</span> v4 <span class="pl-k">+</span> v5</pre>
  </div> 
  <div class="highlight highlight-source-scala">
   <pre>scala<span class="pl-k">&gt;</span> <span class="pl-en">Await</span>.result(f45.toEither, <span class="pl-c1">10.</span>seconds) <span class="pl-c">//again don't do Await in real code</span>
res7<span class="pl-k">:</span> <span class="pl-en">Either</span>[com.iheart.happy.path.<span class="pl-en">Reason</span>,<span class="pl-k">Int</span>] <span class="pl-k">=</span> <span class="pl-en">Left</span>(com.iheart.happy.path.<span class="pl-en">RegularReason</span>)</pre>
  </div> 
  <p>The result of <code>f45</code> is a failed <code>FutureEither[Int]</code> containing a <code>Left[RegularReason[String]]</code>.</p> 
  <p>Some other usage examples can be found in <a href="https://github.com/iheartradio/poweramp-common/blob/master/lib/src/test/scala/com/iheart/poweramp/common/functional/FutureEitherSpec.scala" target="_blank">the tests</a>.</p> 
  <h3><a id="user-content-reason" class="anchor" href="https://github.com/iheartradio/happy-path#reason" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Reason</h3> 
  <p>When a <code>FutureEither</code> fails, usually the reason for failure needs to be propagated back to the client, or matched to figure out how to recover from it. Poweramp defines the following <code>Reason</code>s for failure:</p> 
  <h3><a id="user-content-exceptionreason" class="anchor" href="https://github.com/iheartradio/happy-path#exceptionreason" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>ExceptionReason</code></h3> 
  <p>When the underlying <code>Future</code> fails because of an exception:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">failedF</span> <span class="pl-k">=</span> <span class="pl-en">Future</span>.failed(<span class="pl-k">new</span> <span class="pl-en">RuntimeException</span>(<span class="pl-s"><span class="pl-pds">"</span>Something happened<span class="pl-pds">"</span></span>))
<span class="pl-k">val</span> <span class="pl-en">failedFE</span> <span class="pl-k">=</span> ofFuture(failedF)</pre>
  </div> 
  <p>In the above example, <code>failedFE</code> is a <code>FutureEither</code> containing a <code>Left[ExceptionReason[RuntimeException]]</code>. This will be propagated to the client as a 500 error.</p> 
  <h4><a id="user-content-optionalitemnotfound--itemnotfound" class="anchor" href="https://github.com/iheartradio/happy-path#optionalitemnotfound--itemnotfound" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>OptionalItemNotFound</code> / <code>ItemNotFound</code></h4> 
  <p>There are two different cases we want to handle when an optional item returns <code>None</code>.</p> 
  <p>If it's a requested resource that makes sense to be absent (for example, user requests a track ID that doesn't exist in the database) we use <code>OptionalItemNotFound</code> to propagate the error as a 404.</p> 
  <p>Otherwise, if it's an internal error (some essential resource that we expect to exist, but doesn't), we use <code>ItemNotFound</code>, which will propagate as a 500 error.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">opt</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-k">Int</span>] <span class="pl-k">=</span> <span class="pl-c1">None</span>
<span class="pl-k">val</span> <span class="pl-en">optFE1</span> <span class="pl-k">=</span> ofOptional(opt)
<span class="pl-k">val</span> <span class="pl-en">optFE2</span> <span class="pl-k">=</span> ofOption(opt)

<span class="pl-k">val</span> <span class="pl-en">optF</span> <span class="pl-k">=</span> <span class="pl-en">Future</span>.successful(opt)
<span class="pl-k">val</span> <span class="pl-en">optFE3</span> <span class="pl-k">=</span> ofFutureOptional(optF, <span class="pl-en">OptionalItemNotFound</span>(<span class="pl-s"><span class="pl-pds">"</span>This thing not found<span class="pl-pds">"</span></span>))
<span class="pl-k">val</span> <span class="pl-en">optFE4</span> <span class="pl-k">=</span> ofFutureOption(optF)</pre>
  </div> 
  <p>In the above example, <code>optFE1</code> and <code>optFE3</code> are equivalent, and both contain a <code>Left[OptionalItemNotFound]</code>. <code>optFE2</code> and <code>optFE4</code> are equivalent, and both contain a <code>Left[ItemNotFound]</code>.</p> 
  <h4><a id="user-content-validationreason" class="anchor" href="https://github.com/iheartradio/happy-path#validationreason" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>ValidationReason</code></h4> 
  <p>If the user provides invalid input, we want to return a list of all the validation errors.</p> 
  <p>TODO</p> 
  <h4><a id="user-content-regularreason" class="anchor" href="https://github.com/iheartradio/happy-path#regularreason" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a><code>RegularReason</code></h4> 
  <p>For computations that fail for inconsequential reasons (usually internal), we use <code>RegularReason</code> to avoid logging them.</p> 
 </article>
</div>