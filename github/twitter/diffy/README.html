<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-diffy" class="anchor" href="https://github.com/twitter/diffy#diffy" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Diffy</h1> 
  <p><a href="https://travis-ci.org/twitter/diffy" target="_blank"><img src="https://camo.githubusercontent.com/fde4868289b53ee7cbaab3ae25d9dad54b776d70/68747470733a2f2f696d672e736869656c64732e696f2f7472617669732f747769747465722f64696666792f6d61737465722e737667" alt="Build status" data-canonical-src="https://img.shields.io/travis/twitter/diffy/master.svg" style="max-width:100%;"></a> <a href="https://codecov.io/github/twitter/diffy" target="_blank"><img src="https://camo.githubusercontent.com/4ee290a25d6e57801131acf94b7b412fdebd81f8/68747470733a2f2f696d672e736869656c64732e696f2f636f6465636f762f632f6769746875622f747769747465722f64696666792f6d61737465722e737667" alt="Coverage status" data-canonical-src="https://img.shields.io/codecov/c/github/twitter/diffy/master.svg" style="max-width:100%;"></a> <a href="https://github.com/twitter/diffy#status" target="_blank"><img src="https://camo.githubusercontent.com/8ed5ef79fffe4effb5533ff9c3fcb88f647c10c3/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f7374617475732d6163746976652d627269676874677265656e2e737667" alt="Project status" data-canonical-src="https://img.shields.io/badge/status-active-brightgreen.svg" style="max-width:100%;"></a> <a href="https://gitter.im/twitter/diffy" target="_blank"><img src="https://camo.githubusercontent.com/9b52186233ef85483f5c65b95243444e9392be66/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6769747465722d6a6f696e253230636861742d677265656e2e737667" alt="Gitter" data-canonical-src="https://img.shields.io/badge/gitter-join%20chat-green.svg" style="max-width:100%;"></a> <a href="https://maven-badges.herokuapp.com/maven-central/com.twitter/diffy_2.11" target="_blank"><img src="https://camo.githubusercontent.com/fff5b7c3b71fb1efd46e19a4197bfb1efaadc0c6/68747470733a2f2f696d672e736869656c64732e696f2f6d6176656e2d63656e7472616c2f762f636f6d2e747769747465722f64696666795f322e31312e737667" alt="Maven Central" data-canonical-src="https://img.shields.io/maven-central/v/com.twitter/diffy_2.11.svg" style="max-width:100%;"></a></p> 
  <h2><a id="user-content-status" class="anchor" href="https://github.com/twitter/diffy#status" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Status</h2> 
  <p>This project is used in production at Twitter and is being actively developed and maintained. Feel free to contact us on gitter or <a href="https://twitter.com/diffyproject" target="_blank">@diffyproject</a>.</p> 
  <h2><a id="user-content-what-is-diffy" class="anchor" href="https://github.com/twitter/diffy#what-is-diffy" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>What is Diffy?</h2> 
  <p>Diffy finds potential bugs in your service using running instances of your new code and your old code side by side. Diffy behaves as a proxy and multicasts whatever requests it receives to each of the running instances. It then compares the responses, and reports any regressions that may surface from those comparisons. The premise for Diffy is that if two implementations of the service return “similar” responses for a sufficiently large and diverse set of requests, then the two implementations can be treated as equivalent and the newer implementation is regression-free.</p> 
  <h2><a id="user-content-how-does-diffy-work" class="anchor" href="https://github.com/twitter/diffy#how-does-diffy-work" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>How does Diffy work?</h2> 
  <p>Diffy acts as a proxy that accepts requests drawn from any source that you provide and multicasts each of those requests to three different service instances:</p> 
  <ol> 
   <li>A candidate instance running your new code</li> 
   <li>A primary instance running your last known-good code</li> 
   <li>A secondary instance running the same known-good code as the primary instance</li> 
  </ol> 
  <p>As Diffy receives a request, it is multicast and sent to your candidate, primary, and secondary instances. When those services send responses back, Diffy compares those responses and looks for two things:</p> 
  <ol> 
   <li>Raw differences observed between the candidate and primary instances.</li> 
   <li>Non-deterministic noise observed between the primary and secondary instances. Since both of these instances are running known-good code, you should expect responses to be in agreement. If not, your service may have non-deterministic behavior, which is to be expected.</li> 
  </ol> 
  <p>Diffy measures how often primary and secondary disagree with each other vs. how often primary and candidate disagree with each other. If these measurements are roughly the same, then Diffy determines that there is nothing wrong and that the error can be ignored.</p> 
  <h2><a id="user-content-how-to-get-started" class="anchor" href="https://github.com/twitter/diffy#how-to-get-started" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>How to get started?</h2> 
  <p>First, you need to build Diffy by invoking <code>./sbt assembly</code> from your diffy directory. This will create a diffy jar at <code>diffy/target/scala-2.11/diffy-server.jar</code>.</p> 
  <p>Diffy comes bundled with an example.sh script that you can run to start comparing examples instances we have already deployed online. Once your local Diffy instance is deployed, you send it a few requests via <code>curl --header "Canonical-Resource: Html" localhost:8880</code> and <code>curl --header "Canonical-Resource: Json" localhost:8880/json</code>. You can then go to your browser at <a href="http://localhost:8888" target="_blank">http://localhost:8888</a> to see what the differences across our example instances look like.</p> 
  <p>That was cool but now you want to compare old and new versions of your own service. Here’s how you can start using Diffy to compare three instances of your service:</p> 
  <ol> 
   <li> <p>Deploy your old code to <code>localhost:9990</code>. This is your primary.</p> </li> 
   <li> <p>Deploy your old code to <code>localhost:9991</code>. This is your secondary.</p> </li> 
   <li> <p>Deploy your new code to <code>localhost:9992</code>. This is your candidate.</p> </li> 
   <li> <p>Download the latest Diffy binary or build your own from the code.</p> </li> 
   <li> <p>Run the Diffy jar with following command line arguments:</p> <pre><code>java -jar diffy-server.jar \
-candidate=localhost:9992 \
-master.primary=localhost:9990 \
-master.secondary=localhost:9991 \
-service.protocol=http \
-serviceName=My-Service \
-proxy.port=:31900 \
-admin.port=:31159 \
-http.port=:31149 \
-rootUrl='localhost:31149'
</code></pre> </li> 
   <li> <p>Send a few test requests to your Diffy instance on its proxy port:</p> <pre><code>curl localhost:31900/your/application/route?with=queryparams
</code></pre> </li> 
   <li> <p>Watch the differences show up in your browser at <a href="http://localhost:31149" target="_blank">http://localhost:31149</a>.</p> </li> 
  </ol> 
  <h3><a id="user-content-running-example-on-docker-compose" class="anchor" href="https://github.com/twitter/diffy#running-example-on-docker-compose" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Running example on docker-compose</h3> 
  <p>Inside the example directory you will find instructions to run a complete example with apis and diffy configured and ready to run using docker-compose.</p> 
  <h2><a id="user-content-faqs" class="anchor" href="https://github.com/twitter/diffy#faqs" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>FAQ's</h2> 
  <p>For safety reasons <code>POST</code>, <code>PUT</code>, <code>DELETE</code> are ignored by default . Add <code>-allowHttpSideEffects=true</code> to your command line arguments to enable these verbs.</p> 
  <h2><a id="user-content-license" class="anchor" href="https://github.com/twitter/diffy#license" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>License</h2> 
  <p>Licensed under the <strong><a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank">Apache License, Version 2.0</a></strong> (the "License"); you may not use this software except in compliance with the License.</p> 
  <p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p> 
 </article>
</div>