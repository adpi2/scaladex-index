<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <p><a href="https://github.com/finagle/roc/blob/master/roc-logo.png?raw=true" target="_blank"><img src="https://github.com/finagle/roc/raw/master/roc-logo.png?raw=true" alt="Roc Logo" title="Roc Logo" style="max-width:100%;"></a></p> 
  <p>roc is a modern <a href="http://twitter.github.io/finagle/guide/" target="_blank">Finagle</a> <a href="http://www.postgresql.org/" target="_blank">Postgresql</a> <a href="http://twitter.github.io/finagle/guide/Clients.html" target="_blank">Client</a>. What's modern? A Client relying on a <a href="http://twitter.github.io/finagle/guide/changelog.html" target="_blank">6.x +</a> version of Finagle.</p> 
  <h2><a id="user-content-badges" class="anchor" href="https://github.com/finagle/roc#badges" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Badges</h2> 
  <p><a href="https://github.com/finagle/roc/blob/master" target="_blank"><img src="https://camo.githubusercontent.com/a1b492a1daa1faa5fec0edd2e95db5c2ef34694f/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f446a616e676f2e7376673f7374796c653d706c6173746963" alt="PyPI" data-canonical-src="https://img.shields.io/pypi/l/Django.svg?style=plastic" style="max-width:100%;"></a> <a href="https://maven-badges.herokuapp.com/maven-central/com.github.finagle/roc-core_2.11" target="_blank"><img src="https://camo.githubusercontent.com/943fbfd3d27dc6d7f4add0f72215aba7180ae30e/68747470733a2f2f696d672e736869656c64732e696f2f6d6176656e2d63656e7472616c2f762f636f6d2e6769746875622e66696e61676c652f726f632d636f72655f322e31312e7376673f7374796c653d706c6173746963" alt="Maven Central" data-canonical-src="https://img.shields.io/maven-central/v/com.github.finagle/roc-core_2.11.svg?style=plastic" style="max-width:100%;"></a> <a href="https://codecov.io/github/finagle/roc?branch=master" target="_blank"><img src="https://camo.githubusercontent.com/29f36860dd0d1bba378498cbbb6b15bf589acf26/68747470733a2f2f696d672e736869656c64732e696f2f636f6465636f762f632f6769746875622f66696e61676c652f726f632f6d61737465722e7376673f7374796c653d706c6173746963" alt="Codecov branch" data-canonical-src="https://img.shields.io/codecov/c/github/finagle/roc/master.svg?style=plastic" style="max-width:100%;"></a> <a href="https://circleci.com/gh/finagle/roc/tree/master" target="_blank"><img src="https://camo.githubusercontent.com/a1fc2ff735e4931b005dfff547059a18fdd06ce5/68747470733a2f2f696d672e736869656c64732e696f2f636972636c6563692f70726f6a6563742f66696e61676c652f726f632f6d61737465722e7376673f7374796c653d706c6173746963" alt="CircleCI branch" data-canonical-src="https://img.shields.io/circleci/project/finagle/roc/master.svg?style=plastic" style="max-width:100%;"></a> <a href="https://gitter.im/finagle/roc?" target="_blank"><img src="https://camo.githubusercontent.com/622a787047f84cbe65972aca62e8a6c83fdcb459/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6769747465722d6a6f696e253230636861742d677265656e2e7376673f7374796c653d706c6173746963" alt="Gitter" data-canonical-src="https://img.shields.io/badge/gitter-join%20chat-green.svg?style=plastic" style="max-width:100%;"></a></p> 
  <h2><a id="user-content-tldr" class="anchor" href="https://github.com/finagle/roc#tldr" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>tl;dr</h2> 
  <p>Roc is published to <a href="http://search.maven.org/" target="_blank">Maven Central</a>, so for the latest stable version add the following to your build:</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">++</span><span class="pl-k">=</span> <span class="pl-en">Seq</span>(
  <span class="pl-s"><span class="pl-pds">"</span>com.github.finagle<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>roc-core<span class="pl-pds">"</span></span>  <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.0.4<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>com.github.finagle<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>roc-types<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.0.4<span class="pl-pds">"</span></span>
)</pre>
  </div> 
  <p>Roc is under heavy development, so to stay up to with the latest <code>SNAPSHOT</code> version add the following to your build instead:</p> 
  <div class="highlight highlight-source-scala">
   <pre>resolvers <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-en">Resolver</span>.sonatypeRepo(<span class="pl-s"><span class="pl-pds">"</span>snapshots<span class="pl-pds">"</span></span>)

libraryDependencies <span class="pl-k">++</span><span class="pl-k">=</span> <span class="pl-en">Seq</span>(
  <span class="pl-s"><span class="pl-pds">"</span>com.github.finagle<span class="pl-pds">"</span></span>  <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>roc-core<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.0.5-SNAPSHOT<span class="pl-pds">"</span></span> changing()
)</pre>
  </div> 
  <p>Open <code>sbt console</code> and insert the following</p> 
  <div class="highlight highlight-source-scala">
   <pre>scala <span class="pl-k">&gt;</span> <span class="pl-k">:</span>paste
<span class="pl-k">import</span> <span class="pl-v">com.twitter.util.</span><span class="pl-v">Await</span>
<span class="pl-k">import</span> <span class="pl-v">roc.</span><span class="pl-v">Postgresql</span>
<span class="pl-k">import</span> <span class="pl-v">roc.postgresql.</span>{<span class="pl-v">Request</span>, <span class="pl-v">Row</span>}

<span class="pl-k">val</span> <span class="pl-en">client</span> <span class="pl-k">=</span> <span class="pl-en">Postgresql</span>.client
  .withUserAndPasswd(<span class="pl-s"><span class="pl-pds">"</span>username<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>password<span class="pl-pds">"</span></span>)
  .withDatabase(<span class="pl-s"><span class="pl-pds">"</span>database<span class="pl-pds">"</span></span>)
  .newRichClient(<span class="pl-s"><span class="pl-pds">"</span>inet!localhost:5432<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">req</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Request</span>(<span class="pl-s"><span class="pl-pds">"</span>SELECT * FROM STATES;<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">result</span> <span class="pl-k">=</span> <span class="pl-en">Await</span>.result(client.query(req))
result<span class="pl-k">:</span> roc.postgresql.<span class="pl-en">Result</span> <span class="pl-k">=</span> <span class="pl-en">Result</span>(<span class="pl-en">Text</span>(<span class="pl-en">'id</span>,<span class="pl-c1">23</span>,<span class="pl-c1">1</span>)<span class="pl-en">Text</span>(<span class="pl-en">'name</span>,<span class="pl-c1">25</span>,<span class="pl-en">Alabama</span>)<span class="pl-en">Text</span>(<span class="pl-en">'abbrv</span>,<span class="pl-c1">1043</span>,<span class="pl-en">AL</span>), <span class="pl-en">Text</span>(<span class="pl-en">'id</span>,<span class="pl-c1">23</span>,<span class="pl-c1">2</span>)...)</pre>
  </div> 
  <p>Let's turn a <code>Result</code> into all 50 <code>State(s)</code>.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">java.time.</span><span class="pl-v">ZonedDateTime</span>
<span class="pl-k">import</span> <span class="pl-v">roc.types.decoders.</span><span class="pl-v">_</span>

<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">State</span>(<span class="pl-v">id</span>: <span class="pl-k">Int</span>, <span class="pl-v">name</span>: <span class="pl-k">String</span>, <span class="pl-v">abbrv</span>: <span class="pl-k">String</span>, <span class="pl-v">insertedAt</span>: <span class="pl-en">ZonedDateTime</span>)
<span class="pl-k">val</span> <span class="pl-en">row2State</span><span class="pl-k">:</span> (<span class="pl-en">Row</span>) <span class="pl-k">=&gt;</span> (<span class="pl-en">State</span>) <span class="pl-k">=</span> (<span class="pl-v">row</span>: <span class="pl-en">Row</span>) <span class="pl-k">=&gt;</span> {
  <span class="pl-k">val</span> <span class="pl-en">id</span> <span class="pl-k">=</span> row.get(<span class="pl-en">'id</span>).as[<span class="pl-k">Int</span>]
  <span class="pl-k">val</span> <span class="pl-en">name</span> <span class="pl-k">=</span> row.get(<span class="pl-en">'name</span>).as[<span class="pl-k">String</span>]
  <span class="pl-k">val</span> <span class="pl-en">abbrv</span> <span class="pl-k">=</span> row.get(<span class="pl-en">'abbrv</span>).as[<span class="pl-k">String</span>]
  <span class="pl-k">val</span> <span class="pl-en">insertedAt</span> <span class="pl-k">=</span> row.get(<span class="pl-en">'inserted_at</span>).as[<span class="pl-en">TimestampWithTZ</span>]
  <span class="pl-en">State</span>(id, name, abbrv, insertedAt)
}
<span class="pl-k">val</span> <span class="pl-en">states</span> <span class="pl-k">=</span> result.map(row2State).toList
states<span class="pl-k">:</span> <span class="pl-en">List</span>[<span class="pl-en">State</span>] <span class="pl-k">=</span> <span class="pl-en">List</span>(<span class="pl-en">State</span>(<span class="pl-c1">1</span>,<span class="pl-en">Alabama</span>,<span class="pl-en">AL</span>,<span class="pl-c1">2016</span><span class="pl-k">-</span><span class="pl-c1">05</span><span class="pl-k">-</span>10T11<span class="pl-k">:</span><span class="pl-c1">59</span><span class="pl-k">:</span><span class="pl-c1">13.879709</span><span class="pl-k">-</span><span class="pl-c1">05</span><span class="pl-k">:</span><span class="pl-c1">00</span>), <span class="pl-en">State</span>(<span class="pl-c1">2</span>,<span class="pl-en">Alaska</span>,<span class="pl-en">AK</span>,<span class="pl-c1">2016</span><span class="pl-k">-</span><span class="pl-c1">05</span><span class="pl-k">-</span>10T11<span class="pl-k">:</span><span class="pl-c1">59</span><span class="pl-k">:</span><span class="pl-c1">20.974995</span><span class="pl-k">-</span><span class="pl-c1">05</span><span class="pl-k">:</span><span class="pl-c1">00</span>))</pre>
  </div> 
  <p>If you're into Scaladocs ( I am ), they can be found <a href="http://finagle.github.io/roc/docs/" target="_blank">here</a>.</p> 
  <h2><a id="user-content-tell-me-about-result" class="anchor" href="https://github.com/finagle/roc#tell-me-about-result" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Tell me about Result</h2> 
  <p>The most important type in Roc is <a href="http://finagle.github.io/roc/docs/#roc.postgresql.Result" target="_blank">Result</a>, the type returned after a Postgresql query is executed. Result implements <a href="http://www.scala-lang.org/api/current/#scala.collection.Iterable" target="_blank">Iterable</a> so that it can be viewed as a collection of <a href="http://finagle.github.io/roc/docs/#roc.postgresql.Row" target="_blank">Rows</a>. The two additional members of <code>Result</code> are:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">result</span> <span class="pl-k">=</span> client.query(<span class="pl-k">new</span> <span class="pl-en">Request</span>(<span class="pl-s"><span class="pl-pds">"</span>SELECT * FROM FOO;<span class="pl-pds">"</span></span>))

result.columns <span class="pl-c"><span class="pl-c">//</span> all column information returned from the Request</span>
result.completedCommand <span class="pl-c"><span class="pl-c">//</span> a String representation of what happend</span></pre>
  </div> 
  <h4><a id="user-content-resultcompletedcommand" class="anchor" href="https://github.com/finagle/roc#resultcompletedcommand" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Result.completedCommand</h4> 
  <ul> 
   <li>For an INSERT command, the tag is INSERT oid rows, where rows is the number of rows inserted. oid is the object ID of the inserted row if rows is 1 and the target table has OIDs; otherwise oid is 0.</li> 
   <li>For a DELETE command, the tag is DELETE rows where rows is the number of rows deleted.</li> 
   <li>For an UPDATE command, the tag is UPDATE rows where rows is the number of rows updated.</li> 
   <li>For a SELECT or CREATE TABLE AS command, the tag is SELECT rows where rows is the number of rows retrieved.</li> 
   <li>For a MOVE command, the tag is MOVE rows where rows is the number of rows the cursor's position has been changed by.</li> 
   <li>For a FETCH command, the tag is FETCH rows where rows is the number of rows that have been retrieved from the cursor.</li> 
  </ul> 
  <p>For an <code>UPDATE</code> or <code>INSERT</code> command, a <code>Result</code> will have a length of <code>0</code> and no column information, but will always return a <code>completedCommand</code>. From Postgresql's perspective, the fact that the query returns without giving an error is evidence that the command completed successfully, and <code>Roc</code> will adhere to their style, not the <code>JDBC</code> style.</p> 
  <h3><a id="user-content-row" class="anchor" href="https://github.com/finagle/roc#row" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Row</h3> 
  <p>A <code>Row</code> holds a non-zero number of <a href="http://finagle.github.io/roc/docs/#roc.postgresql.Element" target="_blank">Elements</a>. An <code>Element</code> is the actual value returned at <code>[row][column]</code>. For example, if we were to execute the following:</p> 
  <div class="highlight highlight-source-scala">
   <pre>scala<span class="pl-k">&gt;</span> <span class="pl-k">val</span> <span class="pl-en">req</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Request</span>(<span class="pl-s"><span class="pl-pds">"</span>SELECT COUNT(*) FROM STATES;<span class="pl-pds">"</span></span>)
scala<span class="pl-k">&gt;</span> <span class="pl-k">val</span> <span class="pl-en">result</span> <span class="pl-k">=</span> <span class="pl-en">Await</span>.result(client.query(req))
result<span class="pl-k">:</span> roc.postgresql.<span class="pl-en">Result</span> <span class="pl-k">=</span> <span class="pl-en">Result</span>(<span class="pl-en">Text</span>(<span class="pl-en">'count</span>,<span class="pl-c1">20</span>,<span class="pl-c1">50</span>))</pre>
  </div> 
  <p>we are given a <code>Result</code> with one <code>Column</code> (with the name of <code>'count</code>, a FormatCode of Text, and OID of 20), and one <code>Row</code>. To retrieve a value out of that <code>Row</code>, we do the following:</p> 
  <div class="highlight highlight-source-scala">
   <pre>scala<span class="pl-k">&gt;</span> <span class="pl-k">val</span> <span class="pl-en">head</span> <span class="pl-k">=</span> result.head <span class="pl-c"><span class="pl-c">//</span> let's just get the first row</span>
scala<span class="pl-k">&gt;</span> <span class="pl-k">val</span> <span class="pl-en">count</span> <span class="pl-k">=</span> head.get(<span class="pl-en">'count</span>)
count<span class="pl-k">:</span> roc.postgresql.<span class="pl-en">Element</span> <span class="pl-k">=</span> <span class="pl-en">Text</span>(<span class="pl-en">'count</span>,<span class="pl-c1">20</span>,<span class="pl-c1">50</span>)</pre>
  </div> 
  <p>Wait, what exactly is an <code>Element</code>?</p> 
  <h3><a id="user-content-elements" class="anchor" href="https://github.com/finagle/roc#elements" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Elements</h3> 
  <p><code>roc-core</code> has an extremely minimal design philosophy. That includes the decoding of actual data. In other words, we'll decode the bytes into the correct format, we'll tell you what that format is, but it's up to you (or another roc module) to go any further. Postgreql returns data in 3 possible formats: 1. UTF-8 Text 2. Binary Format (typically Big Endian) 3. No data is returned for that column ( mean it is a NULL value )</p> 
  <p><code>roc-core</code> will decode this data into the given format, but goes no further in the process - it is up to core clients to decide how to procede. Going back to the example above, we see:</p> 
  <div class="highlight highlight-source-scala">
   <pre>scala<span class="pl-k">&gt;</span> <span class="pl-k">val</span> <span class="pl-en">count</span> <span class="pl-k">=</span> head.get(<span class="pl-en">'count</span>)
count<span class="pl-k">:</span> roc.postgresql.<span class="pl-en">Element</span> <span class="pl-k">=</span> <span class="pl-en">Text</span>(<span class="pl-en">'count</span>,<span class="pl-c1">20</span>,<span class="pl-c1">50</span>)</pre>
  </div> 
  <p>This means that Postgresql has returned a column name <code>'count</code>, in a String format, with a Postgresql Type of <code>Long</code>. String encodings are typically preferred, and almost universally the case unless the column returned is binary data, or if a <code>FETCH</code> command is used to return a <code>CURSOR</code>. An <code>Element</code> has 3 sub-types</p> 
  <ol> 
   <li>Text</li> 
   <li>Binary</li> 
   <li>NULL</li> 
  </ol> 
  <p>Yes, we've deliberately introduced a specific <code>NULL</code> type into the system. This allows clients to handle <code>NULL</code> cases in whatever way they see fit.</p> 
  <p>To get a value out of an <code>Element</code>, you have several options:</p> 
  <div class="highlight highlight-source-scala">
   <pre>scala<span class="pl-k">&gt;</span> <span class="pl-k">val</span> <span class="pl-en">count</span> <span class="pl-k">=</span> head.get(<span class="pl-en">'count</span>)
count<span class="pl-k">:</span> roc.postgresql.<span class="pl-en">Element</span> <span class="pl-k">=</span> <span class="pl-en">Text</span>(<span class="pl-en">'count</span>,<span class="pl-c1">20</span>,<span class="pl-c1">50</span>)

scala<span class="pl-k">&gt;</span> count.asString
res4<span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> <span class="pl-c1">50</span>

scala<span class="pl-k">&gt;</span> count.asBytes
roc.postgresql.failures$<span class="pl-en">UnsupportedDecodingFailure</span><span class="pl-k">:</span> <span class="pl-en">Attempted</span> <span class="pl-en">Binary</span> decoding of <span class="pl-k">String</span> column.</pre>
  </div> 
  <p>If you attempt to get the String of a Binary element, you'll get another <code>UnsupportedDecodingFailure</code>. The two attempts above are short cuts to getting values. The preferred method involves a fold:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">fold</span>[<span class="pl-en">A</span>](<span class="pl-v">fa</span>: <span class="pl-k">String</span> <span class="pl-k">=&gt;</span> <span class="pl-en">A</span>, <span class="pl-v">fb</span>: <span class="pl-en">Array</span>[<span class="pl-k">Byte</span>] <span class="pl-k">=&gt;</span> <span class="pl-en">A</span>, <span class="pl-v">fc</span>: () <span class="pl-k">=&gt;</span> <span class="pl-en">A</span>)<span class="pl-k">:</span> <span class="pl-en">A</span> <span class="pl-k">=</span> <span class="pl-c1">this</span> <span class="pl-k">match</span> {
  <span class="pl-k">case</span> <span class="pl-en">Text</span>(_, _, value)   <span class="pl-k">=&gt;</span> fa(value)
  <span class="pl-k">case</span> <span class="pl-en">Binary</span>(_, _, value) <span class="pl-k">=&gt;</span> fb(value)
  <span class="pl-k">case</span> <span class="pl-en">Null</span>(_, _)          <span class="pl-k">=&gt;</span> fc()
}</pre>
  </div> 
  <p>This allows you to handle <code>NULL</code> values in any way you see fit, and makes the decode process typesafe. Both <code>asString</code> and <code>asBytes</code> call <code>fold</code> under the covers.</p> 
  <p>Finally, there is the ubiquitous parsing / decoding method <code>as[A]</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre> <span class="pl-k">def</span> <span class="pl-en">as</span>[<span class="pl-en">A</span>](<span class="pl-k">implicit</span> <span class="pl-v">f</span>: <span class="pl-en">ElementDecoder</span>[<span class="pl-en">A</span>])<span class="pl-k">:</span> <span class="pl-en">A</span> <span class="pl-k">=</span> fold(f.textDecoder, f.binaryDecoder, f.nullDecoder)</pre>
  </div> 
  <p>An <code>ElementDecoder</code> is a TypeClass to allow custom decoding in a more syntax friendly way. See the <a href="http://finagle.github.io/roc/docs/" target="_blank">Scaladocs</a> or gitter for more information.</p> 
  <h2><a id="user-content-decoders" class="anchor" href="https://github.com/finagle/roc#decoders" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>decoders</h2> 
  <p>The <code>roc-types</code> project defines type aliases from <code>Postgresql =&gt; Scala</code>, and includes <code>ElementDecoder</code> instances for those types. The current types include</p> 
  <ul> 
   <li><code>smallint =&gt; Short</code></li> 
   <li><code>int =&gt; Int</code></li> 
   <li><code>bigint =&gt; Long</code></li> 
   <li><code>real =&gt; Float</code></li> 
   <li><code>double precision =&gt; Double</code></li> 
   <li><code>char =&gt; Char (Note this is a C-Style understanding of a Char, not a UTF Rune)</code></li> 
   <li><code>text/CHARACTER VARYING =&gt; String</code></li> 
   <li><code>bool =&gt; Boolean</code></li> 
   <li><code>JSON/JSONB =&gt; Json</code> (via Jawn)</li> 
   <li><code>Date =&gt; Date = java.time.LocalDate</code></li> 
   <li><code>Time =&gt; Time = java.time.LocalTime</code></li> 
   <li> <code>TIME WITH TIME ZONE =&gt; TimestampWithTZ = java.time.ZonedDateTime</code></li> 
   <li><code>NULL =&gt; Option</code></li> 
  </ul> 
  <h3><a id="user-content-optional-decoders" class="anchor" href="https://github.com/finagle/roc#optional-decoders" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Optional Decoders</h3> 
  <p>To decode a column that may be NULL, clients should simply use an <code>Option[A]</code> decoder, where <code>A = COLUMN TYPE</code>. Let's add a <code>population</code> column to our <code>states</code> table, of type <code>int</code>.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">State</span>(<span class="pl-v">id</span>: <span class="pl-k">Int</span>, <span class="pl-v">name</span>: <span class="pl-k">String</span>, <span class="pl-v">abbrv</span>: <span class="pl-k">String</span>, <span class="pl-v">population</span>: <span class="pl-en">Option</span>[<span class="pl-k">Int</span>],
insertedAt<span class="pl-k">:</span> <span class="pl-en">ZonedDateTime</span>)
<span class="pl-k">val</span> <span class="pl-en">row2State</span><span class="pl-k">:</span> (<span class="pl-en">Row</span>) <span class="pl-k">=&gt;</span> (<span class="pl-en">State</span>) <span class="pl-k">=</span> (<span class="pl-v">row</span>: <span class="pl-en">Row</span>) <span class="pl-k">=&gt;</span> {
  <span class="pl-k">val</span> <span class="pl-en">id</span> <span class="pl-k">=</span> row.get(<span class="pl-en">'id</span>).as[<span class="pl-k">Int</span>]
  <span class="pl-k">val</span> <span class="pl-en">name</span> <span class="pl-k">=</span> row.get(<span class="pl-en">'name</span>).as[<span class="pl-k">String</span>]
  <span class="pl-k">val</span> <span class="pl-en">abbrv</span> <span class="pl-k">=</span> row.get(<span class="pl-en">'abbrv</span>).as[<span class="pl-k">String</span>]
  <span class="pl-k">val</span> <span class="pl-en">population</span> <span class="pl-k">=</span> row.get(<span class="pl-en">'population</span>).as[<span class="pl-k">Int</span>]
  <span class="pl-k">val</span> <span class="pl-en">insertedAt</span> <span class="pl-k">=</span> row.get(<span class="pl-en">'inserted_at</span>).as[<span class="pl-en">TimestampWithTZ</span>]
  <span class="pl-en">State</span>(id, name, abbrv, population, insertedAt)
}
<span class="pl-k">val</span> <span class="pl-en">state</span> <span class="pl-k">=</span> result.map(row2State).toList.head
states<span class="pl-k">:</span> <span class="pl-en">State</span> <span class="pl-k">=</span> <span class="pl-en">State</span>(<span class="pl-c1">1</span>,<span class="pl-en">Alabama</span>,<span class="pl-en">AL</span>,<span class="pl-c1">None</span>,<span class="pl-c1">2016</span><span class="pl-k">-</span><span class="pl-c1">05</span><span class="pl-k">-</span>10T12<span class="pl-k">:</span><span class="pl-c1">46</span><span class="pl-k">:</span><span class="pl-c1">59.998788</span><span class="pl-k">-</span><span class="pl-c1">05</span><span class="pl-k">:</span><span class="pl-c1">00</span>)</pre>
  </div> 
  <p>As the type of column should be known at compile time, <code>roc-types</code> throws an <code>NullDecodedFailure(TYPE)</code> with a helpful error message if you attempt to decode a <code>NULL</code> type:</p> 
  <div class="highlight highlight-source-scala">
   <pre>scala<span class="pl-k">&gt;</span> <span class="pl-k">val</span> <span class="pl-en">row</span> <span class="pl-k">=</span> result.head
row<span class="pl-k">:</span> roc.postgresql.<span class="pl-en">Row</span> <span class="pl-k">=</span> <span class="pl-en">Text</span>(<span class="pl-en">'inserted_at</span>,<span class="pl-c1">1184</span>,<span class="pl-c1">2016</span><span class="pl-k">-</span><span class="pl-c1">05</span><span class="pl-k">-</span><span class="pl-c1">1012</span><span class="pl-k">:</span><span class="pl-c1">46</span><span class="pl-k">:</span><span class="pl-c1">59.998788</span><span class="pl-k">-</span><span class="pl-c1">05</span>)<span class="pl-en">Null</span>(<span class="pl-en">'population</span>,<span class="pl-c1">23</span>)<span class="pl-en">Text</span>(<span class="pl-en">'abbrv</span>,<span class="pl-c1">1043</span>,<span class="pl-en">AL</span>)<span class="pl-en">Text</span>(<span class="pl-en">'name</span>,<span class="pl-c1">25</span>,<span class="pl-en">Alabama</span>)<span class="pl-en">Text</span>(<span class="pl-en">'id</span>,<span class="pl-c1">23</span>,<span class="pl-c1">1</span>)
scala<span class="pl-k">&gt;</span> <span class="pl-k">val</span> <span class="pl-en">population</span> <span class="pl-k">=</span> row.get(<span class="pl-en">'population</span>).as[<span class="pl-k">Int</span>]
roc.types.failures$<span class="pl-en">NullDecodedFailure</span><span class="pl-k">:</span> <span class="pl-en">A</span> <span class="pl-en">NULL</span> value was decoded <span class="pl-k">for</span> <span class="pl-k">type</span> <span class="pl-en">INT</span>. <span class="pl-en">Hint</span><span class="pl-k">:</span> use the <span class="pl-en">Option</span>[<span class="pl-en">INT</span>] decoder, or ensure that <span class="pl-en">Postgres</span> cannot <span class="pl-k">return</span> <span class="pl-en">NULL</span> <span class="pl-k">for</span> the requested value.</pre>
  </div> 
  <h2><a id="user-content-design-philosophy" class="anchor" href="https://github.com/finagle/roc#design-philosophy" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Design Philosophy</h2> 
  <p>The desire of <code>core</code> is to be as minimal as possible. In practice, that means mapping a Finagle Service over Postgresql with as little bedazzling as possible. The Postgresql Client will be very minimalistic ( currently just one method, <code>def query(Request): Future[Result]</code>), and the aim is for <code>Result</code> to do as little as possible. Additional future modules may provide additional functionality.</p> 
  <h2><a id="user-content-motivation" class="anchor" href="https://github.com/finagle/roc#motivation" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Motivation</h2> 
  <p>The current <a href="https://github.com/finagle/finagle-postgres" target="_blank">finagle-postgres</a> was developed pre <a href="http://twitter.github.io/finagle/guide/changelog.html" target="_blank">Finagle 6.x</a> and does not use modern finagle abstractions. These are core enough to require what amounts to a complete rewrite of the driver.</p> 
  <h2><a id="user-content-whats-in-a-name" class="anchor" href="https://github.com/finagle/roc#whats-in-a-name" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>What's in a name?</h2> 
  <p>roc (<em>Rokh</em> or <em>Rukh</em>) is named after the Persian mythological bird of prey <a href="https://en.wikipedia.org/wiki/Roc_(mythology)" target="_blank">Roc</a>, which was based in part on the now extinct <a href="https://en.wikipedia.org/wiki/Elephant_bird" target="_blank">elephant bird</a>. Yes, that means we've hit the rare 4 point play with the name</p> 
  <table>
   <thead> 
    <tr> 
     <th align="center">Goal</th> 
     <th align="center">Status</th> 
    </tr> 
   </thead>
   <tbody> 
    <tr> 
     <td align="center">short name</td> 
     <td align="center">
      <g-emoji alias="heavy_check_mark" fallback-src="https://assets-cdn.github.com/images/icons/emoji/unicode/2714.png" ios-version="6.0">
       ✔️
      </g-emoji></td> 
    </tr> 
    <tr> 
     <td align="center">obligatory mythological reference</td> 
     <td align="center">
      <g-emoji alias="heavy_check_mark" fallback-src="https://assets-cdn.github.com/images/icons/emoji/unicode/2714.png" ios-version="6.0">
       ✔️
      </g-emoji></td> 
    </tr> 
    <tr> 
     <td align="center">bird reference for Twitter</td> 
     <td align="center">
      <g-emoji alias="heavy_check_mark" fallback-src="https://assets-cdn.github.com/images/icons/emoji/unicode/2714.png" ios-version="6.0">
       ✔️
      </g-emoji></td> 
    </tr> 
    <tr> 
     <td align="center">elephant reference for Postgresql</td> 
     <td align="center">
      <g-emoji alias="heavy_check_mark" fallback-src="https://assets-cdn.github.com/images/icons/emoji/unicode/2714.png" ios-version="6.0">
       ✔️
      </g-emoji></td> 
    </tr> 
   </tbody>
  </table> 
  <p>High fives for everyone! <a href="https://camo.githubusercontent.com/6469775568c21e47e4a0145c21b0c593ba2a9a9f/687474703a2f2f692e67697068792e636f6d2f31304c4e6a3538306e394f6d69492e676966" target="_blank"><img src="https://camo.githubusercontent.com/6469775568c21e47e4a0145c21b0c593ba2a9a9f/687474703a2f2f692e67697068792e636f6d2f31304c4e6a3538306e394f6d69492e676966" alt="Teenage Mutant Ninja Turtles High Fives" data-canonical-src="http://i.giphy.com/10LNj580n9OmiI.gif" style="max-width:100%;"></a></p> 
  <h2><a id="user-content-contributors-and-participation" class="anchor" href="https://github.com/finagle/roc#contributors-and-participation" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Contributors and Participation</h2> 
  <p>roc is currently maintained by <a href="https://twitter.com/penland365" target="_blank">Jeffrey Davis</a>.</p> 
  <p>The roc project supports the <a href="http://typelevel.org/" target="_blank">Typelevel</a> <a href="http://typelevel.org/conduct.html" target="_blank">code of conduct</a> and wants all of its channels (GitHub, gitter, etc.) to be welcoming environments for everyone.</p> 
  <h2><a id="user-content-license" class="anchor" href="https://github.com/finagle/roc#license" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>License</h2> 
  <p>Licensed under the <strong><a href="https://opensource.org/licenses/BSD-3-Clause" target="_blank">BSD-3-Clause</a></strong> (Revised BSD Liscense); you may not use this software except in compliance with the License.</p> 
  <p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p> 
 </article>
</div>