<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-object-fields-transfer-ocopy" class="anchor" href="https://github.com/lembrd/ocopy#object-fields-transfer-ocopy" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Object Fields Transfer (OCopy)</h1> 
  <p><a href="https://travis-ci.org/lembrd/ocopy" target="_blank"><img src="https://camo.githubusercontent.com/1e493c6cb326f19df7f65631449cccb864e42c10/68747470733a2f2f7472617669732d63692e6f72672f6c656d6272642f6f636f70792e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/lembrd/ocopy.svg?branch=master" style="max-width:100%;"></a> <a href="https://bintray.com/lembrd/maven/ocopy-lib/_latestVersion" target="_blank"> <img src="https://camo.githubusercontent.com/6cefecea1d8b130c9440da50ac3f42aabbfa8bba/68747470733a2f2f6170692e62696e747261792e636f6d2f7061636b616765732f6c656d6272642f6d6176656e2f6f636f70792d6c69622f696d616765732f646f776e6c6f61642e737667" alt="Download" data-canonical-src="https://api.bintray.com/packages/lembrd/maven/ocopy-lib/images/download.svg" style="max-width:100%;"> </a></p> 
  <p>This library simplify object's fields coping. For example you have 2 different case classes: EntityObject and DataTransferObject. Each of them has independent set of fields and you want to transparently transfer data from one object to another without huge handwritten copy methods. </p> 
  <p>This library built on top of scala macros and requires <strong>scala 2.11</strong></p> 
  <h2><a id="user-content-sbt" class="anchor" href="https://github.com/lembrd/ocopy#sbt" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>SBT</h2> 
  <div class="highlight highlight-source-scala">
   <pre> resolvers <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-en">Resolver</span>.bintrayRepo(<span class="pl-s"><span class="pl-pds">"</span>lembrd<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>maven<span class="pl-pds">"</span></span>)
 libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>org.lembrd<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>ocopy-lib<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>1.12<span class="pl-pds">"</span></span></pre>
  </div> 
  <h2><a id="user-content-use-case" class="anchor" href="https://github.com/lembrd/ocopy#use-case" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Use case</h2> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">OCopyTest</span> <span class="pl-k">extends</span> <span class="pl-e">FlatSpec</span> <span class="pl-k">with</span> <span class="pl-e">Matchers</span> {

  <span class="pl-s"><span class="pl-pds">"</span>OCopy<span class="pl-pds">"</span></span> should <span class="pl-s"><span class="pl-pds">"</span>transfer complex classes<span class="pl-pds">"</span></span> in {
    <span class="pl-k">val</span> <span class="pl-en">from</span> <span class="pl-k">=</span> <span class="pl-en">ClassOne</span>(field1 <span class="pl-k">=</span>  <span class="pl-s"><span class="pl-pds">"</span>f1<span class="pl-pds">"</span></span>, field2 <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>f2<span class="pl-pds">"</span></span>, field3 <span class="pl-k">=</span> <span class="pl-en">Another</span>(<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>b<span class="pl-pds">"</span></span>), field4_1 <span class="pl-k">=</span> <span class="pl-c1">0.1d</span>, field4_2 <span class="pl-k">=</span> <span class="pl-c1">42</span>, userId <span class="pl-k">=</span> <span class="pl-en">Some</span>(<span class="pl-en">UserId</span>(<span class="pl-c1">0</span>)), f5 <span class="pl-k">=</span> <span class="pl-c1">50</span>)
    <span class="pl-k">val</span> <span class="pl-en">mergeSource</span> <span class="pl-k">=</span> <span class="pl-en">ClassToBeMerged</span>(mergedField <span class="pl-k">=</span> <span class="pl-c1">113L</span>)

    <span class="pl-c"><span class="pl-c">//</span> implicit def conversion</span>
    <span class="pl-k">implicit</span> <span class="pl-k">def</span> <span class="pl-en">userIdToLong</span>(x<span class="pl-k">:</span><span class="pl-en">UserId</span>) <span class="pl-k">:</span> <span class="pl-k">Long</span> <span class="pl-k">=</span> x.id

    <span class="pl-k">val</span> <span class="pl-en">to</span> <span class="pl-k">:</span> <span class="pl-en">ClassTwo</span> <span class="pl-k">=</span> transfer(from)
      .to[<span class="pl-en">ClassTwo</span>]
<span class="pl-c"><span class="pl-c">//</span>    .mergeAllFrom( mergeSource )  // append fields from object mergeSource</span>
      .mergeExclude(mergeSource)(_.field1, _.fieldExclude2) <span class="pl-c"><span class="pl-c">//</span> append fields from object mergeSource with exclusion checking</span>
      .assign(_.outsideField).fromOutside( <span class="pl-en">Random</span>.nextLong() )  <span class="pl-c"><span class="pl-c">//</span> append field from outside</span>
<span class="pl-c"><span class="pl-c">//</span>    automatically:  field1 copied by default (name and types equal)</span>
<span class="pl-c"><span class="pl-c">//</span>    automatically:  .assign(_.f5).from(_.f5) // using Option wrapper</span>
<span class="pl-c"><span class="pl-c">//</span>    automatically:  userId =&gt; _.userId.id // using implicit def [UserId] -&gt; [Long] and wrapped by Option.map</span>
      .assign(_.f4).using(_.field1){ x <span class="pl-k">=&gt;</span> x.length} <span class="pl-c"><span class="pl-c">//</span> using inline converter</span>
      .assign(_.field3).from(_.field3.f1) <span class="pl-c"><span class="pl-c">//</span> using long path</span>
      .assign(_.field4).usingSelf{ x <span class="pl-k">=&gt;</span> <span class="pl-k">new</span> <span class="pl-en">Complex2</span>(x.field4_1, x.field4_2)} <span class="pl-c"><span class="pl-c">//</span> complex object mapping instead of one field</span>
      .build
<span class="pl-c"><span class="pl-c">/*</span></span>
<span class="pl-c">The actual generated code is:</span>
<span class="pl-c"></span>
<span class="pl-c">new org.lembrd.ocopy.test.ClassTwo(</span>
<span class="pl-c">  f4 = ((x: String) =&gt; x.length())(((x$5: org.lembrd.ocopy.test.ClassOne) =&gt; x$5.field1)(from)),</span>
<span class="pl-c">  field4 = ((x: org.lembrd.ocopy.test.ClassOne) =&gt; new Complex2(x.field4_1, x.field4_2))(from),</span>
<span class="pl-c">  field1 = from.field1,</span>
<span class="pl-c">  mergedField = mergeSource.mergedField,</span>
<span class="pl-c">  userId = from.userId.map(((ftnx0) =&gt; ftnx0)),</span>
<span class="pl-c">  outsideField = org.lembrd.ocopy.`package`.conversions.anyToOption[Long](scala.util.Random.nextLong()),</span>
<span class="pl-c">  field3 = ((x$7: org.lembrd.ocopy.test.ClassOne) =&gt; x$7.field3.f1)(from),</span>
<span class="pl-c">  f5 = from.f5)</span>
<span class="pl-c"> <span class="pl-c">*/</span></span>
    println(to)

    to.field1 shouldBe <span class="pl-s"><span class="pl-pds">"</span>f1<span class="pl-pds">"</span></span>
    to.field3 shouldBe <span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>
    to.userId shouldBe <span class="pl-en">Some</span>(<span class="pl-c1">0L</span>)
  }
}





<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">ClassOne</span>(<span class="pl-v">field1</span>      : <span class="pl-k">String</span>,
                    <span class="pl-v">field2</span>      : <span class="pl-k">String</span>,
                    <span class="pl-v">field3</span>      : <span class="pl-en">Another</span>,
                    <span class="pl-v">field4_1</span>    : <span class="pl-k">Double</span>,
                    <span class="pl-v">field4_2</span>    : <span class="pl-k">Int</span>,
                    <span class="pl-v">userId</span>      : <span class="pl-en">Option</span>[<span class="pl-en">UserId</span>],
                    <span class="pl-v">f5</span>          : <span class="pl-k">Int</span>
                   )
<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">ClassToBeMerged</span>(
                            <span class="pl-v">mergedField</span> : <span class="pl-k">Long</span>,
                            <span class="pl-v">fieldExclude2</span> : <span class="pl-k">String</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>,
                            <span class="pl-v">field1</span> : <span class="pl-k">String</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>
                          )
<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">ClassTwo</span>(<span class="pl-v">userId</span>: <span class="pl-en">Option</span>[<span class="pl-k">Long</span>],
                    <span class="pl-v">field1</span> : <span class="pl-k">String</span>,
                    <span class="pl-v">field3</span> : <span class="pl-k">String</span>,
                    <span class="pl-v">mergedField</span> : <span class="pl-k">Long</span>,
                    <span class="pl-v">f4</span> : <span class="pl-k">Int</span>,
                    <span class="pl-v">f5</span> : <span class="pl-en">Option</span>[<span class="pl-k">Long</span>],
                    <span class="pl-v">field4</span> : <span class="pl-en">Complex2</span>,
                    <span class="pl-v">outsideField</span> : <span class="pl-en">Option</span>[<span class="pl-k">Long</span>]
                   )

<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Another</span>(<span class="pl-v">f1</span> : <span class="pl-k">String</span>, <span class="pl-v">f2</span> : <span class="pl-k">String</span>)
<span class="pl-k">class</span> <span class="pl-en">Complex2</span>(<span class="pl-v">d1</span> : <span class="pl-k">Double</span>, <span class="pl-v">d2</span> : <span class="pl-k">Int</span>)

<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">UserId</span>(<span class="pl-v">id</span> : <span class="pl-k">Long</span>) <span class="pl-k">extends</span> <span class="pl-e">AnyVal</span></pre>
  </div> 
 </article>
</div>