<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <p><a href="https://travis-ci.org/hal/dmr.repl" target="_blank"><img src="https://camo.githubusercontent.com/0554364bee60b81a40cf612312e646ce8985587a/68747470733a2f2f7472617669732d63692e6f72672f68616c2f646d722e7265706c2e706e67" alt="Build Status" data-canonical-src="https://travis-ci.org/hal/dmr.repl.png" style="max-width:100%;"></a></p> 
  <h1><a id="user-content-dmrrepl" class="anchor" href="https://github.com/hal/dmr.repl#dmrrepl" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>DMR.repl</h1> 
  <p>A REPL shell for managing WildFly server instances. Build on a Scala wrapper around DMR, SBT and the Scala REPL at it's core.</p> 
  <p>Features:</p> 
  <ul> 
   <li>DSL for creating DMR operations</li> 
   <li>Interact with model nodes in a more natural way</li> 
  </ul> 
  <p>For an introduction to DMR please refer to the <a href="https://docs.jboss.org/author/display/WFLY8/Detyped+management+and+the+jboss-dmr+library" target="_blank">WildFly Wiki</a>.</p> 
  <h2><a id="user-content-working-with-model-nodes" class="anchor" href="https://github.com/hal/dmr.repl#working-with-model-nodes" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Working with model nodes</h2> 
  <p>Please make sure to import the following packages in order to bring the necessary implicit conversions into scope and to save you some keystrokes.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">org.jboss.dmr.scala.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">org.jboss.dmr.scala.</span><span class="pl-v">ModelNode</span></pre>
  </div> 
  <h2><a id="user-content-creating-model-nodes" class="anchor" href="https://github.com/hal/dmr.repl#creating-model-nodes" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Creating model nodes</h2> 
  <p>Use the factory methods in <code>org.jboss.dmr.scala.ModelNode</code> to create model nodes:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c">// creates an empty model node</span>
<span class="pl-k">val</span> <span class="pl-en">node</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>()

<span class="pl-c">// creates a new model node holding a simple value</span>
<span class="pl-k">val</span> <span class="pl-en">node</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>(<span class="pl-c1">42</span>)

<span class="pl-c">// creates a new model node with structure</span>
<span class="pl-k">val</span> <span class="pl-en">node</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>(
  <span class="pl-s"><span class="pl-pds">"</span>flag<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">true</span>,
  <span class="pl-s"><span class="pl-pds">"</span>hello<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>world<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>answer<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">42</span>,
  <span class="pl-s"><span class="pl-pds">"</span>child<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">ModelNode</span>(
    <span class="pl-s"><span class="pl-pds">"</span>inner-a<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">123</span>,
    <span class="pl-s"><span class="pl-pds">"</span>inner-b<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>test<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>deep-inside<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">ModelNode</span>(<span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>bar<span class="pl-pds">"</span></span>),
    <span class="pl-s"><span class="pl-pds">"</span>deep-list<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">List</span>(
      <span class="pl-en">ModelNode</span>(<span class="pl-s"><span class="pl-pds">"</span>one<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">1</span>),
      <span class="pl-en">ModelNode</span>(<span class="pl-s"><span class="pl-pds">"</span>two<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">2</span>),
      <span class="pl-en">ModelNode</span>(<span class="pl-s"><span class="pl-pds">"</span>three<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">3</span>)
    ),
    <span class="pl-s"><span class="pl-pds">"</span>value-list<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">List</span>(
      <span class="pl-en">ModelNode</span>(<span class="pl-c1">1</span>),
      <span class="pl-en">ModelNode</span>(<span class="pl-c1">2</span>),
      <span class="pl-en">ModelNode</span>(<span class="pl-c1">3</span>)
    )
  )
)</pre>
  </div> 
  <h2><a id="user-content-addressing-and-operations" class="anchor" href="https://github.com/hal/dmr.repl#addressing-and-operations" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Addressing and operations</h2> 
  <p>You can use a DSL like API to set the address and operation for a model node. To describe the "read-resource" operation on "/subsystem=datasources/data-source=ExampleDS" use the following code:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">ModelNode</span>() at (<span class="pl-s"><span class="pl-pds">"</span>subsystem<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>datasources<span class="pl-pds">"</span></span>) <span class="pl-k">/</span> (<span class="pl-s"><span class="pl-pds">"</span>data-source<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>ExampleDS<span class="pl-pds">"</span></span>) op <span class="pl-en">'read_resource</span>(
  <span class="pl-en">'include_runtime</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">false</span>,
  <span class="pl-en">'recursive_depth</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">2</span>
)</pre>
  </div> 
  <p>Addresses can be written down as <code>(String, String)</code> tuples separated by "/". Operations are specified using <code>Symbol</code>s and an optional list of parameters. Each parameter is made up of another <code>Symbol</code> and a value. Using symbols makes the DSL both more readable and extentable.</p> 
  <p>However there's one drawback in using symbols: when using the short form <code>'someSymbol</code> characters like "-" are not allowed. <code>'read-resource</code> is therefore an illegal symbol. As most DMR operations and many parameters do contain "-", all underscores will be replaced with dashes:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">ModelNode</span>() op <span class="pl-en">'read_resource</span>(<span class="pl-en">'include_runtime</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">true</span>)
<span class="pl-c">// is exactly the same as</span>
<span class="pl-en">ModelNode</span>() op <span class="pl-k">Symbol</span>(<span class="pl-s"><span class="pl-pds">"</span>read-resource<span class="pl-pds">"</span></span>)(<span class="pl-k">Symbol</span>(<span class="pl-s"><span class="pl-pds">"</span>include-runtime<span class="pl-pds">"</span></span>) <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">true</span>)</pre>
  </div> 
  <p>Here are some more examples using addresses and operations:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c">// root is a constant for an empty address</span>
<span class="pl-en">ModelNode</span>() at root op <span class="pl-en">'read_resource</span>
<span class="pl-en">ModelNode</span>() at (<span class="pl-s"><span class="pl-pds">"</span>subsystem<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>datasources<span class="pl-pds">"</span></span>) <span class="pl-k">/</span> (<span class="pl-s"><span class="pl-pds">"</span>data-source<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>ExampleDS<span class="pl-pds">"</span></span>) op <span class="pl-en">'disable</span>

<span class="pl-c">// parameters are specified as pairs (Symbol -&gt; Any)</span>
<span class="pl-en">ModelNode</span>() at (<span class="pl-s"><span class="pl-pds">"</span>core-service<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>platform-mbean<span class="pl-pds">"</span></span>) <span class="pl-k">/</span> (<span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>runtime<span class="pl-pds">"</span></span>) op <span class="pl-en">'read_resource</span>(
  <span class="pl-en">'attributes_only</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">true</span>,
  <span class="pl-en">'include_runtime</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">false</span>,
  <span class="pl-en">'recursive_depth</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">3</span>,
  <span class="pl-en">'custom_parameter</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>custom-value<span class="pl-pds">"</span></span>
)

<span class="pl-c">// unsupported parameter types will throw an IllegalArgumentException</span>
<span class="pl-en">ModelNode</span>() at root op <span class="pl-en">'read_resource</span>(<span class="pl-en">'proxies</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">Console</span>.out)</pre>
  </div> 
  <h2><a id="user-content-reading-nodes" class="anchor" href="https://github.com/hal/dmr.repl#reading-nodes" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Reading Nodes</h2> 
  <p>Reading values from a model node follows the sementics of a <code>Map[String, ModelNode]</code>, but instead of a string you have to provide a <code>Path</code> as key. Thanks to an implicit conversion expressions like <code>"a" / "b" / "c"</code> are automatically converted to a path.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">node</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>(
  <span class="pl-s"><span class="pl-pds">"</span>flag<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">true</span>,
  <span class="pl-s"><span class="pl-pds">"</span>hello<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>world<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>answer<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">42</span>,
  <span class="pl-s"><span class="pl-pds">"</span>level0<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">ModelNode</span>(
    <span class="pl-s"><span class="pl-pds">"</span>level1<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">ModelNode</span>(
      <span class="pl-s"><span class="pl-pds">"</span>level2<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">ModelNode</span>(
        <span class="pl-s"><span class="pl-pds">"</span>level3<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">ModelNode</span>(
          <span class="pl-s"><span class="pl-pds">"</span>level4<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">ModelNode</span>(<span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>bar<span class="pl-pds">"</span></span>)
        )
      )
    )
  )
)

<span class="pl-k">val</span> <span class="pl-en">flag</span> <span class="pl-k">=</span> node(<span class="pl-s"><span class="pl-pds">"</span>flag<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">boom</span> <span class="pl-k">=</span> node(<span class="pl-s"><span class="pl-pds">"</span>gag<span class="pl-pds">"</span></span>) <span class="pl-c">// throws a NoSuchelementException</span>
<span class="pl-k">val</span> <span class="pl-en">hello</span> <span class="pl-k">=</span> node.get(<span class="pl-s"><span class="pl-pds">"</span>hello<span class="pl-pds">"</span></span>) <span class="pl-c">// returns an Option[ModelNode]</span>
<span class="pl-k">val</span> <span class="pl-en">x</span> <span class="pl-k">=</span> node.getOrElse(<span class="pl-s"><span class="pl-pds">"</span>nope<span class="pl-pds">"</span></span>, <span class="pl-en">ModelNode</span>(<span class="pl-s"><span class="pl-pds">"</span>y<span class="pl-pds">"</span></span>))
<span class="pl-k">val</span> <span class="pl-en">check</span> <span class="pl-k">=</span> node.contains(<span class="pl-s"><span class="pl-pds">"</span>level0<span class="pl-pds">"</span></span> <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>level1<span class="pl-pds">"</span></span> <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>level2<span class="pl-pds">"</span></span> <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>level3<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">level3</span> <span class="pl-k">=</span> node(<span class="pl-s"><span class="pl-pds">"</span>level0<span class="pl-pds">"</span></span> <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>level1<span class="pl-pds">"</span></span> <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>level2<span class="pl-pds">"</span></span> <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>level3<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">level2</span> <span class="pl-k">=</span> <span class="pl-k">for</span> {
  l0 <span class="pl-k">&lt;</span><span class="pl-k">-</span> node.get(<span class="pl-s"><span class="pl-pds">"</span>level0<span class="pl-pds">"</span></span>)
  l1 <span class="pl-k">&lt;</span><span class="pl-k">-</span> l0.get(<span class="pl-s"><span class="pl-pds">"</span>level1<span class="pl-pds">"</span></span>)
  l2 <span class="pl-k">&lt;</span><span class="pl-k">-</span> l1.get(<span class="pl-s"><span class="pl-pds">"</span>level2<span class="pl-pds">"</span></span>)
} <span class="pl-k">yield</span> l2</pre>
  </div> 
  <p>Since the result of <code>node.get("a" / "b" / "c")</code> is <code>Option[ModelNode]</code>, reading nested model nodes is safe even if some children in the path do not exist. In this case <code>None</code> wil be returned:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">nope</span> <span class="pl-k">=</span> node.get(<span class="pl-s"><span class="pl-pds">"</span>level0<span class="pl-pds">"</span></span> <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>oops<span class="pl-pds">"</span></span> <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>level2<span class="pl-pds">"</span></span> <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>level3<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <h2><a id="user-content-reading-values" class="anchor" href="https://github.com/hal/dmr.repl#reading-values" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Reading Values</h2> 
  <p>You can use the folowing methods to read values from model nodes:</p> 
  <ul> 
   <li><code>ModelNode.asBoolean</code></li> 
   <li><code>ModelNode.asInt</code></li> 
   <li><code>ModelNode.asLong</code></li> 
   <li><code>ModelNode.asBigInt</code></li> 
   <li><code>ModelNode.asDouble</code></li> 
   <li><code>ModelNode.asString</code></li> 
  </ul> 
  <p>These methods return <code>Option</code> instances of the relevant type. This is because not all conversions make sense on all kind of model nodes:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">node</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>(
  <span class="pl-s"><span class="pl-pds">"</span>flag<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">true</span>,
  <span class="pl-s"><span class="pl-pds">"</span>child<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">ModelNode</span>(
    <span class="pl-s"><span class="pl-pds">"</span>size<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">0</span>
  )
)

<span class="pl-k">val</span> <span class="pl-en">nonsense</span> <span class="pl-k">=</span> node(<span class="pl-s"><span class="pl-pds">"</span>child<span class="pl-pds">"</span></span>).asDouble <span class="pl-c">// None</span></pre>
  </div> 
  <h2><a id="user-content-writing" class="anchor" href="https://github.com/hal/dmr.repl#writing" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Writing</h2> 
  <p>Simple values can be set using <code>node("foo") = "bar"</code>. If "foo" doesn't exist it will be created and updated otherwise. As an alternative you can use the <code>+=</code> operator, which comes in handy if you want to add multiple key / value pairs:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">node</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>()

node(<span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span>) <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>bar<span class="pl-pds">"</span></span>
node <span class="pl-k">+</span><span class="pl-k">=</span> (<span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>bar<span class="pl-pds">"</span></span>)

node <span class="pl-k">+</span><span class="pl-k">=</span> (
  <span class="pl-s"><span class="pl-pds">"</span>flag<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">true</span>,
  <span class="pl-s"><span class="pl-pds">"</span>hello<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>world<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>answer<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">42</span>,
  <span class="pl-s"><span class="pl-pds">"</span>child<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">ModelNode</span>(
    <span class="pl-s"><span class="pl-pds">"</span>inner-a<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">123</span>,
    <span class="pl-s"><span class="pl-pds">"</span>inner-b<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>test<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>deep-inside<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">ModelNode</span>(
      <span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>bar<span class="pl-pds">"</span></span>
    ),
    <span class="pl-s"><span class="pl-pds">"</span>deep-list<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">List</span>(
      <span class="pl-en">ModelNode</span>(<span class="pl-s"><span class="pl-pds">"</span>one<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">1</span>),
      <span class="pl-en">ModelNode</span>(<span class="pl-s"><span class="pl-pds">"</span>two<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">2</span>),
      <span class="pl-en">ModelNode</span>(<span class="pl-s"><span class="pl-pds">"</span>three<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">3</span>)
    )
  )
)</pre>
  </div> 
  <p>Reading and writing can also be combined in one call:</p> 
  <div class="highlight highlight-source-scala">
   <pre>node(<span class="pl-s"><span class="pl-pds">"</span>child<span class="pl-pds">"</span></span> <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>deep-inside<span class="pl-pds">"</span></span>) <span class="pl-k">+</span><span class="pl-k">=</span> (<span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>xyz<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <h2><a id="user-content-collection-operations" class="anchor" href="https://github.com/hal/dmr.repl#collection-operations" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Collection Operations</h2> 
  <p>Since <code>ModelNode</code> mixes in <code>Traversable[(String, ModelNode)]</code> you can use all those nifty collection methods like <code>foreach</code>, <code>map</code> or <code>filter</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">node</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>(
  <span class="pl-s"><span class="pl-pds">"</span>flag<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">true</span>,
  <span class="pl-s"><span class="pl-pds">"</span>hello<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>world<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>answer<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">42</span>
)

<span class="pl-c">// turn all keys to upper case</span>
<span class="pl-k">val</span> <span class="pl-en">shout</span> <span class="pl-k">=</span> node.map(kv <span class="pl-k">=&gt;</span> kv._1.toUpperCase <span class="pl-k">-</span><span class="pl-k">&gt;</span> kv._2)

<span class="pl-c">// filter for nodes</span>
<span class="pl-k">val</span> <span class="pl-en">aa</span> <span class="pl-k">=</span> node.filter(_._1 contains <span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">n42</span> <span class="pl-k">=</span> node.filter(_._2 <span class="pl-k">==</span> <span class="pl-en">ModelNode</span>(<span class="pl-c1">42</span>))

<span class="pl-c">// combine nodes</span>
<span class="pl-k">val</span> <span class="pl-en">node2</span> <span class="pl-k">=</span> node <span class="pl-k">++</span> <span class="pl-en">ModelNode</span>(<span class="pl-s"><span class="pl-pds">"</span>abc<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">1</span>)</pre>
  </div> 
  <p>Please note that these kind of methods only traverse over the direct children of a model node. If you want to traverse over all children in a deeply nested model node use the <code>inOrder</code> method which gives you a list of <code>(String, ModelNode)</code> tuples:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">node</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>(
  <span class="pl-s"><span class="pl-pds">"</span>flag<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">true</span>,
  <span class="pl-s"><span class="pl-pds">"</span>answer<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">42</span>,
  <span class="pl-s"><span class="pl-pds">"</span>child<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">ModelNode</span>(
    <span class="pl-s"><span class="pl-pds">"</span>inner-a<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">123</span>,
    <span class="pl-s"><span class="pl-pds">"</span>inner-b<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>test<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>deep-inside<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">ModelNode</span>(<span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>bar<span class="pl-pds">"</span></span>),
    <span class="pl-s"><span class="pl-pds">"</span>deep-list<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">List</span>(
      <span class="pl-en">ModelNode</span>(<span class="pl-s"><span class="pl-pds">"</span>one<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">1</span>),
      <span class="pl-en">ModelNode</span>(<span class="pl-s"><span class="pl-pds">"</span>two<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">2</span>)
    ),
    <span class="pl-s"><span class="pl-pds">"</span>value-list<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">List</span>(
      <span class="pl-en">ModelNode</span>(<span class="pl-c1">1</span>),
      <span class="pl-en">ModelNode</span>(<span class="pl-c1">2</span>)
    )
  )
)

node.inOrder map { tpl <span class="pl-k">=&gt;</span> tpl._1 }
<span class="pl-c">// will result in List(flag, answer, child, inner-a, inner-b, deep-inside, foo, deep-list, one, two, value-list)</span></pre>
  </div> 
  <h2><a id="user-content-pattern-matching--extractor" class="anchor" href="https://github.com/hal/dmr.repl#pattern-matching--extractor" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Pattern Matching / Extractor</h2> 
  <p>Model nodes support pattern matching / extractor against their type:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">node</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>(
  <span class="pl-s"><span class="pl-pds">"</span>flag<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">true</span>,
  <span class="pl-s"><span class="pl-pds">"</span>hello<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>world<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>answer<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">42</span>,
  <span class="pl-s"><span class="pl-pds">"</span>one<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">1</span>,
  <span class="pl-s"><span class="pl-pds">"</span>two<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">2</span>
)

<span class="pl-k">import</span> <span class="pl-v">org.jboss.dmr.ModelType.</span><span class="pl-v">_</span>
<span class="pl-k">for</span> ((key, node) <span class="pl-k">&lt;</span><span class="pl-k">-</span> node) node <span class="pl-k">match</span> {
  <span class="pl-k">case</span> <span class="pl-en">ModelNode</span>(<span class="pl-en">INT</span>) <span class="pl-k">=&gt;</span> println(s<span class="pl-s"><span class="pl-pds">"</span>$key is an integer: $node<span class="pl-pds">"</span></span>)
  <span class="pl-k">case</span> <span class="pl-en">ModelNode</span>(t) <span class="pl-k">=&gt;</span> println(s<span class="pl-s"><span class="pl-pds">"</span>$key is not an integer, but $t<span class="pl-pds">"</span></span>)
}

<span class="pl-k">val</span> (key, firstNode) <span class="pl-k">=</span> node.head
<span class="pl-k">val</span> <span class="pl-en">ModelNode</span>(booleanType) <span class="pl-k">=</span> firstNode
<span class="pl-c">// booleanType == org.jboss.dmr.ModelType.BOOLEAN</span>

<span class="pl-k">val</span> <span class="pl-en">integerNodes</span> <span class="pl-k">=</span> <span class="pl-k">for</span> {
  (key, node) <span class="pl-k">&lt;</span><span class="pl-k">-</span> node
  <span class="pl-en">ModelNode</span>(t) <span class="pl-k">=</span> node
  <span class="pl-k">if</span> t <span class="pl-k">==</span> <span class="pl-en">INT</span>
} <span class="pl-k">yield</span> node
<span class="pl-c">// results in List(42, 1, 2)</span></pre>
  </div> 
  <h2><a id="user-content-composites" class="anchor" href="https://github.com/hal/dmr.repl#composites" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Composites</h2> 
  <p>A composite operation is setup using the <code>ModelNode.composite(n: ModelNode, xn: ModelNode*)</code> factory method:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">ModelNode</span>.composite(
  <span class="pl-en">ModelNode</span>() at (<span class="pl-s"><span class="pl-pds">"</span>core-service<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>management<span class="pl-pds">"</span></span>) <span class="pl-k">/</span> (<span class="pl-s"><span class="pl-pds">"</span>access<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>authorization<span class="pl-pds">"</span></span>) op <span class="pl-en">'read_resource</span>(
    <span class="pl-en">'recursive_depth</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">2</span>),
  <span class="pl-en">ModelNode</span>() at (<span class="pl-s"><span class="pl-pds">"</span>core-service<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>management<span class="pl-pds">"</span></span>) <span class="pl-k">/</span> (<span class="pl-s"><span class="pl-pds">"</span>access<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>authorization<span class="pl-pds">"</span></span>) op <span class="pl-en">'read_children_names</span>(
    <span class="pl-en">'name</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>role-mapping<span class="pl-pds">"</span></span>),
  <span class="pl-en">ModelNode</span>() at (<span class="pl-s"><span class="pl-pds">"</span>subsystem<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>mail<span class="pl-pds">"</span></span>) <span class="pl-k">/</span> (<span class="pl-s"><span class="pl-pds">"</span>mail-session<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>*<span class="pl-pds">"</span></span>) op <span class="pl-en">'read_resource_description</span>,
  <span class="pl-en">ModelNode</span>() at (<span class="pl-s"><span class="pl-pds">"</span>subsystem<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>datasources<span class="pl-pds">"</span></span>) <span class="pl-k">/</span> (<span class="pl-s"><span class="pl-pds">"</span>data-source<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>ExampleDS<span class="pl-pds">"</span></span>) op <span class="pl-en">'disable</span> ,
  <span class="pl-en">ModelNode</span>() at (<span class="pl-s"><span class="pl-pds">"</span>core-service<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>platform-mbean<span class="pl-pds">"</span></span>) <span class="pl-k">/</span> (<span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>runtime<span class="pl-pds">"</span></span>) op <span class="pl-en">'read_attribute</span>(
    <span class="pl-en">'name</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>start-time<span class="pl-pds">"</span></span>)
)</pre>
  </div> 
  <h2><a id="user-content-execute-an-operation" class="anchor" href="https://github.com/hal/dmr.repl#execute-an-operation" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Execute an operation</h2> 
  <p>To execute DMR operations against a running WildFly instance use <a href="https://github.com/hal/dmr.repl" target="_blank">DMR.repl</a>. The <code>Response</code> object has an extractor and constants to parse the DMR response using pattern matching. The pattern matching variables <code>result</code> and <code>failure</code> are both model nodes containing the response payload or the wrapped error description:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">client</span> <span class="pl-k">=</span> connect()
<span class="pl-k">val</span> <span class="pl-en">node</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>() at (<span class="pl-s"><span class="pl-pds">"</span>subsystem<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>datasources<span class="pl-pds">"</span></span>) op <span class="pl-en">'read_resource</span>

<span class="pl-k">import</span> <span class="pl-v">org.jboss.dmr.repl.</span><span class="pl-v">Response</span>
<span class="pl-k">import</span> <span class="pl-v">org.jboss.dmr.repl.Response.</span>{<span class="pl-v">Success</span>, <span class="pl-v">Failure</span>}
(client <span class="pl-k">!</span> node) map {
  <span class="pl-k">case</span> <span class="pl-en">Response</span>(<span class="pl-en">Success</span>, result) <span class="pl-k">=&gt;</span> ...
  <span class="pl-k">case</span> <span class="pl-en">Response</span>(<span class="pl-en">Failure</span>, failure) <span class="pl-k">=&gt;</span> ...
}

<span class="pl-k">import</span> <span class="pl-v">scala.util.</span>{<span class="pl-v">Success</span>, <span class="pl-v">Failure</span>}
(client <span class="pl-k">?</span> node).onComplete {
  <span class="pl-k">case</span> <span class="pl-en">Success</span>(response) <span class="pl-k">=&gt;</span> ...
  <span class="pl-k">case</span> <span class="pl-en">Failure</span>(ex) <span class="pl-k">=&gt;</span> ...
}</pre>
  </div> 
  <h1><a id="user-content-repl-shell" class="anchor" href="https://github.com/hal/dmr.repl#repl-shell" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>REPL Shell</h1> 
  <h2><a id="user-content-connect" class="anchor" href="https://github.com/hal/dmr.repl#connect" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Connect</h2> 
  <p>To make use of DMR.repl, first thing you'll need is a client for a WildFly server.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">org.jboss.dmr.repl.Client.</span><span class="pl-v">_</span>

<span class="pl-c">// Creates a client and connects to 127.0.0.1:9999</span>
<span class="pl-k">val</span> <span class="pl-en">client</span>  <span class="pl-k">=</span> connect()

<span class="pl-c">// Connects to specified host:port</span>
<span class="pl-k">val</span> <span class="pl-en">client</span> <span class="pl-k">=</span> connect(<span class="pl-s"><span class="pl-pds">"</span>homer<span class="pl-pds">"</span></span>, <span class="pl-c1">9876</span>)</pre>
  </div> 
  <h2><a id="user-content-execute-dmr-operations" class="anchor" href="https://github.com/hal/dmr.repl#execute-dmr-operations" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Execute DMR Operations</h2> 
  <p>To execute an operation you can choose between <code>!</code> for synchronous and <code>?</code> for asynchronous execution. The synchronous method returns with a <code>Try[ModelNode]</code>, the asynchronous with a <code>Future[ModelNode]</code>.</p> 
  <h3><a id="user-content-synchronous" class="anchor" href="https://github.com/hal/dmr.repl#synchronous" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Synchronous</h3> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">org.jboss.dmr.repl.Response.</span>{<span class="pl-v">Success</span>, <span class="pl-v">Failure</span>}
<span class="pl-k">val</span> <span class="pl-en">node</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>() at (<span class="pl-s"><span class="pl-pds">"</span>subsystem<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>datasources<span class="pl-pds">"</span></span>) op <span class="pl-en">'read_resource</span>

(client <span class="pl-k">!</span> node) map {
  <span class="pl-k">case</span> <span class="pl-en">Response</span>(<span class="pl-en">Success</span>, result) <span class="pl-k">=&gt;</span> ...
  <span class="pl-k">case</span> <span class="pl-en">Response</span>(<span class="pl-en">Failure</span>, failure) <span class="pl-k">=&gt;</span> ...
}</pre>
  </div> 
  <h3><a id="user-content-asynchronous" class="anchor" href="https://github.com/hal/dmr.repl#asynchronous" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Asynchronous</h3> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">scala.util.</span>{<span class="pl-v">Success</span>, <span class="pl-v">Failure</span>}
<span class="pl-k">val</span> <span class="pl-en">node</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>() at (<span class="pl-s"><span class="pl-pds">"</span>subsystem<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>datasources<span class="pl-pds">"</span></span>) op <span class="pl-en">'read_resource</span>

(client <span class="pl-k">?</span> node).onComplete {
  <span class="pl-k">case</span> <span class="pl-en">Success</span>(response) <span class="pl-k">=&gt;</span> ...
  <span class="pl-k">case</span> <span class="pl-en">Failure</span>(ex) <span class="pl-k">=&gt;</span> ...
}</pre>
  </div> 
  <p>When executing DMR operations, you can make use of some handy extractors which will return the actual payload of a DMR response / composite response. If you execute a DMR operation like this</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">node</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>() at (<span class="pl-s"><span class="pl-pds">"</span>subsystem<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>datasources<span class="pl-pds">"</span></span>) op <span class="pl-en">'read_resource</span>
<span class="pl-k">val</span> <span class="pl-en">response</span> <span class="pl-k">=</span> client <span class="pl-k">!</span> node getOrElse <span class="pl-en">ModelNode</span>.<span class="pl-en">Undefined</span></pre>
  </div> 
  <p><code>response</code> will contain the full response:</p> 
  <pre><code>{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "data-source" =&gt; {"ExampleDS" =&gt; undefined},
        "jdbc-driver" =&gt; {"h2" =&gt; undefined},
        "xa-data-source" =&gt; undefined
    }
}
</code></pre> 
  <p>If you're just interested in the result, use</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">Response</span>(<span class="pl-en">Success</span>, result) <span class="pl-k">=</span> response</pre>
  </div> 
  <p>which will assign a model node to <code>result</code> containing just the payload:</p> 
  <pre><code>{
    "data-source" =&gt; {"ExampleDS" =&gt; undefined},
    "jdbc-driver" =&gt; {"h2" =&gt; undefined},
    "xa-data-source" =&gt; undefined
}
</code></pre> 
  <p>The same applies to composite operations:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">d1</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>() at (<span class="pl-s"><span class="pl-pds">"</span>deployment<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>foo.war<span class="pl-pds">"</span></span>) op <span class="pl-en">'read_resource</span>
<span class="pl-k">val</span> <span class="pl-en">d2</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>() at (<span class="pl-s"><span class="pl-pds">"</span>deployment<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>bar.war<span class="pl-pds">"</span></span>) op <span class="pl-en">'read_resource</span>
<span class="pl-k">val</span> <span class="pl-en">comp</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>.composite(d1, d2)
<span class="pl-k">val</span> <span class="pl-en">response</span> <span class="pl-k">=</span> client <span class="pl-k">!</span> comp getOrElse <span class="pl-en">ModelNode</span>.<span class="pl-en">Undefined</span></pre>
  </div> 
  <p>Again <code>response</code> will contain the full response with the all steps and nested responses:</p> 
  <pre><code>{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "step-1" =&gt; {
            "outcome" =&gt; "success",
            "result" =&gt; {
                "name" =&gt; "foo.war",
                ...
            }
        },
        "step-2" =&gt; {
            "outcome" =&gt; "success",
            "result" =&gt; {
                "name" =&gt; "bar.war",
                ...
            }
        }
    }
}
</code></pre> 
  <p>To extract just the nested result nodes, use the <code>Composite</code> extractor:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">Composite</span>(<span class="pl-en">Success</span>, steps) <span class="pl-k">=</span> response</pre>
  </div> 
  <p>which will give you a <code>List[ModelNode]</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">List</span>(
{
    <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>foo.war<span class="pl-pds">"</span></span>,
    ...
},
{
    <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>bar.war<span class="pl-pds">"</span></span>,
    ...
})
</pre>
  </div> 
  <h2><a id="user-content-dmr-scripts" class="anchor" href="https://github.com/hal/dmr.repl#dmr-scripts" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>DMR Scripts</h2> 
  <p>If you have a more advanced use cases or want to chain several operations, scripts are the way to go. To write a script create a subclass of <code>Script</code> and override the <code>code</code> method. Scripts carry a type parameter for the expected result. Furthermore they rely on an implicit client instance which is brought into scope by the clients companion object. So please make sure you <code>import org.jboss.dmr.repl.Client._</code> when you run your script.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">scala.concurrent.duration.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">scala.util.</span><span class="pl-v">Try</span>
<span class="pl-k">import</span> <span class="pl-v">org.jboss.dmr.scala.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">org.jboss.dmr.repl.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">org.jboss.dmr.repl.Response.</span><span class="pl-v">_</span>

<span class="pl-c">/** Returns the uptime for the standalone server */</span>
<span class="pl-k">class</span> <span class="pl-en">Uptime</span> <span class="pl-k">extends</span> <span class="pl-e">Script</span>[<span class="pl-en">Duration</span>] {
  <span class="pl-k">def</span> <span class="pl-en">code</span><span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-en">Duration</span>] <span class="pl-k">=</span> {
    <span class="pl-k">val</span> <span class="pl-en">node</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>() at (<span class="pl-s"><span class="pl-pds">"</span>core-service<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>platform-mbean<span class="pl-pds">"</span></span>) <span class="pl-k">/</span> (<span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>runtime<span class="pl-pds">"</span></span>) op <span class="pl-en">'read_attribute</span>(<span class="pl-en">'name</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>uptime<span class="pl-pds">"</span></span>)
    client <span class="pl-k">!</span> node map {
      <span class="pl-k">case</span> <span class="pl-en">Response</span>(<span class="pl-en">Success</span>, result) <span class="pl-k">=&gt;</span> result.asLong.get.millis
      <span class="pl-k">case</span> <span class="pl-en">Response</span>(<span class="pl-en">Failure</span>, failure) <span class="pl-k">=&gt;</span> <span class="pl-k">throw</span> <span class="pl-k">new</span> <span class="pl-en">ScriptException</span>(failure)
    }
  }
}</pre>
  </div> 
  <p>Execute a script using its run method:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">org.jboss.dmr.repl.Client.</span><span class="pl-v">_</span>

connect()
<span class="pl-k">val</span> <span class="pl-en">uptime</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Uptime</span>().run()</pre>
  </div> 
  <p>Please see the <a href="https://github.com/hal/dmr.repl/blob/master/src/main/scala/org/jboss/dmr/repl/samples" target="_blank">samples</a> package for more advanced samples.</p> 
  <h2><a id="user-content-local-storage" class="anchor" href="https://github.com/hal/dmr.repl#local-storage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Local Storage</h2> 
  <p>You can save and load model nodes to and from the local file system. By default they are written as base64 to <code>~/.sbt/node_&lt;counter&gt;</code>, but you can choose another folder and/or filename.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">node</span> <span class="pl-k">=</span> <span class="pl-en">ModelNode</span>() at (<span class="pl-s"><span class="pl-pds">"</span>core-service<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>platform-mbean<span class="pl-pds">"</span></span>) <span class="pl-k">/</span> (<span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>runtime<span class="pl-pds">"</span></span>) op <span class="pl-en">'read_resource</span>(
  <span class="pl-en">'attributes_only</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">true</span>,
  <span class="pl-en">'include_runtime</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">false</span>,
  <span class="pl-en">'recursive_depth</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">3</span>,
  <span class="pl-en">'custom_parameter</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>custom-value<span class="pl-pds">"</span></span>
)

<span class="pl-c">// Uses an implicit conversion and the default folder and filename</span>
node.save()

<span class="pl-c">// Uses a storage using the folder 'nodes' in the current folder and saves the node as 'mbean'</span>
<span class="pl-k">val</span> <span class="pl-en">storage</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Storage</span>(<span class="pl-k">new</span> <span class="pl-en">java.io.File</span>(<span class="pl-s"><span class="pl-pds">"</span>nodes<span class="pl-pds">"</span></span>))
storage.save(node, <span class="pl-s"><span class="pl-pds">"</span>mbean<span class="pl-pds">"</span></span>)

<span class="pl-c">// load by name</span>
<span class="pl-k">val</span> <span class="pl-en">copy</span> <span class="pl-k">=</span> storage.load(<span class="pl-s"><span class="pl-pds">"</span>mbean<span class="pl-pds">"</span></span>)

<span class="pl-c">// get rid of the saved node</span>
storage.remove(<span class="pl-s"><span class="pl-pds">"</span>mbean<span class="pl-pds">"</span></span>)</pre>
  </div> 
 </article>
</div>