<div class="announce instapaper_body md" data-path="readme.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a href="https://github.com/cchantep/acolyte#acolyte" aria-hidden="true" class="anchor" id="user-content-acolyte" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Acolyte</h1> 
  <p>Acolyte is a JDBC driver designed for cases like mockup, testing, or any case you would like to be able to handle JDBC query by hand (or maybe that's only Chmeee's son on the Ringworld).</p> 
  <h2><a href="https://github.com/cchantep/acolyte#motivation" aria-hidden="true" class="anchor" id="user-content-motivation" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Motivation</h2> 
  <p>Persistence layer not only apply changes and retrieve raw data. It usually gathers those data from several sources (e.g. various queries), but also converts data types (e.g. integer to boolean) and maps it to structured information.</p> 
  <p>Automated testing about that is not trivial. Using test DB requires tools (scripts) to set up environment repeatly, for each time tests are executed.</p> 
  <p>Considering integration testing that's fine. It's different for unit testing.</p> 
  <p>Unit tests must be isolated from each others so each unit can be validated independently.</p> 
  <p>A unit test can alter database as executed. Thus tests coming after would have to cope with this altered environment, without asserting which one is runned first (no order assumption).</p> 
  <p>As tests can be runned in parallel while considering code accessing same data spaces. Without extra attention to isolation/transaction management, this can lead to tests conflicting between them.</p> 
  <p>With Acolyte, connection behaviour can be built, defining which statement is supported with which (query or update) result.</p> 
  <p>Each prepared connection can supports only queries and updates your code is interested in, and there is no need to simulate a whole data store structure/schema.</p> 
  <p>As soon as Acolyte connections don't rely on data store, statement executions are isolated without extra effort.</p> 
  <p>As a JDBC driver is provided you can simply update test configuration, so that Acolyte connections are resolved by persistence code without change throught standard mechanisms (JDBC URL, JNDI, ...).</p> 
  <p>It also makes simple testing of DB edge cases (e.g. unrecoverable/unexpected error). It's easy to throw an exception from Acolyte connection, so that it can be validated persistence code is properly handling such case.</p> 
  <p>You can also use Acolyte to fully benefit from data access abstraction, not only not having to wait persistence (DB) being setup to code accesses, but also not having to wait persistence to code tests for access code.</p> 
  <p>You can get a quick interactive tour of Acolyte, online at <a href="http://tour.acolyte.eu.org" target="_blank">tour.acolyte.eu.org</a>.</p> 
  <h2><a href="https://github.com/cchantep/acolyte#usage" aria-hidden="true" class="anchor" id="user-content-usage" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h2> 
  <p>Acolyte is usable with any code relying on JDBC. It makes it available for any JVM language:</p> 
  <ul> 
   <li>vanilla <a href="http://acolyte.eu.org/java/" target="_blank">Java</a>,</li> 
   <li><a href="http://acolyte.eu.org/scala/" target="_blank">Scala</a> (with DSL),</li> 
   <li><a href="http://clojure.com" target="_blank">Clojure</a>, <a href="https://github.com/Frege/frege" target="_blank">Fredge</a>, ...</li> 
  </ul> 
  <p>You can get connection defined by Acolyte using the well-known <code>java.sql.DriverManager.getConnection(jdbcUrl)</code> (see <a href="http://acolyte.eu.org/java/#Connection" target="_blank">connection management</a>).</p> 
  <div class="highlight highlight-source-java">
   <pre><span class="pl-k">final</span> <span class="pl-smi">String</span> jdbcUrl <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>jdbc:acolyte:anything-you-want?handler=my-unique-id<span class="pl-pds">"</span></span>;

<span class="pl-smi">StatementHandler</span> handler <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">CompositeHandler</span>()<span class="pl-c1">.</span>
  withQueryDetection(<span class="pl-s"><span class="pl-pds">"</span>^SELECT <span class="pl-pds">"</span></span>)<span class="pl-c1">.</span> <span class="pl-c"><span class="pl-c">//</span> regex test from beginning</span>
  withQueryDetection(<span class="pl-s"><span class="pl-pds">"</span>EXEC that_proc<span class="pl-pds">"</span></span>)<span class="pl-c1">.</span> <span class="pl-c"><span class="pl-c">//</span> second detection regex</span>
  withUpdateHandler(<span class="pl-k">new</span> <span class="pl-smi">CompositeHandler</span>.<span class="pl-smi">UpdateHandler</span>() {
    <span class="pl-c"><span class="pl-c">//</span> Handle execution of update statement (not query)</span>
    <span class="pl-k">public</span> <span class="pl-smi">UpdateResult</span> <span class="pl-en">apply</span>(<span class="pl-smi">String</span> <span class="pl-v">sql</span>, <span class="pl-k">List&lt;<span class="pl-smi">Parameter</span>&gt;</span> <span class="pl-v">parameters</span>) {
      <span class="pl-c"><span class="pl-c">//</span> ...</span>
    }
  })<span class="pl-k">.</span>withQueryHandler(<span class="pl-k">new</span> <span class="pl-smi">CompositeHandler</span>.<span class="pl-smi">QueryHandler</span> () {
    <span class="pl-k">public</span> <span class="pl-smi">QueryResult</span> <span class="pl-en">apply</span>(<span class="pl-smi">String</span> <span class="pl-v">sql</span>, <span class="pl-k">List&lt;<span class="pl-smi">Parameter</span>&gt;</span> <span class="pl-v">parameters</span>) {
      <span class="pl-c"><span class="pl-c">//</span> ...</span>
    }
  });

<span class="pl-c"><span class="pl-c">//</span> Register prepared handler with expected ID 'my-unique-id'</span>
<span class="pl-smi">acolyte.jdbc<span class="pl-k">.</span>Driver</span><span class="pl-k">.</span>register(<span class="pl-s"><span class="pl-pds">"</span>my-unique-id<span class="pl-pds">"</span></span>, handler);

<span class="pl-c"><span class="pl-c">//</span> then when existing code do ...</span>
<span class="pl-smi">Connection</span> con <span class="pl-k">=</span> <span class="pl-smi">DriverManager</span><span class="pl-k">.</span>getConnection(jdbcUrl);

<span class="pl-c"><span class="pl-c">//</span> ... Connection |con| is managed through Acolyte |handler|</span></pre>
  </div> 
  <p>You can use Acolyte with various JVM test and persistence frameworks (see <a href="http://acolyte.eu.org/integration/" target="_blank">Integration guide</a>).</p> 
  <p>With <a href="http://acolyte.eu.org/studio/" target="_blank">Studio</a>, you can use data extracted from existing database with Acolyte handler.</p> 
  <p><em>Projects using Acolyte:</em></p> 
  <ul> 
   <li><a href="http://www.playframework.com/" target="_blank">Play Framework</a> Anorm (<a href="https://github.com/playframework/anorm/blob/master/core/src/test/scala/anorm/AnormSpec.scala" target="_blank">AnormSpec</a>).</li> 
   <li><a href="https://github.com/youtube/vitess" target="_blank">Youtube Vitess</a>.</li> 
  </ul> 
  <p>To share questions, answers &amp; ideas, you can go to the <a href="https://groups.google.com/forum/#!forum/acolyte-support" target="_blank">mailing list</a>.</p> 
  <h2><a href="https://github.com/cchantep/acolyte#requirements" aria-hidden="true" class="anchor" id="user-content-requirements" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Requirements</h2> 
  <ul> 
   <li>Java 1.6+</li> 
  </ul> 
  <h2><a href="https://github.com/cchantep/acolyte#limitations" aria-hidden="true" class="anchor" id="user-content-limitations" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Limitations</h2> 
  <ul> 
   <li>Limited datatype conversions.</li> 
   <li>Binary datatype are not currently supported.</li> 
   <li>Pseudo-support for transaction.</li> 
   <li>Currency types.</li> 
  </ul> 
  <h2><a href="https://github.com/cchantep/acolyte#related-applications" aria-hidden="true" class="anchor" id="user-content-related-applications" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Related applications</h2> 
  <ul> 
   <li><a href="http://acolyte.eu.org/studio/" target="_blank">Acolyte Studio</a>: Application with CLI and GUI which is useful when you already have a database and want tests to use data extracted from there.</li> 
   <li><a href="http://acolyte.eu.org/reactive-mongo/" target="_blank">Acolyte for ReactiveMongo</a>. Acolyte module to unit test persistence based on <a href="http://reactivemongo.org/" target="_blank">ReactiveMongo</a>.</li> 
  </ul> 
 </article>
</div>