<div class="announce instapaper_body markdown" data-path="README.markdown" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-this-is-now-an-official-part-of-unfiltered" class="anchor" href="https://github.com/teigen/unfiltered-directives#this-is-now-an-official-part-of-unfiltered" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>[This is now an official part of <a href="https://github.com/unfiltered/unfiltered/tree/master/directives" target="_blank">Unfiltered</a>]</h1> 
  <h2><a id="user-content-use-the-official-unfiltered-version-and-ignore-this-one-its-no-longer-maintained" class="anchor" href="https://github.com/teigen/unfiltered-directives#use-the-official-unfiltered-version-and-ignore-this-one-its-no-longer-maintained" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Use the official Unfiltered version, and ignore this one.. its no longer maintained</h2> 
  <h1><a id="user-content-unfiltered-directives" class="anchor" href="https://github.com/teigen/unfiltered-directives#unfiltered-directives" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Unfiltered-Directives</h1> 
  <p>A monadic api for <a href="http://github.com/unfiltered/unfiltered" target="_blank">Unfiltered</a> demonstrated at <a href="http://nescala.org/" target="_blank">NEScala 2013</a></p> 
  <h1><a id="user-content-download--use" class="anchor" href="https://github.com/teigen/unfiltered-directives#download--use" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Download / Use</h1> 
  <p>Unfiltered-Directives is published to maven central for scala versions "2.9.1-1", "2.9.2" and "2.10.0"</p> 
  <pre><code>libraryDependencies += "com.jteigen" %% "unfiltered-directives" % "0.1"
</code></pre> 
  <h1><a id="user-content-why-" class="anchor" href="https://github.com/teigen/unfiltered-directives#why-" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Why ?</h1> 
  <p>Writing well behaved http applications is hard. You are often left with the choice between readable code and a well behaved application. Unfiltered-Directives is an attempt at making it simpler to write readable and well behaved applications. Its design is influenced by (parser-combinators)[<a href="https://github.com/scala/scala/blob/master/src/library/scala/util/parsing/combinator/Parsers.scala" target="_blank">https://github.com/scala/scala/blob/master/src/library/scala/util/parsing/combinator/Parsers.scala</a>], but unlike the parser combinators, it avoids the heavy use of operators.</p> 
  <h2><a id="user-content-1---good-code-bad-http" class="anchor" href="https://github.com/teigen/unfiltered-directives#1---good-code-bad-http" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>1 - Good code, Bad HTTP</h2> 
  <p>While this code is very readable and simple to understand, it's hard to use. If the client doesn't get everything right the result will be a 404 (not found) - making it hard for the client to understand whats wrong</p> 
  <pre><code>def intent = {
  case req @ POST(Path("/example"))) &amp; Accepts.Json(RequestContentType("application/json")) =&gt;
    Ok ~&gt; JsonContent ~&gt; ResponseBytes(Body.bytes(req))
}
</code></pre> 
  <h2><a id="user-content-2---bad-code-good-http" class="anchor" href="https://github.com/teigen/unfiltered-directives#2---bad-code-good-http" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>2 - Bad code, Good HTTP</h2> 
  <p>A better implementation is something like this, where the client will be given a reasonable status indicating whats wrong. But it's less readable, and if you have multiple resources you will quickly find yourself copy-pasting a lot of that behaviour between your resources</p> 
  <pre><code>def intent = {
  case req @ Path("/example") =&gt; req match {
    case POST(_) =&gt; req match {
      case RequestContentType("application/json") =&gt; req match {
        case Accepts.Json(_) =&gt;
          Ok ~&gt; JsonContent ~&gt; ResponseBytes(Body.bytes(req))
        case _ =&gt; NotAcceptable
      }
      case _ =&gt; UnsupportedMediaType
    }
    case _ =&gt; MethodNotAllowed
  }
}
</code></pre> 
  <h2><a id="user-content-3---good-code-good-http" class="anchor" href="https://github.com/teigen/unfiltered-directives#3---good-code-good-http" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>3 - Good code, Good HTTP</h2> 
  <p>Unfiltered-Directives provides a nice api for providing reasonable HTTP behaviour, while allowing you to write good and readable code. The following example behaves exactly like the previous example, but is much more usable</p> 
  <pre><code>import directives._, Directives._

// it's simple to define your own directives
def contentType(tpe:String) =
  when{ case RequestContentType(`tpe`) =&gt; } orElse UnsupportedMediaType

def intent = Path.Intent {
  case Seg(List("example", id)) =&gt;
    for {
      _ &lt;- POST
      _ &lt;- contentType("application/json")
      _ &lt;- Accepts.Json
      r &lt;- request[Any]
    } yield Ok ~&gt; JsonContent ~&gt; ResponseBytes(Body bytes r)
}
</code></pre> 
  <h2><a id="user-content-4---reuse" class="anchor" href="https://github.com/teigen/unfiltered-directives#4---reuse" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>4 - Reuse</h2> 
  <p>Directives are composable and simple to reuse. This example demonstrates how you can build and reuse a session based directive requiring users to login.</p> 
  <pre><code>import directives._, Directives._
import javax.servlet.http.HttpServletRequest

case class User(name:String)

// depending on the underlying request directive, providing the HttpSession
def session = underlying[HttpServletRequest].map(_.getSession)

// depending on the session directive, getting the User from session, orElse redirecting user to the `"/login"` page
def user = session.flatMap{ s =&gt;
  val u = Option(s.getAttribute("user")).map(_.asInstanceOf[User])
  getOrElse(u, Redirect("/login"))
}

def intent = Intent {
  case "/" =&gt;
    for {
      _ &lt;- GET
      u &lt;- user
    } yield Html5(&lt;h1&gt;Hi {u.name}&lt;/h1&gt;)

  case "/mypage" =&gt;
    for {
	  _ &lt;- POST
	  u &lt;- user
    } yield doStuffWithUser(u)
}
</code></pre> 
  <p>Runnable examples are available under <code>src/test/scala</code></p> 
  <h2><a id="user-content-licence" class="anchor" href="https://github.com/teigen/unfiltered-directives#licence" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Licence</h2> 
  <p>MIT licenced (same licence as Unfiltered)</p> 
 </article>
</div>