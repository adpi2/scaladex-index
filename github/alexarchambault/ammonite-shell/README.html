<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h2><a id="user-content-ammonium" class="anchor" href="https://github.com/alexarchambault/ammonite-shell#ammonium" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>ammonium</h2> 
  <p>A modified version of <a href="https://github.com/lihaoyi/Ammonite/" target="_blank">Ammonite</a>.</p> 
  <p><a href="https://travis-ci.org/alexarchambault/ammonium" target="_blank"><img src="https://camo.githubusercontent.com/26b44e6028b0c77a6d81bd3378efcfcd398e69df/68747470733a2f2f7472617669732d63692e6f72672f616c657861726368616d6261756c742f616d6d6f6e69756d2e737667" alt="Build Status" data-canonical-src="https://travis-ci.org/alexarchambault/ammonium.svg" style="max-width:100%;"></a> <a href="https://maven-badges.herokuapp.com/maven-central/com.github.alexarchambault.ammonium/interpreter_2.11.8" target="_blank"><img src="https://camo.githubusercontent.com/642665233d3d20860fec8a7b7c55024b27d605ff/68747470733a2f2f696d672e736869656c64732e696f2f6d6176656e2d63656e7472616c2f762f636f6d2e6769746875622e616c657861726368616d6261756c742e616d6d6f6e69756d2f696e7465727072657465725f322e31312e382e737667" alt="Maven Central" data-canonical-src="https://img.shields.io/maven-central/v/com.github.alexarchambault.ammonium/interpreter_2.11.8.svg" style="max-width:100%;"></a></p> 
  <p>If you're not using Spark, or are not interested in advanced features like class loader isolation, you should really be using <a href="https://github.com/lihaoyi/Ammonite/" target="_blank">Ammonite</a>. If you prefer web-based notebook interfaces to terminal ones, you should be using <a href="https://github.com/alexarchambault/jupyter-scala" target="_blank">jupyter-scala</a>. Else, welcome here, this is ammonium, a - possibly temporary, and somehow experimental - fork of Ammonite, and the basis of <a href="https://github.com/alexarchambault/jupyter-scala" target="_blank">jupyter-scala</a>!</p> 
  <p>Compared to the original Ammonite, it adds, among others, the following features:</p> 
  <ul> 
   <li>Java serialization friendly (Spark support through an external dependency loaded from the REPL),</li> 
   <li>cleaner user-facing ClassLoader (less dependencies -&gt; cleaner completion, easier to move the session JARs around),</li> 
   <li>better dependencies management (faster module resolution with <a href="https://github.com/alexarchambault/coursier" target="_blank">coursier</a>),</li> 
   <li>easier to re-use in other contexts (in particular, <a href="https://github.com/alexarchambault/jupyter-scala" target="_blank">jupyter-scala</a>, the initial motivation of this repo).</li> 
  </ul> 
  <p>Most of these require some hard-to-justify-a-priori overhauling of the code, hence this fork.</p> 
  <h2><a id="user-content-try-it" class="anchor" href="https://github.com/alexarchambault/ammonite-shell#try-it" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Try it</h2> 
  <p>Download and run its launcher with</p> 
  <pre><code>curl -L -o ammonium https://git.io/vzNa2 &amp;&amp; chmod +x ammonium &amp;&amp; ./ammonium
</code></pre> 
  <p>For the 2.10 version, do</p> 
  <pre><code>curl -L -o ammonium-2.10 https://git.io/vzApn &amp;&amp; chmod +x ammonium-2.10 &amp;&amp; ./ammonium-2.10
</code></pre> 
  <h2><a id="user-content-usage" class="anchor" href="https://github.com/alexarchambault/ammonite-shell#usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h2> 
  <h3><a id="user-content-adding-dependencies" class="anchor" href="https://github.com/alexarchambault/ammonite-shell#adding-dependencies" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Adding dependencies</h3> 
  <p>Example</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">@</span> classpath.add(<span class="pl-s"><span class="pl-pds">"</span>org.typelevel<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>cats<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.4.0<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>Several dependencies can be added at the same time:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">@</span> classpath.add(
    <span class="pl-s"><span class="pl-pds">"</span>org.typelevel<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>cats<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.4.0<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>com.chuusai<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>shapeless<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>2.2.5<span class="pl-pds">"</span></span>
  )</pre>
  </div> 
  <h3><a id="user-content-adding-compiler-plugin" class="anchor" href="https://github.com/alexarchambault/ammonite-shell#adding-compiler-plugin" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Adding compiler plugin</h3> 
  <p>Compiler plugins are like standard dependencies, except that they are added to a separate configuration - here <code>"plugin"</code> instead of the default <code>"compile"</code>.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">@</span> classpath.addInConfig(<span class="pl-s"><span class="pl-pds">"</span>plugin<span class="pl-pds">"</span></span>)(
    <span class="pl-s"><span class="pl-pds">"</span>org.spire-math<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>kind-projector<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.7.1<span class="pl-pds">"</span></span>
  )
<span class="pl-en">Adding</span> <span class="pl-c1">1</span> artifact(s)

<span class="pl-k">@</span> <span class="pl-k">trait</span> <span class="pl-en">TC</span>[<span class="pl-en">F</span>[_]]
defined <span class="pl-k">trait</span> <span class="pl-en">TC</span>

<span class="pl-k">@</span> <span class="pl-k">type</span> <span class="pl-en">TCEitherStr</span> <span class="pl-k">=</span> <span class="pl-en">TC</span>[<span class="pl-en">Either</span>[<span class="pl-k">String</span>, <span class="pl-k">?</span>]]
defined <span class="pl-k">type</span> <span class="pl-en">TCEitherStr</span></pre>
  </div> 
  <h3><a id="user-content-easier-dependency-adding-with-setups" class="anchor" href="https://github.com/alexarchambault/ammonite-shell#easier-dependency-adding-with-setups" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Easier dependency adding with setups</h3> 
  <p>Setups allow to easily add a bunch of dependencies in the session, and run a few lines that typically initialize what was added.</p> 
  <p>Example:</p> 
  <pre><code>@ setup("shapeless") // load shapeless and add its main imports
...

@ (1, "a") :+ true
res1: (Int, String, Boolean) = (1, "a", true)

@ 1.narrow
res2: 1 = 1
</code></pre> 
  <pre><code>@ setup("cats")
...


</code></pre> 
  <h3><a id="user-content-other" class="anchor" href="https://github.com/alexarchambault/ammonite-shell#other" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Other</h3> 
  <p>Manually evaluate code:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">@</span> eval(<span class="pl-s"><span class="pl-pds">"</span>print(2)<span class="pl-pds">"</span></span>)
...</pre>
  </div> 
  <p>List what's in the classpath:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">@</span> show(classpath.path()) <span class="pl-c">// inspects the default configuration, compile</span>
...

<span class="pl-k">@</span> show(classpath.path(<span class="pl-s"><span class="pl-pds">"</span>plugin<span class="pl-pds">"</span></span>)) <span class="pl-c">// look at the compiler plugins configuration</span>
...</pre>
  </div> 
  <p>Print a value, with no truncation (same as in Ammonite):</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">@</span> show(<span class="pl-en">List</span>.fill(<span class="pl-c1">40</span>)(<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>))
...</pre>
  </div> 
  <h3><a id="user-content-spark" class="anchor" href="https://github.com/alexarchambault/ammonite-shell#spark" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Spark</h3> 
  <p>Example of Spark session on a YARN cluster</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">@</span> <span class="pl-k">val</span> <span class="pl-en">sparkHome</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>/spark/1.6.0-bin-scala-2.11_hadoop-2.6<span class="pl-pds">"</span></span>
<span class="pl-k">@</span> <span class="pl-k">val</span> <span class="pl-en">hadoopConfDir</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>/etc/hadoop<span class="pl-pds">"</span></span> <span class="pl-c">// should contain things like yarn-site.xml or hdfs-site.xml</span>
<span class="pl-k">@</span> <span class="pl-k">val</span> <span class="pl-en">sparkAssembly</span> <span class="pl-k">=</span> s<span class="pl-s"><span class="pl-pds">"</span>$sparkHome/lib/spark-assembly-1.6.0-hadoop2.6.0.jar<span class="pl-pds">"</span></span>
<span class="pl-k">@</span> <span class="pl-k">val</span> <span class="pl-en">sparkMaster</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>yarn-client<span class="pl-pds">"</span></span>
<span class="pl-k">@</span> <span class="pl-k">val</span> <span class="pl-en">sparkVersion</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>1.6.0<span class="pl-pds">"</span></span>
<span class="pl-k">@</span> <span class="pl-k">val</span> <span class="pl-en">hadoopVersion</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>2.6.0<span class="pl-pds">"</span></span>
<span class="pl-k">@</span> <span class="pl-k">val</span> <span class="pl-en">scalaVersion</span> <span class="pl-k">=</span> scala.util.<span class="pl-en">Properties</span>.versionNumberString

<span class="pl-k">@</span> classpath.addPath(hadoopConfDir)

<span class="pl-k">@</span> classpath.add(
    <span class="pl-s"><span class="pl-pds">"</span>com.github.alexarchambault.ammonium<span class="pl-pds">"</span></span> <span class="pl-k">%</span> s<span class="pl-s"><span class="pl-pds">"</span>spark_${sparkVersion}_${scalaVersion}<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.4.0-M6<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>org.apache.spark<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>spark-yarn<span class="pl-pds">"</span></span> <span class="pl-k">%</span> sparkVersion,
    <span class="pl-s"><span class="pl-pds">"</span>org.apache.hadoop<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>hadoop-client<span class="pl-pds">"</span></span> <span class="pl-k">%</span> hadoopVersion,
    <span class="pl-s"><span class="pl-pds">"</span>org.apache.hadoop<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>hadoop-yarn-server-web-proxy<span class="pl-pds">"</span></span> <span class="pl-k">%</span> hadoopVersion,
    <span class="pl-s"><span class="pl-pds">"</span>org.apache.hadoop<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>hadoop-aws<span class="pl-pds">"</span></span> <span class="pl-k">%</span> hadoopVersion
  )

<span class="pl-k">@</span> <span class="pl-k">@</span>transient <span class="pl-k">val</span> <span class="pl-en">Spark</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">ammonite.spark.Spark</span>

<span class="pl-k">@</span> <span class="pl-k">import</span> <span class="pl-v">Spark.</span>{ <span class="pl-v">sparkConf</span>, <span class="pl-v">sc</span>, <span class="pl-v">sqlContext</span> }

<span class="pl-k">@</span> sparkConf
    .setMaster(<span class="pl-s"><span class="pl-pds">"</span>yarn-client<span class="pl-pds">"</span></span>)
    .setAppName(<span class="pl-s"><span class="pl-pds">"</span>ammonium-spark<span class="pl-pds">"</span></span>)
    .set(<span class="pl-s"><span class="pl-pds">"</span>spark.home<span class="pl-pds">"</span></span>, sparkHome)
    .set(<span class="pl-s"><span class="pl-pds">"</span>spark.yarn.jar<span class="pl-pds">"</span></span>, sparkAssembly)

<span class="pl-k">@</span> sc</pre>
  </div> 
  <h2><a id="user-content-internals" class="anchor" href="https://github.com/alexarchambault/ammonite-shell#internals" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Internals</h2> 
  <p>ammonium's fork started - then diverged - from the original Ammonite sources around mid-2015.</p> 
  <p>The first two notable changes consist in splitting the <code>repl</code> module of Ammonite in 2, then each of the resulting modules in 2 again, resulting in 4 modules. The first split separates the user-facing API (<code>interpreter-api</code> and <code>shell-api</code> modules in ammonium) from the internals of the interpreter (<code>interpreter</code> and <code>shell</code> in ammonium). Each of them are split in 2 again, separating the core of the interpreter (<code>interpreter-api</code> and <code>interpreter</code>) from the terminal-specific parts (<code>shell-api</code> and <code>shell</code>). So the 4 resulting modules are:</p> 
  <ul> 
   <li><code>interpreter</code>: the core of the interpreter, able to compile code and dealing with byte code and classpaths,</li> 
   <li><code>interpreter-api</code>: the user-facing parts of the core of the interpreter - contains definitions of interfaces that will be seen by the users, like <code>Classpath</code>, <code>Eval</code>, or <code>Setup</code>,</li> 
   <li><code>shell</code>: a terminal-based interface for the interpreter, with roughly the same features as <code>repl</code> from Ammonite,</li> 
   <li><code>shell-api</code>: the <code>shell</code>-specific user-facing parts of <code>shell</code> - defines <code>Term</code> in particular.</li> 
  </ul> 
  <p><code>interpreter</code> and <code>shell-api</code> depend on <code>interpreter-api</code>. <code>shell</code> depends on the 3 others.</p> 
  <h2><a id="user-content-launcher-internals" class="anchor" href="https://github.com/alexarchambault/ammonite-shell#launcher-internals" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Launcher internals</h2> 
  <p>The launchers heavily use the possibilities offered by <a href="https://github.com/alexarchambault/coursier" target="_blank">coursier</a>. With the coursier launcher, one could trivially launch ammonium with</p> 
  <pre><code>$ ./coursier launch com.github.alexarchambault.ammonium:shell_2.11.7:0.4.0-M6
</code></pre> 
  <p>Launching ammonium this way prevents class loader isolation to work though: the ammonium dependencies are mixed up with the user ones, in the REPL session.</p> 
  <p>For class loader isolation to work, one must ask the coursier launcher to setup separate class loaders with just the right dependencies, alongside the class loader that loads and runs ammonium. This can be achieved with</p> 
  <pre><code>$ ./coursier launch \
    com.github.alexarchambault.ammonium:shell_2.11.7:0.4.0-M6 \
    -i ammonium-compile,ammonium-macro \
    -I ammonium-compile:com.github.alexarchambault.ammonium:shell-api_2.11.7:0.4.0-M6 \
    -I ammonium-macro:org.scala-lang:scala-compiler:2.11.7
</code></pre> 
  <p>The <code>-i ammonium-compile,ammonium-macro</code> options asks the coursier launcher to setup two separate class loaders (alongside the main one), <code>ammonium-compile</code> and <code>ammonium-macro</code>. The class loaders setup by the launcher form a hierarchy, that is <code>ammonium-compile</code> will be the parent of <code>ammonium-macro</code>, which will itself be the parent of the class loader that will load the remaining dependencies.</p> 
  <p>The <code>-I ammonium-compile:com.github.alexarchambault.ammonium:shell-api_2.11.7:0.4.0-M6</code> option asks the launcher to put the dependency <code>com.github.alexarchambault.ammonium:shell-api_2.11.7:0.4.0-M6</code>, along with its transitive dependencies, in the <code>ammonium-compile</code> loader. In the same fashion, <code>-I ammonium-macro:org.scala-lang:scala-compiler:2.11.7</code> asks the launcher to put <code>org.scala-lang:scala-compiler:2.11.7</code> and its transitive dependencies in the <code>ammonium-macro</code> loader. The remaining dependencies of <code>com.github.alexarchambault.ammonium:shell_2.11.7:0.4.0-M6</code> will be put in a third class loader, inheriting <code>ammonium-macro</code>.</p> 
  <p>Launched this way, ammonium will find the <code>ammonium-compile</code> and <code>ammonium-macro</code> loaders, and use them to setup class loader isolation in the session. <code>ammonium-compile</code> will be the basis of the class loader of the session, and <code>ammonium-macro</code> will be the basis of the loader that runs macros.</p> 
  <p>The launchers that are linked above are generated by <a href="https://github.com/alexarchambault/ammonium/blob/master/project/generate-launcher.sh" target="_blank">a separate script</a>, that asks coursier to generate a bootstrap launcher, which downloads all the dependencies of ammonium in a first time, then launch ammonium with the same class loader setup as above.</p> 
  <h2><a id="user-content-notice" class="anchor" href="https://github.com/alexarchambault/ammonite-shell#notice" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Notice</h2> 
  <p>Copyright 2015-2016, Alexandre Archambault</p> 
  <p>Original Ammonite code is Copyright 2014-2015, Li Haoyi</p> 
  <p>Released under a MIT license</p> 
 </article>
</div>