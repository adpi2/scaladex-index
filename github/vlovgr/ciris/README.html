<div class="announce instapaper_body md" data-path="readme.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <p><a href="https://travis-ci.org/vlovgr/ciris" target="_blank"><img src="https://camo.githubusercontent.com/31ff35f430d78d8bc1800d22c3e5bcfe5fbac8b2/68747470733a2f2f696d672e736869656c64732e696f2f7472617669732f766c6f7667722f63697269732f6d61737465722e737667" alt="Travis" data-canonical-src="https://img.shields.io/travis/vlovgr/ciris/master.svg" style="max-width:100%;"></a> <a href="https://codecov.io/gh/vlovgr/ciris" target="_blank"><img src="https://camo.githubusercontent.com/64f8ebcebef209dbf7d5f6bd353897ede4fad7e0/68747470733a2f2f696d672e736869656c64732e696f2f636f6465636f762f632f6769746875622f766c6f7667722f63697269732e737667" alt="Codecov" data-canonical-src="https://img.shields.io/codecov/c/github/vlovgr/ciris.svg" style="max-width:100%;"></a> <a href="https://gitter.im/vlovgr/ciris" target="_blank"><img src="https://camo.githubusercontent.com/2e257dc72b9f25f156c728b0391e15273f4296bc/68747470733a2f2f696d672e736869656c64732e696f2f6769747465722f726f6f6d2f766c6f7667722f63697269732e7376673f636f6c6f72423d346462373938" alt="Gitter" data-canonical-src="https://img.shields.io/gitter/room/vlovgr/ciris.svg?colorB=4db798" style="max-width:100%;"></a> <a href="https://index.scala-lang.org/vlovgr/ciris" target="_blank"><img src="https://camo.githubusercontent.com/6c148ae058acff0926babd9c6d2d5b450c7b2e94/68747470733a2f2f696d672e736869656c64732e696f2f6d6176656e2d63656e7472616c2f762f69732e6369722f63697269732d636f72655f322e31322e7376673f636f6c6f723d626c7565266c6162656c3d76657273696f6e" alt="Version" data-canonical-src="https://img.shields.io/maven-central/v/is.cir/ciris-core_2.12.svg?color=blue&amp;label=version" style="max-width:100%;"></a> <a href="https://www.javadoc.io/doc/is.cir/ciris-core_2.12" target="_blank"><img src="https://camo.githubusercontent.com/80ec0fa42905f21b8642c910505879896c9739e8/68747470733a2f2f696d672e736869656c64732e696f2f6d6176656e2d63656e7472616c2f762f69732e6369722f63697269732d636f72655f322e31322e7376673f636f6c6f723d626c7565266c6162656c3d646f6373" alt="Documentation" data-canonical-src="https://img.shields.io/maven-central/v/is.cir/ciris-core_2.12.svg?color=blue&amp;label=docs" style="max-width:100%;"></a></p> 
  <h2><a id="user-content-ciris" class="anchor" href="https://github.com/vlovgr/ciris#ciris" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Ciris</h2> 
  <p>Lightweight, extensible, and validated configuration loading in <a href="http://www.scala-lang.org" target="_blank">Scala</a> and <a href="https://www.scala-js.org" target="_blank">Scala.js</a>.<br> The core library is dependency-free, while modules provide library integrations.</p> 
  <h3><a id="user-content-introduction" class="anchor" href="https://github.com/vlovgr/ciris#introduction" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Introduction</h3> 
  <p>Ciris encourages compile-time safety by defining as much as possible of your configurations in Scala. For the data which cannot reside in code, Ciris helps you to load and decode values, while dealing with errors. Validation is encoded by using appropriate data types, with available integrations to libraries such as <a href="https://github.com/fthomas/refined" target="_blank">refined</a> and <a href="http://www.squants.com" target="_blank">squants</a> to support even more types. Configurations are typically modeled as case class hierarchies, but you are free to choose the model you see fit.</p> 
  <h3><a id="user-content-getting-started" class="anchor" href="https://github.com/vlovgr/ciris#getting-started" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Getting Started</h3> 
  <p>To get started with <a href="http://www.scala-sbt.org" target="_blank">SBT</a>, simply add the following lines to your <code>build.sbt</code> file:</p> 
  <pre><code>// Libraries are published for Scala 2.10, 2.11, 2.12
libraryDependencies ++= Seq(
  "is.cir" %% "ciris-core" % "0.2.0",
  "is.cir" %% "ciris-enumeratum" % "0.2.0",
  "is.cir" %% "ciris-refined" % "0.2.0",
  "is.cir" %% "ciris-squants" % "0.2.0"
)
</code></pre> 
  <p>and make sure to replace <code>%%</code> with <code>%%%</code> if you are using Scala.js.</p> 
  <p>The only required module is <code>ciris-core</code>, the rest are optional library integrations.</p> 
  <ul> 
   <li>The <code>ciris-enumeratum</code> module allows loading <a href="https://github.com/lloydmeta/enumeratum" target="_blank">enumeratum</a> enumerations.</li> 
   <li>The <code>ciris-refined</code> module allows loading <a href="https://github.com/fthomas/refined" target="_blank">refined</a> refinement types.</li> 
   <li>The <code>ciris-squants</code> module allows loading <a href="http://www.squants.com" target="_blank">squants</a> data types.</li> 
  </ul> 
  <h3><a id="user-content-usage-examples" class="anchor" href="https://github.com/vlovgr/ciris#usage-examples" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage Examples</h3> 
  <p>Ciris configuration loading is done in two parts: define what to load, and what to create once everything is loaded.<br> Let's start simple by defining a configuration and loading only the necessary parts of it from the environment.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">ciris.</span><span class="pl-v">_</span>

<span class="pl-k">import</span> <span class="pl-v">scala.concurrent.duration.</span><span class="pl-v">_</span>

<span class="pl-k">final</span> <span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Config</span>(
  <span class="pl-v">apiKey</span>: <span class="pl-k">String</span>,
  <span class="pl-v">timeout</span>: <span class="pl-en">Duration</span>,
  <span class="pl-v">port</span>: <span class="pl-k">Int</span>
)

<span class="pl-k">val</span> <span class="pl-en">config</span><span class="pl-k">:</span> <span class="pl-en">Either</span>[<span class="pl-en">ConfigErrors</span>, <span class="pl-en">Config</span>] <span class="pl-k">=</span>
  loadConfig(
    env[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>API_KEY<span class="pl-pds">"</span></span>), <span class="pl-c"><span class="pl-c">//</span> Reads environment variable API_KEY</span>
    prop[<span class="pl-en">Option</span>[<span class="pl-k">Int</span>]](<span class="pl-s"><span class="pl-pds">"</span>http.port<span class="pl-pds">"</span></span>) <span class="pl-c"><span class="pl-c">//</span> Reads system property http.port</span>
  ) { (apiKey, port) <span class="pl-k">=&gt;</span>
    <span class="pl-en">Config</span>(
      apiKey <span class="pl-k">=</span> apiKey,
      timeout <span class="pl-k">=</span> <span class="pl-c1">10.</span>seconds,
      port <span class="pl-k">=</span> port getOrElse <span class="pl-c1">4000</span>
    )
  }
</pre>
  </div> 
  <div class="highlight highlight-source-scala">
   <pre>show(config)
<span class="pl-c"><span class="pl-c">//</span> res5: String = Left(ConfigErrors(MissingKey(API_KEY,Environment)))</span>

show(config.left.map(_.messages))
<span class="pl-c"><span class="pl-c">//</span> res6: String = Left(Vector(Missing environment variable [API_KEY]))</span></pre>
  </div> 
  <h4><a id="user-content-encoding-validation" class="anchor" href="https://github.com/vlovgr/ciris#encoding-validation" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Encoding Validation</h4> 
  <p>Ciris intentionally forces you to encode validation in your data types. This means you have to put more thought into your configurations, and in turn, your domain models. If you want to load an API key, you probably don't want it to be any <code>String</code>. If you want to load a port value, you probably don't want it to be any <code>Int</code> (valid ports are 0 to 65535).</p> 
  <p>By using more precise types, we get type-safety and a guarantee that values conform to our requirements. One of the easiest ways to encode validation in data types is by using <a href="https://github.com/fthomas/refined" target="_blank">refined</a>. Ciris provides a <code>ciris-refined</code> module which allows you to read any refined type. You can also get compile-time validation for literals from refined.</p> 
  <p>Let's modify the configuration to use refined types and again load the same parts from the environment.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">ciris.refined.</span><span class="pl-v">_</span>

<span class="pl-k">import</span> <span class="pl-v">eu.timepit.refined.auto.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">eu.timepit.refined.types.net.</span><span class="pl-v">PortNumber</span>
<span class="pl-k">import</span> <span class="pl-v">eu.timepit.refined.types.string.</span><span class="pl-v">NonEmptyString</span>

<span class="pl-k">final</span> <span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Config</span>(
  <span class="pl-v">apiKey</span>: <span class="pl-en">NonEmptyString</span>,
  <span class="pl-v">timeout</span>: <span class="pl-en">Duration</span>,
  <span class="pl-v">port</span>: <span class="pl-en">PortNumber</span>
)

<span class="pl-k">val</span> <span class="pl-en">config</span> <span class="pl-k">=</span>
  loadConfig(
    env[<span class="pl-en">NonEmptyString</span>](<span class="pl-s"><span class="pl-pds">"</span>API_KEY<span class="pl-pds">"</span></span>),
    prop[<span class="pl-en">Option</span>[<span class="pl-en">PortNumber</span>]](<span class="pl-s"><span class="pl-pds">"</span>http.port<span class="pl-pds">"</span></span>)
  ) { (apiKey, port) <span class="pl-k">=&gt;</span>
    <span class="pl-en">Config</span>(
      apiKey <span class="pl-k">=</span> apiKey,
      timeout <span class="pl-k">=</span> <span class="pl-c1">10</span> seconds,
      port <span class="pl-k">=</span> port getOrElse <span class="pl-c1">4000</span>
    )
  }</pre>
  </div> 
  <h4><a id="user-content-multiple-environments" class="anchor" href="https://github.com/vlovgr/ciris#multiple-environments" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Multiple Environments</h4> 
  <p>One of the most common use cases for configurations is having different values for different environments. There are several ways to deal with environments with Ciris: one way being to define an enumeration with <a href="https://github.com/lloydmeta/enumeratum" target="_blank">enumeratum</a> and use the <code>ciris-enumeratum</code> module to be able to load values of that enumeration. You can then switch configuration by just writing conditional statements in plain code.</p> 
  <p>Let's define and load a configuration depending on different environments.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">_root_.enumeratum.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">ciris.enumeratum.</span><span class="pl-v">_</span>

<span class="pl-k">object</span> <span class="pl-en">configuration</span> {
  <span class="pl-k">sealed</span> <span class="pl-k">abstract</span> <span class="pl-k">class</span> <span class="pl-en">AppEnvironment</span> <span class="pl-k">extends</span> <span class="pl-e">EnumEntry</span>
  <span class="pl-k">object</span> <span class="pl-en">AppEnvironment</span> <span class="pl-k">extends</span> <span class="pl-e">Enum</span>[<span class="pl-en">AppEnvironment</span>] {
    <span class="pl-k">case</span> <span class="pl-k">object</span> <span class="pl-en">Local</span> <span class="pl-k">extends</span> <span class="pl-e">AppEnvironment</span>
    <span class="pl-k">case</span> <span class="pl-k">object</span> <span class="pl-en">Testing</span> <span class="pl-k">extends</span> <span class="pl-e">AppEnvironment</span>
    <span class="pl-k">case</span> <span class="pl-k">object</span> <span class="pl-en">Production</span> <span class="pl-k">extends</span> <span class="pl-e">AppEnvironment</span>

    <span class="pl-k">val</span> <span class="pl-en">values</span> <span class="pl-k">=</span> findValues
  }
}

<span class="pl-k">import</span> <span class="pl-v">configuration.</span><span class="pl-v">_</span>

<span class="pl-k">val</span> <span class="pl-en">config</span> <span class="pl-k">=</span>
  loadConfig(
    env[<span class="pl-en">NonEmptyString</span>](<span class="pl-s"><span class="pl-pds">"</span>API_KEY<span class="pl-pds">"</span></span>),
    prop[<span class="pl-en">Option</span>[<span class="pl-en">PortNumber</span>]](<span class="pl-s"><span class="pl-pds">"</span>http.port<span class="pl-pds">"</span></span>),
    env[<span class="pl-en">Option</span>[<span class="pl-en">AppEnvironment</span>]](<span class="pl-s"><span class="pl-pds">"</span>APP_ENV<span class="pl-pds">"</span></span>)
  ) { (apiKey, port, appEnvironment) <span class="pl-k">=&gt;</span>
    <span class="pl-k">val</span> <span class="pl-en">default</span> <span class="pl-k">=</span>
      <span class="pl-en">Config</span>(
        apiKey <span class="pl-k">=</span> apiKey,
        timeout <span class="pl-k">=</span> <span class="pl-c1">10</span> seconds,
        port <span class="pl-k">=</span> port getOrElse <span class="pl-c1">4000</span>
      )

    appEnvironment.map {
      <span class="pl-k">case</span> <span class="pl-en">AppEnvironment</span>.<span class="pl-en">Local</span> <span class="pl-k">=&gt;</span> default
      <span class="pl-k">case</span> _ <span class="pl-k">=&gt;</span> default.copy(timeout <span class="pl-k">=</span> <span class="pl-c1">5</span> seconds)
    }.getOrElse(default)
  }</pre>
  </div> 
  <p>What about reading different configuration values depending on the environment? For example, you could use defaults for everything in a local environment, while reading configuration values, like the API key and port, in the other environments.</p> 
  <p>For that purpose, there is a <code>withValues</code> (and <code>withValue</code>) construct that you can use. It works exactly like <code>loadConfig</code>, except it wraps your <code>loadConfig</code> statements, only executing them if all <code>withValues</code> values could be read successfully. If it helps, think of <code>loadConfig</code> as <code>map</code> and <code>withValues</code> as <code>flatMap</code> (which is also how they are defined internally).</p> 
  <div class="highlight highlight-source-scala">
   <pre>withValue(env[<span class="pl-en">Option</span>[<span class="pl-en">AppEnvironment</span>]](<span class="pl-s"><span class="pl-pds">"</span>APP_ENV<span class="pl-pds">"</span></span>)) {
  <span class="pl-k">case</span> <span class="pl-en">Some</span>(<span class="pl-en">AppEnvironment</span>.<span class="pl-en">Local</span>) <span class="pl-k">|</span> <span class="pl-c1">None</span> <span class="pl-k">=&gt;</span>
    loadConfig {
      <span class="pl-en">Config</span>(
        apiKey <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>changeme<span class="pl-pds">"</span></span>,
        timeout <span class="pl-k">=</span> <span class="pl-c1">10</span> seconds,
        port <span class="pl-k">=</span> <span class="pl-c1">4000</span>
      )
    }
  <span class="pl-k">case</span> _ <span class="pl-k">=&gt;</span>
    loadConfig(
      env[<span class="pl-en">NonEmptyString</span>](<span class="pl-s"><span class="pl-pds">"</span>API_KEY<span class="pl-pds">"</span></span>),
      prop[<span class="pl-en">PortNumber</span>](<span class="pl-s"><span class="pl-pds">"</span>http.port<span class="pl-pds">"</span></span>)
    ) { (apiKey, port) <span class="pl-k">=&gt;</span>
      <span class="pl-en">Config</span>(
        apiKey <span class="pl-k">=</span> apiKey,
        timeout <span class="pl-k">=</span> <span class="pl-c1">5</span> seconds,
        port <span class="pl-k">=</span> port
      )
    }
}</pre>
  </div> 
 </article>
</div>