<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-neo4j-scala-wrapper-library" class="anchor" href="https://github.com/fakod/neo4j-scala#neo4j-scala-wrapper-library" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Neo4j Scala wrapper library</h1> 
  <p>The Neo4j Scala wrapper library allows you use <a href="http://neo4j.org/" target="_blank">Neo4j open source graph database</a> through a domain-specific language.</p> 
  <p>This wrapper is mostly based on the work done by <a href="http://twitter.com/martinkl" target="_blank">Martin Kleppmann</a> in his <a href="http://github.com/ept/neo4j-resources" target="_blank">Scala implementation of RESTful JSON HTTP resources on top of the Neo4j graph database and Jersey</a> project.</p> 
  <p>See this <a href="https://gist.github.com/1331556" target="_blank">GIST</a> for a usual Neo4j Matrix Example</p> 
  <p>You may find <a href="http://github.com/FaKod/neo4j-spatial-scala" target="_blank">Neo4j-Spatial-Scala</a> interesting as well.</p> 
  <p>All discussions (if there are any) see Google Group <a href="https://groups.google.com/forum/#!forum/neo4j-scala" target="_blank">neo4j-scala</a></p> 
  <h2><a id="user-content-building" class="anchor" href="https://github.com/fakod/neo4j-scala#building" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Building</h2> 
  <pre><code>$ git clone git://github.com/FaKod/neo4j-scala.git
$ cd neo4j-scala
$ mvn clean install
</code></pre> 
  <p>Or fetch it with Maven (the Sonatype Maven Repo is only needed if you want to use a SNAPSHOT version):</p> 
  <div class="highlight highlight-text-xml">
   <pre>&lt;<span class="pl-ent">repositories</span>&gt;
  &lt;<span class="pl-ent">repository</span>&gt;
    &lt;<span class="pl-ent">id</span>&gt;sonatype-snapshots&lt;/<span class="pl-ent">id</span>&gt;
    &lt;<span class="pl-ent">url</span>&gt;https://oss.sonatype.org/content/repositories/snapshots/&lt;/<span class="pl-ent">url</span>&gt;
  &lt;/<span class="pl-ent">repository</span>&gt;
  ...
&lt;/<span class="pl-ent">repositories</span>&gt;

&lt;<span class="pl-ent">dependencies</span>&gt;
  &lt;<span class="pl-ent">dependency</span>&gt;
    &lt;<span class="pl-ent">groupId</span>&gt;eu.fakod&lt;/<span class="pl-ent">groupId</span>&gt;
    &lt;<span class="pl-ent">artifactId</span>&gt;neo4j-scala_2.10&lt;/<span class="pl-ent">artifactId</span>&gt;
    &lt;<span class="pl-ent">version</span>&gt;0.3.0&lt;/<span class="pl-ent">version</span>&gt;
  &lt;/<span class="pl-ent">dependency</span>&gt;
&lt;/<span class="pl-ent">dependencies</span>&gt;</pre>
  </div> 
  <h2><a id="user-content-troubleshooting" class="anchor" href="https://github.com/fakod/neo4j-scala#troubleshooting" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Troubleshooting</h2> 
  <p>Please consider using <a href="http://github.com/fakod/neo4j-scala/issues" target="_blank">Github issues tracker</a> to submit bug reports or feature requests.</p> 
  <h1><a id="user-content-using-this-library" class="anchor" href="https://github.com/fakod/neo4j-scala#using-this-library" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Using this library</h1> 
  <h2><a id="user-content-graph-database-service-provider" class="anchor" href="https://github.com/fakod/neo4j-scala#graph-database-service-provider" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Graph Database Service Provider</h2> 
  <p>Neo4j Scala Wrapper needs a Graph Database Service Provider, it has to implement GraphDatabaseServiceProvider trait. One possibility is to use the EmbeddedGraphDatabaseServiceProvider for embedded Neo4j instances where you simply have to define a Neo4j storage directory. The class MyNeo4jClass using the wrapper is f.e.:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">MyNeo4jClass</span> <span class="pl-k">extends</span> <span class="pl-e">SomethingClass</span> <span class="pl-k">with</span> <span class="pl-e">Neo4jWrapper</span> <span class="pl-k">with</span> <span class="pl-e">EmbeddedGraphDatabaseServiceProvider</span> {
  <span class="pl-k">def</span> <span class="pl-en">neo4jStoreDir</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>/tmp/temp-neo-test<span class="pl-pds">"</span></span>
  . . .
}</pre>
  </div> 
  <p>Available are:</p> 
  <ul> 
   <li>EmbeddedGraphDatabaseServiceProvider</li> 
   <li>SingletonEmbeddedGraphDatabaseServiceProvider (singleton version)</li> 
   <li>BatchGraphDatabaseServiceProvider (use it with Neo4jBatchIndexProvider)</li> 
   <li>REMOVED -&gt; RestGraphDatabaseServiceProvider uses the REST binding</li> 
  </ul> 
  <h2><a id="user-content-transaction-wrapping" class="anchor" href="https://github.com/fakod/neo4j-scala#transaction-wrapping" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Transaction Wrapping</h2> 
  <p>Transactions are wrapped by withTx. After leaving the "scope" success is called (or rollback if an exception is raised):</p> 
  <div class="highlight highlight-source-scala">
   <pre>withTx {
 <span class="pl-k">implicit</span> neo <span class="pl-k">=&gt;</span>
   <span class="pl-k">val</span> <span class="pl-en">start</span> <span class="pl-k">=</span> createNode
   <span class="pl-k">val</span> <span class="pl-en">end</span> <span class="pl-k">=</span> createNode
   start <span class="pl-k">--</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span> <span class="pl-k">--</span><span class="pl-k">&gt;</span> end
}</pre>
  </div> 
  <h2><a id="user-content-using-an-index" class="anchor" href="https://github.com/fakod/neo4j-scala#using-an-index" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Using an Index</h2> 
  <p>Neo4j provides indexes for nodes and relationships. The indexes can be configured by mixing in the Neo4jIndexProvider trait. See <a href="http://docs.neo4j.org/chunked/stable/indexing.html" target="_blank">Indexing</a></p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">MyNeo4jClass</span> <span class="pl-k">extends</span> <span class="pl-e">.</span> . . <span class="pl-k">with</span> <span class="pl-e">Neo4jIndexProvider</span> {
  <span class="pl-c"><span class="pl-c">//</span> configuration for the index being created.</span>
  <span class="pl-k">override</span> <span class="pl-k">def</span> <span class="pl-en">NodeIndexConfig</span> <span class="pl-k">=</span> (<span class="pl-s"><span class="pl-pds">"</span>MyTest1stIndex<span class="pl-pds">"</span></span>, <span class="pl-en">Some</span>(<span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>provider<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>lucene<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>fulltext<span class="pl-pds">"</span></span>))) <span class="pl-k">::</span>
                                 (<span class="pl-s"><span class="pl-pds">"</span>MyTest2ndIndex<span class="pl-pds">"</span></span>, <span class="pl-en">Some</span>(<span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>provider<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>lucene<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>fulltext<span class="pl-pds">"</span></span>))) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>
}</pre>
  </div> 
  <p>Use one of the configured indexes with</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">nodeIndex</span> <span class="pl-k">=</span> getNodeIndex(<span class="pl-s"><span class="pl-pds">"</span>MyTest1stIndex<span class="pl-pds">"</span></span>).get</pre>
  </div> 
  <p>Add and remove entries by:</p> 
  <div class="highlight highlight-source-scala">
   <pre>nodeIndex <span class="pl-k">+</span><span class="pl-k">=</span> (<span class="pl-en">Node_A</span>, <span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>The Matrix<span class="pl-pds">"</span></span>)
nodeIndex <span class="pl-k">-</span><span class="pl-k">=</span> (<span class="pl-en">Node_A</span>)</pre>
  </div> 
  <h2><a id="user-content-relations" class="anchor" href="https://github.com/fakod/neo4j-scala#relations" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Relations</h2> 
  <p>Using this wrapper, this is how creating two relationships can look in Scala. The String are automatically converted into Dynamic Relationships:</p> 
  <div class="highlight highlight-source-scala">
   <pre>start <span class="pl-k">--</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>KNOWS<span class="pl-pds">"</span></span> <span class="pl-k">--</span><span class="pl-k">&gt;</span> intermediary <span class="pl-k">--</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>KNOWS<span class="pl-pds">"</span></span> <span class="pl-k">--</span><span class="pl-k">&gt;</span> end
left <span class="pl-k">--</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span> <span class="pl-k">--</span><span class="pl-k">&gt;</span> middle <span class="pl-k">&lt;</span><span class="pl-k">--</span> <span class="pl-s"><span class="pl-pds">"</span>bar<span class="pl-pds">"</span></span> <span class="pl-k">&lt;</span><span class="pl-k">--</span> right</pre>
  </div> 
  <p>To return the Property Container for the Relation Object use the '&lt;' method:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">relation</span> <span class="pl-k">=</span> start <span class="pl-k">--</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>KNOWS<span class="pl-pds">"</span></span> <span class="pl-k">--</span><span class="pl-k">&gt;</span> end <span class="pl-k">&lt;</span></pre>
  </div> 
  <h2><a id="user-content-properties" class="anchor" href="https://github.com/fakod/neo4j-scala#properties" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Properties</h2> 
  <p>And this is how getting and setting properties on a node or relationship looks like :</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span> setting the property foo</span>
start(<span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span>) <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>bar<span class="pl-pds">"</span></span>
<span class="pl-c"><span class="pl-c">//</span> cast Object to String and match . . .</span>
start[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span>) <span class="pl-k">match</span> {
  <span class="pl-k">case</span> <span class="pl-en">Some</span>(x) <span class="pl-k">=&gt;</span> println(x)
  <span class="pl-k">case</span> <span class="pl-c1">None</span> <span class="pl-k">=&gt;</span> println(<span class="pl-s"><span class="pl-pds">"</span>aww<span class="pl-pds">"</span></span>)
}</pre>
  </div> 
  <h2><a id="user-content-using-case-classes" class="anchor" href="https://github.com/fakod/neo4j-scala#using-case-classes" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Using Case Classes</h2> 
  <p>Neo4j provides storing keys (String) and values (Object) into Nodes. To store Case Classes the properties are stored as key/values to the Property Container, they can be a Node or a Relation. However, Working types are limited to basic types like String, Integer etc.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Test</span>(<span class="pl-v">s</span>: <span class="pl-k">String</span>, <span class="pl-v">i</span>: <span class="pl-k">Int</span>, <span class="pl-v">ji</span>: java.lang.<span class="pl-en">Integer</span>, <span class="pl-v">d</span>: <span class="pl-k">Double</span>, <span class="pl-v">l</span>: <span class="pl-k">Long</span>, <span class="pl-v">b</span>: <span class="pl-k">Boolean</span>)

. . .
withTx {
  <span class="pl-k">implicit</span> neo <span class="pl-k">=&gt;</span>
    <span class="pl-c"><span class="pl-c">//</span> create new Node with Case Class Test</span>
    <span class="pl-k">val</span> <span class="pl-en">node1</span> <span class="pl-k">=</span> createNode(<span class="pl-en">Test</span>(<span class="pl-s"><span class="pl-pds">"</span>Something<span class="pl-pds">"</span></span>, <span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3.3</span>, <span class="pl-c1">10</span>, <span class="pl-c1">true</span>))

    <span class="pl-c"><span class="pl-c">//</span> can Test be created from node</span>
    <span class="pl-k">val</span> <span class="pl-en">b</span><span class="pl-k">:</span><span class="pl-k">Boolean</span> <span class="pl-k">=</span> node.toCCPossible[<span class="pl-en">Test</span>]

    <span class="pl-c"><span class="pl-c">//</span> or using Option[T] (returning Some[T] if possible)</span>
    <span class="pl-k">val</span> <span class="pl-en">nodeOption</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-en">Test</span>] <span class="pl-k">=</span> node.toCC[<span class="pl-en">Test</span>]

    <span class="pl-c"><span class="pl-c">//</span> yield all Nodes that are of type Case Class Test</span>
    <span class="pl-k">val</span> <span class="pl-en">tests</span> <span class="pl-k">=</span> <span class="pl-k">for</span>(n <span class="pl-k">&lt;</span><span class="pl-k">-</span> getTraverser; t <span class="pl-k">&lt;</span><span class="pl-k">-</span> n.toCC[<span class="pl-en">Test</span>]) <span class="pl-k">yield</span> t

    <span class="pl-c"><span class="pl-c">//</span> create new relation with Case Class Test</span>
    node1 <span class="pl-k">--</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span> <span class="pl-k">--</span><span class="pl-k">&gt;</span> node2 <span class="pl-k">&lt;</span> <span class="pl-en">Test</span>(<span class="pl-s"><span class="pl-pds">"</span>other<span class="pl-pds">"</span></span>, <span class="pl-c1">0</span>, <span class="pl-c1">1</span>, <span class="pl-c1">1.3</span>, <span class="pl-c1">1</span>, <span class="pl-c1">false</span>)
 }</pre>
  </div> 
  <h2><a id="user-content-traversing" class="anchor" href="https://github.com/fakod/neo4j-scala#traversing" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Traversing</h2> 
  <p>Besides, the neo4j scala binding makes it possible to write stop and returnable evaluators in a functional style :</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span>StopEvaluator.END_OF_GRAPH, written in a Scala idiomatic way :</span>
start.traverse(<span class="pl-en">Traverser</span>.<span class="pl-en">Order</span>.<span class="pl-en">BREADTH_FIRST</span>, (<span class="pl-v">tp</span> : <span class="pl-en">TraversalPosition</span>) <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span>, 
<span class="pl-en">ReturnableEvaluator</span>.<span class="pl-en">ALL_BUT_START_NODE</span>, <span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span>, <span class="pl-en">Direction</span>.<span class="pl-en">OUTGOING</span>)

<span class="pl-c"><span class="pl-c">//</span>ReturnableEvaluator.ALL_BUT_START_NODE, written in a Scala idiomatic way :</span>
start.traverse(<span class="pl-en">Traverser</span>.<span class="pl-en">Order</span>.<span class="pl-en">BREADTH_FIRST</span>, <span class="pl-en">StopEvaluator</span>.<span class="pl-en">END_OF_GRAPH</span>, (<span class="pl-v">tp</span> : <span class="pl-en">TraversalPosition</span>) <span class="pl-k">=&gt;</span> tp.notStartNode(), 
<span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span>, <span class="pl-en">Direction</span>.<span class="pl-en">OUTGOING</span>)</pre>
  </div> 
  <h2><a id="user-content-typed-traversing" class="anchor" href="https://github.com/fakod/neo4j-scala#typed-traversing" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Typed Traversing</h2> 
  <p>The traverser mentioned above processes and returns Nodes resp. Property Container. To allow a more type safe traverser the TypedTraverser was introduced. The basic semantic is that you have to define the type (a case class) that should be returned (while inheritance is respected). But first define Relation Types and Directions:</p> 
  <h3><a id="user-content-relation-types-and-direction" class="anchor" href="https://github.com/fakod/neo4j-scala#relation-types-and-direction" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Relation Types and Direction</h3> 
  <p>To define relation types and directions use the follow method. Some examples</p> 
  <div class="highlight highlight-source-scala">
   <pre>follow(<span class="pl-en">BREADTH_FIRST</span>) <span class="pl-k">--</span> <span class="pl-s"><span class="pl-pds">"</span>KNOWS<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span><span class="pl-k">-</span> <span class="pl-s"><span class="pl-pds">"</span>CODED_BY<span class="pl-pds">"</span></span> <span class="pl-c"><span class="pl-c">//</span> BOTH for "KNOWS", OUTGOING for "CODED_BY"</span>
follow <span class="pl-k">-</span><span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-s"><span class="pl-pds">"</span>BAR<span class="pl-pds">"</span></span> <span class="pl-k">--</span> <span class="pl-s"><span class="pl-pds">"</span>FOO<span class="pl-pds">"</span></span>                       <span class="pl-c"><span class="pl-c">//</span> INCOMING for "BAR", BOTH for "FOO", defaults to DEPTH_FIRST</span>
follow(<span class="pl-en">DEPTH_FIRST</span>) <span class="pl-k">-</span><span class="pl-k">&gt;</span><span class="pl-k">-</span> <span class="pl-s"><span class="pl-pds">"</span>FOOBAR<span class="pl-pds">"</span></span>                <span class="pl-c"><span class="pl-c">//</span> OUTGOING for "FOOBAR"</span></pre>
  </div> 
  <p>So the traverser, that returns an Iterable[MatrixBase], can be written like this:</p> 
  <div class="highlight highlight-source-scala">
   <pre>myNode.doTraverse[<span class="pl-en">MatrixBase</span>](follow(<span class="pl-en">BREADTH_FIRST</span>) <span class="pl-k">--</span> <span class="pl-s"><span class="pl-pds">"</span>KNOWS<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span><span class="pl-k">-</span> <span class="pl-s"><span class="pl-pds">"</span>CODED_BY<span class="pl-pds">"</span></span>) {
    . . .block1. . .
} {
    . . .block2. . .
}</pre>
  </div> 
  <h3><a id="user-content-return-and-stop-evaluator" class="anchor" href="https://github.com/fakod/neo4j-scala#return-and-stop-evaluator" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Return and Stop Evaluator</h3> 
  <p><strong>block1</strong> is the Stop Evaluator and <strong>block2</strong> the Return Evaluator, both of type PartialFunction[(T, TraversalPosition), Boolean]. Where T is MatrixBase in case of the example, TraversalPosition from the traverser and Boolean as return type. </p> 
  <p>PartialFunctions can be handled with a case statement, like this:</p> 
  <div class="highlight highlight-source-scala">
   <pre>node.doTraverse[<span class="pl-en">MatrixBase</span>](follow(<span class="pl-en">BREADTH_FIRST</span>) <span class="pl-k">--</span> <span class="pl-s"><span class="pl-pds">"</span>KNOWS<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span><span class="pl-k">-</span> <span class="pl-s"><span class="pl-pds">"</span>CODED_BY<span class="pl-pds">"</span></span>) {
        <span class="pl-en">END_OF_GRAPH</span> <span class="pl-c"><span class="pl-c">//</span> predefined partial function</span>
    } {
        <span class="pl-c"><span class="pl-c">//</span> if node is of type Matrix and TraversalPosition.depth == 2 then check lenth</span>
        <span class="pl-k">case</span> (<span class="pl-v">x</span>: <span class="pl-en">Matrix</span>, tp) <span class="pl-k">if</span> (tp.depth <span class="pl-k">==</span> <span class="pl-c1">2</span>) <span class="pl-k">=&gt;</span> x.name.length <span class="pl-k">&gt;</span> <span class="pl-c1">2</span>

        <span class="pl-c"><span class="pl-c">//</span> if node is of type NonMatrix then false</span>
        <span class="pl-k">case</span> (<span class="pl-v">y</span>: <span class="pl-en">NonMatrix</span>, _) <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span>
    }</pre>
  </div> 
  <p>Assuming that Matrix and NonMatrix are inherited from MatrixBase the traverser will handle that correctly. X and y only matches if the given type can be marshaled to Matrix or NonMatrix and assigned from MatrixBase. Additionally, you can use the TraversalPosition in both case statements or ignore it with '_'. The example defines that depth must be 2 and the Matrix.name parameter must be of length &gt; 2. NonMatrix classes are not returned. The Stop Evaluator always returns false.</p> 
  <h3><a id="user-content-iterablet" class="anchor" href="https://github.com/fakod/neo4j-scala#iterablet" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Iterable[T]</h3> 
  <p>The example above returns an Iterable[MatrixBase]. This allows to use the powerful Scala collections, f.e.:</p> 
  <div class="highlight highlight-source-scala">
   <pre>...}.toList.sortWith(_.name <span class="pl-k">&lt;</span> _.name) <span class="pl-c"><span class="pl-c">//</span> sorts Nodes by name</span>

...}.toList.flatMap(_.name) <span class="pl-c"><span class="pl-c">//</span> List(N, e, o, M, o, r, p, h, e, u, s)</span>

...}.toList.par. . . <span class="pl-c"><span class="pl-c">//</span> do something with parallel collections</span></pre>
  </div> 
  <p>Where '_' is automatically replaced by MatrixBase instances.</p> 
  <p>Finally we can write, f.e.:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">list</span><span class="pl-k">:</span><span class="pl-en">List</span>[<span class="pl-en">MatrixBase</span>] <span class="pl-k">=</span> node.doTraverse[<span class="pl-en">MatrixBase</span>](follow <span class="pl-k">-</span><span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-s"><span class="pl-pds">"</span>KNOWS<span class="pl-pds">"</span></span>) {
    <span class="pl-k">case</span> _ <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span>
} {
    <span class="pl-k">case</span> (<span class="pl-v">x</span>: <span class="pl-en">Matrix</span>, _) <span class="pl-k">=&gt;</span> <span class="pl-c1">true</span>
    <span class="pl-k">case</span> (<span class="pl-v">x</span>: <span class="pl-en">NonMatrix</span>, _) <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span>
}.toList.sortWith(_.name <span class="pl-k">&lt;</span> _.name)</pre>
  </div> 
  <h3><a id="user-content-using-a-list-of-nodes" class="anchor" href="https://github.com/fakod/neo4j-scala#using-a-list-of-nodes" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Using a List of Nodes</h3> 
  <p>Instead of one Node you can use a List of Nodes (List[Node]). The given traverser is started multithreaded for every node in the List. The resulting threads are joined, the result-lists are appended and Node duplicates removed. F.e:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">erg1</span> <span class="pl-k">=</span> startWithNodes.doTraverse[<span class="pl-en">MatrixBase</span>](follow <span class="pl-k">-</span><span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-s"><span class="pl-pds">"</span>KNOWS<span class="pl-pds">"</span></span>) {
    <span class="pl-k">case</span> _ <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span>
  } {
    <span class="pl-k">case</span> (<span class="pl-v">x</span>: <span class="pl-en">Matrix</span>, _) <span class="pl-k">=&gt;</span> <span class="pl-c1">true</span>
    <span class="pl-k">case</span> (<span class="pl-v">x</span>: <span class="pl-en">NonMatrix</span>, _) <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span>
  }.toList.sortWith(_.name <span class="pl-k">&lt;</span> _.name)</pre>
  </div> 
  <p>Where startWithNodes is of type List[Node].</p> 
  <h2><a id="user-content-removed---rest-typed-traversing----removed" class="anchor" href="https://github.com/fakod/neo4j-scala#removed---rest-typed-traversing----removed" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>REMOVED -&gt; REST Typed Traversing &lt;-- REMOVED</h2> 
  <p>The main difference between the non-REST Typed Traverser is the ability to provide server side Prune Evaluator and Return Filter. This is important because otherwise all traversed data will be transfered to the client. This is possible but not always the best solution.</p> 
  <h3><a id="user-content-prune-evaluator-and-max-depth" class="anchor" href="https://github.com/fakod/neo4j-scala#prune-evaluator-and-max-depth" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Prune Evaluator and Max Depth</h3> 
  <p>The <strong>PruneEvaluator</strong> defines where to stop traversing relations. It has to be Java Script code that can use the position instance of type org.neo4j.graphdb.Path.</p> 
  <p><strong>max depth</strong> is a short-hand way of specifying a prune evaluator which prunes after a certain depth. If not specified</p> 
  <ul> 
   <li>a max depth of 1 is used and </li> 
   <li>if a "prune evaluator" is specified instead of a max depth, no max depth limit is set.</li> 
  </ul> 
  <h4><a id="user-content-examples-for-prune-evaluator--maxdepth" class="anchor" href="https://github.com/fakod/neo4j-scala#examples-for-prune-evaluator--maxdepth" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Examples for Prune Evaluator / MaxDepth</h4> 
  <p>Using the case class PruneEvaluator ("JAVASCRIPT" is dafault, "false" is Java Script code):</p> 
  <div class="highlight highlight-source-scala">
   <pre>startNode.doTraverse[<span class="pl-en">Test_MatrixBase</span>](follow <span class="pl-k">--</span> <span class="pl-s"><span class="pl-pds">"</span>KNOWS<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span><span class="pl-k">-</span> <span class="pl-s"><span class="pl-pds">"</span>CODED_BY<span class="pl-pds">"</span></span>) {
  <span class="pl-en">PruneEvaluator</span>(<span class="pl-s"><span class="pl-pds">"</span>false<span class="pl-pds">"</span></span>)
} {
  <span class="pl-k">case</span> (<span class="pl-v">x</span>: <span class="pl-en">Test_Matrix</span>, tp) <span class="pl-k">if</span> (tp.depth <span class="pl-k">==</span> <span class="pl-c1">3</span>) <span class="pl-k">=&gt;</span> x.name.length <span class="pl-k">&gt;</span> <span class="pl-c1">2</span>
  <span class="pl-k">case</span> (<span class="pl-v">x</span>: <span class="pl-en">Test_NonMatrix</span>, _) <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span>
}.toList.sortWith(_.name <span class="pl-k">&lt;</span> _.name)</pre>
  </div> 
  <p>Using a Java Script prune evaluator as a String (implicit conversion involved)</p> 
  <div class="highlight highlight-source-scala">
   <pre>startNode.doTraverse[<span class="pl-en">Test_MatrixBase</span>](follow(<span class="pl-en">BREADTH_FIRST</span>) <span class="pl-k">--</span> <span class="pl-s"><span class="pl-pds">"</span>KNOWS<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span><span class="pl-k">-</span> <span class="pl-s"><span class="pl-pds">"</span>CODED_BY<span class="pl-pds">"</span></span>) {
  <span class="pl-s"><span class="pl-pds">"</span>position.length() &gt; 100;<span class="pl-pds">"</span></span>
} {
  <span class="pl-k">case</span> (<span class="pl-v">x</span>: <span class="pl-en">Test_Matrix</span>, tp) <span class="pl-k">if</span> (tp.depth <span class="pl-k">==</span> <span class="pl-c1">2</span>) <span class="pl-k">=&gt;</span> x.name.length <span class="pl-k">&gt;</span> <span class="pl-c1">2</span>
  <span class="pl-k">case</span> (<span class="pl-v">x</span>: <span class="pl-en">Test_NonMatrix</span>, _) <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span>
}.toList.sortWith(_.name <span class="pl-k">&lt;</span> _.name)</pre>
  </div> 
  <p>Using MaxDepth 100:</p> 
  <div class="highlight highlight-source-scala">
   <pre>startNode.doTraverse[<span class="pl-en">Test_MatrixBase</span>](follow(<span class="pl-en">BREADTH_FIRST</span>) <span class="pl-k">--</span> <span class="pl-s"><span class="pl-pds">"</span>KNOWS<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span><span class="pl-k">-</span> <span class="pl-s"><span class="pl-pds">"</span>CODED_BY<span class="pl-pds">"</span></span>)(<span class="pl-c1">100</span>) {
  <span class="pl-k">case</span> (<span class="pl-v">x</span>: <span class="pl-en">Test_Matrix</span>, _) <span class="pl-k">=&gt;</span> x.name.length <span class="pl-k">&gt;</span> <span class="pl-c1">2</span>
}.toList.sortWith(_.name <span class="pl-k">&lt;</span> _.name)</pre>
  </div> 
  <h3><a id="user-content-return-filter" class="anchor" href="https://github.com/fakod/neo4j-scala#return-filter" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Return Filter</h3> 
  <p>The Return Filter has the same semantic as the Return Evaluator. It can be used as with the normal TypedTraverser, can be used with the Java Script and with two builtin functions:</p> 
  <ul> 
   <li>ReturnAllButStartNode</li> 
   <li>ReturnAll</li> 
  </ul> 
  <h4><a id="user-content-examples-for-return-filter" class="anchor" href="https://github.com/fakod/neo4j-scala#examples-for-return-filter" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Examples for Return Filter</h4> 
  <p>Traversing with Max Depth 10 and all nodes except start node:</p> 
  <div class="highlight highlight-source-scala">
   <pre>startNode.
       doTraverse[…](follow(<span class="pl-en">BREADTH_FIRST</span>) <span class="pl-k">--</span> <span class="pl-s"><span class="pl-pds">"</span>KNOWS<span class="pl-pds">"</span></span>, <span class="pl-c1">10</span>, <span class="pl-en">ReturnAllButStartNode</span>)</pre>
  </div> 
  <p>Using Java Script Prune Evaluator ("true"):</p> 
  <div class="highlight highlight-source-scala">
   <pre>startNode.
       doTraverse[…](follow(<span class="pl-en">BREADTH_FIRST</span>) <span class="pl-k">-</span><span class="pl-k">&gt;</span><span class="pl-k">-</span> <span class="pl-s"><span class="pl-pds">"</span>CODED_BY<span class="pl-pds">"</span></span>, <span class="pl-c1">1</span>, <span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>Server Side type check and Max Depth 3:</p> 
  <div class="highlight highlight-source-scala">
   <pre>startNode.doTraverse[<span class="pl-en">Test_MatrixBase</span>](follow(<span class="pl-en">BREADTH_FIRST</span>) <span class="pl-k">--</span> <span class="pl-s"><span class="pl-pds">"</span>KNOWS<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span><span class="pl-k">-</span> <span class="pl-s"><span class="pl-pds">"</span>CODED_BY<span class="pl-pds">"</span></span>, <span class="pl-c1">3</span>,
    endNode.isOfType[<span class="pl-en">Test_Matrix</span>]
  ).toList.sortWith(_.name <span class="pl-k">&lt;</span> _.name)</pre>
  </div> 
  <p>Server Side type check and Server Side Java Script Prune Evaluator</p> 
  <div class="highlight highlight-source-scala">
   <pre>startNode.doTraverse[<span class="pl-en">Test_MatrixBase</span>](follow(<span class="pl-en">BREADTH_FIRST</span>) <span class="pl-k">--</span> <span class="pl-s"><span class="pl-pds">"</span>KNOWS<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span><span class="pl-k">-</span> <span class="pl-s"><span class="pl-pds">"</span>CODED_BY<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>position.length() &gt;= 1<span class="pl-pds">"</span></span>,
    endNode.isOfType[<span class="pl-en">Test_Matrix</span>]
  ).toList.sortWith(_.name <span class="pl-k">&lt;</span> _.name)</pre>
  </div> 
  <h2><a id="user-content-simple-cypher-support" class="anchor" href="https://github.com/fakod/neo4j-scala#simple-cypher-support" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Simple Cypher Support</h2> 
  <p>The following example shows how to use Cypher together with typed results. In this case "execute" returns the case class Test_Matrix.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">MyClass</span> <span class="pl-k">extends</span> <span class="pl-e">Neo4jWrapper</span> <span class="pl-k">with</span> <span class="pl-e">SingletonEmbeddedGraphDatabaseServiceProvider</span> <span class="pl-k">with</span> <span class="pl-e">Cypher</span> {
    . . .
    <span class="pl-k">val</span> <span class="pl-en">query</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>start n=node(<span class="pl-pds">"</span></span> <span class="pl-k">+</span> nodeId <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>) return n, n.name<span class="pl-pds">"</span></span>

    <span class="pl-k">val</span> <span class="pl-en">typedResult</span> <span class="pl-k">=</span> query.execute.asCC[<span class="pl-en">Test_Matrix</span>](<span class="pl-s"><span class="pl-pds">"</span>n<span class="pl-pds">"</span></span>)

    typedResult.next.name must be_<span class="pl-k">==</span>(<span class="pl-s"><span class="pl-pds">"</span>Neo<span class="pl-pds">"</span></span>)
    . . .
}</pre>
  </div> 
  <h2><a id="user-content-batch-processing" class="anchor" href="https://github.com/fakod/neo4j-scala#batch-processing" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Batch Processing</h2> 
  <p>Neo4j has a batch insertion mode intended for initial imports, which must run in a single thread and bypasses transactions and other checks in favor of performance. See <a href="http://docs.neo4j.org/chunked/milestone/indexing-batchinsert.html" target="_blank">Batch insertion</a>.</p> 
  <p>The Java interfaces are slightly different. I wrote some wrapper classes to support nearly transparent usage of batch node and batch relation insertion. Means same code for batch insertion and for normal non batch mode. Instead of using</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">Builder</span> <span class="pl-k">extends</span> <span class="pl-e">Neo4jWrapper</span> <span class="pl-k">with</span> <span class="pl-e">SingletonEmbeddedGraphDatabaseServiceProvider</span> <span class="pl-k">with</span> <span class="pl-e">Neo4jIndexProvider</span> {...}</pre>
  </div> 
  <p>simply exchange the provider traits with</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">Builder</span> <span class="pl-k">extends</span> <span class="pl-e">Neo4jWrapper</span> <span class="pl-k">with</span> <span class="pl-e">Neo4jBatchIndexProvider</span> <span class="pl-k">with</span> <span class="pl-e">BatchGraphDatabaseServiceProvider</span> {...}</pre>
  </div> 
  <p>getting the indexes is still the same code</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">nodeIndex</span> <span class="pl-k">=</span> getNodeIndex(<span class="pl-s"><span class="pl-pds">"</span>NodeIndex<span class="pl-pds">"</span></span>).get
<span class="pl-k">val</span> <span class="pl-en">relationIndex</span> <span class="pl-k">=</span> getRelationIndex(<span class="pl-s"><span class="pl-pds">"</span>RelationIndex<span class="pl-pds">"</span></span>).get</pre>
  </div> 
  <p>setting cache size:</p> 
  <div class="highlight highlight-source-scala">
   <pre>nodeIndex.setCacheCapacity(<span class="pl-s"><span class="pl-pds">"</span>NodeIndex<span class="pl-pds">"</span></span>, <span class="pl-c1">1000000</span>)
relationIndex.setCacheCapacity(<span class="pl-s"><span class="pl-pds">"</span>RelationIndex<span class="pl-pds">"</span></span>, <span class="pl-c1">1000000</span>)</pre>
  </div> 
  <p>Nevertheless, indexes are not available till flushing. To flush call:</p> 
  <div class="highlight highlight-source-scala">
   <pre>nodeIndex.flush
relationIndex.flush</pre>
  </div> 
  <p>After insertion, the batch index manager and batch insertion manager have to be shut down</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">Builder</span> <span class="pl-k">extends</span> <span class="pl-e">Neo4jWrapper</span> . . .{
    . . .
    shutdownIndex
    shutdown(ds)
    . . .
}</pre>
  </div> 
  <h2><a id="user-content-copyright-and-license" class="anchor" href="https://github.com/fakod/neo4j-scala#copyright-and-license" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Copyright and License</h2> 
  <p>Copyright (C) 2012 <a href="http://blog.fakod.eu/" target="_blank">Christopher Schmidt</a> </p> 
  <p>Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p> 
  <p><a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank">http://www.apache.org/licenses/LICENSE-2.0</a></p> 
  <p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p> 
 </article>
</div>