<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-play-json-rpc" class="anchor" href="https://github.com/dhpcs/play-json-rpc#play-json-rpc" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>play-json-rpc</h1> 
  <p>A Scala library providing implicit <a href="https://www.playframework.com/documentation/2.3.x/ScalaJson" target="_blank">play-json Formats</a> for <a href="http://www.jsonrpc.org/specification" target="_blank">JSON-RPC 2.0</a> messages, built on top of the Play Framework's standalone <code>play-json</code> library. It does <em>not</em> depend on the whole of Play, so the dependency footprint is relatively small and you can use it in a wide range of applications – including in Android projects.</p> 
  <h2><a id="user-content-sbt-dependency" class="anchor" href="https://github.com/dhpcs/play-json-rpc#sbt-dependency" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>SBT dependency</h2> 
  <div class="highlight highlight-source-scala">
   <pre>resolvers <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-en">Resolver</span>.bintrayRepo(<span class="pl-s"><span class="pl-pds">"</span>dhpcs<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>maven<span class="pl-pds">"</span></span>)

libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>com.dhpcs<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>play-json-rpc<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>1.3.0<span class="pl-pds">"</span></span></pre>
  </div> 
  <h2><a id="user-content-gradle-dependency" class="anchor" href="https://github.com/dhpcs/play-json-rpc#gradle-dependency" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Gradle dependency</h2> 
  <div class="highlight highlight-source-groovy">
   <pre>dependencies {
    compile <span class="pl-s"><span class="pl-pds">'</span>com.dhpcs:play-json-rpc_2.11:1.3.0<span class="pl-pds">'</span></span>
}</pre>
  </div> 
  <h2><a id="user-content-structure" class="anchor" href="https://github.com/dhpcs/play-json-rpc#structure" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Structure</h2> 
  <p><code>play-json-rpc</code> essentially provides two things:</p> 
  <ol> 
   <li><p>Types and formats for JSON-RPC 2.0 messages. The types are as follows:</p> 
    <ol> 
     <li><p><code>JsonRpcRequestMessage</code>:</p> 
      <div class="highlight highlight-source-scala">
       <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">JsonRpcRequestMessage</span>(<span class="pl-v">method</span>: <span class="pl-k">String</span>,
                                 <span class="pl-v">params</span>: <span class="pl-en">Option</span>[<span class="pl-en">Either</span>[<span class="pl-en">JsArray</span>, <span class="pl-en">JsObject</span>]],
                                 <span class="pl-v">id</span>: <span class="pl-en">Option</span>[<span class="pl-en">Either</span>[<span class="pl-k">String</span>, <span class="pl-en">BigDecimal</span>]]) <span class="pl-k">extends</span> <span class="pl-e">JsonRpcMessage</span></pre>
      </div></li> 
     <li><p><code>JsonRpcRequestMessageBatch</code>:</p> 
      <div class="highlight highlight-source-scala">
       <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">JsonRpcRequestMessageBatch</span>(<span class="pl-v">messages</span>: <span class="pl-en">Seq</span>[<span class="pl-en">Either</span>[<span class="pl-en">JsonRpcNotificationMessage</span>, <span class="pl-en">JsonRpcRequestMessage</span>]])
  <span class="pl-k">extends</span> <span class="pl-e">JsonRpcMessage</span> {
  require(messages.nonEmpty)
}</pre>
      </div></li> 
     <li><p><code>JsonRpcResponseMessage</code>:</p> 
      <div class="highlight highlight-source-scala">
       <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">JsonRpcResponseMessage</span>(<span class="pl-v">eitherErrorOrResult</span>: <span class="pl-en">Either</span>[<span class="pl-en">JsonRpcResponseError</span>, <span class="pl-en">JsValue</span>],
                                  <span class="pl-v">id</span>: <span class="pl-en">Option</span>[<span class="pl-en">Either</span>[<span class="pl-k">String</span>, <span class="pl-en">BigDecimal</span>]]) <span class="pl-k">extends</span> <span class="pl-e">JsonRpcMessage</span></pre>
      </div></li> 
     <li><p><code>JsonRpcResponseMessageBatch</code>:</p> 
      <div class="highlight highlight-source-scala">
       <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">JsonRpcResponseMessageBatch</span>(<span class="pl-v">messages</span>: <span class="pl-en">Seq</span>[<span class="pl-en">JsonRpcResponseMessage</span>]) <span class="pl-k">extends</span> <span class="pl-e">JsonRpcMessage</span> {
  require(messages.nonEmpty)
}</pre>
      </div></li> 
     <li><p><code>JsonRpcNotificationMessage</code>:</p> 
      <div class="highlight highlight-source-scala">
       <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">JsonRpcNotificationMessage</span>(<span class="pl-v">method</span>: <span class="pl-k">String</span>,
                                      <span class="pl-v">params</span>: <span class="pl-en">Either</span>[<span class="pl-en">JsArray</span>, <span class="pl-en">JsObject</span>]) <span class="pl-k">extends</span> <span class="pl-e">JsonRpcMessage</span></pre>
      </div></li> 
    </ol> <p>The companion object for the <code>JsonRpcMessage</code> trait has an implicitly available <code>JsonRpcMessageFormat</code> that can read and write all of the above types – you can then match on the type of the result.</p></li> 
   <li><p>A set of abstract classes as bases for companion objects providing read/write functions for a hierarchy of application level types (see example usage).</p></li> 
  </ol> 
  <h2><a id="user-content-example-usage" class="anchor" href="https://github.com/dhpcs/play-json-rpc#example-usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Example usage</h2> 
  <p>This is best demonstrated by the example project (located in the <code>example</code> directory).</p> 
  <p>The best way to get started with <code>play-json-rpc</code> in your project is to copy the example project and then add/change/remove domain and message types as necessary. You might want to copy and modify the example tests too.</p> 
  <p>The example project includes:</p> 
  <ol> 
   <li><p>Two domain types with JSON Formats, <code>Account</code> and <code>Transaction</code> (definitions omitted for brevity here because they are fairly typical <code>play-json</code> usage).</p></li> 
   <li><p>Two command message types (<code>UpdateAccountCommand</code> and <code>AddTransactionCommand</code>), two matching response types (<code>UpdateAccountResponse</code> and <code>AddTransactionResponse</code>) and two notification message types (<code>AccountUpdatedNotification</code> and <code>TransactionAddedNotification</code>).</p> <p>Note that <code>play-json-rpc</code> leaves the definition of the <code>Message</code> type hierarchy to your code in order that <code>Message</code> and all its subtypes can be defined as sealed to let you benefit from the <a href="http://www.scala-lang.org/old/node/123" target="_blank">compiler checks</a> that sealed enables.</p> <p>Thus most users should copy and preserve the definitions of <code>Message</code>, <code>Command</code>, <code>Response</code>, <code>ResultResponse</code> and <code>Notification</code>, and simply replace the implementations of <code>Command</code>, <code>ResultResponse</code> and <code>Notfication</code> with their own.</p></li> 
   <li><p>Partial code for a server that receives messages of type <code>JsonRpcRequestMessage</code> and sends messages of type <code>JsonRpcResponseMessage</code> and <code>JsonRpcNotificationMessage</code>.</p></li> 
   <li><p>Partial code for a client that sends messages of type <code>JsonRpcRequestMessage</code> and receives messages of type <code>JsonRpcResponseMessage</code> and <code>JsonRpcNotificationMessage</code>.</p></li> 
  </ol> 
  <h3><a id="user-content-example-message-types" class="anchor" href="https://github.com/dhpcs/play-json-rpc#example-message-types" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Example message types</h3> 
  <p>The types that you should define as a user of <code>play-json-rpc</code> will look something like the following.</p> 
  <p>The full definition with imports is at <a href="https://github.com/dhpcs/play-json-rpc/blob/master/example/src/main/scala/com/dhpcs/jsonrpc/example/models/Message.scala" target="_blank">example/src/main/scala/com/dhpcs/jsonrpc/example/models/Message.scala</a>.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">sealed</span> <span class="pl-k">trait</span> <span class="pl-en">Message</span>

<span class="pl-k">sealed</span> <span class="pl-k">trait</span> <span class="pl-en">Command</span> <span class="pl-k">extends</span> <span class="pl-e">Message</span>

<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">UpdateAccountCommand</span>(<span class="pl-v">account</span>: <span class="pl-en">Account</span>) <span class="pl-k">extends</span> <span class="pl-e">Command</span>

<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">AddTransactionCommand</span>(<span class="pl-v">from</span>: <span class="pl-k">Int</span>,
                                 <span class="pl-v">to</span>: <span class="pl-k">Int</span>,
                                 <span class="pl-v">value</span>: <span class="pl-en">BigDecimal</span>,
                                 <span class="pl-v">description</span>: <span class="pl-en">Option</span>[<span class="pl-k">String</span>] <span class="pl-k">=</span> <span class="pl-c1">None</span>,
                                 <span class="pl-v">metadata</span>: <span class="pl-en">Option</span>[<span class="pl-en">JsObject</span>] <span class="pl-k">=</span> <span class="pl-c1">None</span>) <span class="pl-k">extends</span> <span class="pl-e">Command</span> {
  require(value <span class="pl-k">&gt;=</span> <span class="pl-c1">0</span>)
}

<span class="pl-k">object</span> <span class="pl-en">AddTransactionCommand</span> {
  <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">AddTransactionCommandFormat</span><span class="pl-k">:</span> <span class="pl-en">Format</span>[<span class="pl-en">AddTransactionCommand</span>] <span class="pl-k">=</span> (
    (<span class="pl-en">JsPath</span> \ <span class="pl-s"><span class="pl-pds">"</span>from<span class="pl-pds">"</span></span>).format[<span class="pl-k">Int</span>] and
      (<span class="pl-en">JsPath</span> \ <span class="pl-s"><span class="pl-pds">"</span>to<span class="pl-pds">"</span></span>).format[<span class="pl-k">Int</span>] and
      (<span class="pl-en">JsPath</span> \ <span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>).format(min[<span class="pl-en">BigDecimal</span>](<span class="pl-c1">0</span>)) and
      (<span class="pl-en">JsPath</span> \ <span class="pl-s"><span class="pl-pds">"</span>description<span class="pl-pds">"</span></span>).formatNullable[<span class="pl-k">String</span>] and
      (<span class="pl-en">JsPath</span> \ <span class="pl-s"><span class="pl-pds">"</span>metadata<span class="pl-pds">"</span></span>).formatNullable[<span class="pl-en">JsObject</span>]
    )((from, to, value, description, metadata) <span class="pl-k">=&gt;</span>
    <span class="pl-en">AddTransactionCommand</span>(
      from,
      to,
      value,
      description,
      metadata
    ), addTransactionCommand <span class="pl-k">=&gt;</span>
    (addTransactionCommand.from,
      addTransactionCommand.to,
      addTransactionCommand.value,
      addTransactionCommand.description,
      addTransactionCommand.metadata)
    )
}

<span class="pl-k">object</span> <span class="pl-en">Command</span> <span class="pl-k">extends</span> <span class="pl-e">CommandCompanion</span>[<span class="pl-en">Command</span>] {
  <span class="pl-k">override</span> <span class="pl-k">val</span> <span class="pl-en">CommandFormats</span> <span class="pl-k">=</span> <span class="pl-en">MessageFormats</span>(
    <span class="pl-s"><span class="pl-pds">"</span>updateAccount<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">Json</span>.format[<span class="pl-en">UpdateAccountCommand</span>],
    <span class="pl-s"><span class="pl-pds">"</span>addTransaction<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">Json</span>.format[<span class="pl-en">AddTransactionCommand</span>]
  )
}

<span class="pl-k">sealed</span> <span class="pl-k">trait</span> <span class="pl-en">Response</span> <span class="pl-k">extends</span> <span class="pl-e">Message</span>

<span class="pl-k">sealed</span> <span class="pl-k">trait</span> <span class="pl-en">ResultResponse</span> <span class="pl-k">extends</span> <span class="pl-e">Response</span>

<span class="pl-k">case</span> <span class="pl-k">object</span> <span class="pl-en">UpdateAccountResponse</span> <span class="pl-k">extends</span> <span class="pl-e">ResultResponse</span>

<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">AddTransactionResponse</span>(<span class="pl-v">created</span>: <span class="pl-k">Long</span>) <span class="pl-k">extends</span> <span class="pl-e">ResultResponse</span>

<span class="pl-k">object</span> <span class="pl-en">Response</span> <span class="pl-k">extends</span> <span class="pl-e">ResponseCompanion</span>[<span class="pl-en">ResultResponse</span>] {
  <span class="pl-k">override</span> <span class="pl-k">val</span> <span class="pl-en">ResponseFormats</span> <span class="pl-k">=</span> <span class="pl-en">MessageFormats</span>(
    <span class="pl-s"><span class="pl-pds">"</span>updateAccount<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">Message</span>.objectFormat(<span class="pl-en">UpdateAccountResponse</span>),
    <span class="pl-s"><span class="pl-pds">"</span>addTransaction<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">Json</span>.format[<span class="pl-en">AddTransactionResponse</span>]
  )
}

<span class="pl-k">sealed</span> <span class="pl-k">trait</span> <span class="pl-en">Notification</span> <span class="pl-k">extends</span> <span class="pl-e">Message</span>

<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">AccountUpdatedNotification</span>(<span class="pl-v">account</span>: <span class="pl-en">Account</span>) <span class="pl-k">extends</span> <span class="pl-e">Notification</span>

<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">TransactionAddedNotification</span>(<span class="pl-v">transaction</span>: <span class="pl-en">Transaction</span>) <span class="pl-k">extends</span> <span class="pl-e">Notification</span>

<span class="pl-k">object</span> <span class="pl-en">Notification</span> <span class="pl-k">extends</span> <span class="pl-e">NotificationCompanion</span>[<span class="pl-en">Notification</span>] {
  <span class="pl-k">override</span> <span class="pl-k">val</span> <span class="pl-en">NotificationFormats</span> <span class="pl-k">=</span> <span class="pl-en">MessageFormats</span>(
    <span class="pl-s"><span class="pl-pds">"</span>accountUpdated<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">Json</span>.format[<span class="pl-en">AccountUpdatedNotification</span>],
    <span class="pl-s"><span class="pl-pds">"</span>transactionAdded<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">Json</span>.format[<span class="pl-en">TransactionAddedNotification</span>]
  )
}</pre>
  </div> 
  <h3><a id="user-content-example-server-code" class="anchor" href="https://github.com/dhpcs/play-json-rpc#example-server-code" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Example server code</h3> 
  <p>Note that <code>readCommand</code> is not included in <code>play-json-rpc</code> itself because different use cases may have different directionality. The following example receives commands and sends responses and notifications; other use cases might receive commands and notifications but only send responses.</p> 
  <p>The full definition with imports is at <a href="https://github.com/dhpcs/play-json-rpc/blob/master/example/src/main/scala/com/dhpcs/jsonrpc/example/Server.scala" target="_blank">example/src/main/scala/com/dhpcs/jsonrpc/example/Server.scala</a>.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">object</span> <span class="pl-en">Server</span> {
  <span class="pl-k">private</span> <span class="pl-k">def</span> <span class="pl-en">readCommand</span>(<span class="pl-v">jsonString</span>: <span class="pl-k">String</span>)<span class="pl-k">:</span>
  (<span class="pl-en">Option</span>[<span class="pl-en">Either</span>[<span class="pl-k">String</span>, <span class="pl-en">BigDecimal</span>]], <span class="pl-en">Either</span>[<span class="pl-en">JsonRpcResponseError</span>, <span class="pl-en">Command</span>]) <span class="pl-k">=</span>
    <span class="pl-en">Try</span>(<span class="pl-en">Json</span>.parse(jsonString)) <span class="pl-k">match</span> {
      <span class="pl-k">case</span> <span class="pl-en">Failure</span>(exception) <span class="pl-k">=&gt;</span>
        <span class="pl-c1">None</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">Left</span>(
          <span class="pl-en">JsonRpcResponseError</span>.parseError(exception)
        )
      <span class="pl-k">case</span> <span class="pl-en">Success</span>(json) <span class="pl-k">=&gt;</span>
        <span class="pl-en">Json</span>.fromJson[<span class="pl-en">JsonRpcRequestMessage</span>](json).fold(
          errors <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">Left</span>(
            <span class="pl-en">JsonRpcResponseError</span>.invalidRequest(errors)
          ),
          jsonRpcRequestMessage <span class="pl-k">=&gt;</span>
            <span class="pl-en">Command</span>.read(jsonRpcRequestMessage)
              .fold[(<span class="pl-en">Option</span>[<span class="pl-en">Either</span>[<span class="pl-k">String</span>, <span class="pl-en">BigDecimal</span>]], <span class="pl-en">Either</span>[<span class="pl-en">JsonRpcResponseError</span>, <span class="pl-en">Command</span>])](
              jsonRpcRequestMessage.id <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">Left</span>(
                <span class="pl-en">JsonRpcResponseError</span>.methodNotFound(jsonRpcRequestMessage.method)
              )
            )(commandJsResult <span class="pl-k">=&gt;</span> commandJsResult.fold(
              errors <span class="pl-k">=&gt;</span> jsonRpcRequestMessage.id <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">Left</span>(
                <span class="pl-en">JsonRpcResponseError</span>.invalidParams(errors)
              ),
              command <span class="pl-k">=&gt;</span> jsonRpcRequestMessage.id <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">Right</span>(
                command
              )
            ))
        )
    }
}

<span class="pl-k">class</span> <span class="pl-en">Server</span> {
  <span class="pl-k">private</span>[<span class="pl-v">this</span>] <span class="pl-k">def</span> <span class="pl-en">deliverToSender</span>(<span class="pl-v">jsonString</span>: <span class="pl-k">String</span>) <span class="pl-k">=</span> <span class="pl-k">???</span>

  <span class="pl-k">private</span>[<span class="pl-v">this</span>] <span class="pl-k">def</span> <span class="pl-en">deliverToSubscribers</span>(<span class="pl-v">jsonString</span>: <span class="pl-k">String</span>) <span class="pl-k">=</span> <span class="pl-k">???</span>

  <span class="pl-k">def</span> <span class="pl-en">yourMessageHandler</span>(<span class="pl-v">jsonString</span>: <span class="pl-k">String</span>) <span class="pl-k">=</span> readCommand(jsonString) <span class="pl-k">match</span> {
    <span class="pl-k">case</span> (id, <span class="pl-en">Left</span>(jsonRpcResponseError)) <span class="pl-k">=&gt;</span>
      <span class="pl-k">val</span> <span class="pl-en">jsonResponseString</span> <span class="pl-k">=</span> <span class="pl-en">Json</span>.stringify(<span class="pl-en">Json</span>.toJson(
        <span class="pl-en">JsonRpcResponseMessage</span>(<span class="pl-en">Left</span>(jsonRpcResponseError), id)
      ))
      deliverToSender(jsonResponseString)
    <span class="pl-k">case</span> (id, <span class="pl-en">Right</span>(command)) <span class="pl-k">=&gt;</span>
      command <span class="pl-k">match</span> {
        <span class="pl-k">case</span> <span class="pl-en">UpdateAccountCommand</span>(account) <span class="pl-k">=&gt;</span>
          <span class="pl-c">// Omitted: validate and handle the command</span>
          <span class="pl-c">// ...</span>
          <span class="pl-c">// For demonstration purposes we'll toss a coin to decide whether to reject the command</span>
          <span class="pl-k">if</span> (<span class="pl-en">Random</span>.nextBoolean()) {
            <span class="pl-c">// Rejecting a command:</span>
            <span class="pl-k">val</span> <span class="pl-en">jsonResponseString</span> <span class="pl-k">=</span> <span class="pl-en">Json</span>.stringify(<span class="pl-en">Json</span>.toJson(
              <span class="pl-en">Response</span>.write(
                <span class="pl-en">Left</span>(
                  <span class="pl-en">ErrorResponse</span>(
                    <span class="pl-en">JsonRpcResponseError</span>.<span class="pl-en">ReservedErrorCodeFloor</span> <span class="pl-k">-</span> <span class="pl-c1">1</span>,
                    <span class="pl-s"><span class="pl-pds">"</span>Fate does not favour you today<span class="pl-pds">"</span></span>
                  )
                ),
                id
              )
            ))
            deliverToSender(jsonResponseString)
          } <span class="pl-k">else</span> {
            <span class="pl-k">val</span> <span class="pl-en">jsonResponseString</span> <span class="pl-k">=</span> <span class="pl-en">Json</span>.stringify(<span class="pl-en">Json</span>.toJson(
              <span class="pl-en">Response</span>.write(
                <span class="pl-en">Right</span>(
                  <span class="pl-en">UpdateAccountResponse</span>
                ),
                id
              )
            ))
            deliverToSender(jsonResponseString)
            <span class="pl-k">val</span> <span class="pl-en">jsonNotificationString</span> <span class="pl-k">=</span> <span class="pl-en">Json</span>.stringify(<span class="pl-en">Json</span>.toJson(
              <span class="pl-en">Notification</span>.write(
                <span class="pl-en">AccountUpdatedNotification</span>(
                  account
                )
              )
            ))
            deliverToSubscribers(jsonNotificationString)
          }
        <span class="pl-k">case</span> <span class="pl-en">AddTransactionCommand</span>(from, to, value, description, metadata) <span class="pl-k">=&gt;</span>
          <span class="pl-c">// Omitted: validate and handle the command</span>
          <span class="pl-c">// ...</span>
          <span class="pl-c">// For demonstration purposes we'll toss a coin to decide whether to reject the command</span>
          <span class="pl-k">if</span> (<span class="pl-en">Random</span>.nextBoolean()) {
            <span class="pl-c">// Rejecting a command:</span>
            <span class="pl-k">val</span> <span class="pl-en">jsonResponseString</span> <span class="pl-k">=</span> <span class="pl-en">Json</span>.stringify(<span class="pl-en">Json</span>.toJson(
              <span class="pl-en">Response</span>.write(
                <span class="pl-en">Left</span>(
                  <span class="pl-en">ErrorResponse</span>(
                    <span class="pl-en">JsonRpcResponseError</span>.<span class="pl-en">ReservedErrorCodeFloor</span> <span class="pl-k">-</span> <span class="pl-c1">1</span>,
                    <span class="pl-s"><span class="pl-pds">"</span>Fate does not favour you today<span class="pl-pds">"</span></span>
                  )
                ),
                id
              )
            ))
            deliverToSender(jsonResponseString)
          } <span class="pl-k">else</span> {
            <span class="pl-k">val</span> <span class="pl-en">transaction</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>(from, to, value, <span class="pl-en">System</span>.currentTimeMillis, description, metadata)
            <span class="pl-k">val</span> <span class="pl-en">jsonResponseString</span> <span class="pl-k">=</span> <span class="pl-en">Json</span>.stringify(<span class="pl-en">Json</span>.toJson(
              <span class="pl-en">Response</span>.write(
                <span class="pl-en">Right</span>(
                  <span class="pl-en">AddTransactionResponse</span>(
                    transaction.created
                  )
                ),
                id
              )
            ))
            deliverToSender(jsonResponseString)
            <span class="pl-k">val</span> <span class="pl-en">jsonNotificationString</span> <span class="pl-k">=</span> <span class="pl-en">Json</span>.stringify(<span class="pl-en">Json</span>.toJson(
              <span class="pl-en">Notification</span>.write(
                <span class="pl-en">TransactionAddedNotification</span>(
                  transaction
                )
              )
            ))
            deliverToSubscribers(jsonNotificationString)
          }
      }
  }
}</pre>
  </div> 
  <h3><a id="user-content-example-client-code" class="anchor" href="https://github.com/dhpcs/play-json-rpc#example-client-code" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Example client code</h3> 
  <p>Note that <code>readJsonRpcMessage</code> is not included in <code>play-json-rpc</code> itself, for the same reason that the server example's <code>readCommand</code> is not.</p> 
  <p>Note also that in the real project this example is based on, there is extra code that ensures <code>pendingRequests</code> etc. is only accessed by one thread. That code was removed to simplify this example.</p> 
  <p>The full definition with imports is at <a href="https://github.com/dhpcs/play-json-rpc/blob/master/example/src/main/scala/com/dhpcs/jsonrpc/example/Client.scala" target="_blank">example/src/main/scala/com/dhpcs/jsonrpc/example/Client.scala</a>.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">object</span> <span class="pl-en">Client</span> {

  <span class="pl-k">trait</span> <span class="pl-en">ResponseCallback</span> {
    <span class="pl-k">def</span> <span class="pl-en">onErrorReceived</span>(<span class="pl-v">errorResponse</span>: <span class="pl-en">ErrorResponse</span>)

    <span class="pl-k">def</span> <span class="pl-en">onResultReceived</span>(<span class="pl-v">resultResponse</span>: <span class="pl-en">ResultResponse</span>) <span class="pl-k">=</span> ()
  }

  <span class="pl-k">private</span> <span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">PendingRequest</span>(<span class="pl-v">requestMessage</span>: <span class="pl-en">JsonRpcRequestMessage</span>,
                                    <span class="pl-v">callback</span>: <span class="pl-en">ResponseCallback</span>)

  <span class="pl-k">private</span> <span class="pl-k">def</span> <span class="pl-en">readJsonRpcMessage</span>(<span class="pl-v">jsonString</span>: <span class="pl-k">String</span>)<span class="pl-k">:</span> <span class="pl-en">Either</span>[<span class="pl-k">String</span>, <span class="pl-en">JsonRpcMessage</span>] <span class="pl-k">=</span>
    <span class="pl-en">Try</span>(<span class="pl-en">Json</span>.parse(jsonString)) <span class="pl-k">match</span> {
      <span class="pl-k">case</span> <span class="pl-en">Failure</span>(exception) <span class="pl-k">=&gt;</span>
        <span class="pl-en">Left</span>(s<span class="pl-s"><span class="pl-pds">"</span>Invalid JSON: $exception<span class="pl-pds">"</span></span>)
      <span class="pl-k">case</span> <span class="pl-en">Success</span>(json) <span class="pl-k">=&gt;</span>
        <span class="pl-en">Json</span>.fromJson[<span class="pl-en">JsonRpcMessage</span>](json).fold(
          errors <span class="pl-k">=&gt;</span> <span class="pl-en">Left</span>(s<span class="pl-s"><span class="pl-pds">"</span>Invalid JSON-RPC message: $errors<span class="pl-pds">"</span></span>),
          jsonRpcMessage <span class="pl-k">=&gt;</span> <span class="pl-en">Right</span>(jsonRpcMessage)
        )
    }
}

<span class="pl-k">class</span> <span class="pl-en">Client</span> {
  <span class="pl-k">private</span>[<span class="pl-v">this</span>] <span class="pl-k">var</span> <span class="pl-en">pendingRequests</span> <span class="pl-k">=</span> <span class="pl-en">Map</span>.empty[<span class="pl-en">BigDecimal</span>, <span class="pl-en">PendingRequest</span>]
  <span class="pl-k">private</span>[<span class="pl-v">this</span>] <span class="pl-k">var</span> <span class="pl-en">commandIdentifier</span> <span class="pl-k">=</span> <span class="pl-en">BigDecimal</span>(<span class="pl-c1">0</span>)

  <span class="pl-k">private</span>[<span class="pl-v">this</span>] <span class="pl-k">def</span> <span class="pl-en">deliverToServer</span>(<span class="pl-v">jsonString</span>: <span class="pl-k">String</span>) <span class="pl-k">=</span> <span class="pl-k">???</span>

  <span class="pl-k">private</span>[<span class="pl-v">this</span>] <span class="pl-k">def</span> <span class="pl-en">notifySubscribers</span>(<span class="pl-v">notification</span>: <span class="pl-en">Notification</span>) <span class="pl-k">=</span> <span class="pl-k">???</span>

  <span class="pl-k">def</span> <span class="pl-en">sendCommand</span>(<span class="pl-v">command</span>: <span class="pl-en">Command</span>, <span class="pl-v">responseCallback</span>: <span class="pl-en">ResponseCallback</span>) {
    <span class="pl-k">val</span> <span class="pl-en">jsonRpcRequestMessage</span> <span class="pl-k">=</span> <span class="pl-en">Command</span>.write(command, <span class="pl-en">Some</span>(<span class="pl-en">Right</span>(commandIdentifier)))
    commandIdentifier <span class="pl-k">=</span> commandIdentifier <span class="pl-k">+</span> <span class="pl-c1">1</span>
    <span class="pl-k">val</span> <span class="pl-en">jsonCommandString</span> <span class="pl-k">=</span> <span class="pl-en">Json</span>.stringify(
      <span class="pl-en">Json</span>.toJson(jsonRpcRequestMessage)
    )
    deliverToServer(jsonCommandString)
    pendingRequests <span class="pl-k">=</span> pendingRequests <span class="pl-k">+</span>
      (jsonRpcRequestMessage.id.get.right.get <span class="pl-k">-</span><span class="pl-k">&gt;</span>
        <span class="pl-en">PendingRequest</span>(jsonRpcRequestMessage, responseCallback))
  }

  <span class="pl-k">def</span> <span class="pl-en">yourMessageHandler</span>(<span class="pl-v">jsonString</span>: <span class="pl-k">String</span>) {
    readJsonRpcMessage(jsonString) <span class="pl-k">match</span> {
      <span class="pl-k">case</span> <span class="pl-en">Left</span>(error) <span class="pl-k">=&gt;</span>
        sys.error(error)
      <span class="pl-k">case</span> <span class="pl-en">Right</span>(jsonRpcMessage) <span class="pl-k">=&gt;</span> jsonRpcMessage <span class="pl-k">match</span> {
        <span class="pl-k">case</span> <span class="pl-v">jsonRpcRequestMessage</span>: <span class="pl-en">JsonRpcRequestMessage</span> <span class="pl-k">=&gt;</span>
          sys.error(s<span class="pl-s"><span class="pl-pds">"</span>Received $jsonRpcRequestMessage<span class="pl-pds">"</span></span>)
        <span class="pl-k">case</span> <span class="pl-v">jsonRpcRequestMessageBatch</span>: <span class="pl-en">JsonRpcRequestMessageBatch</span> <span class="pl-k">=&gt;</span>
          sys.error(s<span class="pl-s"><span class="pl-pds">"</span>Received $jsonRpcRequestMessageBatch<span class="pl-pds">"</span></span>)
        <span class="pl-k">case</span> <span class="pl-v">jsonRpcResponseMessage</span>: <span class="pl-en">JsonRpcResponseMessage</span> <span class="pl-k">=&gt;</span>
          jsonRpcResponseMessage.id.fold {
            sys.error(s<span class="pl-s"><span class="pl-pds">"</span>JSON-RPC message ID missing, jsonRpcResponseMessage<span class="pl-pds">"</span></span> <span class="pl-k">+</span>
              s<span class="pl-s"><span class="pl-pds">"</span>.eitherErrorOrResult=${jsonRpcResponseMessage.eitherErrorOrResult}<span class="pl-pds">"</span></span>)
          } { id <span class="pl-k">=&gt;</span>
            id.right.toOption.fold {
              sys.error(s<span class="pl-s"><span class="pl-pds">"</span>JSON-RPC message ID was not a number, id=$id<span class="pl-pds">"</span></span>)
            } { commandIdentifier <span class="pl-k">=&gt;</span>
              pendingRequests.get(commandIdentifier).fold {
                sys.error(s<span class="pl-s"><span class="pl-pds">"</span>No pending request exists with commandIdentifier<span class="pl-pds">"</span></span> <span class="pl-k">+</span>
                  s<span class="pl-s"><span class="pl-pds">"</span>=$commandIdentifier<span class="pl-pds">"</span></span>)
              } { pendingRequest <span class="pl-k">=&gt;</span>
                pendingRequests <span class="pl-k">=</span> pendingRequests <span class="pl-k">-</span> commandIdentifier
                <span class="pl-en">Response</span>.read(
                  jsonRpcResponseMessage,
                  pendingRequest.requestMessage.method
                ).fold({ errors <span class="pl-k">=&gt;</span>
                  sys.error(s<span class="pl-s"><span class="pl-pds">"</span>Invalid Response: $errors<span class="pl-pds">"</span></span>)
                }, {
                  <span class="pl-k">case</span> <span class="pl-en">Left</span>(errorResponse) <span class="pl-k">=&gt;</span>
                    pendingRequest.callback.onErrorReceived(errorResponse)
                  <span class="pl-k">case</span> <span class="pl-en">Right</span>(resultResponse) <span class="pl-k">=&gt;</span>
                    pendingRequest.callback.onResultReceived(resultResponse)
                })
              }
            }
          }
        <span class="pl-k">case</span> <span class="pl-v">jsonRpcResponseMessageBatch</span>: <span class="pl-en">JsonRpcResponseMessageBatch</span> <span class="pl-k">=&gt;</span>
          sys.error(s<span class="pl-s"><span class="pl-pds">"</span>Received $jsonRpcResponseMessageBatch<span class="pl-pds">"</span></span>)
        <span class="pl-k">case</span> <span class="pl-v">jsonRpcNotificationMessage</span>: <span class="pl-en">JsonRpcNotificationMessage</span> <span class="pl-k">=&gt;</span>
          <span class="pl-en">Notification</span>.read(jsonRpcNotificationMessage).fold {
            sys.error(s<span class="pl-s"><span class="pl-pds">"</span>No notification type exists with method<span class="pl-pds">"</span></span> <span class="pl-k">+</span>
              s<span class="pl-s"><span class="pl-pds">"</span>=${jsonRpcNotificationMessage.method}<span class="pl-pds">"</span></span>)
          }(_.fold({ errors <span class="pl-k">=&gt;</span>
            sys.error(s<span class="pl-s"><span class="pl-pds">"</span>Invalid Notification: $errors<span class="pl-pds">"</span></span>)
          }, notifySubscribers
          ))
      }
    }
  }
}</pre>
  </div> 
  <h2><a id="user-content-error-responses" class="anchor" href="https://github.com/dhpcs/play-json-rpc#error-responses" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Error responses</h2> 
  <p>A <code>JsonRpcResponseError</code> looks like this:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">sealed</span> <span class="pl-k">trait</span> <span class="pl-en">JsonRpcResponseError</span> {

  <span class="pl-k">def</span> <span class="pl-en">code</span><span class="pl-k">:</span> <span class="pl-k">Int</span>

  <span class="pl-k">def</span> <span class="pl-en">message</span><span class="pl-k">:</span> <span class="pl-k">String</span>

  <span class="pl-k">def</span> <span class="pl-en">data</span><span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-en">JsValue</span>]

}</pre>
  </div> 
  <p>And has the following functions available on its companion object with which to create instances:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">parseError</span>(<span class="pl-v">exception</span>: <span class="pl-en">Throwable</span>)<span class="pl-k">:</span> <span class="pl-en">JsonRpcResponseError</span>

<span class="pl-k">def</span> <span class="pl-en">invalidRequest</span>(<span class="pl-v">errors</span>: <span class="pl-en">Seq</span>[(<span class="pl-en">JsPath</span>, <span class="pl-en">Seq</span>[<span class="pl-en">ValidationError</span>])])<span class="pl-k">:</span> <span class="pl-en">JsonRpcResponseError</span>

<span class="pl-k">def</span> <span class="pl-en">methodNotFound</span>(<span class="pl-v">method</span>: <span class="pl-k">String</span>)<span class="pl-k">:</span> <span class="pl-en">JsonRpcResponseError</span>

<span class="pl-k">def</span> <span class="pl-en">invalidParams</span>(<span class="pl-v">errors</span>: <span class="pl-en">Seq</span>[(<span class="pl-en">JsPath</span>, <span class="pl-en">Seq</span>[<span class="pl-en">ValidationError</span>])])<span class="pl-k">:</span> <span class="pl-en">JsonRpcResponseError</span>

<span class="pl-k">def</span> <span class="pl-en">internalError</span>(<span class="pl-v">error</span>: <span class="pl-en">Option</span>[<span class="pl-en">JsValue</span>] <span class="pl-k">=</span> <span class="pl-c1">None</span>)<span class="pl-k">:</span> <span class="pl-en">JsonRpcResponseError</span>

<span class="pl-k">def</span> <span class="pl-en">serverError</span>(<span class="pl-v">code</span>: <span class="pl-k">Int</span>, <span class="pl-v">error</span>: <span class="pl-en">Option</span>[<span class="pl-en">JsValue</span>] <span class="pl-k">=</span> <span class="pl-c1">None</span>)<span class="pl-k">:</span> <span class="pl-en">JsonRpcResponseError</span>

<span class="pl-k">def</span> <span class="pl-en">applicationError</span>(<span class="pl-v">code</span>: <span class="pl-k">Int</span>,
                     <span class="pl-v">message</span>: <span class="pl-k">String</span>,
                     <span class="pl-v">data</span>: <span class="pl-en">Option</span>[<span class="pl-en">JsValue</span>] <span class="pl-k">=</span> <span class="pl-c1">None</span>)<span class="pl-k">:</span> <span class="pl-en">JsonRpcResponseError</span></pre>
  </div> 
  <p>Note that <code>applicationError(...)</code> and <code>serverError(...)</code> validate the integer code passed in and will fail if it is not legal for the error type as per the JSON-RPC 2.0 spec.</p> 
  <h2><a id="user-content-notes-on-usage-in-android-projects" class="anchor" href="https://github.com/dhpcs/play-json-rpc#notes-on-usage-in-android-projects" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Notes on usage in Android projects</h2> 
  <p>Use in Android projects is very much supported. The motivation behind building the library was in being able to define message types and supporting code only once (both the JSON-RPC formats and formats for domain objects), and then use them both on the server and client side of the downstream project.</p> 
  <p>However, there are two caveats:</p> 
  <ol> 
   <li><p>The <code>play-json-rpc</code> dependency on <code>play-json</code> and its transitive dependencies will result in your application exceeding the <a href="https://developer.android.com/tools/building/multidex.html" target="_blank">DEX 65K Methods Limit</a>. You will need to workaround this. The recommended approach is to use MultiDex as described at <a href="https://github.com/saturday06/gradle-android-scala-plugin#52-option-2-use-multidex" target="_blank">https://github.com/saturday06/gradle-android-scala-plugin#52-option-2-use-multidex</a>. Note that unless you are writing Scala code in the Android application itself you do <em>not</em> need to add <code>compile "org.scala-lang:scala-library:2.11.7"</code> to your dependencies, just as you do not need to use the gradle-android-scala plugin.</p></li> 
   <li><p>In Play 2.4, <a href="https://playframework.com/documentation/2.4.x/Migration24" target="_blank">"the support for Java 6 and Java 7 was dropped and Play 2.4 now requires Java 8."</a>. This means that the 2.4.0 standalone play-json library is also compiled with JDK8. In order to support use in Android projects <code>play-json-rpc</code> depends on <code>play-json</code> 2.3.10 – the last release compiled with JDK7. As long as Android does not support Java 8 features, changing the dependency to 2.4.0 will result in build time errors in Android projects.</p> <p>Fixing the dependency at 2.3.10 introduces its own problems in that Play 2.4.x+ projects will override the <code>play-json</code> dependency to 2.4.x, which can result in runtime errors if the runtime play-json version e.g. does not have methods that were present in 2.3.10 which <code>play-json-rpc</code> is compiled against.</p> <p>Specifically, between <code>play-json</code> 2.3.10 and <code>play-json</code> 2.4.0 there was a change in how JsObjects are created. In 2.3.10 the <a href="https://github.com/playframework/playframework/blob/2.3.10/framework/src/play-json/src/main/scala/play/api/libs/json/JsValue.scala#L166" target="_blank">case class constructor accepted a fields sequence</a>, while in 2.4.0 the case class constructor has changed and to create JsObjects from a sequence of fields entails calling a <a href="https://github.com/playframework/playframework/blob/2.4.0/framework/src/play-json/src/main/scala/play/api/libs/json/JsValue.scala#L154" target="_blank">new apply method on the companion object</a>. As such, attempting to create a JsObject with a <code>play-json</code> runtime version of 2.4.0 but with code that was compiled against 2.3.10 results in <code>NoSuchMethodErrors</code>.</p> <p><code>play-json-rpc</code> accommodates this difference by instead using the <code>Json.obj()</code> JsObject creation function, which is present in both 2.3.10 and 2.4.0.</p></li> 
  </ol> 
  <h2><a id="user-content-testkit" class="anchor" href="https://github.com/dhpcs/play-json-rpc#testkit" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Testkit</h2> 
  <p>There are two types in the <code>com.dhpcs.json</code> package of the testkit module that may be useful when writing tests in dependent projects (example use can be seen in <code>JsonRpcMessageSpec.scala</code>): 1. <code>JsResultUniformity</code> 2. <code>FormatBehaviors</code></p> 
  <p>They are published as a separate artifact, so to make use of them in your dependent project's tests, set your dependencies to be like this:</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">++</span><span class="pl-k">=</span> <span class="pl-en">Seq</span>(
  <span class="pl-s"><span class="pl-pds">"</span>com.dhpcs<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>play-json-rpc<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>1.3.0<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>org.scalatest<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>scalatest<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>3.0.0<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-en">Test</span>,
  <span class="pl-s"><span class="pl-pds">"</span>com.dhpcs<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>play-json-rpc-testkit<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>1.3.0<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-en">Test</span>
)</pre>
  </div> 
  <h2><a id="user-content-contributing" class="anchor" href="https://github.com/dhpcs/play-json-rpc#contributing" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Contributing</h2> 
  <p>Contributions – both code and documentation – are welcome.</p> 
  <p>The tests are in <code>JsonRpcMessageSpec.scala</code> and can be run with <code>sbt test</code>.</p> 
  <h2><a id="user-content-license" class="anchor" href="https://github.com/dhpcs/play-json-rpc#license" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>License</h2> 
  <p>play-json-rpc is licensed under the Apache 2 License.</p> 
 </article>
</div>