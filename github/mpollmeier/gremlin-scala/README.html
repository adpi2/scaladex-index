<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <p><a href="https://github.com/mpollmeier/gremlin-scala/raw/master/doc/images/gremlin-scala-logo.png" target="_blank"><img src="https://github.com/mpollmeier/gremlin-scala/raw/master/doc/images/gremlin-scala-logo.png" alt="logo" style="max-width:100%;"></a> <a href="http://travis-ci.org/mpollmeier/gremlin-scala" target="_blank"><img src="https://camo.githubusercontent.com/9f50846c4b0d761fb6e0dc68e60ff12d1e63a199/68747470733a2f2f7365637572652e7472617669732d63692e6f72672f6d706f6c6c6d656965722f6772656d6c696e2d7363616c612e706e673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://secure.travis-ci.org/mpollmeier/gremlin-scala.png?branch=master" style="max-width:100%;"></a> <a href="https://gitter.im/mpollmeier/gremlin-scala?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge" target="_blank"><img src="https://camo.githubusercontent.com/da2edb525cde1455a622c58c0effc3a90b9a181c/68747470733a2f2f6261646765732e6769747465722e696d2f4a6f696e253230436861742e737667" alt="Join the chat at https://gitter.im/mpollmeier/gremlin-scala" data-canonical-src="https://badges.gitter.im/Join%20Chat.svg" style="max-width:100%;"></a> <a href="https://maven-badges.herokuapp.com/maven-central/com.michaelpollmeier/gremlin-scala_2.12" target="_blank"><img src="https://camo.githubusercontent.com/67d39a8d22e7acd7fd885d8957729769dd549d03/68747470733a2f2f6d6176656e2d6261646765732e6865726f6b756170702e636f6d2f6d6176656e2d63656e7472616c2f636f6d2e6d69636861656c706f6c6c6d656965722f6772656d6c696e2d7363616c615f322e31322f62616467652e737667" alt="Maven Central" data-canonical-src="https://maven-badges.herokuapp.com/maven-central/com.michaelpollmeier/gremlin-scala_2.12/badge.svg" style="max-width:100%;"></a></p> 
  <h2><a id="user-content-gremlin-scala-for-apache-tinkerpop-3" class="anchor" href="https://github.com/mpollmeier/gremlin-scala#gremlin-scala-for-apache-tinkerpop-3" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Gremlin-Scala for Apache Tinkerpop 3</h2> 
  <p>A wrapper to use <a href="https://github.com/apache/incubator-tinkerpop" target="_blank">Apache Tinkerpop3</a> - a JVM graph traversal library - from Scala.</p> 
  <ul> 
   <li>Scala friendly function signatures, aiming to be close to the Scala collection library. 
    <ul> 
     <li>use standard Scala functions - no need to worry about how to implement things like <code>java.util.function.BiPredicate</code></li> 
    </ul> </li> 
   <li>Beautiful DSL to create vertices and edges</li> 
   <li>Type safe traversals</li> 
   <li>Minimal runtime overhead - only allocates additional instances if absolutely necessary</li> 
   <li>Nothing is hidden away, you can always easily access the underlying Gremlin-Java objects if needed, e.g. to access graph db specifics things like indexes</li> 
  </ul> 
  <h3><a id="user-content-getting-started" class="anchor" href="https://github.com/mpollmeier/gremlin-scala#getting-started" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Getting started</h3> 
  <p>The <a href="https://github.com/mpollmeier/gremlin-scala-examples" target="_blank">examples project</a> comes with working examples for different graph databases. Typically you just need to add a dependency on <code>"com.michaelpollmeier" %% "gremlin-scala" % "SOME_VERSION"</code> and one for the graph db of your choice to your <code>build.sbt</code>. The latest version is displayed at the top of this readme in the maven badge.</p> 
  <h3><a id="user-content-using-the-sbt-console" class="anchor" href="https://github.com/mpollmeier/gremlin-scala#using-the-sbt-console" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Using the sbt console</h3> 
  <ul> 
   <li><code>sbt gremlin-scala/test:console</code></li> 
  </ul> 
  <pre><code>import gremlin.scala._
import org.apache.tinkerpop.gremlin.tinkergraph.structure.TinkerFactory
val g = TinkerFactory.createModern.asScala
g.V.hasLabel("person").value[String]("name").toList
// List(marko, vadas, josh, peter)
</code></pre> 
  <h3><a id="user-content-simple-traversals" class="anchor" href="https://github.com/mpollmeier/gremlin-scala#simple-traversals" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Simple traversals</h3> 
  <p>The below create traversals, which are lazy computations. To run a traversal, you can use e.g. <code>toSet</code>, <code>toList</code>, <code>head</code>, <code>headOption</code> etc.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">gremlin.scala.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">org.apache.tinkerpop.gremlin.tinkergraph.structure.</span><span class="pl-v">TinkerFactory</span>

graph.<span class="pl-en">V</span> <span class="pl-c"><span class="pl-c">//</span>all vertices</span>
graph.<span class="pl-en">E</span> <span class="pl-c"><span class="pl-c">//</span>all edges</span>

graph.<span class="pl-en">V</span>(<span class="pl-c1">1</span>).outE(<span class="pl-s"><span class="pl-pds">"</span>knows<span class="pl-pds">"</span></span>) <span class="pl-c"><span class="pl-c">//</span>follow outgoing edges</span>
graph.<span class="pl-en">V</span>(<span class="pl-c1">1</span>).out(<span class="pl-s"><span class="pl-pds">"</span>knows<span class="pl-pds">"</span></span>) <span class="pl-c"><span class="pl-c">//</span>follow outgoing edges to incoming vertex</span>

<span class="pl-k">for</span> {
  person <span class="pl-k">&lt;</span><span class="pl-k">-</span> graph.<span class="pl-en">V</span>.hasLabel(<span class="pl-s"><span class="pl-pds">"</span>person<span class="pl-pds">"</span></span>)
  favorite <span class="pl-k">&lt;</span><span class="pl-k">-</span> person.outE(<span class="pl-s"><span class="pl-pds">"</span>likes<span class="pl-pds">"</span></span>).orderBy(<span class="pl-s"><span class="pl-pds">"</span>weight<span class="pl-pds">"</span></span>, <span class="pl-en">Order</span>.decr).limit(<span class="pl-c1">1</span>).inV
} <span class="pl-k">yield</span> (person, favorite.label)

<span class="pl-c"><span class="pl-c">//</span> remove all people over 30 from the graph - also removes corresponding edges</span>
<span class="pl-k">val</span> <span class="pl-en">Age</span> <span class="pl-k">=</span> <span class="pl-en">Key</span>[<span class="pl-k">Int</span>](<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>)
graph.<span class="pl-en">V</span>.hasLabel(<span class="pl-s"><span class="pl-pds">"</span>person<span class="pl-pds">"</span></span>).has(<span class="pl-en">Age</span>, <span class="pl-en">P</span>.gte(<span class="pl-c1">30</span>)).drop.iterate</pre>
  </div> 
  <p>Warning: GremlinScala is <em>not</em> a monad, because the underlying Tinkerpop GraphTraversal is not. I.e. while GremlinScala offers <code>map</code>, <code>flatMap</code> etc. and you can use it in a for comprehension for syntactic sugar, it does not fulfil all monad laws.</p> 
  <p>More working examples in <a href="https://github.com/mpollmeier/gremlin-scala/blob/master/gremlin-scala/src/test/scala/gremlin/scala/TraversalSpec.scala" target="_blank">TraversalSpec</a>.</p> 
  <h3><a id="user-content-vertices-and-edges-with-type-safe-properties" class="anchor" href="https://github.com/mpollmeier/gremlin-scala#vertices-and-edges-with-type-safe-properties" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Vertices and edges with type safe properties</h3> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">gremlin.scala.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">org.apache.tinkerpop.gremlin.tinkergraph.structure.</span><span class="pl-v">TinkerGraph</span>
<span class="pl-k">val</span> <span class="pl-en">graph</span> <span class="pl-k">=</span> <span class="pl-en">TinkerGraph</span>.open.asScala

<span class="pl-c"><span class="pl-c">//</span> Keys for properties which can later be used for type safe traversals</span>
<span class="pl-k">val</span> <span class="pl-en">Founded</span> <span class="pl-k">=</span> <span class="pl-en">Key</span>[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>founded<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">Distance</span> <span class="pl-k">=</span> <span class="pl-en">Key</span>[<span class="pl-k">Int</span>](<span class="pl-s"><span class="pl-pds">"</span>distance<span class="pl-pds">"</span></span>)

<span class="pl-c"><span class="pl-c">//</span> create labelled vertex</span>
<span class="pl-k">val</span> <span class="pl-en">paris</span> <span class="pl-k">=</span> graph <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>Paris<span class="pl-pds">"</span></span>

<span class="pl-c"><span class="pl-c">//</span> create vertex with typed properties</span>
<span class="pl-k">val</span> <span class="pl-en">london</span> <span class="pl-k">=</span> graph <span class="pl-k">+</span> (<span class="pl-s"><span class="pl-pds">"</span>London<span class="pl-pds">"</span></span>, <span class="pl-en">Founded</span> <span class="pl-k">→</span> <span class="pl-s"><span class="pl-pds">"</span>43 AD<span class="pl-pds">"</span></span>)

<span class="pl-c"><span class="pl-c">//</span> create labelled edges </span>
paris <span class="pl-k">---</span> <span class="pl-s"><span class="pl-pds">"</span>OneWayRoad<span class="pl-pds">"</span></span> <span class="pl-k">--</span><span class="pl-k">&gt;</span> london
paris <span class="pl-k">&lt;</span><span class="pl-k">--</span> <span class="pl-s"><span class="pl-pds">"</span>OtherWayAround<span class="pl-pds">"</span></span> <span class="pl-k">---</span> london
paris <span class="pl-k">&lt;</span><span class="pl-k">--</span> <span class="pl-s"><span class="pl-pds">"</span>Eurostar<span class="pl-pds">"</span></span> <span class="pl-k">--</span><span class="pl-k">&gt;</span> london

<span class="pl-c"><span class="pl-c">//</span> create edge with typed properties</span>
paris <span class="pl-k">---</span> (<span class="pl-s"><span class="pl-pds">"</span>Eurostar<span class="pl-pds">"</span></span>, <span class="pl-en">Distance</span> <span class="pl-k">→</span> <span class="pl-c1">495</span>) <span class="pl-k">--</span><span class="pl-k">&gt;</span> london

<span class="pl-c"><span class="pl-c">//</span> type safe access to properties</span>
paris.out(<span class="pl-s"><span class="pl-pds">"</span>Eurostar<span class="pl-pds">"</span></span>).value(<span class="pl-en">Founded</span>).head <span class="pl-c"><span class="pl-c">//</span>43 AD</span>
paris.outE(<span class="pl-s"><span class="pl-pds">"</span>Eurostar<span class="pl-pds">"</span></span>).value(<span class="pl-en">Distance</span>).head <span class="pl-c"><span class="pl-c">//</span>495</span>
london.valueOption(<span class="pl-en">Founded</span>) <span class="pl-c"><span class="pl-c">//</span>Some(43 AD)</span>
london.valueOption(<span class="pl-en">Distance</span>) <span class="pl-c"><span class="pl-c">//</span>None</span>
paris.setProperty(<span class="pl-en">Founded</span>, <span class="pl-s"><span class="pl-pds">"</span>300 BC<span class="pl-pds">"</span></span>)

<span class="pl-k">val</span> <span class="pl-en">Name</span> <span class="pl-k">=</span> <span class="pl-en">Key</span>[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">Age</span> <span class="pl-k">=</span> <span class="pl-en">Key</span>[<span class="pl-k">Int</span>](<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>)

<span class="pl-k">val</span> <span class="pl-en">v1</span> <span class="pl-k">=</span> graph <span class="pl-k">+</span> (<span class="pl-s"><span class="pl-pds">"</span>person<span class="pl-pds">"</span></span>, <span class="pl-en">Name</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>marko<span class="pl-pds">"</span></span>, <span class="pl-en">Age</span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">29</span>) asScala

v1.keys <span class="pl-c"><span class="pl-c">//</span> Set(Key("name"), Key("age"))</span>
v1.property(<span class="pl-en">Name</span>) <span class="pl-c"><span class="pl-c">//</span> "marko"</span>
v1.valueMap <span class="pl-c"><span class="pl-c">//</span> Map("name" → "marko", "age" → 29)</span>
v1.valueMap(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>) <span class="pl-c"><span class="pl-c">//</span> Map("name" → "marko", "age" → 29)</span></pre>
  </div> 
  <p>More working examples in <a href="https://github.com/mpollmeier/gremlin-scala/blob/master/gremlin-scala/src/test/scala/gremlin/scala/SchemaSpec.scala" target="_blank">SchemaSpec</a>, <a href="https://github.com/mpollmeier/gremlin-scala/blob/master/gremlin-scala/src/test/scala/gremlin/scala/ArrowSyntaxSpec.scala" target="_blank">ArrowSyntaxSpec</a> and <a href="https://github.com/mpollmeier/gremlin-scala/blob/master/gremlin-scala/src/test/scala/gremlin/scala/ElementSpec.scala" target="_blank">ElementSpec</a>.</p> 
  <h3><a id="user-content-compiler-helps-to-eliminate-invalid-traversals" class="anchor" href="https://github.com/mpollmeier/gremlin-scala#compiler-helps-to-eliminate-invalid-traversals" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Compiler helps to eliminate invalid traversals</h3> 
  <p>Gremlin-Scala aims to helps you at compile time as much as possible. Take this simple example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">gremlin.scala.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">org.apache.tinkerpop.gremlin.tinkergraph.structure.</span><span class="pl-v">TinkerGraph</span>
<span class="pl-k">val</span> <span class="pl-en">graph</span> <span class="pl-k">=</span> <span class="pl-en">TinkerGraph</span>.open.asScala
graph.<span class="pl-en">V</span>.outE.inV  <span class="pl-c"><span class="pl-c">//</span>compiles</span>
graph.<span class="pl-en">V</span>.outE.outE <span class="pl-c"><span class="pl-c">//</span>does _not_ compile</span></pre>
  </div> 
  <p>In Gremlin-Groovy there's nothing stopping you to create the second traversal - it will explode at runtime, as outgoing edges do not have outgoing edges. In Gremlin-Scala this simply doesn't compile.</p> 
  <h3><a id="user-content-type-safe-traversals" class="anchor" href="https://github.com/mpollmeier/gremlin-scala#type-safe-traversals" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Type safe traversals</h3> 
  <p>You can label any step using <code>as(StepLabel)</code> and the compiler will infer the correct types for you in the select step using an HList (a type safe list, i.e. the compiler knows the types of the elements of the list). In Gremlin-Java and Gremlin-Groovy you get a <code>Map[String, Any]</code>, so you have to cast to the type you <em>think</em> it will be, which is ugly and error prone. For example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span> use :paste in Scala REPL</span>
<span class="pl-k">import</span> <span class="pl-v">gremlin.scala.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">shapeless.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">org.apache.tinkerpop.gremlin.tinkergraph.structure.</span><span class="pl-v">TinkerFactory</span>
<span class="pl-k">import</span> <span class="pl-v">org.apache.tinkerpop.gremlin.tinkergraph.structure.</span><span class="pl-v">TinkerGraph</span>
<span class="pl-k">def</span> <span class="pl-en">g</span> <span class="pl-k">=</span> <span class="pl-en">TinkerFactory</span>.createModern.asScala

<span class="pl-c"><span class="pl-c">//</span> select all labelled steps</span>
g.<span class="pl-en">V</span>(<span class="pl-c1">1</span>).as(<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>)
.outE.as(<span class="pl-s"><span class="pl-pds">"</span>b<span class="pl-pds">"</span></span>)
.select
.toList
<span class="pl-c"><span class="pl-c">//</span> returns a `(Vertex, Edge)` for each path</span>


<span class="pl-c"><span class="pl-c">//</span> select subset of labelled steps</span>
<span class="pl-k">val</span> <span class="pl-en">a</span> <span class="pl-k">=</span> <span class="pl-en">StepLabel</span>[<span class="pl-en">Vertex</span>]()
<span class="pl-k">val</span> <span class="pl-en">b</span> <span class="pl-k">=</span> <span class="pl-en">StepLabel</span>[<span class="pl-en">Edge</span>]()
<span class="pl-k">val</span> <span class="pl-en">c</span> <span class="pl-k">=</span> <span class="pl-en">StepLabel</span>[<span class="pl-k">Double</span>]()

g.<span class="pl-en">V</span>(<span class="pl-c1">1</span>).as(a)
.outE(<span class="pl-s"><span class="pl-pds">"</span>created<span class="pl-pds">"</span></span>).as(b)
.value(<span class="pl-s"><span class="pl-pds">"</span>weight<span class="pl-pds">"</span></span>).as(c)
.select((b, c)) <span class="pl-c"><span class="pl-c">//</span>step labels parsed as tuple of any size</span>
.head
<span class="pl-c"><span class="pl-c">//</span> returns a `(Edge, Double)`</span></pre>
  </div> 
  <p>More working examples in <a href="https://github.com/mpollmeier/gremlin-scala/blob/master/gremlin-scala/src/test/scala/gremlin/scala/SelectSpec.scala" target="_blank">SelectSpec</a>. Kudos to <a href="https://github.com/milessabin/shapeless/" target="_blank">shapeless</a> and Scala's sophisticated type system that made this possible.</p> 
  <h3><a id="user-content-common-and-useful-steps" class="anchor" href="https://github.com/mpollmeier/gremlin-scala#common-and-useful-steps" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Common and useful steps</h3> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span> get a vertex by id</span>
graph.<span class="pl-en">V</span>(<span class="pl-c1">1</span>).headOption

<span class="pl-c"><span class="pl-c">//</span> get all vertices</span>
graph.<span class="pl-en">V</span>.toList

<span class="pl-c"><span class="pl-c">//</span> group all vertices by their label</span>
graph.<span class="pl-en">V</span>.groupBy(_.label)

<span class="pl-c"><span class="pl-c">//</span> group vertices by a property</span>
graph.<span class="pl-en">V</span>.has(<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>).groupBy(_.value[<span class="pl-en">Integer</span>](<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>))

<span class="pl-c"><span class="pl-c">//</span> order by property decreasing</span>
graph.<span class="pl-en">V</span>.has(<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>).orderBy(<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>, <span class="pl-en">Order</span>.decr)</pre>
  </div> 
  <p>More working examples in <a href="https://github.com/mpollmeier/gremlin-scala/blob/master/gremlin-scala/src/test/scala/gremlin/scala/TraversalSpec.scala" target="_blank">TraversalSpec</a>.</p> 
  <h3><a id="user-content-mapping-vertices-fromto-case-classes" class="anchor" href="https://github.com/mpollmeier/gremlin-scala#mapping-vertices-fromto-case-classes" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Mapping vertices from/to case classes</h3> 
  <p>You can save and load case classes as a vertex - implemented with a <a href="http://docs.scala-lang.org/overviews/macros/blackbox-whitebox.html" target="_blank">blackbox macro</a>. You can optionally annotate the id and label of your case class. Scala's <code>Option</code> types will be automatically unwrapped, i.e. a <code>Some[A]</code> will be stored as the value of type <code>A</code> in the database, or <code>null</code> if it's <code>None</code>. If we wouldn't unwrap it, the database would have to understand Scala's Option type itself. The same goes for value classes, i.e. a <code>case class ShoeSize(value: Int) extends AnyVal</code> will be stored as an Integer. Note: your classes must be defined outside the scope where they are being used (e.g. in the code below the class <code>Example</code> cannot be inside <code>object Main</code>).</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span> this does _not_ work in a REPL</span>
<span class="pl-k">@</span>label(<span class="pl-s"><span class="pl-pds">"</span>example<span class="pl-pds">"</span></span>)
<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Example</span>(<span class="pl-k">@</span>id <span class="pl-v">id</span>: <span class="pl-en">Option</span>[<span class="pl-k">Int</span>],
                   <span class="pl-v">longValue</span>: <span class="pl-k">Long</span>,
                   <span class="pl-v">stringValue</span>: <span class="pl-en">Option</span>[<span class="pl-k">String</span>])

<span class="pl-k">object</span> <span class="pl-en">Main</span> {
  <span class="pl-k">import</span> <span class="pl-v">gremlin.scala.</span><span class="pl-v">_</span>
  <span class="pl-k">import</span> <span class="pl-v">org.apache.tinkerpop.gremlin.tinkergraph.structure.</span><span class="pl-v">TinkerGraph</span>

  <span class="pl-k">val</span> <span class="pl-en">graph</span> <span class="pl-k">=</span> <span class="pl-en">TinkerGraph</span>.open.asScala
  <span class="pl-k">val</span> <span class="pl-en">example</span> <span class="pl-k">=</span> <span class="pl-en">Example</span>(<span class="pl-c1">None</span>, <span class="pl-k">Long</span>.<span class="pl-en">MaxValue</span>, <span class="pl-en">Some</span>(<span class="pl-s"><span class="pl-pds">"</span>optional value<span class="pl-pds">"</span></span>))
  <span class="pl-k">val</span> <span class="pl-en">v</span> <span class="pl-k">=</span> graph <span class="pl-k">+</span> example
  v.toCC[<span class="pl-en">Example</span>] <span class="pl-c"><span class="pl-c">//</span> equal to `example`, but with id set</span>

  <span class="pl-c"><span class="pl-c">//</span> find all vertices with the label of the case class `Example`</span>
  graph.<span class="pl-en">V</span>.hasLabel[<span class="pl-en">Example</span>]
  
  <span class="pl-c"><span class="pl-c">//</span> modify the vertex like a case class</span>
  v.updateAs[<span class="pl-en">Example</span>](_.copy(longValue <span class="pl-k">=</span> <span class="pl-c1">0L</span>))
}</pre>
  </div> 
  <p>You can also define your own marshaller, if the macro generated one doesn't quite cut it. For that and more examples check out the <a href="https://github.com/mpollmeier/gremlin-scala/blob/master/gremlin-scala/src/test/scala/gremlin/scala/MarshallableSpec.scala" target="_blank">MarshallableSpec</a>.</p> 
  <h3><a id="user-content-some-more-advanced-traversals" class="anchor" href="https://github.com/mpollmeier/gremlin-scala#some-more-advanced-traversals" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Some more advanced traversals</h3> 
  <p>Here are some examples of more complex traversals from the <a href="https://github.com/mpollmeier/gremlin-scala-examples/" target="_blank">examples repo</a>. If you want to run them yourself, check out the tinkergraph examples in there.</p> 
  <p><em>What is <code>Die Hard's</code> average rating?</em></p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span> use :paste in Scala REPL</span>
graph.<span class="pl-en">V</span>.has(<span class="pl-s"><span class="pl-pds">"</span>movie<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Die Hard<span class="pl-pds">"</span></span>)
  .inE(<span class="pl-s"><span class="pl-pds">"</span>rated<span class="pl-pds">"</span></span>)
  .values(<span class="pl-s"><span class="pl-pds">"</span>stars<span class="pl-pds">"</span></span>)
  .mean
  .head</pre>
  </div> 
  <p><em>Get the maximum number of movies a single user rated</em></p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span> use :paste in Scala REPL</span>
g.<span class="pl-en">V</span>.hasLabel(<span class="pl-s"><span class="pl-pds">"</span>person<span class="pl-pds">"</span></span>)
  .flatMap(_.outE(<span class="pl-s"><span class="pl-pds">"</span>rated<span class="pl-pds">"</span></span>).count)
  .max
  .head</pre>
  </div> 
  <p><em>What 80's action movies do 30-something programmers like?</em> <em>Group count the movies by their name and sort the group count map in decreasing order by value.</em></p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span> use :paste in Scala REPL</span>
g.<span class="pl-en">V</span>
  .`<span class="pl-k">match</span>`(
    __.as(<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>).hasLabel(<span class="pl-s"><span class="pl-pds">"</span>movie<span class="pl-pds">"</span></span>),
    __.as(<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>).out(<span class="pl-s"><span class="pl-pds">"</span>hasGenre<span class="pl-pds">"</span></span>).has(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Action<span class="pl-pds">"</span></span>),
    __.as(<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>).has(<span class="pl-s"><span class="pl-pds">"</span>year<span class="pl-pds">"</span></span>, <span class="pl-en">P</span>.between(<span class="pl-c1">1980</span>, <span class="pl-c1">1990</span>)),
    __.as(<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>).inE(<span class="pl-s"><span class="pl-pds">"</span>rated<span class="pl-pds">"</span></span>).as(<span class="pl-s"><span class="pl-pds">"</span>b<span class="pl-pds">"</span></span>),
    __.as(<span class="pl-s"><span class="pl-pds">"</span>b<span class="pl-pds">"</span></span>).has(<span class="pl-s"><span class="pl-pds">"</span>stars<span class="pl-pds">"</span></span>, <span class="pl-c1">5</span>),
    __.as(<span class="pl-s"><span class="pl-pds">"</span>b<span class="pl-pds">"</span></span>).outV().as(<span class="pl-s"><span class="pl-pds">"</span>c<span class="pl-pds">"</span></span>),
    __.as(<span class="pl-s"><span class="pl-pds">"</span>c<span class="pl-pds">"</span></span>).out(<span class="pl-s"><span class="pl-pds">"</span>hasOccupation<span class="pl-pds">"</span></span>).has(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>programmer<span class="pl-pds">"</span></span>),
    __.as(<span class="pl-s"><span class="pl-pds">"</span>c<span class="pl-pds">"</span></span>).has(<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>, <span class="pl-en">P</span>.between(<span class="pl-c1">30</span>, <span class="pl-c1">40</span>))
  )
  .select[<span class="pl-en">Vertex</span>](<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>)
  .map(_.value[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>))
  .groupCount()
  .order(<span class="pl-en">Scope</span>.local).by(<span class="pl-en">Order</span>.valueDecr)
  .limit(<span class="pl-en">Scope</span>.local, <span class="pl-c1">10</span>)
  .head</pre>
  </div> 
  <p><em>What is the most liked movie in each decade?</em></p> 
  <pre><code>// use :paste in Scala REPL
g.V()
  .hasLabel(Movie)
  .where(_.inE(Rated).count().is(P.gt(10)))
  .groupBy { movie =&gt;
    val year = movie.value2(Year)
    val decade = (year / 10)
    (decade * 10): Integer
  }
  .map { moviesByDecade ⇒
    val highestRatedByDecade = moviesByDecade.mapValues { movies ⇒
      movies.toList
        .sortBy { _.inE(Rated).value(Stars).mean().head }
        .reverse.head //get the movie with the highest mean rating
    }
    highestRatedByDecade.mapValues(_.value2(Name))
  }
  .order(Scope.local).by(Order.keyIncr)
  .head
</code></pre> 
  <h2><a id="user-content-serialise-to-and-from-files" class="anchor" href="https://github.com/mpollmeier/gremlin-scala#serialise-to-and-from-files" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Serialise to and from files</h2> 
  <p>Currently graphML, graphson and gryo/kryo are supported file formats, it is very easy to serialise and deserialise into those: see <a href="https://github.com/mpollmeier/gremlin-scala/blob/master/gremlin-scala/src/test/scala/gremlin/scala/GraphSerialisationSpec.scala" target="_blank">GraphSerialisationSpec</a>. An easy way to visualise your graph is to export it into graphML and import it into (gephi)[<a href="https://gephi.org/" target="_blank">https://gephi.org/</a>].</p> 
  <h2><a id="user-content-help---its-open-source" class="anchor" href="https://github.com/mpollmeier/gremlin-scala#help---its-open-source" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Help - it's open source!</h2> 
  <p>If you would like to help, here's a list of things that needs to be addressed:</p> 
  <ul> 
   <li>add more graph databases and examples into the <a href="https://github.com/mpollmeier/gremlin-scala-examples" target="_blank">examples project</a></li> 
   <li>port over more TP3 steps - see <a href="https://github.com/apache/incubator-tinkerpop/tree/master/gremlin-test/src/main/java/org/apache/tinkerpop/gremlin/process/traversal/step" target="_blank">TP3 testsuite</a> and <a href="https://github.com/mpollmeier/gremlin-scala/blob/master/gremlin-scala/src/test/scala/gremlin/scala/GremlinStandardTestSuite.scala" target="_blank">Gremlin-Scala StandardTests</a></li> 
   <li>ideas for more type safety in traversals</li> 
   <li>fill this readme and provide other documentation, or how-tos, e.g. a blog post or tutorial</li> 
  </ul> 
  <h2><a id="user-content-further-reading" class="anchor" href="https://github.com/mpollmeier/gremlin-scala#further-reading" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Further reading</h2> 
  <p>For more information about Gremlin see the <a href="http://tinkerpop.incubator.apache.org/" target="_blank">Gremlin docs</a> and the <a href="https://groups.google.com/forum/#!forum/gremlin-users" target="_blank">Gremlin users mailinglist</a>. Please note that while Gremlin-Scala is very close to the original Gremlin, there are differences to Gremlin-Groovy - don't be afraid, they hopefully all make sense to a Scala developer ;)</p> 
  <p>Random links:</p> 
  <ul> 
   <li>Social Network using Titan Db: <a href="https://partialflow.wordpress.com/2017/02/26/social-network-using-titan-db-part-1/" target="_blank">part 1</a> and <a href="https://partialflow.wordpress.com/2017/03/04/social-network-using-titan-db-part-2/" target="_blank">part 2</a></li> 
   <li><a href="http://www.michaelpollmeier.com/2014/12/27/gremlin-scala-shortest-path" target="_blank">Shortest path algorithm with Gremlin-Scala 3.0.0 (Michael Pollmeier)</a></li> 
   <li><a href="http://bleibinha.us/blog/2013/10/scala-and-graph-databases-with-gremlin-scala" target="_blank">Shortest path algorithm with Gremlin-Scala 2.4.1 (Stefan Bleibinhaus)</a></li> 
  </ul> 
  <h1><a id="user-content-release-a-new-version" class="anchor" href="https://github.com/mpollmeier/gremlin-scala#release-a-new-version" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Release a new version</h1> 
  <ul> 
   <li>release #will do a release for each crossScalaVersions</li> 
   <li>sonatypeRelease</li> 
  </ul> 
  <h2><a id="user-content-next-steps-upgrade-gremlin-examples" class="anchor" href="https://github.com/mpollmeier/gremlin-scala#next-steps-upgrade-gremlin-examples" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>next steps: upgrade gremlin-examples</h2> 
  <ul> 
   <li>find . -name build.sbt | xargs grep gremlin-scala</li> 
   <li>git grep -l 3.2.3.1 | xargs sed -i 's/3.2.3.1/3.2.4.0/g'</li> 
   <li>bash testAll.sh</li> 
  </ul> 
 </article>
</div>