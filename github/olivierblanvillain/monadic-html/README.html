<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-monadic-html---" class="anchor" href="https://github.com/olivierblanvillain/monadic-html#monadic-html---" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>monadic-html <a href="https://travis-ci.org/OlivierBlanvillain/monadic-html" target="_blank"><img src="https://camo.githubusercontent.com/f29f6560fa5d92423033a8313adb0716b24880a6/68747470733a2f2f7472617669732d63692e6f72672f4f6c6976696572426c616e76696c6c61696e2f6d6f6e616469632d68746d6c2e7376673f6272616e63683d6d6173746572" alt="Travis" data-canonical-src="https://travis-ci.org/OlivierBlanvillain/monadic-html.svg?branch=master" style="max-width:100%;"></a> <a href="https://gitter.im/monadic-html/Lobby" target="_blank"><img src="https://camo.githubusercontent.com/6e2e4ff44c73110343db4979ca470e9cf0ff58a7/68747470733a2f2f6261646765732e6769747465722e696d2f2e737667" alt="Gitter" data-canonical-src="https://badges.gitter.im/.svg" style="max-width:100%;"></a> <a href="https://repo1.maven.org/maven2/in/nvilla/monadic-html_sjs0.6_2.12/" target="_blank"><img src="https://camo.githubusercontent.com/2c1d8b3fc4920cd35fa2830ebdeef7829a74968c/68747470733a2f2f696d672e736869656c64732e696f2f6d6176656e2d63656e7472616c2f762f696e2e6e76696c6c612f6d6f6e616469632d68746d6c5f736a73302e365f322e31322e7376673f6c6162656c3d6d6176656e" alt="Maven" data-canonical-src="https://img.shields.io/maven-central/v/in.nvilla/monadic-html_sjs0.6_2.12.svg?label=maven" style="max-width:100%;"></a></h1> 
  <p><a href="https://github.com/olivierblanvillain/monadic-html/blob/master/project/cats.jpg" target="_blank"><img align="right" src="https://github.com/olivierblanvillain/monadic-html/raw/master/project/cats.jpg" style="max-width:100%;"></a></p> 
  <p>Tiny DOM binding library for Scala.js</p> 
  <p>Main Objectives: friendly syntax for frontend developers (XHTML) and fast compilation speeds (no macros).</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-s"><span class="pl-pds">"</span>in.nvilla<span class="pl-pds">"</span></span> <span class="pl-k">%%%</span> <span class="pl-s"><span class="pl-pds">"</span>monadic-html<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>latest.integration<span class="pl-pds">"</span></span></pre>
  </div> 
  <p>The core value propagation library is also available separately for both platforms as <code>monadic-rx</code>. Integration with <a href="https://github.com/typelevel/cats" target="_blank">cats</a> is optionally available as <code>monadic-rx-cats</code>.</p> 
  <p>This library is inspired by <a href="https://github.com/ThoughtWorksInc/Binding.scala" target="_blank">Binding.scala</a> and <a href="https://github.com/lihaoyi/scala.rx" target="_blank">Scala.rx</a> which both relies on macros to obtain type-safety and hide monadic context from users.</p> 
  <h2><a id="user-content-getting-started" class="anchor" href="https://github.com/olivierblanvillain/monadic-html#getting-started" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Getting Started</h2> 
  <ol> 
   <li>Define <code>Var</code>s to store mutable state</li> 
   <li>Write views in a mix of XHTML and Scala expressions</li> 
   <li>Mount your beauty to the DOM</li> 
   <li>Updating <code>Var</code>s automatically propagates to the views!</li> 
  </ol> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">mhtml.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">scala.xml.</span><span class="pl-v">Node</span>
<span class="pl-k">import</span> <span class="pl-v">org.scalajs.</span><span class="pl-v">dom</span>

<span class="pl-k">val</span> <span class="pl-en">count</span><span class="pl-k">:</span> <span class="pl-en">Var</span>[<span class="pl-k">Int</span>] <span class="pl-k">=</span> <span class="pl-en">Var</span>(<span class="pl-c1">0</span>)

<span class="pl-k">val</span> <span class="pl-en">doge</span><span class="pl-k">:</span> <span class="pl-en">Node</span> <span class="pl-k">=</span>
  &lt;<span class="pl-ent">img</span> <span class="pl-e">style</span>=<span class="pl-s"><span class="pl-pds">"</span>width: 100px;<span class="pl-pds">"</span></span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>http://doge2048.com/meta/doge-600.png<span class="pl-pds">"</span></span>/&gt;

<span class="pl-k">val</span> <span class="pl-en">rxDoges</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-en">Seq</span>[<span class="pl-en">Node</span>]] <span class="pl-k">=</span>
  count.map(i <span class="pl-k">=&gt;</span> <span class="pl-en">Seq</span>.fill(i)(doge))

<span class="pl-k">val</span> <span class="pl-en">component</span> <span class="pl-k">=</span> <span class="pl-c"><span class="pl-c">//</span> ‚Üê look, you can even use fancy names!</span>
  &lt;<span class="pl-ent">div</span>&gt;
    &lt;<span class="pl-ent">button</span> <span class="pl-e">onclick</span>={ () <span class="pl-k">=&gt;</span> count.update(_ <span class="pl-k">+</span> <span class="pl-c1">1</span>) }&gt;<span class="pl-en">Click</span> <span class="pl-en">Me</span><span class="pl-k">!</span>&lt;/<span class="pl-ent">button</span>&gt;
    { count.map(i <span class="pl-k">=&gt;</span> <span class="pl-k">if</span> (i <span class="pl-k">&lt;=</span> <span class="pl-c1">0</span>) &lt;<span class="pl-ent">div</span>&gt;&lt;/<span class="pl-ent">div</span>&gt; <span class="pl-k">else</span> &lt;<span class="pl-ent">h2</span>&gt;<span class="pl-en">WOW</span><span class="pl-k">!!!</span>&lt;/<span class="pl-ent">h2</span>&gt;) }
    { count.map(i <span class="pl-k">=&gt;</span> <span class="pl-k">if</span> (i <span class="pl-k">&lt;=</span> <span class="pl-c1">2</span>) &lt;<span class="pl-ent">div</span>&gt;&lt;/<span class="pl-ent">div</span>&gt; <span class="pl-k">else</span> &lt;<span class="pl-ent">h2</span>&gt;<span class="pl-en">MUCH</span> <span class="pl-en">REACTIVE</span><span class="pl-k">!!!</span>&lt;/<span class="pl-ent">h2</span>&gt;) }
    { count.map(i <span class="pl-k">=&gt;</span> <span class="pl-k">if</span> (i <span class="pl-k">&lt;=</span> <span class="pl-c1">5</span>) &lt;<span class="pl-ent">div</span>&gt;&lt;/<span class="pl-ent">div</span>&gt; <span class="pl-k">else</span> &lt;<span class="pl-ent">h2</span>&gt;<span class="pl-en">SUCH</span> <span class="pl-en">BINDING</span><span class="pl-k">!!!</span>&lt;/<span class="pl-ent">h2</span>&gt;) }
    { rxDoges }
  &lt;/<span class="pl-ent">div</span>&gt;

<span class="pl-k">val</span> <span class="pl-en">div</span> <span class="pl-k">=</span> dom.document.createElement(<span class="pl-s"><span class="pl-pds">"</span>div<span class="pl-pds">"</span></span>)
mount(div, component)</pre>
  </div> 
  <p>For more examples, see our <a href="https://github.com/olivierblanvillain/monadic-html/blob/master/tests/src/test/scala/mhtml/HtmlTests.scala" target="_blank">test suite</a>, <a href="https://github.com/olivierblanvillain/monadic-html/blob/master/example/src/main/scala/mhtml" target="_blank">examples</a> (<a href="https://olivierblanvillain.github.io/monadic-html/examples/" target="_blank">live here</a>) and the <a href="https://github.com/olafurpg/mhtml-todo/" target="_blank">TodoMVC implementation</a>.</p> 
  <h2><a id="user-content-design" class="anchor" href="https://github.com/olivierblanvillain/monadic-html#design" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Design</h2> 
  <p>This library uses two concepts: <code>Rx</code> and <code>Var</code>.</p> 
  <p><strong><code>Rx[A]</code></strong> is a value of type <code>A</code> which can change over time. New reactive values can be constructed with methods like <code>map</code>, <code>flatMap</code> (it's a Monad!), merge (it's a Semigroup!) <a href="https://github.com/olivierblanvillain/monadic-html#frp-ish-apis" target="_blank">and others</a>. In each case, the resulting <code>Rx</code> automatically updates when one of its constituent updates:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">trait</span> <span class="pl-en">Rx</span>[<span class="pl-k">+</span><span class="pl-en">A</span>] {
  <span class="pl-k">def</span> <span class="pl-en">map</span>[<span class="pl-en">B</span>](<span class="pl-v">f</span>: <span class="pl-en">A</span> <span class="pl-k">=&gt;</span> <span class="pl-en">B</span>)<span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-en">B</span>]
  <span class="pl-k">def</span> <span class="pl-en">flatMap</span>[<span class="pl-en">B</span>](<span class="pl-v">f</span>: <span class="pl-en">A</span> <span class="pl-k">=&gt;</span> <span class="pl-en">Rx</span>[<span class="pl-en">B</span>])<span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-en">B</span>]
  <span class="pl-k">def</span> <span class="pl-en">merge</span>(<span class="pl-v">other</span>: <span class="pl-en">Rx</span>[<span class="pl-en">A</span>])<span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-en">A</span>]
  ...
}</pre>
  </div> 
  <p><strong><code>Var[A]</code></strong> extends <code>Rx[A]</code> with two additional methods, <code>:=</code> and <code>update</code>, which lets you update the value contained in the variable <code>Var[A]</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">Var</span>[<span class="pl-en">A</span>](<span class="pl-v">initialValue</span>: <span class="pl-en">A</span>) <span class="pl-k">extends</span> <span class="pl-e">Rx</span>[<span class="pl-en">A</span>] {
  <span class="pl-k">def</span> <span class="pl-en">:</span><span class="pl-k">=</span>(<span class="pl-v">newValue</span>: <span class="pl-en">A</span>)<span class="pl-k">:</span> <span class="pl-k">Unit</span>
  <span class="pl-k">def</span> <span class="pl-en">update</span>(<span class="pl-v">f</span>: <span class="pl-en">A</span> <span class="pl-k">=&gt;</span> <span class="pl-en">A</span>)<span class="pl-k">:</span> <span class="pl-k">Unit</span>
}</pre>
  </div> 
  <p>The central idea is to write HTML views in term of these <code>Rx</code>s and <code>Var</code>s, such updates are automatically propagated from the source <code>Var</code>s all the way to the DOM. This approach, named precise data-binding* by <a href="https://github.com/ThoughtWorksInc/Binding.scala" target="_blank">Binding.scala</a> permits DOM updates to be targeted to portions of the page affected by the change.</p> 
  <p>Let's look at a concrete example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">a</span> <span class="pl-k">=</span> <span class="pl-en">Var</span>(<span class="pl-s"><span class="pl-pds">"</span>id1<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">b</span> <span class="pl-k">=</span> <span class="pl-en">Var</span>(<span class="pl-s"><span class="pl-pds">"</span>foo<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">c</span> <span class="pl-k">=</span> <span class="pl-en">Var</span>(<span class="pl-s"><span class="pl-pds">"</span>bar<span class="pl-pds">"</span></span>)

<span class="pl-k">val</span> <span class="pl-en">view</span> <span class="pl-k">=</span>
  &lt;<span class="pl-ent">div</span> <span class="pl-e">id</span>={a}&gt;
    <span class="pl-en">Variable</span> <span class="pl-c1">1</span><span class="pl-k">:</span> {b}; variable <span class="pl-c1">2</span><span class="pl-k">:</span> {c}.
  &lt;/<span class="pl-ent">div</span>&gt;</pre>
  </div> 
  <p>When mounting this view, <a href="https://github.com/OlivierBlanvillain/monadic-html/blob/master/monadic-html/src/main/scala/mhtml/mount.scala" target="_blank">the implementation</a> will attach callbacks to each <code>Rx</code> such that changing <code>a</code>, <code>b</code> or <code>c</code> results in precise DOM updates:</p> 
  <ul> 
   <li>Changing <code>a</code> will update the <code>div</code> attribute (reusing the same <code>div</code> node)</li> 
   <li>Changing <code>b</code> will delete the text node between <code>Variable 1:</code> and <code>; variable 2:</code>, and insert a new replacement between these two nodes.</li> 
   <li>Changing <code>c</code> will do the same between <code>; variable 2:</code> and <code>.</code>.</li> 
  </ul> 
  <p>These updates correspond to what React is able to compute after running its virtual-DOM diffing algorithm on the entire page. However this approach falls short when working with large immutable data structures. Indeed, creating a large view out of a <code>Rx[List[_]]</code> implies that any changes to the <code>List</code> triggers a re-rendering of the entirety of the view. We plan to address this point in <a href="https://github.com/OlivierBlanvillain/monadic-html/issues/13" target="_blank">#13</a> by combining the current approach with targeted virtual-DOM.</p> 
  <h2><a id="user-content-interacting-with-dom-events" class="anchor" href="https://github.com/olivierblanvillain/monadic-html#interacting-with-dom-events" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Interacting with DOM events</h2> 
  <p>Interactions with DOM events are handled using functions attached directly to xml nodes:</p> 
  <div class="highlight highlight-source-scala">
   <pre>&lt;<span class="pl-ent">button</span> <span class="pl-e">onclick</span>={ () <span class="pl-k">=&gt;</span> println(<span class="pl-s"><span class="pl-pds">"</span>clicked!<span class="pl-pds">"</span></span>) }&gt;<span class="pl-en">Click</span> <span class="pl-en">Me</span><span class="pl-k">!</span>&lt;/<span class="pl-ent">button</span>&gt;</pre>
  </div> 
  <p>Even handlers can also take one argument, which will be populated using raw event objects coming directly from the browser:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">&lt;</span>input type<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>text<span class="pl-pds">"</span></span> onchange<span class="pl-k">=</span>{
  (<span class="pl-v">e</span>: js.<span class="pl-en">Dynamic</span>) <span class="pl-k">=&gt;</span>
    <span class="pl-k">val</span> <span class="pl-en">content</span><span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> e.target.value.<span class="pl-c1">asInstanceOf</span>[<span class="pl-k">String</span>]
    println(s<span class="pl-s"><span class="pl-pds">"</span>Input changed to: $content<span class="pl-pds">"</span></span>)
}<span class="pl-k">/</span><span class="pl-k">&gt;</span></pre>
  </div> 
  <p>The function argument can be anything here, so if you're in a type safe mood feel free to use the types from <a href="http://scala-js.github.io/scala-js-dom/" target="_blank">scala-js-dom</a>:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">&lt;</span>div onkeydown<span class="pl-k">=</span>{
  (<span class="pl-v">e</span>: dom.<span class="pl-en">KeyboardEvent</span>) <span class="pl-k">=&gt;</span>
    <span class="pl-k">val</span> <span class="pl-en">code</span><span class="pl-k">:</span> <span class="pl-k">Int</span> <span class="pl-k">=</span> e.keyCode
    println(s<span class="pl-s"><span class="pl-pds">"</span>You just pressed $code<span class="pl-pds">"</span></span>)
}<span class="pl-k">&gt;</span>&lt;/<span class="pl-ent">div</span>&gt;</pre>
  </div> 
  <p>In some cases you may need to obtain references to the underlying DOM nodes your xml gets interpreted into. For this purpose, we added two new lifecycle hooks to those already available for the DOM:</p> 
  <ul> 
   <li><code>mhtml-onmount</code>: called when adding a node to the DOM</li> 
   <li><code>mhtml-onunmount</code>: called when removing a node from the DOM</li> 
  </ul> 
  <p>In both cases, a reference to the underlying element will be passed in to the event handler, enabling seemingless interoperability with js libraries:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">crazyCanvasStuff</span>(<span class="pl-v">e</span>: dom.html.<span class="pl-en">Canvas</span>)<span class="pl-k">:</span> <span class="pl-k">Unit</span> <span class="pl-k">=</span> ...

&lt;<span class="pl-ent">canvas</span> <span class="pl-e">mhtml-onmount</span>={ e <span class="pl-k">=&gt;</span> crazyCanvasStuff(e) }&gt;&lt;/<span class="pl-ent">canvas</span>&gt;</pre>
  </div> 
  <h2><a id="user-content-frp-ish-apis" class="anchor" href="https://github.com/olivierblanvillain/monadic-html#frp-ish-apis" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>FRP-ish APIs</h2> 
  <p>This section presents the <code>Rx</code> API in its entirety. Let's start with the referentially transparent methods:</p> 
  <ul> 
   <li><p><code>def map[B](f: A =&gt; B): Rx[B]</code></p> <p>Apply a function to ecah elements of this <code>Rx</code>.</p> 
    <div class="highlight highlight-source-scala">
     <pre><span class="pl-k">val</span> <span class="pl-en">numbers</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-k">Int</span>]
<span class="pl-k">val</span> <span class="pl-en">doubles</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-k">Int</span>] <span class="pl-k">=</span> numbers.map(<span class="pl-c1">2</span>.<span class="pl-k">*</span>)
<span class="pl-c"><span class="pl-c">//</span> numbers =&gt; 0 1 4 3 2 ...</span>
<span class="pl-c"><span class="pl-c">//</span> doubles =&gt; 0 2 8 6 4 ...</span></pre>
    </div></li> 
   <li><p><code>def flatMap[B](f: A =&gt; Rx[B]): Rx[B]</code></p> <p>Dynamically switch between different <code>Rx</code>s according to the given function, applied on each element of this <code>Rx</code>. Each switch will cancel the subscriptions for the previous outgoing <code>Rx</code>, and lunch a subscriptions on the next <code>Rx</code>.</p> <p>Together with <code>Rx#map</code> and <code>Rx.apply</code>, flatMap, <code>Rx</code> is a <code>Monad</code>. <a href="https://github.com/OlivierBlanvillain/monadic-html/blob/master/monadic-rx-cats/src/main/scala/mhtml/cats.scala" target="_blank">Proof</a>.</p></li> 
   <li><p><code>def dropRepeats: Rx[A]</code></p> <p>Drop repeated value of this <code>Rx</code>.</p> 
    <div class="highlight highlight-source-scala">
     <pre><span class="pl-k">val</span> <span class="pl-en">numbers</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-k">Int</span>]
<span class="pl-k">val</span> <span class="pl-en">noDups</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-k">Int</span>] <span class="pl-k">=</span> numbers.dropRepeats
<span class="pl-c"><span class="pl-c">//</span> numbers =&gt; 0 0 3 3 5 5 5 4 ...</span>
<span class="pl-c"><span class="pl-c">//</span> noDups  =&gt; 0   3   5     4 ...</span></pre>
    </div></li> 
   <li><p><code>def merge(other: Rx[A]): Rx[A]</code></p> <p>Merge two <code>Rx</code> into one. Updates coming from either of the incoming <code>Rx</code> trigger updates in the outgoing <code>Rx</code>. Upon creation, the outgoing <code>Rx</code> first receives the current value from this <code>Rx</code>, then from the other <code>Rx</code>.</p> 
    <div class="highlight highlight-source-scala">
     <pre><span class="pl-k">val</span> <span class="pl-en">r1</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-k">Int</span>]
<span class="pl-k">val</span> <span class="pl-en">r2</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-k">Int</span>]
<span class="pl-k">val</span> <span class="pl-en">merged</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-k">Int</span>] <span class="pl-k">=</span> r1.merge(r2)
<span class="pl-c"><span class="pl-c">//</span> r1     =&gt; 0 8     3 ...</span>
<span class="pl-c"><span class="pl-c">//</span> r2     =&gt; 1   4 3   ...</span>
<span class="pl-c"><span class="pl-c">//</span> merged =&gt; 0 8 4 3 3 ...</span></pre>
    </div> <p>With this operation, <code>Rx</code> is a <code>Semigroup</code>. <a href="https://github.com/OlivierBlanvillain/monadic-html/blob/master/monadic-rx-cats/src/main/scala/mhtml/cats.scala" target="_blank">Proof</a>.</p></li> 
   <li><p><code>def foldp[B](seed: B)(step: (B, A) =&gt; B): Rx[B]</code></p> <p>Produces a <code>Rx</code> containing cumulative results of applying a binary operator to each element of this <code>Rx</code>, starting from a <code>seed</code> and the current value, and moving forward in time.</p> 
    <div class="highlight highlight-source-scala">
     <pre><span class="pl-k">val</span> <span class="pl-en">numbers</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-k">Int</span>]
<span class="pl-k">val</span> <span class="pl-en">folded</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-k">Int</span>] <span class="pl-k">=</span> numbers.fold(<span class="pl-c1">0</span>)(_ <span class="pl-k">+</span> _)
<span class="pl-c"><span class="pl-c">//</span> numbers =&gt; 1 2 1 1 3 ...</span>
<span class="pl-c"><span class="pl-c">//</span> folded  =&gt; 1 3 4 5 8 ...</span></pre>
    </div></li> 
   <li><p><code>def keepIf(f: A =&gt; Boolean)(a: A): Rx[A]</code></p> <p>Returns a new <code>Rx</code> with updates fulfilling a predicate. If the first update is dropped, the default value is used instead.</p> 
    <div class="highlight highlight-source-scala">
     <pre><span class="pl-k">val</span> <span class="pl-en">numbers</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-k">Int</span>]
<span class="pl-k">val</span> <span class="pl-en">even</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-k">Int</span>] <span class="pl-k">=</span> numbers.keepIf(_ <span class="pl-k">%</span> <span class="pl-c1">2</span> <span class="pl-k">==</span> <span class="pl-c1">0</span>)(<span class="pl-k">-</span><span class="pl-c1">1</span>)
<span class="pl-c"><span class="pl-c">//</span> numbers =&gt; 0 0 3 4 5 6 ...</span>
<span class="pl-c"><span class="pl-c">//</span> even    =&gt; 0 0   4   6 ...</span></pre>
    </div></li> 
   <li><p><code>def dropIf(f: A =&gt; Boolean)(a: A): Rx[A]</code></p> <p>Returns a new <code>Rx</code> without updates fulfilling a predicate. If the first update is dropped, the default value is used instead.</p> 
    <div class="highlight highlight-source-scala">
     <pre> <span class="pl-k">val</span> <span class="pl-en">numbers</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-k">Int</span>]
 <span class="pl-k">val</span> <span class="pl-en">even</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-k">Int</span>] <span class="pl-k">=</span> numbers.dropIf(_ <span class="pl-k">%</span> <span class="pl-c1">2</span> <span class="pl-k">==</span> <span class="pl-c1">0</span>)(<span class="pl-k">-</span><span class="pl-c1">1</span>)
 <span class="pl-c"><span class="pl-c">//</span> numbers =&gt;  0 0 3 4 5 6 ...</span>
 <span class="pl-c"><span class="pl-c">//</span> even    =&gt; -1   3   5   ...</span></pre>
    </div></li> 
   <li><p><code>def sampleOn[B](other: Rx[B]): Rx[A]</code></p> <p>Sample this <code>Rx</code> using another <code>Rx</code>: every time an event occurs on the second <code>Rx</code> the output updates with the latest value of this <code>Rx</code>.</p> 
    <div class="highlight highlight-source-scala">
     <pre> <span class="pl-k">val</span> <span class="pl-en">r1</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-k">Char</span>]
 <span class="pl-k">val</span> <span class="pl-en">r2</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-k">Int</span>]
 <span class="pl-k">val</span> <span class="pl-en">sp</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-k">Int</span>] <span class="pl-k">=</span> r2.sampleOn(r1)
 <span class="pl-c"><span class="pl-c">//</span> r1 =&gt;   u   u   u   u ...</span>
 <span class="pl-c"><span class="pl-c">//</span> r2 =&gt; 1   2 3     4   ...</span>
 <span class="pl-c"><span class="pl-c">//</span> sp =&gt;   1   3   3   4 ...</span></pre>
    </div></li> 
  </ul> 
  <p>In order to observe content of <code>Rx</code> value, we expose two methods in an <code>impure</code> object:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">trait</span> <span class="pl-en">Rx</span>[<span class="pl-k">+</span><span class="pl-en">A</span>] {
  ...
  <span class="pl-k">object</span> <span class="pl-en">impure</span> {
    <span class="pl-k">def</span> <span class="pl-en">foreach</span>(<span class="pl-v">effect</span>: <span class="pl-en">A</span> <span class="pl-k">=&gt;</span> <span class="pl-k">Unit</span>)<span class="pl-k">:</span> <span class="pl-en">Cancelable</span>
    <span class="pl-k">def</span> <span class="pl-en">value</span><span class="pl-k">:</span> <span class="pl-en">A</span>
  }
}</pre>
  </div> 
  <p>These methods can be usefull for testing and debuging, but should ideally be avoided in application code. The <code>foreach</code> is particularly dangerous since omitting to cancel subscriptions opens the door to memory leaks. But I have good news, you don't have to use these! You should be able to do everything you need using the functional, referentially transparent APIs.</p> 
  <h2><a id="user-content-faq" class="anchor" href="https://github.com/olivierblanvillain/monadic-html#faq" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>FAQ</h2> 
  <h4><a id="user-content-does-the-compiler-catch-html-typos" class="anchor" href="https://github.com/olivierblanvillain/monadic-html#does-the-compiler-catch-html-typos" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Does the compiler catch HTML typos?</h4> 
  <p>No, only invalid XML literals will be rejected at compile time. However, we do provide <a href="https://github.com/olivierblanvillain/monadic-html/blob/master/src/main/scala/mhtml/settings.scala" target="_blank">configurable settings</a> to emit runtime warnings about unknown elements, attributes, entity references and event handlers. For example, the following piece of XML compiles fine:</p> 
  <div class="highlight highlight-source-scala">
   <pre>&lt;<span class="pl-ent">captain</span> <span class="pl-e">yolo</span>=<span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span> <span class="pl-e">onClick</span>={ () <span class="pl-k">=&gt;</span> println(<span class="pl-s"><span class="pl-pds">"</span>Oh yeah!<span class="pl-pds">"</span></span>) }&gt;&lt;/<span class="pl-ent">captain</span>&gt;</pre>
  </div> 
  <p>But mounting it to the DOM will print warnings in the console:</p> 
  <pre><code>[mhtml] Warning: Unknown event onClick. Did you mean onclick instead?
[mhtml] Warning: Unknown attribute yolo. Did you mean cols instead?
[mhtml] Warning: Unknown element captain. Did you mean caption instead?
</code></pre> 
  <p><code>MountSettings.default</code> emit warnings only when compiled to with <code>fastOptJS</code>, and becomes silent (and faster) whe compiled with <code>fullOptJS</code>.</p> 
  <h4><a id="user-content-can-i-insert-any-values-into-xml-literals" class="anchor" href="https://github.com/olivierblanvillain/monadic-html#can-i-insert-any-values-into-xml-literals" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Can I insert Any values into xml literals?</h4> 
  <p>No. Monadic-html uses a fork of scala-xml that puts type constraints on what values are allowed in xml element or attribute position.</p> 
  <p>Both attributes and elements:</p> 
  <ul> 
   <li><code>String</code></li> 
   <li><code>mhtml.Var[T], mhtml.Rx[T] where T is itself embeddable</code></li> 
   <li><code>Option[T] where T can itself be embedded (None ‚Üí remove from the DOM)</code></li> 
  </ul> 
  <p>Attributes:</p> 
  <ul> 
   <li><code>Boolean (false ‚Üí remove from the DOM)</code></li> 
   <li><code>() =&gt; Unit, T =&gt; Unit event handler</code></li> 
  </ul> 
  <p>Elements:</p> 
  <ul> 
   <li><code>Int, Long, Double, Float, Char (silently converted with .toString)</code></li> 
   <li><code>xml.Node</code></li> 
   <li><code>Seq[xml.Node]</code></li> 
  </ul> 
  <p>For examples of how each type is rendered into dom nodes, take a look at the <a href="https://github.com/OlivierBlanvillain/monadic-html/blob/master/tests/src/test/scala/mhtml/RenderTests.scala" target="_blank">tests</a>.</p> 
  <h4><a id="user-content-global-mutable-state-booo-booo" class="anchor" href="https://github.com/olivierblanvillain/monadic-html#global-mutable-state-booo-booo" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Global mutable state, Booo! Booo!!!</h4> 
  <p><code>Vars</code> shouldn't be globally accessible. Instead, they should be defined and mutated as locally as possible, and exposed to the outside world as <code>Rxs</code>. In the following example uses the fact that <code>Var[T] &lt;: Rx[T]</code> to hide the fact that <code>fugitive</code> is mutable:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">myCounter</span>()<span class="pl-k">:</span> (xml.<span class="pl-en">Node</span>, <span class="pl-en">Rx</span>[<span class="pl-k">Int</span>]) <span class="pl-k">=</span> {
  <span class="pl-k">val</span> <span class="pl-en">fugitive</span><span class="pl-k">:</span> <span class="pl-en">Var</span>[<span class="pl-k">Int</span>] <span class="pl-k">=</span> <span class="pl-en">Var</span>[<span class="pl-k">Int</span>](<span class="pl-c1">0</span>) <span class="pl-c"><span class="pl-c">//</span> It won't escape it's scope!</span>
  <span class="pl-k">val</span> <span class="pl-en">node</span><span class="pl-k">:</span> xml.<span class="pl-en">Node</span> <span class="pl-k">=</span>
    &lt;<span class="pl-ent">div</span>&gt;
      &lt;<span class="pl-ent">h1</span>&gt;<span class="pl-en">So</span> far, you clicked { fugitive } times.&lt;/<span class="pl-ent">h1</span>&gt;
      &lt;<span class="pl-ent">button</span> <span class="pl-e">onclick</span>={ () <span class="pl-k">=&gt;</span> fugitive.update(<span class="pl-c1">1</span>.<span class="pl-k">+</span>) }&gt;&lt;/<span class="pl-ent">button</span>&gt;
    &lt;/<span class="pl-ent">div</span>&gt;
  (node, fugitive)
}</pre>
  </div> 
  <p>To keep your application manageable, you are advised to use exactly one local <code>Var</code> per signal coming from the outside world. Following the simple rule of "one <code>Var</code>, one <code>:=</code>" leads to clean, simple functional code. To see the difference in action, you can study <a href="https://github.com/OlivierBlanvillain/monadic-html/commit/afb8719897812b8bdd3c649850b9b60a1cd43a17" target="_blank">this commit</a> which rewrites most of <code>SelectList</code> example from imperative to functional style.</p> 
  <h4><a id="user-content-how-can-i-turn-a-listrxa-into-a-rxlista" class="anchor" href="https://github.com/olivierblanvillain/monadic-html#how-can-i-turn-a-listrxa-into-a-rxlista" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>How can I turn a <code>List[Rx[A]]</code> into a <code>Rx[List[A]]</code>?</h4> 
  <p>Short answer:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">implicit</span> <span class="pl-k">class</span> <span class="pl-en">SequencingListFFS</span>[<span class="pl-en">A</span>](<span class="pl-c1">self</span><span class="pl-k">:</span> <span class="pl-en">List</span>[<span class="pl-en">Rx</span>[<span class="pl-en">A</span>]]) {
  <span class="pl-k">def</span> <span class="pl-en">sequence</span><span class="pl-k">:</span> <span class="pl-en">Rx</span>[<span class="pl-en">List</span>[<span class="pl-en">A</span>]] <span class="pl-k">=</span>
    <span class="pl-c1">self</span>.foldRight(<span class="pl-en">Rx</span>(<span class="pl-en">List</span>[<span class="pl-en">A</span>]()))(<span class="pl-k">for</span> {n<span class="pl-k">&lt;</span><span class="pl-k">-</span>_;s<span class="pl-k">&lt;</span><span class="pl-k">-</span>_} <span class="pl-k">yield</span> n<span class="pl-k">+</span><span class="pl-k">:</span>s)
}</pre>
  </div> 
  <p><a href="http://typelevel.org/cats/typeclasses/traverse.html" target="_blank">Long answer:</a></p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-s"><span class="pl-pds">"</span>in.nvilla<span class="pl-pds">"</span></span> <span class="pl-k">%%%</span> <span class="pl-s"><span class="pl-pds">"</span>monadic-rx-cats<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>latest.integration<span class="pl-pds">"</span></span></pre>
  </div> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">cats.implicits.</span><span class="pl-v">_, </span><span class="pl-v">mhtml.implicits.cats.</span><span class="pl-v">_</span></pre>
  </div> 
  <h2><a id="user-content-further-reading" class="anchor" href="https://github.com/olivierblanvillain/monadic-html#further-reading" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Further reading</h2> 
  <p><a href="http://staltz.com/unidirectional-user-interface-architectures.html" target="_blank"><em>Unidirectional User Interface Architectures</em></a> by Andr√© Staltz</p> 
  <p>This blog post presents several existing solution to handle mutable state in user interfaces. It explains the core ideas behind Flux, Redux, Elm &amp; others, and presents a new approach, <em>nested dialogues</em>, which is similar to what you would write in <code>monadic-html</code>.</p> 
  <p><a href="https://www.youtube.com/watch?v=Agu6jipKfYw" target="_blank"><em>Controlling Time and Space: understanding the many formulations of FRP</em></a> by Evan Czaplicki (author of <a href="https://github.com/olivierblanvillain/monadic-html/blob/master/elm-lang.org" target="_blank">Elm</a>)</p> 
  <p>This presentation gives an overview of various formulations of FRP. The talked is focused on how different systems deal with the <code>flatMap</code> operator. When combined with a <code>fold</code> operator, <code>flatMap</code> is problematic: it either leaks memory or break referential transparency. Elm solution is to simply avoid the <code>flatMap</code> operator altogether (programs can exclusively be written in applicative style).</p> 
  <p><a href="https://blogs.janestreet.com/breaking-down-frp/" target="_blank"><em>Breaking down FRP</em></a> by Yaron Minsky</p> 
  <p>Blog post discussing various formulations of reactive programs. The author makes a distinction between Applicative FRP, Monadic FRP, impure Monadic FRP and Self-Adjusting Computations. The takeaway is that history-sensitivity and dynamism are competing goals: each implementations make a different trade offs.</p> 
 </article>
</div>