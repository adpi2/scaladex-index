<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-franz" class="anchor" href="https://github.com/deciphernow/franz#franz" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Franz</h1> 
  <p>A library for working with Kafka via Akka streams.</p> 
  <h2><a id="user-content-usage" class="anchor" href="https://github.com/deciphernow/franz#usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h2> 
  <p>To use Franz within a Maven project add the following dependency:</p> 
  <div class="highlight highlight-text-xml">
   <pre>&lt;<span class="pl-ent">dependency</span>&gt;
    &lt;<span class="pl-ent">groupId</span>&gt;com.deciphernow&lt;/<span class="pl-ent">groupId</span>&gt;
    &lt;<span class="pl-ent">artifactId</span>&gt;franz&lt;/<span class="pl-ent">artifactId</span>&gt;
    &lt;<span class="pl-ent">version</span>&gt;1.0.0&lt;/<span class="pl-ent">version</span>&gt;
&lt;/<span class="pl-ent">dependency</span>&gt;
</pre>
  </div> 
  <p>To use Franz within an SBT project add the following dependency:</p> 
  <pre lang="sbtshell"><code>libraryDependencies += "com.deciphernow" % "franz" % "1.0.0"
</code></pre> 
  <h3><a id="user-content-consuming-from-kafka" class="anchor" href="https://github.com/deciphernow/franz#consuming-from-kafka" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Consuming from Kafka</h3> 
  <p>Franz supports two methods of consuming records from Kafka: fetching and flowing. Fetching provides a means to retrieve a set number of records from Kafka while flowing allows you to continually stream records from Kafka. In most production use cases, you will be flowing from Kafka, but in a limited set of cases (e.g., testing) you simply need to fetch from Kafka. In either case Franz supports ephemeral consumers (i.e. consumers that do not track offsets) and persistent consumers (i.e., consumers that track offsets).</p> 
  <h4><a id="user-content-fetching" class="anchor" href="https://github.com/deciphernow/franz#fetching" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Fetching</h4> 
  <p>The following line demonstrates how to fetch from Kafka:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">Fetching</span>.ephemera(settings, subscription, <span class="pl-c1">10</span>, <span class="pl-en">Duration</span>(<span class="pl-c1">10</span>, <span class="pl-en">SECONDS</span>))</pre>
  </div> 
  <p>The above code will return ten records from Kafka or, if ten records are not available after waiting ten seconds, it will return all available records. To execute the same action but persist the offsets to Kafka so that subsequent calls do not retrieve the same records do the following:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">Fetching</span>.persistent(settings, subscription, <span class="pl-c1">10</span>, <span class="pl-en">Duration</span>(<span class="pl-c1">10</span>, <span class="pl-en">SECONDS</span>))</pre>
  </div> 
  <h4><a id="user-content-flowing" class="anchor" href="https://github.com/deciphernow/franz#flowing" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Flowing</h4> 
  <p>To flow records from Kafka do the following:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">flow</span> <span class="pl-k">=</span> <span class="pl-en">Flow</span>[<span class="pl-en">ConsumerRecord</span>[<span class="pl-en">K</span>, <span class="pl-en">V</span>]].map { record <span class="pl-k">=&gt;</span>
  <span class="pl-c"><span class="pl-c">/*</span> Process the record here <span class="pl-c">*/</span></span>
  <span class="pl-en">Done</span>
}

<span class="pl-k">val</span> <span class="pl-en">future</span> <span class="pl-k">=</span> <span class="pl-en">Flowing</span>.ephemeral(settings, subscription, flow)</pre>
  </div> 
  <p>If you desire to process records in parallel simply modify your flow to something like:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">flow</span> <span class="pl-k">=</span> <span class="pl-en">Flow</span>[<span class="pl-en">ConsumerRecord</span>[<span class="pl-en">K</span>, <span class="pl-en">V</span>]].mapAsync(<span class="pl-c1">10</span>) { record <span class="pl-k">=&gt;</span>
  <span class="pl-en">Future</span> {
    <span class="pl-c"><span class="pl-c">/*</span> Process the record here <span class="pl-c">*/</span></span>
    <span class="pl-en">Done</span>
  }
}</pre>
  </div> 
  <p>This will allow for up to ten records to be processed in parallel.</p> 
  <p>If you need to commit offsets back to Kafka (in most use cases this is required) you should do the following:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">flow</span> <span class="pl-k">=</span> <span class="pl-en">Flow</span>[<span class="pl-en">ConsumerRecord</span>[<span class="pl-en">K</span>, <span class="pl-en">V</span>]].map { record <span class="pl-k">=&gt;</span>
  <span class="pl-c"><span class="pl-c">/*</span> Process the record here <span class="pl-c">*/</span></span>
  <span class="pl-en">Done</span>
}

<span class="pl-k">val</span> <span class="pl-en">future</span> <span class="pl-k">=</span> <span class="pl-en">Flowing</span>.persistent(settings, subscription, flow, <span class="pl-c1">1</span>, <span class="pl-c1">10</span>, <span class="pl-c1">1</span>)</pre>
  </div> 
  <p>The above will process one record at a time with the provided flow, but allows for commits to be batched in groups of up to ten records which are processed in a single thread. You can also process records in parallel but must ensure that the level of parallelism of the provided flow matches the <code>flowParallelism</code> parameter passed to <code>Flowing.persistent</code>. Failure to do so will result in either a blocking flow or buffer overflow.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">flow</span> <span class="pl-k">=</span> <span class="pl-en">Flow</span>[<span class="pl-en">ConsumerRecord</span>[<span class="pl-en">K</span>, <span class="pl-en">V</span>]].mapAsync(<span class="pl-c1">25</span>) { record <span class="pl-k">=&gt;</span>
  <span class="pl-c"><span class="pl-c">/*</span> Process the record here <span class="pl-c">*/</span></span>
  <span class="pl-en">Done</span>
}

<span class="pl-k">val</span> <span class="pl-en">future</span> <span class="pl-k">=</span> <span class="pl-en">Flowing</span>.persistent(settings, subscription, flow, <span class="pl-c1">25</span>, <span class="pl-c1">10</span>, <span class="pl-c1">1</span>)</pre>
  </div> 
  <p>Note that commiting records to Kafka is expensive and allowing for larger batches or more parallelism will speed up your flow. However, larger batches may aslo result in more messages being reprocessed in failure cases.</p> 
  <h1><a id="user-content-contributing" class="anchor" href="https://github.com/deciphernow/franz#contributing" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Contributing</h1> 
  <ol> 
   <li>Fork it</li> 
   <li>Create your feature branch (git checkout -b my-new-feature)</li> 
   <li>Commit your changes (git commit -am 'Add some feature')</li> 
   <li>Push to the branch (git push origin my-new-feature)</li> 
   <li>Create new Pull Request</li> 
  </ol> 
 </article>
</div>