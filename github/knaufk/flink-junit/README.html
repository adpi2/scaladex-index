<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <p><a href="https://travis-ci.org/knaufk/flink-junit" target="_blank"><img src="https://camo.githubusercontent.com/291b2e0a17eb959d88390367fc523db3041a8392/68747470733a2f2f7472617669732d63692e6f72672f6b6e6175666b2f666c696e6b2d6a756e69742e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/knaufk/flink-junit.svg?branch=master" style="max-width:100%;"></a> <a href="https://maven-badges.herokuapp.com/maven-central/cz.jirutka.rsql/rsql-parser" target="_blank"><img src="https://camo.githubusercontent.com/85e0a2f40ad3cf96174dbd1ac666523ed7c12f7b/68747470733a2f2f6d6176656e2d6261646765732e6865726f6b756170702e636f6d2f6d6176656e2d63656e7472616c2f636f6d2e6769746875622e6b6e6175666b2f666c696e6b2d6a756e69745f322e31312f62616467652e737667" alt="Maven Central" data-canonical-src="https://maven-badges.herokuapp.com/maven-central/com.github.knaufk/flink-junit_2.11/badge.svg" style="max-width:100%;"></a></p> 
  <h2><a id="user-content-junit-rule-for-apache-flink" class="anchor" href="https://github.com/knaufk/flink-junit#junit-rule-for-apache-flink" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>JUnit Rule for Apache Flink</h2> 
  <p>This is a small, easy-to-use, but flexible JUnit Rule, which spins up and tears down an Apache Flink cluster for integration tests.</p> 
  <p>It builds upon Flink's <code>TestEnvironment</code> and <code>TestStreamEnvironment</code> and can be used for the <code>DataSet API</code> as well as <code>DataStream API</code>.</p> 
  <h3><a id="user-content-verify" class="anchor" href="https://github.com/knaufk/flink-junit#verify" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Verify</h3> 
  <p><code>./gradlew check</code></p> 
  <h3><a id="user-content-compatability" class="anchor" href="https://github.com/knaufk/flink-junit#compatability" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Compatability</h3> 
  <table> 
   <thead> 
    <tr> 
     <th>Version</th> 
     <th>Flink Version</th> 
     <th>Java Version</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td>0.2</td> 
     <td>1.3.0</td> 
     <td>1.7</td> 
    </tr> 
    <tr> 
     <td>0.1</td> 
     <td>1.2.1</td> 
     <td>1.7</td> 
    </tr>
   </tbody>
  </table> 
  <h3><a id="user-content-dependencies" class="anchor" href="https://github.com/knaufk/flink-junit#dependencies" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Dependencies</h3> 
  <p>Release versions are available on Maven Central. Snapshot versions are available in Sonatype OSS Snapshot Repository.</p> 
  <h5><a id="user-content-gradle-example" class="anchor" href="https://github.com/knaufk/flink-junit#gradle-example" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Gradle Example</h5> 
  <div class="highlight highlight-source-groovy">
   <pre>repositories {
    mavenCentral()
    maven {
        url <span class="pl-s"><span class="pl-pds">"</span>https://oss.sonatype.org/content/repositories/snapshots<span class="pl-pds">"</span></span>
    }
}

dependencies {
    testCompile <span class="pl-s"><span class="pl-pds">'</span>com.github.knaufk:flink-junit_2.10:0.2<span class="pl-pds">'</span></span>
    <span class="pl-c"><span class="pl-c">//</span> or testCompile 'com.github.knaufk:flink-junit_2.11:0.2'</span>
    testCompile <span class="pl-s"><span class="pl-pds">'</span>junit:junit:4.11<span class="pl-pds">'</span></span>
}</pre>
  </div> 
  <h3><a id="user-content-usage" class="anchor" href="https://github.com/knaufk/flink-junit#usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h3> 
  <p>There are two ways to use this rule.</p> 
  <h5><a id="user-content-option-1-flinkjunitrulebuilder" class="anchor" href="https://github.com/knaufk/flink-junit#option-1-flinkjunitrulebuilder" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Option 1: FlinkJunitRuleBuilder</h5> 
  <p>The preferred way to use the <code>FlinkJunitRule</code> is to use the <code>FlinkJUnitRuleBuilder</code>. This way you can easily configure a local Flink cluster with a few lines of code.</p> 
  <div class="highlight highlight-source-java">
   <pre> <span class="pl-k">@ClassRule</span>
 <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-smi">FlinkJUnitRule</span> flinkRule <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">FlinkJUnitRuleBuilder</span>()
                                               .withTaskmanagers(<span class="pl-c1">1</span>)    
                                               .withTaskSlots(<span class="pl-c1">4</span>)
                                               .withWebUiEnabled() <span class="pl-c"><span class="pl-c">//</span> Will use random free port</span>
                                               .withJobManagerHA() <span class="pl-c"><span class="pl-c">//</span> Will spin up local Zookeeper broker (random free port)</span>
                                               .build();

  <span class="pl-k">@Test</span>
  <span class="pl-k">public</span> <span class="pl-k">void</span> testingAStreamingJob() throws <span class="pl-smi">Exception</span> {

    <span class="pl-smi">StreamExecutionEnvironment</span> env <span class="pl-k">=</span> <span class="pl-smi">StreamExecutionEnvironment</span><span class="pl-k">.</span>getExecutionEnvironment();

    <span class="pl-k">DataStream&lt;<span class="pl-smi">Integer</span>&gt;</span> testStream <span class="pl-k">=</span> env<span class="pl-k">.</span>fromElements(<span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>, <span class="pl-c1">4</span>);

    testStream<span class="pl-k">.</span>print();

    env<span class="pl-k">.</span>execute();
  }

  <span class="pl-k">@Test</span>
  <span class="pl-k">public</span> <span class="pl-k">void</span> testingABatchJob() throws <span class="pl-smi">Exception</span> {

    <span class="pl-smi">ExecutionEnvironment</span> env <span class="pl-k">=</span> <span class="pl-smi">ExecutionEnvironment</span><span class="pl-k">.</span>getExecutionEnvironment();

    <span class="pl-k">DataSource&lt;<span class="pl-smi">Integer</span>&gt;</span> testSet <span class="pl-k">=</span> env<span class="pl-k">.</span>fromElements(<span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>, <span class="pl-c1">4</span>);

    testSet<span class="pl-k">.</span>print();
  }
</pre>
  </div> 
  <p>There are reasonable defaults for all options. To get started, you can just use <code>new FlinkJunitBuilder().build()</code>.</p> 
  <h5><a id="user-content-option-2-full--flexibility" class="anchor" href="https://github.com/knaufk/flink-junit#option-2-full--flexibility" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Option 2: Full Flexibility</h5> 
  <p>For full configurability you can also pass the full Flink cluster configuration object to the constructor of the <code>FlinkJunitRule</code> directly. This option exists to give the application developer the full flexbility to adjust the cluster to the specific needs of the test.</p> 
  <div class="highlight highlight-source-java">
   <pre>  <span class="pl-k">private</span> <span class="pl-k">static</span> <span class="pl-smi">Configuration</span> config <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">Configuration</span>();

  <span class="pl-k">static</span> {
    config<span class="pl-k">.</span>setInteger(<span class="pl-smi">ConfigConstants</span><span class="pl-c1"><span class="pl-k">.</span>LOCAL_NUMBER_TASK_MANAGER</span>, <span class="pl-c1">2</span>);
    <span class="pl-c1">...</span>
  }

  <span class="pl-k">@ClassRule</span>
  <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-smi">FlinkJUnitRule</span> flinkRule <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">FlinkJUnitRule</span>(config);</pre>
  </div> 
  <h5><a id="user-content-rule-vs-classrule" class="anchor" href="https://github.com/knaufk/flink-junit#rule-vs-classrule" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>@Rule vs @ClassRule</h5> 
  <p>When using <code>@ClassRule</code> one Flink cluster will be used for all test methods. With <code>@Rule</code> a new Flink cluster will be started and torn down for each test. In most cases <code>@ClassRule</code> should work fine and saves time during test execution as opposed to <code>@Rule</code></p> 
 </article>
</div>