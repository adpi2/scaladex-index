<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-zeromqakka-streams-extension" class="anchor" href="https://github.com/zenaptix/rx_zmq_streams#zeromqakka-streams-extension" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>ZeroMQ/Akka-streams Extension</h1> 
  <p>The zeroMQ guide states: <em>zeroMQ looks like an embeddable networking library but acts like a concurrency framework. It gives you sockets that carry atomic messages across various transports like in-process, inter-process, TCP, and multicast.</em></p> 
  <p>zeroMQ provides a large number of design patterns to accommodate a variety of use cases.</p> 
  <p>This project attepmts to use zeroMQ to provide a reactive bridge between distinct environments, i.e. it provide back-pressure over zeroMQ while also providing a reactive sink and source on either side of the wire. </p> 
  <h2><a id="user-content-dependencies" class="anchor" href="https://github.com/zenaptix/rx_zmq_streams#dependencies" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Dependencies</h2> 
  <p>Dependencies for using rx_zmq_streams in your code: </p> 
  <pre><code>resolvers += "zenaptix at bintray" at "http://dl.bintray.com/zenaptix/rx_zmq_streams"  
libraryDependencies += "com.zenaptix" %% "rx_zmq_streams" % "0.4.0"
</code></pre> 
  <h2><a id="user-content-overview" class="anchor" href="https://github.com/zenaptix/rx_zmq_streams#overview" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Overview</h2> 
  <p>This application is a somewhat heuristic implementation of Reactive Streams utilizing zeroMQ as transport layer<br> It creates a ReactiveZeroMQ Akka Extension that provides a: </p> 
  <ol> 
   <li>pubSink that will transmit its data from an Akka Stream onto zeroMQ</li> 
   <li>subSource that will receive data over zeroMQ and stream it out to a subsequent Akka Stream</li> 
   <li>a Balanced pubSink that load balances the stream from a source to any number of subscribers</li> 
   <li>a Broadcast pubSink that duplicates the stream from a source to any number of subscribers</li> 
   <li><p>the pubSink and subSource are implementing the Reactive Streams protocol and as such allows for a back-pressure on the zeroMQ transmission </p> <p>It uses zeroMQ Pub/Sub socket as the transport for a Reactive Streams implementation with Akka Streams.<br> Akka Streams is an implementation of <a href="http://www.reactive-streams.org/" target="_blank">Reactive Streams</a><br> zeroMQ is a Socket Library disguised as a concurrency framework. "Sockets on steroids"<br> The project depends on either jeromq or jzmq </p> <p>"org.zeromq" % "jzmq" % "3.1.0"<br> "org.zeromq" % "jeromq" % "0.3.5" </p></li> 
  </ol> 
  <h2><a id="user-content-pubsink" class="anchor" href="https://github.com/zenaptix/rx_zmq_streams#pubsink" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>pubSink</h2> 
  <p>A pubSink is acquired from the RxZMQExtension and is used as a sink at the end of a Akka Stream. All the messages will be forwarded over zeroMQ to a subscriber (subSource) </p> 
  <h2><a id="user-content-subsource" class="anchor" href="https://github.com/zenaptix/rx_zmq_streams#subsource" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>subSource</h2> 
  <p>A subSource is acquired from the RxZMQExtension and is used as a source at the start of a Akka Stream. All the messages received from the zeroMQ socket is pushed onto the Akka Stream. </p> 
  <h2><a id="user-content-example" class="anchor" href="https://github.com/zenaptix/rx_zmq_streams#example" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Example</h2> 
  <p>A good place to start is with the RxZMQExtensionSpec. Below is a trivial example running a connected processes.</p> 
  <p>Connecting over zeroMQ </p> 
  <pre><code>import com.zenaptix.reactive.RxZMQExtension

import akka.actor.{Props, ActorSystem}
import akka.stream.ActorFlowMaterializer
import akka.stream.scaladsl.{Sink, Source}
import akka.util.Timeout
import com.typesafe.config.{Config, ConfigFactory}
import com.typesafe.scalalogging.LazyLogging
import zeromq.Message
import scala.concurrent.duration._

class RxZMQExtensionExample {
    implicit val timeout: Timeout = Timeout(5 seconds)
    implicit val materializer = ActorFlowMaterializer()
    val conf = ConfigFactory.load()
    def rxZmq = RxZMQExtension(system)
    val sourcePath = conf.getString("gateway.source_path")
    val file = new File(sourcePath)
// publish the messages from the file
    SynchronousFileSource(file,13).map(b =&gt; {
    println(s"[SOURCE] -&gt; ${b.decodeString("UTF8")}")
    Message(b)
    }).runWith(rxZmq.pubSink())
// receive the messages from the file
    var i = 0
    val subSource = rxZmq.subSource("0.0.0.0:5556")
    subSource.map(
        m =&gt; {
        i += 1
        println(s"[SINK]] &lt;- ${m.part.utf8String}")
    }).runWith(Sink.ignore)
}
</code></pre> 
  <h2><a id="user-content-testing-using-rxzmqextensionspec" class="anchor" href="https://github.com/zenaptix/rx_zmq_streams#testing-using-rxzmqextensionspec" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Testing using RxZMQExtensionSpec</h2> 
  <p>To run the above code - cd to the directory where the project was cloned and execute:</p> 
  <pre><code>    export RX_ZMQ_INSTALL_DIR=`pwd`
    sbt test
    &lt;/pre&gt;
</code></pre> 
  <h2><a id="user-content-testing-using-comzenaptixreactivepublisher-and-reactivesubscriber" class="anchor" href="https://github.com/zenaptix/rx_zmq_streams#testing-using-comzenaptixreactivepublisher-and-reactivesubscriber" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Testing using com.zenaptix.ReactivePublisher and ReactiveSubscriber</h2> 
  <p>The Reactive Publisher</p> 
  <pre><code>package com.zenaptix.reactive

import java.io.File

import akka.actor.ActorSystem
import akka.stream.ActorFlowMaterializer
import akka.stream.io.SynchronousFileSource
import com.typesafe.config.ConfigFactory
import com.typesafe.scalalogging.LazyLogging

object ReactivePublisher extends App with LazyLogging {
  implicit val system = ActorSystem("publisher")
  implicit val materializer = ActorFlowMaterializer()
  lazy val log = system.log
  def rxZmq = RxZMQExtension(system)
  val conf = ConfigFactory.load()
  val sourcePath = conf.getString("gateway.source_path")
  val file = new File(sourcePath)
  SynchronousFileSource(file,13).map(b =&gt; {
    logger.debug(s"[SOURCE] -&gt; ${b.decodeString("UTF8")}")
    Message(b)
  }).runWith(rxZmq.pubSink())
  system.awaitTermination()
 }
</code></pre> 
  <p>Running</p> 
  <pre><code>sbt
&gt; project publisher
&gt; run
</code></pre> 
  <p>The Reactive Subscriber</p> 
  <pre><code>package com.zenaptix.reactive

import akka.actor.ActorSystem
import akka.stream.ActorFlowMaterializer
import akka.stream.scaladsl.Sink
import com.typesafe.config.ConfigFactory
import com.typesafe.scalalogging.LazyLogging

object ReactiveSubscriber extends App with LazyLogging {
  implicit val system = ActorSystem("subscriber")
  implicit val materializer = ActorFlowMaterializer()
  def rxZmq = RxZMQExtension(system)
  val conf = ConfigFactory.load()
  val conn = s"${conf.getString("zeromq.host")}:${conf.getInt("zeromq.port")}")
  rxZmq.subSource(conn).map(m =&gt;
    logger.debug(s"SINK &lt;- ${m.part.decodeString("UTF8")}")).
    runWith(Sink.ignore)
}
</code></pre> 
  <p>Running: </p> 
  <pre><code>sbt
&gt; project subscriber
&gt; run
    &lt;/pre&gt;
</code></pre> 
  <h2><a id="user-content-using-docker" class="anchor" href="https://github.com/zenaptix/rx_zmq_streams#using-docker" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Using Docker</h2> 
  <p>The Publisher </p> 
  <p>On OSX first install and run boot2docker: </p> 
  <pre><code>export RX_ZMQ_INSTALL_DIR=`pwd`
sbt
&gt; project publisher
&gt; docker:publishLocal
&gt; exit
docker run -v $RX_ZMQ_INSTALL_DIR/data:/data -p 5556:5556 -p 5557:5557 \
        -d --name rx_zmq_publisher com.zenaptix/rx_zmq_publisher:v0.4.0
</code></pre> 
  <p>The Subscriber </p> 
  <p>and again:</p> 
  <pre><code>sbt
project subscriber
&gt; docker:publishLocal
&gt; exit
docker run -i -t --name rx_zmq_subscriber com.zenaptix:rx_zmq_subscriber:v0.4.0 -Dzeromq.host=$RXZMQ_PUBLISHER_IP
</code></pre> 
  <p>The Logs then view the publisher log:</p> 
  <pre><code>docker logs rx_zmq_publisher
</code></pre> 
  <h2><a id="user-content-message-exchange" class="anchor" href="https://github.com/zenaptix/rx_zmq_streams#message-exchange" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Message Exchange</h2> 
  <p>rx_zmq_streams is implemented using a Req/Rep channel for exchanging control messages, and a pub/sub channel for receiving the actual data.</p> 
  <p><a href="https://github.com/zenaptix/rx_zmq_streams/blob/master/tutorial/rxzmq.png" target="_blank"><img src="https://github.com/zenaptix/rx_zmq_streams/raw/master/tutorial/rxzmq.png" alt="Image" style="max-width:100%;"></a></p> 
 </article>
</div>