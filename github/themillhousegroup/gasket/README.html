<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a href="https://github.com/themillhousegroup/gasket#gasket" aria-hidden="true" class="anchor" id="user-content-gasket" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>gasket</h1> 
  <p>Wraps the <a href="https://developers.google.com/google-apps/spreadsheets/" target="_blank">Google Spreadsheet API (v3)</a> for simpler consumption from Scala.</p> 
  <p>The Java API as provided by Google is quite tedious to use, requiring a lot of boilerplate method-calling combined with occasional "magic strings" to make it all work properly.</p> 
  <p>The intent of this library is to present a far-simpler view, where each level on the hierarchy of objects (see below) is an appropriate type from <code>scala.collection.immutable</code>, allowing idiomatic operations.</p> 
  <h1><a href="https://github.com/themillhousegroup/gasket#the-gasket-hierarchy" aria-hidden="true" class="anchor" id="user-content-the-gasket-hierarchy" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>The Gasket Hierarchy</h1> 
  <pre><code>   Account
      |
      o
  Spreadsheet
      |
      o
   Worksheet
      |
      o
   [ Row ]
      |
      o
     Cell
</code></pre> 
  <p><code>Row</code>s are an artificial collection representing some-or-all of the <code>Cell</code>s on one row.</p> 
  <h1><a href="https://github.com/themillhousegroup/gasket#what-could-i-use-this-for" aria-hidden="true" class="anchor" id="user-content-what-could-i-use-this-for" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>What Could I Use This For?</h1> 
  <p>The sky's the limit, and if you're here, you probably already have an application in mind. But a few other ideas:</p> 
  <ul> 
   <li>Use a Google Spreadsheet as a source of app configuration data</li> 
   <li>Crunch spreadsheet numbers using the power of Scala</li> 
   <li>A straightforward and user-friendly way to feed tabular data into an application</li> 
  </ul> 
  <h1><a href="https://github.com/themillhousegroup/gasket#installation" aria-hidden="true" class="anchor" id="user-content-installation" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Installation</h1> 
  <p>Gasket is built for both Scala 2.10 and 2.11. Bring in the library by adding the following to your <code>build.sbt</code>.</p> 
  <ul> 
   <li>The release repository:</li> 
  </ul> 
  <pre><code>   resolvers ++= Seq(
     "Millhouse Bintray"  at "http://dl.bintray.com/themillhousegroup/maven"
   )
</code></pre> 
  <ul> 
   <li>The dependency itself:</li> 
  </ul> 
  <pre><code>   libraryDependencies ++= Seq(
     "com.themillhousegroup" %% "gasket" % "2.0.90"
   )

</code></pre> 
  <h1><a href="https://github.com/themillhousegroup/gasket#granting-access-to-your-app" aria-hidden="true" class="anchor" id="user-content-granting-access-to-your-app" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Granting Access to your app</h1> 
  <p>Since May 2015, Google requires OAuth 2.0 authentication to access spreadsheets shared from Google Drive. As a result, Gasket 2.x has a changed <code>Account</code> API entry point, requiring a <code>clientID</code> string and <code>.p12</code> file to gain access. Here's how to get these:</p> 
  <ul> 
   <li>Register at [<a href="https://console.developers.google.com" target="_blank">https://console.developers.google.com</a>]</li> 
   <li>Create a new project for your project that is using Gasket</li> 
   <li>Under APIs &amp; Auth -&gt; Credential -&gt; Create New Client ID for Service Account</li> 
   <li>When the Client ID is generated, also generate a P12 key, and download that to somewhere local</li> 
  </ul> 
  <p>You now have all the credentials you need - here's where they go:</p> 
  <ul> 
   <li>The first parameter to the <code>Account</code> constructor is the Service Account <strong>email address</strong> - it probably looks like <code>10788-xyz-123@developer.gserviceaccount.com</code></li> 
   <li>The <code>.p12</code> file should be loaded into your project and passed to the <code>Account</code> constructor as a <code>java.io.File</code> handle</li> 
   <li>In Google Drive, share your target spreadsheet with the Service Account <strong>email address</strong></li> 
  </ul> 
  <p>(For more info, check out this <a href="http://stackoverflow.com/questions/30483601/create-spreadsheet-using-google-spreadsheet-api-in-google-drive-in-java#30533517" target="_blank">Stack Overflow Answer</a>)</p> 
  <h1><a href="https://github.com/themillhousegroup/gasket#implementation" aria-hidden="true" class="anchor" id="user-content-implementation" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Implementation</h1> 
  <p>Because many of the API calls can take hundreds of milliseconds to complete, the Gasket API is non-blocking, returning <code>Future</code>s from all methods. This lends itself quite naturally to working in <code>for</code>-comprehension-style, as shown in the examples below. The way into the API is via the <code>Account</code> companion object, and the most useful class is probably <code>Worksheet</code>, where the contents of a worksheet can be sliced-and-diced. All Gasket objects are immutable, but some offer an update method which will return a future version of itself after updating the remote spreadsheet.</p> 
  <h1><a href="https://github.com/themillhousegroup/gasket#examples" aria-hidden="true" class="anchor" id="user-content-examples" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Examples</h1> 
  <p>(Taken from the <a href="https://github.com/themillhousegroup/gasket/blob/master/src/test/scala/com/themillhousegroup/gasket/integration/ForComprehensionSpec.scala" target="_blank">ForComprehensionSpec</a> which contains several more examples):</p> 
  <h4><a href="https://github.com/themillhousegroup/gasket#getting-the-content-of-all-the-cells-in-a-worksheet-as-a-futureseqstring" aria-hidden="true" class="anchor" id="user-content-getting-the-content-of-all-the-cells-in-a-worksheet-as-a-futureseqstring" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Getting the content of all the cells in a worksheet as a <code>Future[Seq[String]]</code>:</h4> 
  <pre><code>    val futureCellContents =
        for {
          acct      &lt;- Account(clientId, p12File)
          ss        &lt;- acct.spreadsheets
          ws        &lt;- ss("Example Spreadsheet").worksheets
          cells     &lt;- ws("Sheet1").cells
          contents  = cells.map(_.value)
        } yield contents
</code></pre> 
  <h4><a href="https://github.com/themillhousegroup/gasket#getting-a-rectangular-block-of-cells-in-a-worksheet-as-a-futureseqrow" aria-hidden="true" class="anchor" id="user-content-getting-a-rectangular-block-of-cells-in-a-worksheet-as-a-futureseqrow" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Getting a rectangular block of cells in a worksheet as a <code>Future[Seq[Row]]</code>:</h4> 
  <pre><code>   val futureRows =
     for {
       acct &lt;- Account(clientId, p12File)
       ss &lt;- acct.spreadsheets
       ws &lt;- ss("Example Spreadsheet").worksheets
       rows &lt;- ws("Sheet1").block(1 to 2, 2 to 3)
     } yield rows
</code></pre> 
  <p>This sequence of commands, if applied to a source worksheet that looks like this:</p> 
  <pre><code>   1  2  3
   4  5  6
   7  8  9
</code></pre> 
  <p>Will return 2 <code>Row</code> objects:</p> 
  <p>Row: <code>2 3</code> Row: <code>5 6</code></p> 
  <h4><a href="https://github.com/themillhousegroup/gasket#pushing-individual-values-back-into-the-google-spreadsheet" aria-hidden="true" class="anchor" id="user-content-pushing-individual-values-back-into-the-google-spreadsheet" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Pushing individual values back into the Google Spreadsheet</h4> 
  <p>Although <code>Cell</code> is immutable, it has an <code>update</code> method with the following signature:</p> 
  <p><code>def update(newValue: String): Future[Cell]</code></p> 
  <p>That is, it performs the API call to update the remote spreadsheet, and returns a future version of the Cell with the desired value within. Because it's returning a <code>Future</code>, you can even make it a part of a for-comprehension - here's an example where the first cell with value "0" is changed to have value "EMPTY":</p> 
  <pre><code>   for {
     acct &lt;- Account(clientId, p12File)
     ss &lt;- acct.spreadsheets
     ws &lt;- ss("Example Spreadsheet").worksheets
     cells &lt;- ws("Sheet3").cells
     newCell &lt;- cells.filter(_.value == "0").head.update("EMPTY"")
   } yield newCell
</code></pre> 
  <h4><a href="https://github.com/themillhousegroup/gasket#adding-a-row-to-a-worksheet" aria-hidden="true" class="anchor" id="user-content-adding-a-row-to-a-worksheet" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Adding a row to a Worksheet</h4> 
  <p>Again although <code>Worksheet</code> is immutable by design, it has an <code>addRows</code> method with the following signature:</p> 
  <p><code>def addRows(newRows: Seq[Seq[(String, String)]]): Future[Worksheet]</code></p> 
  <p>The argument to this method is a sequence of rows, where a row is a sequence of <code>(columnHeaderName -&gt; cellValue)</code> tuples. The new data is "played in" to the remote API, and then a new fresh <code>Worksheet</code> containing the new rows at the bottom is returned in the <code>Future</code>.</p> 
  <h1><a href="https://github.com/themillhousegroup/gasket#still-to-come" aria-hidden="true" class="anchor" id="user-content-still-to-come" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Still To Come</h1> 
  <ul> 
   <li>More updating methods</li> 
   <li>A Scala-idiomatic way of performing batched operations</li> 
   <li>More performance</li> 
  </ul> 
  <h1><a href="https://github.com/themillhousegroup/gasket#troubleshooting" aria-hidden="true" class="anchor" id="user-content-troubleshooting" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Troubleshooting</h1> 
  <p>If you see a <code>TokenResponseException: 400 Bad Request</code> containing the JSON:</p> 
  <pre><code>  	{ "error" : "invalid_grant" }  
</code></pre> 
  <p>then you've supplied the wrong identifier as the first parameter to <code>Account</code>. It needs to be the "email address" as listed at <a href="https://console.developers.google.com/project/%5BYOUR_PROJECT%5D/apiui/credential" target="_blank">https://console.developers.google.com/project/[YOUR_PROJECT]/apiui/credential</a>.</p> 
 </article>
</div>