<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-retry" class="anchor" href="https://github.com/softprops/retry#retry" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>retry</h1> 
  <p><a href="https://travis-ci.org/softprops/retry" target="_blank"><img src="https://camo.githubusercontent.com/e65bda93b670d345df9f632295bd7ee3df8cd860/68747470733a2f2f7472617669732d63692e6f72672f736f667470726f70732f72657472792e706e673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/softprops/retry.png?branch=master" style="max-width:100%;"></a></p> 
  <p>don't give up</p> 
  <h2><a id="user-content-install" class="anchor" href="https://github.com/softprops/retry#install" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>install</h2> 
  <p>With sbt, add the following to your project's build.sbt</p> 
  <div class="highlight highlight-source-scala">
   <pre>resolvers <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>softprops-maven<span class="pl-pds">"</span></span> at <span class="pl-s"><span class="pl-pds">"</span>http://dl.bintray.com/content/softprops/maven<span class="pl-pds">"</span></span>

libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>me.lessis<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>retry<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.2.0<span class="pl-pds">"</span></span></pre>
  </div> 
  <h2><a id="user-content-usage" class="anchor" href="https://github.com/softprops/retry#usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>usage</h2> 
  <p>Applications fail. Network connections drop. Connections timeout. Bad things happen.</p> 
  <p>Failure to address this will cause other bad things to happen. Effort is the measurement of how hard you try.</p> 
  <p>You can give your application perseverance with retry.</p> 
  <p>Retry provides interfaces for common retry strategies that operate on Scala <a href="http://www.scala-lang.org/api/current/index.html#scala.concurrent.Future" target="_blank">Futures</a>.</p> 
  <p>Basic usage requires three things</p> 
  <ul> 
   <li>an implicit execution context for executing futures</li> 
   <li>a definition of <a href="https://github.com/softprops/retry#defining-success" target="_blank">Success</a> encode what "success" means for the type of your future</li> 
   <li>a block of code that results in a Scala <a href="http://www.scala-lang.org/api/current/index.html#scala.concurrent.Future" target="_blank">Future</a>.</li> 
  </ul> 
  <p>Depending on your strategy for retrying a future you may also need an <a href="https://github.com/softprops/odelay#timers" target="_blank">odelay.Timer</a> for asynchronously scheduling followup attempts</p> 
  <p>Retry provides a set of defaults that provide <code>retry.Success</code> definitions for <a href="http://www.scala-lang.org/api/current/index.html#scala.Option" target="_blank">Option</a>, <a href="http://www.scala-lang.org/api/current/index.html#scala.util.Either" target="_blank">Either</a>, <a href="http://www.scala-lang.org/api/current/index.html#scala.util.Try" target="_blank">Try</a>, and a partial function (defined with Success.definedAt(partialFunction)) out of the box.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">scala.concurrent.ExecutionContext.Implicits.</span><span class="pl-v">global</span>
<span class="pl-k">import</span> <span class="pl-v">scala.concurrent.</span><span class="pl-v">Future</span>

retry.<span class="pl-en">Backoff</span>()(() <span class="pl-k">=&gt;</span> <span class="pl-en">Future</span> {
  <span class="pl-c"><span class="pl-c">//</span> something that can "fail"</span>
})</pre>
  </div> 
  <h3><a id="user-content-defining-success" class="anchor" href="https://github.com/softprops/retry#defining-success" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Defining success</h3> 
  <p>Retry needs to know what <em>success</em> means in the context of your Future in order to know when to retry an operation.</p> 
  <p>It does this through a generic <code>Success[-T](pred: T =&gt; Boolean)</code> type class, where <code>T</code> matches the type your <a href="http://www.scala-lang.org/api/current/index.html#scala.concurrent.Future" target="_blank">Future</a> will resolve to.</p> 
  <p>Retry looks for this definition within implicit scope of the retry.</p> 
  <p>You may wish define an application-specific definition of what "success" means for your future. You can do so by specifying the following in scope of the retry.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">perfectTen</span> <span class="pl-k">=</span> <span class="pl-en">Success</span>[<span class="pl-k">Int</span>](_ <span class="pl-k">==</span> <span class="pl-c1">10</span>)</pre>
  </div> 
  <p>If your future completes with anything other than 10, it will be considered a failure and will be retried. Here's to you, tiger mom!</p> 
  <p>Success values may also be composed with <code>and</code> and <code>or</code> semantics</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span> will be considered a success when the preconditions of both successA and successB are met</span>
<span class="pl-k">val</span> <span class="pl-en">successC</span> <span class="pl-k">=</span> successA.and(successB)

<span class="pl-c"><span class="pl-c">//</span> will be considered a success when the predconditions of either successC or successD are met</span>
<span class="pl-k">val</span> <span class="pl-en">successE</span> <span class="pl-k">=</span> successC.or(successD)</pre>
  </div> 
  <h3><a id="user-content-sleep-schedules" class="anchor" href="https://github.com/softprops/retry#sleep-schedules" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Sleep schedules</h3> 
  <p>Rather than blocking a thread, retry attempts are scheduled using Timers. Your application may run within a platform that provides its own way for scheduling tasks. If an <a href="https://github.com/softprops/odelay#jdktimer" target="_blank">odelay.jdk.JdkTimer</a> isn't what you're looking for, you may wish to use the <code>odelay.Timer</code> for netty, <a href="https://github.com/softprops/odelay#netty3timers" target="_blank">odelay.netty.Timer</a> in the <code>odelay-netty</code> module or an <a href="https://github.com/softprops/odelay#twittertimers" target="_blank">odelay.twitter.TwitterTimer</a> available in the <code>odelay-twitter</code> module.</p> 
  <p>See the <a href="https://github.com/softprops/odelay#readme" target="_blank">odelay docs</a> for defining your own timer. If none of these aren't what you're looking for, please open a pull request!</p> 
  <h3><a id="user-content-according-to-policy" class="anchor" href="https://github.com/softprops/retry#according-to-policy" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>According to Policy</h3> 
  <p>Retry logic is implemented in modules whose behavior vary but all produce a common interface: a <code>retry.Policy</code>.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">trait</span> <span class="pl-en">Policy</span> {
  <span class="pl-k">def</span> <span class="pl-en">apply</span>[<span class="pl-en">T</span>](<span class="pl-v">promise</span>: () <span class="pl-k">=&gt;</span> <span class="pl-en">Future</span>[<span class="pl-en">T</span>])
     (<span class="pl-k">implicit</span> <span class="pl-v">success</span>: <span class="pl-en">Success</span>[<span class="pl-en">T</span>],
      <span class="pl-v">executor</span>: <span class="pl-en">ExecutionContext</span>)<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">T</span>]
}</pre>
  </div> 
  <h4><a id="user-content-directly" class="anchor" href="https://github.com/softprops/retry#directly" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Directly</h4> 
  <p>The <code>retry.Directly</code> module defines interfaces for retrying a future directly after a failed attempt.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span> retry 4 times</span>
<span class="pl-k">val</span> <span class="pl-en">future</span> <span class="pl-k">=</span> retry.<span class="pl-en">Directly</span>(<span class="pl-c1">4</span>) { () <span class="pl-k">=&gt;</span>
  attempt
}</pre>
  </div> 
  <h4><a id="user-content-pause" class="anchor" href="https://github.com/softprops/retry#pause" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Pause</h4> 
  <p>The <code>retry.Pause</code> module defines interfaces for retrying a future with a configurable pause in between attempts</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span> retry 3 times pausing 30 seconds in between attempts</span>
<span class="pl-k">val</span> <span class="pl-en">future</span> <span class="pl-k">=</span> retry.<span class="pl-en">Pause</span>(<span class="pl-c1">3</span>, <span class="pl-c1">30.</span>seconds) { () <span class="pl-k">=&gt;</span>
  attempt
}</pre>
  </div> 
  <h4><a id="user-content-backoff" class="anchor" href="https://github.com/softprops/retry#backoff" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Backoff</h4> 
  <p>The <code>retry.Backoff</code> modules defines interfaces for retrying a future with a configureable pause and exponential backoff factor.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span> retry 4 times with a delay of 1 second which will be multipled</span>
<span class="pl-c"><span class="pl-c">//</span> by 2 on every attempt</span>
<span class="pl-k">val</span> <span class="pl-en">future</span> <span class="pl-k">=</span> retry.<span class="pl-en">Backoff</span>(<span class="pl-c1">4</span>, <span class="pl-c1">1.</span>second) { () <span class="pl-k">=&gt;</span>
  attempt
}</pre>
  </div> 
  <h4><a id="user-content-when" class="anchor" href="https://github.com/softprops/retry#when" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>When</h4> 
  <p>All of the retry strategies above assume you are representing failure in your Future's result type. In cases where the result of your future is "exceptional". You can use the When module which takes a PartialFunction of Any to Policy.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">policy</span> <span class="pl-k">=</span> retry.<span class="pl-en">When</span> {
  <span class="pl-k">case</span> <span class="pl-en">NonFatal</span>(e) <span class="pl-k">=&gt;</span> retry.<span class="pl-en">Pause</span>(<span class="pl-c1">1.</span>second)
}

policy(execptionalAttempt)</pre>
  </div> 
  <p>Note, The domain of the PartialFunction passed to When may cover both the exception thrown <em>or</em> the successful result of the future.</p> 
  <h4><a id="user-content-suggested-library-usage" class="anchor" href="https://github.com/softprops/retry#suggested-library-usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Suggested library usage</h4> 
  <p>Since all retry modules now produce a generic interface, a <code>retry.Policy</code>, if you wish to write clients of services you may wish to make define a Success for the type of that service and capture an configurable reference to a Policy so that clients may swap policies based on use case.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Client</span>(<span class="pl-v">retryPolicy</span>: retry.<span class="pl-en">Policy</span> <span class="pl-k">=</span> retry.<span class="pl-en">Directly</span>()) {
  <span class="pl-k">def</span> <span class="pl-en">request</span> <span class="pl-k">=</span> retryPolicy(mkRequest)
}

<span class="pl-k">val</span> <span class="pl-en">defaultClient</span> <span class="pl-k">=</span> <span class="pl-en">Client</span>()

<span class="pl-k">val</span> <span class="pl-en">customClient</span> <span class="pl-k">=</span> defaultClient.copy(
  retryPolicy <span class="pl-k">=</span> retry.<span class="pl-en">Backoff</span>()
)</pre>
  </div> 
  <p>Doug Tangren (softprops) 2013-2014</p> 
 </article>
</div>