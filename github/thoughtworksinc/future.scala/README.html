<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-futurescala-" class="anchor" href="https://github.com/thoughtworksinc/future.scala#futurescala-" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>future.scala <a href="http://thoughtworks.com/" target="_blank"><img align="right" src="https://camo.githubusercontent.com/4e8bb83ad97ee6b683cb5529d8c5489e4927855a/68747470733a2f2f7777772e74686f75676874776f726b732e636f6d2f696d67732f74772d6c6f676f2e706e67" alt="ThoughtWorks" height="15" data-canonical-src="https://www.thoughtworks.com/imgs/tw-logo.png" style="max-width:100%;"></a></h1> 
  <p><a href="https://gitter.im/ThoughtWorksInc/future.scala?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge" target="_blank"><img src="https://camo.githubusercontent.com/1aa5b0d07ecf2eab7c2ede3632a2af905e8bff6d/68747470733a2f2f6261646765732e6769747465722e696d2f54686f75676874576f726b73496e632f6675747572652e7363616c612e737667" alt="Join the chat at https://gitter.im/ThoughtWorksInc/future.scala" data-canonical-src="https://badges.gitter.im/ThoughtWorksInc/future.scala.svg" style="max-width:100%;"></a> <a href="https://travis-ci.org/ThoughtWorksInc/future.scala" target="_blank"><img src="https://camo.githubusercontent.com/d0a7effb30396a0503f3f3a430d38e98c6255ac4/68747470733a2f2f7472617669732d63692e6f72672f54686f75676874576f726b73496e632f6675747572652e7363616c612e7376673f6272616e63683d312e302e78" alt="Build Status" data-canonical-src="https://travis-ci.org/ThoughtWorksInc/future.scala.svg?branch=1.0.x" style="max-width:100%;"></a> <a href="https://index.scala-lang.org/thoughtworksinc/future.scala/future" target="_blank"><img src="https://camo.githubusercontent.com/a05ed792bbebf03194d711cbb1756bf19e8d48ac/68747470733a2f2f696e6465782e7363616c612d6c616e672e6f72672f74686f75676874776f726b73696e632f6675747572652e7363616c612f6675747572652f6c61746573742e737667" alt="Latest version" data-canonical-src="https://index.scala-lang.org/thoughtworksinc/future.scala/future/latest.svg" style="max-width:100%;"></a> <a href="https://javadoc.io/page/com.thoughtworks.future/future_2.11/latest/com/thoughtworks/future$$Future.html" target="_blank"><img src="https://camo.githubusercontent.com/61ed8349ab1b90d441c1d212d0efa4a344ae1fc6/68747470733a2f2f6a617661646f632e696f2f62616467652f636f6d2e74686f75676874776f726b732e6675747572652f6675747572655f322e31312e7376673f6c6162656c3d7363616c61646f63" alt="Scaladoc" data-canonical-src="https://javadoc.io/badge/com.thoughtworks.future/future_2.11.svg?label=scaladoc" style="max-width:100%;"></a></p> 
  <p><strong>future.scala</strong> is the spiritual successor to <a href="https://github.com/qifun/stateless-future" target="_blank">Stateless Future</a> for stack-safe asynchronous programming in pure functional flavor. We dropped the Stateless Future's built-in <code>async</code>/<code>await</code> support, in favor of more general <code>monadic</code>/<code>each</code> syntax provided by <a href="https://github.com/ThoughtWorksInc/each" target="_blank">ThoughtWorks Each</a>.</p> 
  <p>future.scala provide an API similar to <code>scala.concurrent.Future</code> or <code>scalaz.concurrent.Task</code>, except future.scala does not throw the <code>StackOverflowError</code>.</p> 
  <h2><a id="user-content-design" class="anchor" href="https://github.com/thoughtworksinc/future.scala#design" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Design</h2> 
  <p>future.scala inherits many design decision from Stateless Future.</p> 
  <table> 
   <thead> 
    <tr> 
     <td></td> 
     <th><code>com.thoughtworks.future.Future</code></th> 
     <th><code>scalaz.concurrent.Task</code></th> 
     <th><code>scala.concurrent.Future</code></th> 
    </tr> 
    <tr> 
     <th>Stateless</th> 
     <td>Yes</td> 
     <td>Yes</td> 
     <td>No</td> 
    </tr> 
    <tr> 
     <th>Threading-free</th> 
     <td>Yes</td> 
     <td>Yes</td> 
     <td>No</td> 
    </tr> 
    <tr> 
     <th>Exception Handling</th> 
     <td>Yes</td> 
     <td>Yes</td> 
     <td>Yes</td> 
    </tr> 
    <tr> 
     <th>Support covariance</th> 
     <td>Yes</td> 
     <td>No</td> 
     <td>Yes</td> 
    </tr> 
    <tr> 
     <th>Stack-safe</th> 
     <td>Yes</td> 
     <td>No</td> 
     <td>No</td> 
    </tr> 
    <tr> 
     <th>Support JVM</th> 
     <td>Yes</td> 
     <td>Yes</td> 
     <td>Yes</td> 
    </tr> 
    <tr> 
     <th>Support Scala.js</th> 
     <td>Yes</td> 
     <td>No</td> 
     <td>Yes</td> 
    </tr> 
   </thead> 
  </table> 
  <h3><a id="user-content-statelessness" class="anchor" href="https://github.com/thoughtworksinc/future.scala#statelessness" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Statelessness</h3> 
  <p>future.scala are pure functional, thus they will never store result values or exceptions. Instead, future.scala evaluate lazily, and they do the same job every time you invoke <code>onComplete</code>.</p> 
  <p>Also, there is no <code>isComplete</code> method in future.scala. As a result, the users of future.scala are forced not to share futures between threads, not to check the states in futures. They have to care about control flows instead of threads, and build the control flows by defining future.scala.</p> 
  <h3><a id="user-content-threading-free-model" class="anchor" href="https://github.com/thoughtworksinc/future.scala#threading-free-model" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Threading-free Model</h3> 
  <p>There are too many threading models and implimentations in the Java/Scala world, <code>java.util.concurrent.Executor</code>, <code>scala.concurrent.ExecutionContext</code>, <code>javax.swing.SwingUtilities.invokeLater</code>, <code>java.util.Timer</code>, ... It is very hard to communicate between threading models. When a developer is working with multiple threading models, he must very carefully pass messages between threading models, or he have to maintain bulks of <code>synchronized</code> methods to properly deal with the shared variables between threads.</p> 
  <p>Why does he need multiple threading models? Because the libraries that he uses depend on different threading modes. For example, you must update Swing components in the Swing's UI thread, you must specify <code>java.util.concurrent.ExecutionService</code>s for <code>java.nio.channels.CompletionHandler</code>, and, you must specify <code>scala.concurrent.ExecutionContext</code>s for <code>scala.concurrent.Future</code> and <code>scala.async.Async</code>. Oops!</p> 
  <p>Think about somebody who uses Swing to develop a text editor software. He wants to create a state machine to update UI. He have heard the cool <code>scala.async</code>, then he uses the cool "A-Normal Form" expression in <code>async</code> to build the state machine that updates UI, and he types <code>import scala.concurrent.ExecutionContext.Implicits._</code> to suppress the compiler errors. Everything looks pretty, except the software always crashes.</p> 
  <p>Fortunately, future.scala depends on none of these threading model, and cooperates with all of these threading models. If the poor guy tries future.scala, replacing <code>async { }</code> to <code>monadic[Future] { }</code>, deleting the <code>import scala.concurrent.ExecutionContext.Implicits._</code>, he will find that everything looks pretty like before, and does not crash any more. That's why threading-free model is important.</p> 
  <h3><a id="user-content-exception-handling" class="anchor" href="https://github.com/thoughtworksinc/future.scala#exception-handling" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Exception Handling</h3> 
  <p>There were two <code>Future</code> implementations in Scala standard library, <code>scala.actors.Future</code> and <code>scala.concurrent.Future</code>. <code>scala.actors.Future</code>s are not designed to handling exceptions, since exceptions are always handled by actors. There is no way to handle a particular exception in a particular subrange of an actor.</p> 
  <p>Unlike <code>scala.actors.Future</code>s, <code>scala.concurrent.Future</code>s are designed to handle exceptions. Unfortunately, <code>scala.concurrent.Future</code>s provide too many mechanisms to handle an exception. For example:</p> 
  <pre><code>import scala.concurrent.Await
import scala.concurrent.ExecutionContext
import scala.concurrent.duration.Duration
import scala.util.control.Exception.Catcher
import scala.concurrent.forkjoin.ForkJoinPool
val threadPool = new ForkJoinPool()
val catcher1: Catcher[Unit] = { case e: Exception =&gt; println("catcher1") }
val catcher2: Catcher[Unit] = {
  case e: java.io.IOException =&gt; println("catcher2")
  case other: Exception =&gt; throw new RuntimeException(other)
}
val catcher3: Catcher[Unit] = {
  case e: java.io.IOException =&gt; println("catcher3")
  case other: Exception =&gt; throw new RuntimeException(other)
}
val catcher4: Catcher[Unit] = { case e: Exception =&gt; println("catcher4") }
val catcher5: Catcher[Unit] = { case e: Exception =&gt; println("catcher5") }
val catcher6: Catcher[Unit] = { case e: Exception =&gt; println("catcher6") }
val catcher7: Catcher[Unit] = { case e: Exception =&gt; println("catcher7") }
def future1 = scala.concurrent.future { 1 }(ExecutionContext.fromExecutor(threadPool, catcher1))
def future2 = scala.concurrent.Future.failed(new Exception)
val composedFuture = future1.flatMap { _ =&gt; future2 }(ExecutionContext.fromExecutor(threadPool, catcher2))
composedFuture.onFailure(catcher3)(ExecutionContext.fromExecutor(threadPool, catcher4))
composedFuture.onFailure(catcher5)(ExecutionContext.fromExecutor(threadPool, catcher6))
try { Await.result(composedFuture, Duration.Inf) } catch { case e if catcher7.isDefinedAt(e) =&gt; catcher7(e) }
</code></pre> 
  <p>Is any sane developer able to tell which catchers will receive the exceptions?</p> 
  <p>There are too many concepts about exceptions when you work with <code>scala.concurrent.Future</code>. You have to remember the different exception handling strategies between <code>flatMap</code>, <code>recover</code>, <code>recoverWith</code> and <code>onFailure</code>, and the difference between <code>scala.concurrent.Future.failed(new Exception)</code> and <code>scala.concurrent.future { throw new Exception }</code>.</p> 
  <p><code>scala.async</code> does not make things better, because <code>scala.async</code> will <a href="https://github.com/scala/async/blob/master/src/test/scala/scala/async/neg/NakedAwait.scala#L104" target="_blank">produce a compiler error</a> for every <code>await</code> in a <code>try</code> statement.</p> 
  <p>Fortunately, you can get rid of all those concepts if you switch to future.scala. There is neither <code>executor</code> implicit parameter in <code>flatMap</code> or <code>map</code> in future.scala, nor <code>onFailure</code> nor <code>recover</code> method at all. You just simply <code>try</code>, and things get done. See <a href="https://github.com/ThoughtWorksInc/each/blob/3.3.x/each/src/test/scala/com/thoughtworks/each/MonadicErrorTest.scala" target="_blank">the examples</a> to learn that.</p> 
  <h3><a id="user-content-tail-call-optimization" class="anchor" href="https://github.com/thoughtworksinc/future.scala#tail-call-optimization" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Tail Call Optimization</h3> 
  <p>Tail call optimization is an important feature for pure functional programming. Without tail call optimization, many recursive algorithm will fail at run-time, and you will get the well-known <code>StackOverflowError</code>.</p> 
  <p>future.scala project is internally based on <code>scalaz.Trampoline</code>, and automatically performs tail call optimization in the magic <code>Future</code> blocks, without any additional special syntax.</p> 
  <p>See <a href="https://github.com/ThoughtWorksInc/RAII.scala/blob/d6390ba439356d3f50891f4b501547bb2748cb6a/asynchronous/src/test/scala/com/thoughtworks/raii/asynchronousSpec.scala#L59" target="_blank">this example</a>. The example creates 30000 stack levels recursively. And it just works, without any <code>StackOverflowError</code> or <code>OutOfMemoryError</code>. Note that if you port this example for <code>scala.async</code> it will throw an <code>OutOfMemoryError</code> or a <code>TimeoutException</code>.</p> 
  <h2><a id="user-content-links" class="anchor" href="https://github.com/thoughtworksinc/future.scala#links" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Links</h2> 
  <ul> 
   <li><a href="https://javadoc.io/page/com.thoughtworks.future/future_2.11/latest/com/thoughtworks/future$$Future.html" target="_blank">API Documentation</a></li> 
   <li><a href="https://gitter.im/ThoughtWorksInc/future.scala" target="_blank">Gitter Room</a></li> 
  </ul> 
  <h3><a id="user-content-related-projects" class="anchor" href="https://github.com/thoughtworksinc/future.scala#related-projects" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Related projects</h3> 
  <ul> 
   <li><a href="http://scalaz.org/" target="_blank">Scalaz</a> provides type classes and underlying data structures for this project.</li> 
   <li><a href="https://github.com/ThoughtWorksInc/each" target="_blank">ThoughtWorks Each</a> provides <code>monadic</code>/<code>each</code>-like syntax which can be used with this project.</li> 
   <li><a href="https://github.com/ThoughtWorksInc/TryT.scala" target="_blank">tryt.scala</a> provides exception handling monad transformers for this project.</li> 
   <li><a href="https://github.com/ThoughtWorksInc/RAII.scala" target="_blank">RAII.scala</a> uses this project for asynchronous automatic resource management.</li> 
   <li><a href="http://deeplearning.thoughtworks.school/" target="_blank">DeepLearning.scala</a> uses this project for asynchronous executed neural networks.</li> 
  </ul> 
 </article>
</div>