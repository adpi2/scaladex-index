<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a href="https://github.com/gree/aurora#aurora" aria-hidden="true" class="anchor" id="user-content-aurora" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Aurora</h1> 
  <p><a href="https://gitter.im/gree/aurora?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge" target="_blank"><img src="https://camo.githubusercontent.com/da2edb525cde1455a622c58c0effc3a90b9a181c/68747470733a2f2f6261646765732e6769747465722e696d2f4a6f696e253230436861742e737667" alt="Gitter" data-canonical-src="https://badges.gitter.im/Join%20Chat.svg" style="max-width:100%;"></a></p> 
  <p>AuroraはI/OをシャーディングするためのJava/Scala向けライブラリです。</p> 
  <p><a href="https://travis-ci.org/gree/aurora" target="_blank"><img src="https://camo.githubusercontent.com/052da4aec6939ea67d1ac4e21d72595fdc9e0ee0/68747470733a2f2f7472617669732d63692e6f72672f677265652f6175726f72612e7376673f6272616e63683d646576656c6f70" alt="Build Status" data-canonical-src="https://travis-ci.org/gree/aurora.svg?branch=develop" style="max-width:100%;"></a></p> 
  <h2><a href="https://github.com/gree/aurora#特徴" aria-hidden="true" class="anchor" id="user-content-特徴" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>特徴</h2> 
  <ul> 
   <li>Scala, Javaで利用可能 
    <ul> 
     <li>Java版は <code>aurora-core</code>、Scala版は <code>aurora-scala</code> を提供</li> 
     <li>他のJVM言語から利用できるはずです</li> 
    </ul> </li> 
   <li>ストレージデバイスフリー 
    <ul> 
     <li>コネクションやSQLなどのストレージデバイス固有の知識に依存しない</li> 
     <li>標準ではJDBC, Redis, Memcacheなどに対応</li> 
    </ul> </li> 
  </ul> 
  <h2><a href="https://github.com/gree/aurora#ライセンス" aria-hidden="true" class="anchor" id="user-content-ライセンス" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>ライセンス</h2> 
  <p>Copyright (c) 2014 GREE, Inc.</p> 
  <p>MIT License</p> 
  <h2><a href="https://github.com/gree/aurora#サポートする言語" aria-hidden="true" class="anchor" id="user-content-サポートする言語" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>サポートする言語</h2> 
  <ul> 
   <li>Java (SE 7以降)</li> 
   <li>Scala 2.10.x, 2.11.x</li> 
  </ul> 
  <h2><a href="https://github.com/gree/aurora#機能一覧" aria-hidden="true" class="anchor" id="user-content-機能一覧" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>機能一覧</h2> 
  <ul> 
   <li>データソース・シャーディング機能<br> 事前に定義したデータソース群とリゾルバによって、ヒントに応じたデータソースを解決できます(データソースからコネクションの変換は別途ロジックが必要。詳細は後述)。</li> 
   <li>テーブル名・シャーディング機能<br> 事前に定義したリゾルバによって、ヒントに応じたテーブル名を解決できます。</li> 
  </ul> 
  <h2><a href="https://github.com/gree/aurora#使い方利用者向け" aria-hidden="true" class="anchor" id="user-content-使い方利用者向け" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>使い方(利用者向け)</h2> 
  <h3><a href="https://github.com/gree/aurora#データソースシャーディング機能" aria-hidden="true" class="anchor" id="user-content-データソースシャーディング機能" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>データソース・シャーディング機能</h3> 
  <h4><a href="https://github.com/gree/aurora#プロジェクトのひな形を作成する" aria-hidden="true" class="anchor" id="user-content-プロジェクトのひな形を作成する" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>プロジェクトのひな形を作成する</h4> 
  <h5><a href="https://github.com/gree/aurora#scalaの場合" aria-hidden="true" class="anchor" id="user-content-scalaの場合" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Scalaの場合</h5> 
  <ul> 
   <li><code>typesafe-activator</code>と<code>sbt</code>をインストールする。</li> 
  </ul> 
  <div class="highlight highlight-source-shell">
   <pre>$ brew install typesafe-activator sbt</pre>
  </div> 
  <ul> 
   <li><code>typesafe-activator</code> でプロジェクトのひな形を作成する。 <code>minimal-scala</code> を選択する。</li> 
  </ul> 
  <div class="highlight highlight-source-shell">
   <pre>$ activator new
Fetching the latest list of templates...

Browse the list of templates: http://typesafe.com/activator/templates
Choose from these featured templates or enter a template name:
  1) minimal-java
  2) minimal-scala
  3) play-java
  4) play-scala
(hit tab to see a list of all templates)
<span class="pl-k">&gt;</span> 2
Enter a name <span class="pl-k">for</span> your application (just press enter <span class="pl-k">for</span> <span class="pl-s"><span class="pl-pds">'</span>minimal-scala<span class="pl-pds">'</span></span>)
<span class="pl-k">&gt;</span> example
OK, application <span class="pl-s"><span class="pl-pds">"</span>example<span class="pl-pds">"</span></span> is being created using the <span class="pl-s"><span class="pl-pds">"</span>minimal-scala<span class="pl-pds">"</span></span> template.

To run <span class="pl-s"><span class="pl-pds">"</span>example<span class="pl-pds">"</span></span> from the command-line, run:
/Users/junichi.kato/temp/example/activator run

To run the <span class="pl-c1">test</span> <span class="pl-k">for</span> <span class="pl-s"><span class="pl-pds">"</span>example<span class="pl-pds">"</span></span> from the command-line, run:
/Users/junichi.kato/temp/example/activator <span class="pl-c1">test</span>

To run the Activator UI <span class="pl-k">for</span> <span class="pl-s"><span class="pl-pds">"</span>example<span class="pl-pds">"</span></span> from the command-line, run:
/Users/junichi.kato/temp/example/activator ui</pre>
  </div> 
  <ul> 
   <li><code>build.sbt</code> に <code>aurora-scala</code> ライブラリへの依存関係を追加する。</li> 
  </ul> 
  <div class="highlight highlight-source-scala">
   <pre>name <span class="pl-k">:</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"""</span>example<span class="pl-pds">"""</span></span>

version <span class="pl-k">:</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span>

scalaVersion <span class="pl-k">:</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>2.11.1<span class="pl-pds">"</span></span>

resolvers <span class="pl-k">++</span><span class="pl-k">=</span> <span class="pl-en">Seq</span>(
	<span class="pl-s"><span class="pl-pds">"</span>Sonatype OSS Release Repository<span class="pl-pds">"</span></span> at <span class="pl-s"><span class="pl-pds">"</span>https://oss.sonatype.org/content/repositories/releases/<span class="pl-pds">"</span></span>,
	<span class="pl-s"><span class="pl-pds">"</span>Sonatype OSS Snapshots Repository<span class="pl-pds">"</span></span> at <span class="pl-s"><span class="pl-pds">"</span>https://oss.sonatype.org/content/repositories/snapshots<span class="pl-pds">"</span></span>
)

libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>net.gree.aurora<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>aurora-scala<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>x.x.x<span class="pl-pds">"</span></span></pre>
  </div> 
  <ul> 
   <li>以下の手順でコンパイルできることを確認する。</li> 
  </ul> 
  <div class="highlight highlight-source-shell">
   <pre>$ <span class="pl-c1">cd</span> example
example $ sbt clean compile</pre>
  </div> 
  <h5><a href="https://github.com/gree/aurora#javaの場合" aria-hidden="true" class="anchor" id="user-content-javaの場合" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Javaの場合</h5> 
  <ul> 
   <li>Mavenをインストールする</li> 
  </ul> 
  <div class="highlight highlight-source-shell">
   <pre>$ brew install maven</pre>
  </div> 
  <ul> 
   <li>Maven Archetypeでプロジェクトのひな形を生成する。</li> 
  </ul> 
  <div class="highlight highlight-source-shell">
   <pre>$ mvn archetype:generate -DarchetypeArtifactId=maven-archetype-quickstart
[INFO] Scanning <span class="pl-k">for</span> projects...
[INFO]
[INFO] Using the builder org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder with a thread count of 1
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building Maven Stub Project (No POM) 1
[INFO] ------------------------------------------------------------------------
<span class="pl-k">&lt;</span>snip<span class="pl-k">&gt;</span>
Define value <span class="pl-k">for</span> property <span class="pl-s"><span class="pl-pds">'</span>groupId<span class="pl-pds">'</span></span>: <span class="pl-c1">:</span> example
Define value <span class="pl-k">for</span> property <span class="pl-s"><span class="pl-pds">'</span>artifactId<span class="pl-pds">'</span></span>: <span class="pl-c1">:</span> example
Define value <span class="pl-k">for</span> property <span class="pl-s"><span class="pl-pds">'</span>version<span class="pl-pds">'</span></span>:  1.0-SNAPSHOT: <span class="pl-c1">:</span>
Define value <span class="pl-k">for</span> property <span class="pl-s"><span class="pl-pds">'</span>package<span class="pl-pds">'</span></span>:  example: <span class="pl-c1">:</span>
Confirm properties configuration:
groupId: example
artifactId: example
version: 1.0-SNAPSHOT
package: example
 Y: <span class="pl-c1">:</span> Y
[INFO] ----------------------------------------------------------------------------
[INFO] Using following parameters <span class="pl-k">for</span> creating project from Old (1.x) Archetype: maven-archetype-quickstart:1.0
[INFO] ----------------------------------------------------------------------------
[INFO] Parameter: groupId, Value: example
[INFO] Parameter: packageName, Value: example
[INFO] Parameter: package, Value: example
[INFO] Parameter: artifactId, Value: example
[INFO] Parameter: basedir, Value: /Users/user/
[INFO] Parameter: version, Value: 1.0-SNAPSHOT
[INFO] project created from Old (1.x) Archetype <span class="pl-k">in</span> dir: /Users/user
[INFO] ------------------------------------------------------------------------</pre>
  </div> 
  <ul> 
   <li><code>pom.xml</code> に <code>aurora-core</code> ライブラリへの依存関係を追加する。</li> 
  </ul> 
  <div class="highlight highlight-text-xml">
   <pre>&lt;<span class="pl-ent">dependencies</span>&gt;
  &lt;<span class="pl-ent">dependency</span>&gt;
  	&lt;<span class="pl-ent">groupId</span>&gt;net.gree.aurora&lt;/<span class="pl-ent">groupId</span>&gt;
  	&lt;<span class="pl-ent">artifactId</span>&gt;aurora-core&lt;/<span class="pl-ent">artifactId</span>&gt;
  	&lt;<span class="pl-ent">version</span>&gt;x.x.x&lt;/<span class="pl-ent">version</span>&gt;
  &lt;/<span class="pl-ent">dependency</span>&gt;
&lt;/<span class="pl-ent">dependencies</span>&gt;</pre>
  </div> 
  <ul> 
   <li>以下の手順でコンパイルできることを確認する。</li> 
  </ul> 
  <div class="highlight highlight-source-shell">
   <pre>$ <span class="pl-c1">cd</span> example
example $ mvn clean compile</pre>
  </div> 
  <h4><a href="https://github.com/gree/aurora#設定ファイルを用意する" aria-hidden="true" class="anchor" id="user-content-設定ファイルを用意する" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>設定ファイルを用意する</h4> 
  <p>まず最初に設定ファイル(<code>conf/application.conf</code>)を用意します。Auroraは<code>typesafe config</code>を利用しています。</p> 
  <p>例えばJDBCの場合は、以下のように記述します。</p> 
  <pre><code>aurora {
    sharding-configs {
        database {
            type=jdbc
            default {
                driver-class-name="org.mysql.Driver"
                prefix-url="jdbc:mysql://"
                user-name=user1
                password=user1pass
                read-only-user-name=user2
                read-only-password=user2pass
            }
            cluster-groups=[
                {
                    main {
                        clusters=[
                            {
                                cluster1 {
                                    master="192.168.1.2"
                                    slaves=[
                                        "192.168.1.3",
                                        "192.168.1.4"
                                    ]
                                    standby="192.168.1.254"
                                    database="test_a"
                                }
                            },
                            {
                                cluster2 {
                                    master="192.168.2.2"
                                    slaves=[
                                        "192.168.2.3",
                                        "192.168.2.4"
                                    ]
                                    standby="192.168.2.254"
                                    database="test_b"
                                }
                            }
                        ]
                    }
                },
                {
                    sub {
                        clusters=[
                            {
                                cluster1 {
                                    master="192.168.3.2"
                                    slaves=[
                                        "192.168.3.3",
                                        "192.168.3.4"
                                    ]
                                    standby="192.168.3.254"
                                    database="test_a"
                                }
                            },
                            {
                                cluster2 {
                                    master="192.168.4.2"
                                    slaves=[
                                        "192.168.4.3",
                                        "192.168.4.4"
                                    ]
                                    standby="192.168.4.254"
                                    database="test_b"
                                }
                            }
                        ]
                    }
                }
            ]
        }
    }
}
</code></pre> 
  <p><code>aurora/sharding-configs/database</code>の部分は、<code>sharding-config-id</code>と呼び、開発者が自由に命名できます。</p> 
  <p>JDBCの場合は<code>type=jdbc</code>としてください。<code>type</code>は必須項目です(他にも<code>genric</code>, <code>redis</code>などが使えます。後述)</p> 
  <p><code>default</code>には、各データソースで共通な設定項目(ドライバクラス名やユーザ名など)を記述します。<code>driver-class-name</code>, <code>prefix-url</code>, <code>user-name</code>, <code>password</code>, <code>read-only-user-name</code>, <code>read-only-password</code>は必須項目です。</p> 
  <table> 
   <thead> 
    <tr>
     <td>項目名</td>
     <td>意味</td>
     <td>補足</td> 
    </tr>
   </thead> 
   <tbody>
    <tr> 
     <td>driver-class-name</td>
     <td>JDBCドライバクラス名</td>
     <td></td> 
    </tr> 
    <tr> 
     <td>prefix-url</td>
     <td>JDBC接続URLのプレフィックス</td>
     <td></td> 
    </tr> 
    <tr> 
     <td>user-name</td>
     <td>JDBC接続ユーザ名</td>
     <td>マスターデータソースに利用します</td> 
    </tr> 
    <tr> 
     <td>password</td>
     <td>JDBC接続ユーザのパスワード</td>
     <td></td> 
    </tr> 
    <tr> 
     <td>read-only-user-name</td>
     <td>JDBC接続ユーザ名(読込み専用)</td>
     <td>スレーブデータソースに利用します</td> 
    </tr> 
    <tr> 
     <td>read-only-password</td>
     <td>JDBC接続ユーザ(読込み専用)のパスワード</td>
     <td></td> 
    </tr> 
   </tbody>
  </table> 
  <p>続く、<code>cluster-groups</code>(クラスターグループ)には、後述する<code>cluster</code>(クラスター)を複数個 登録します(1個でもよい)。クラスターグループは機能ごとに分割したい時に便利です。 <code>aurora/sharding-configs/{sharding-config-id}/cluster-groups/(main|sub)</code>の部分は、<code>cluster-group-id</code>と呼び、開発者が自由に命名できます。この二つのIDはデータソースを選択する際に必要になります。 <code>aurora/sharding-config/{sharding-config-id}/cluster-groups/{cluster-groupo-id}/clusters/(cluster1|cluster2)</code>の部分は、<code>cluster-id</code>と呼び、開発者が自由に命名できます。</p> 
  <p>続く、<code>cluster</code>(クラスター)には、マスター用途(<code>master</code>)とスレーブ用途(<code>slave</code>)のデータソースを定義できます。1クラスターにマスターは1台とし、スレーブは複数台を登録します。<code>database</code>にはデータベース名を指定します。(<code>standby</code>はコメントです)</p> 
  <h3><a href="https://github.com/gree/aurora#ヒントを与えてデータソースを解決する" aria-hidden="true" class="anchor" id="user-content-ヒントを与えてデータソースを解決する" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>ヒントを与えてデータソースを解決する</h3> 
  <p>ヒントを受け取ってクラスタ名を返すリゾルバ(<code>clusterIdResolver</code>)を実装し、AuroraShardingServiceを初期化します(<code>auroraShardingService</code>)。 <code>AuroraShardingService#resolveClusterByHint</code>メソッドを使って、ヒントに応じたクラスターを取得します。</p> 
  <p>クラスターにはデータソースが含まれているので、それを使って目的に応じてI/Oを行います(データソースからコネクションの変換はアプリケーション開発者が行う必要があります)</p> 
  <h4><a href="https://github.com/gree/aurora#javaの場合-1" aria-hidden="true" class="anchor" id="user-content-javaの場合-1" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Javaの場合</h4> 
  <div class="highlight highlight-source-java">
   <pre><span class="pl-k">package</span> <span class="pl-smi">net.gree.aurora</span>;

<span class="pl-k">import</span> <span class="pl-smi">net.gree.aurora.application.AuroraShardingService</span>;
<span class="pl-k">import</span> <span class="pl-smi">net.gree.aurora.application.AuroraShardingServiceFactory</span>;
<span class="pl-k">import</span> <span class="pl-smi">net.gree.aurora.domain.cluster.AbstractClusterIdResolver</span>;
<span class="pl-k">import</span> <span class="pl-smi">net.gree.aurora.domain.cluster.Cluster</span>;
<span class="pl-k">import</span> <span class="pl-smi">net.gree.aurora.domain.cluster.ClusterIdResolver</span>;
<span class="pl-k">import</span> <span class="pl-smi">net.gree.aurora.domain.datasource.DataSourceRepository</span>;
<span class="pl-k">import</span> <span class="pl-smi">net.gree.aurora.domain.datasource.DataSourceSelector</span>;
<span class="pl-k">import</span> <span class="pl-smi">net.gree.aurora.domain.datasource.JDBCDataSource</span>;
<span class="pl-k">import</span> <span class="pl-smi">net.gree.aurora.domain.hint.Hint</span>;
<span class="pl-k">import</span> <span class="pl-smi">net.gree.aurora.domain.hint.HintFactory</span>;

<span class="pl-k">import</span> <span class="pl-smi">java.io.File</span>;
<span class="pl-k">import</span> <span class="pl-smi">java.io.IOException</span>;
<span class="pl-k">import</span> <span class="pl-smi">java.sql.*</span>;

<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Main</span> {

    <span class="pl-k">private</span> <span class="pl-k">static</span> <span class="pl-k">class</span> <span class="pl-en">User</span> {
        <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-k">int</span> id;
        <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-smi">String</span> name;

        <span class="pl-en">User</span>(<span class="pl-k">int</span> <span class="pl-v">id</span>, <span class="pl-smi">String</span> <span class="pl-v">name</span>){
            <span class="pl-c1">this</span><span class="pl-k">.</span>id <span class="pl-k">=</span> id;
            <span class="pl-c1">this</span><span class="pl-k">.</span>name <span class="pl-k">=</span> name;
        }

        <span class="pl-k">public</span> <span class="pl-k">int</span> <span class="pl-en">getId</span>() {
            <span class="pl-k">return</span> id;
        }

        <span class="pl-k">public</span> <span class="pl-smi">String</span> <span class="pl-en">getName</span>() {
            <span class="pl-k">return</span> name;
        }

        <span class="pl-k">@Override</span>
        <span class="pl-k">public</span> <span class="pl-smi">String</span> <span class="pl-en">toString</span>() {
            <span class="pl-k">return</span> <span class="pl-s"><span class="pl-pds">"</span>User{<span class="pl-pds">"</span></span> <span class="pl-k">+</span>
                    <span class="pl-s"><span class="pl-pds">"</span>id=<span class="pl-pds">"</span></span> <span class="pl-k">+</span> id <span class="pl-k">+</span>
                    <span class="pl-s"><span class="pl-pds">"</span>, name='<span class="pl-pds">"</span></span> <span class="pl-k">+</span> name <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-cce">\'</span><span class="pl-pds">'</span></span> <span class="pl-k">+</span>
                    <span class="pl-s"><span class="pl-pds">'</span>}<span class="pl-pds">'</span></span>;
        }
    }

    <span class="pl-c"><span class="pl-c">//</span> リゾルバを定義する</span>
    <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-k">ClusterIdResolver&lt;<span class="pl-smi">Integer</span>&gt;</span> clusterIdResolver <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-k">AbstractClusterIdResolver&lt;<span class="pl-smi">Integer</span>&gt;</span>(<span class="pl-s"><span class="pl-pds">"</span>cluster<span class="pl-pds">"</span></span>) {

        <span class="pl-k">@Override</span>
        <span class="pl-k">protected</span> <span class="pl-smi">String</span> <span class="pl-en">getSuffixName</span>(<span class="pl-k">Hint&lt;<span class="pl-smi">Integer</span>&gt;</span> <span class="pl-v">userIdHint</span>, <span class="pl-k">int</span> <span class="pl-v">clusterSize</span>) {
            <span class="pl-k">return</span> <span class="pl-smi">Integer</span><span class="pl-k">.</span>toString(((userIdHint<span class="pl-k">.</span>getValue() <span class="pl-k">+</span><span class="pl-c1">1</span>) <span class="pl-k">%</span> clusterSize) <span class="pl-k">+</span> <span class="pl-c1">1</span>);
        }
        
    };

    <span class="pl-c"><span class="pl-c">//</span> AuroraShardingServiceを初期化する</span>
    <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-k">AuroraShardingService&lt;<span class="pl-smi">Integer</span>&gt;</span> auroraShardingService <span class="pl-k">=</span> <span class="pl-smi">AuroraShardingServiceFactory</span><span class="pl-k">.</span>create(clusterIdResolver, <span class="pl-k">new</span> <span class="pl-smi">File</span>(<span class="pl-s"><span class="pl-pds">"</span>./conf/example.conf<span class="pl-pds">"</span></span>));

    <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-smi">DataSourceRepository</span> dataSourceRepository <span class="pl-k">=</span> auroraShardingService<span class="pl-k">.</span>getDataSourceRepository()<span class="pl-k">.</span>get();

    <span class="pl-k">private</span> <span class="pl-smi">User</span> <span class="pl-en">findByUserId</span>(<span class="pl-k">int</span> <span class="pl-v">userId</span>) <span class="pl-k">throws</span> <span class="pl-smi">SQLException</span>, <span class="pl-smi">ClassNotFoundException</span>, <span class="pl-smi">IOException</span> {
        <span class="pl-c"><span class="pl-c">//</span> sharding-config-idとcluster-group-idとヒントを引数に与えてclusterを解決する</span>
        <span class="pl-smi">Cluster</span> cluster <span class="pl-k">=</span> auroraShardingService<span class="pl-k">.</span>resolveClusterByHint(<span class="pl-s"><span class="pl-pds">"</span>database<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>main<span class="pl-pds">"</span></span>, <span class="pl-smi">HintFactory</span><span class="pl-k">.</span>create(userId))<span class="pl-k">.</span>get();

        <span class="pl-c"><span class="pl-c">//</span> スレーブはランダム選択</span>
        <span class="pl-k">DataSourceSelector&lt;<span class="pl-smi">Integer</span>&gt;</span> selector <span class="pl-k">=</span> cluster<span class="pl-k">.</span>createDataSourceSelectorAsRandom(dataSourceRepository);
        <span class="pl-c"><span class="pl-c">//</span> スレーブデータソースを選択する</span>
        <span class="pl-smi">JDBCDataSource</span> dataSource <span class="pl-k">=</span> selector<span class="pl-k">.</span>selectDataSourceAsJDBC(<span class="pl-c1">null</span>)<span class="pl-k">.</span>get();
        <span class="pl-c"><span class="pl-c">//</span> 書き込み用途でマスターを利用する場合は、以下。</span>
        <span class="pl-c"><span class="pl-c">//</span> JDBCDataSource dataSource = cluster.masterDataSource(dataSourceRepository).get();</span>

        <span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(dataSource);

        <span class="pl-c"><span class="pl-c">//</span> データソースからコネクションを取得する</span>
        <span class="pl-smi">Connection</span> connection <span class="pl-k">=</span> getConnection(dataSource);

        <span class="pl-c"><span class="pl-c">//</span> コネクションを使ってSQLを発行する</span>
        <span class="pl-smi">Statement</span> st <span class="pl-k">=</span> connection<span class="pl-k">.</span>createStatement();
        <span class="pl-smi">ResultSet</span> rs <span class="pl-k">=</span> st<span class="pl-k">.</span>executeQuery(<span class="pl-s"><span class="pl-pds">"</span>SELECT * FROM user WHERE id = <span class="pl-pds">"</span></span> <span class="pl-k">+</span> userId);
        <span class="pl-k">if</span> (rs<span class="pl-k">.</span>next()) {
            <span class="pl-k">return</span> convertToModel(rs);
        }<span class="pl-k">else</span> {
            <span class="pl-k">throw</span> <span class="pl-k">new</span> <span class="pl-smi">IOException</span>(<span class="pl-s"><span class="pl-pds">"</span>entity is not found.<span class="pl-pds">"</span></span>);
        }
    }

    <span class="pl-c"><span class="pl-c">//</span> ここでは都度コネクションを取得していますが、</span>
    <span class="pl-c"><span class="pl-c">//</span> 必要に応じてコネクションプールからコネクションを取得してもよいでしょう</span>
    <span class="pl-k">private</span> <span class="pl-smi">Connection</span> <span class="pl-en">getConnection</span>(<span class="pl-smi">JDBCDataSource</span> <span class="pl-v">dataSource</span>) <span class="pl-k">throws</span> <span class="pl-smi">ClassNotFoundException</span>, <span class="pl-smi">SQLException</span> {
        <span class="pl-smi">Class</span><span class="pl-k">.</span>forName(dataSource<span class="pl-k">.</span>getDriverClassName());
        <span class="pl-k">return</span> <span class="pl-smi">DriverManager</span><span class="pl-k">.</span>getConnection(dataSource<span class="pl-k">.</span>getUrl(), dataSource<span class="pl-k">.</span>getUserName(), dataSource<span class="pl-k">.</span>getPassword());
    }

    <span class="pl-k">private</span> <span class="pl-smi">User</span> <span class="pl-en">convertToModel</span>(<span class="pl-smi">ResultSet</span> <span class="pl-v">resultSet</span>) <span class="pl-k">throws</span> <span class="pl-smi">SQLException</span> {
        <span class="pl-k">return</span> <span class="pl-k">new</span> <span class="pl-smi">User</span>(resultSet<span class="pl-k">.</span>getInt(<span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>), resultSet<span class="pl-k">.</span>getString(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>));
    }

    <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">main</span>(<span class="pl-k">String</span>[] <span class="pl-v">args</span>) <span class="pl-k">throws</span> <span class="pl-smi">SQLException</span>, <span class="pl-smi">ClassNotFoundException</span>, <span class="pl-smi">IOException</span> {
        <span class="pl-smi">User</span> user <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">Main</span>()<span class="pl-k">.</span>findByUserId(<span class="pl-c1">1</span>);
        <span class="pl-smi">System</span><span class="pl-k">.</span>out<span class="pl-k">.</span>println(user);
    }

}</pre>
  </div> 
  <h4><a href="https://github.com/gree/aurora#scalaの場合-1" aria-hidden="true" class="anchor" id="user-content-scalaの場合-1" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Scalaの場合</h4> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">package</span> <span class="pl-en">net.gree.aurora.scala</span>

<span class="pl-k">import</span> <span class="pl-v">java.io.</span>{<span class="pl-v">IOException</span>, <span class="pl-v">File</span>}
<span class="pl-k">import</span> <span class="pl-v">java.sql.</span>{<span class="pl-v">Connection</span>, <span class="pl-v">DriverManager</span>, <span class="pl-v">ResultSet</span>}

<span class="pl-k">import</span> <span class="pl-v">net.gree.aurora.scala.application.</span><span class="pl-v">AuroraShardingService</span>
<span class="pl-k">import</span> <span class="pl-v">net.gree.aurora.scala.domain.cluster.</span><span class="pl-v">AbstractClusterIdResolver</span>
<span class="pl-k">import</span> <span class="pl-v">net.gree.aurora.scala.domain.datasource.</span><span class="pl-v">JDBCDataSource</span>
<span class="pl-k">import</span> <span class="pl-v">net.gree.aurora.scala.domain.hint.</span><span class="pl-v">Hint</span>
<span class="pl-k">import</span> <span class="pl-v">org.sisioh.dddbase.core.lifecycle.sync.</span><span class="pl-v">SyncEntityIOContext</span>

<span class="pl-k">import</span> <span class="pl-v">scala.util.</span><span class="pl-v">Try</span>

<span class="pl-k">object</span> <span class="pl-en">Main</span> <span class="pl-k">extends</span> <span class="pl-e">App</span> {

  <span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">User</span>(<span class="pl-v">id</span>: <span class="pl-k">Int</span>, <span class="pl-v">name</span>: <span class="pl-k">String</span>)

  <span class="pl-c"><span class="pl-c">//</span> リゾルバを定義する</span>
  <span class="pl-k">private</span> <span class="pl-k">val</span> <span class="pl-en">clusterIdResolver</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">AbstractClusterIdResolver</span>[<span class="pl-k">Int</span>](<span class="pl-s"><span class="pl-pds">"</span>cluster<span class="pl-pds">"</span></span>) {

    <span class="pl-k">override</span> <span class="pl-k">protected</span> <span class="pl-k">def</span> <span class="pl-en">getSuffixName</span>(<span class="pl-v">userIdHint</span>: <span class="pl-en">Hint</span>[<span class="pl-k">Int</span>], <span class="pl-v">clusterSize</span>: <span class="pl-k">Int</span>)<span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> {
      (((userIdHint.value <span class="pl-k">+</span> <span class="pl-c1">1</span>) <span class="pl-k">%</span> clusterSize) <span class="pl-k">+</span> <span class="pl-c1">1</span>).toString
    }

  }

  <span class="pl-c"><span class="pl-c">//</span> AuroraShardingServiceを初期化する</span>
  <span class="pl-k">private</span> <span class="pl-k">val</span> <span class="pl-en">auroraShardingService</span> <span class="pl-k">=</span> <span class="pl-en">AuroraShardingService</span>(clusterIdResolver, <span class="pl-k">new</span> <span class="pl-en">File</span>(<span class="pl-s"><span class="pl-pds">"</span>./conf/example.conf<span class="pl-pds">"</span></span>))

  <span class="pl-k">private</span> <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">dataSourceRepository</span> <span class="pl-k">=</span> auroraShardingService.dataSourceRepository.get
  <span class="pl-k">private</span> <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">ctx</span> <span class="pl-k">=</span> <span class="pl-en">SyncEntityIOContext</span>

  <span class="pl-k">private</span> <span class="pl-k">def</span> <span class="pl-en">findByUserId</span>(<span class="pl-v">userId</span>: <span class="pl-k">Int</span>)<span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-en">User</span>] <span class="pl-k">=</span> {
    <span class="pl-c"><span class="pl-c">//</span> sharding-config-idとcluster-group-idとヒントを引数に与えてclusterを解決する</span>
    auroraShardingService.resolveClusterByHint(<span class="pl-s"><span class="pl-pds">"</span>database<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>main<span class="pl-pds">"</span></span>, <span class="pl-en">Hint</span>(userId)).map { cluster <span class="pl-k">=&gt;</span>
      <span class="pl-c"><span class="pl-c">//</span> スレーブはランダム選択</span>
      <span class="pl-k">val</span> <span class="pl-en">selector</span> <span class="pl-k">=</span> cluster.createDataSourceSelectorAsRandom
      <span class="pl-c"><span class="pl-c">//</span> スレーブデータソースを選択する</span>
      <span class="pl-k">val</span> <span class="pl-en">dataSource</span> <span class="pl-k">=</span> selector.selectDataSourceAsJDBC().get
      <span class="pl-c"><span class="pl-c">//</span> 書き込み用途でマスターを利用する場合は、以下。</span>
      <span class="pl-c"><span class="pl-c">//</span> val dataSource = cluster.masterDataSource</span>

      println(dataSource)

      <span class="pl-c"><span class="pl-c">//</span> データソースからコネクションを取得する</span>
      <span class="pl-k">val</span> <span class="pl-en">connection</span> <span class="pl-k">=</span> getConnection(dataSource)

      <span class="pl-c"><span class="pl-c">//</span> コネクションを使ってSQLを発行する</span>
      <span class="pl-k">val</span> <span class="pl-en">st</span> <span class="pl-k">=</span> connection.createStatement
      <span class="pl-k">val</span> <span class="pl-en">rs</span> <span class="pl-k">=</span> st.executeQuery(<span class="pl-s"><span class="pl-pds">"</span>SELECT * FROM user WHERE id = <span class="pl-pds">"</span></span> <span class="pl-k">+</span> userId)
      <span class="pl-k">if</span> (rs.next())
        convertToModel(rs)
      <span class="pl-k">else</span>
         <span class="pl-k">throw</span> <span class="pl-k">new</span> <span class="pl-en">IOException</span>(<span class="pl-s"><span class="pl-pds">"</span>entity is not found.<span class="pl-pds">"</span></span>)
    }
  }

  <span class="pl-c"><span class="pl-c">//</span> ここでは都度コネクションを取得していますが、</span>
  <span class="pl-c"><span class="pl-c">//</span> 必要に応じてコネクションプールからコネクションを取得してもよいでしょう</span>
  <span class="pl-k">private</span> <span class="pl-k">def</span> <span class="pl-en">getConnection</span>(<span class="pl-v">dataSource</span>: <span class="pl-en">JDBCDataSource</span>)<span class="pl-k">:</span> <span class="pl-en">Connection</span> <span class="pl-k">=</span> {
    <span class="pl-k">val</span> <span class="pl-en">url</span> <span class="pl-k">=</span> dataSource.url
    <span class="pl-k">val</span> <span class="pl-en">userName</span> <span class="pl-k">=</span> dataSource.userName
    <span class="pl-k">val</span> <span class="pl-en">password</span> <span class="pl-k">=</span> dataSource.password
    <span class="pl-en">Class</span>.forName(dataSource.driverClassName)
    <span class="pl-en">DriverManager</span>.getConnection(url, userName, password)
  }

  <span class="pl-k">private</span> <span class="pl-k">def</span> <span class="pl-en">convertToModel</span>(<span class="pl-v">resultSet</span>: <span class="pl-en">ResultSet</span>)<span class="pl-k">:</span> <span class="pl-en">User</span> <span class="pl-k">=</span>
    <span class="pl-en">User</span>(
      id <span class="pl-k">=</span> resultSet.getInt(<span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>),
      name <span class="pl-k">=</span> resultSet.getString(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>)
    )

  <span class="pl-k">val</span> <span class="pl-en">user</span> <span class="pl-k">=</span> findByUserId(<span class="pl-c1">1</span>).get

  println(user)

}</pre>
  </div> 
  <p>上記のサンプルコードは、以下の手順で実行することができます(MySQLサーバをlocalhostで稼働させている前提)。</p> 
  <div class="highlight highlight-source-shell">
   <pre>$ git clone git@github.com:gree/aurora.git
$ <span class="pl-c1">cd</span> aurora/tool
$ sh setup_testdb.sh
$ <span class="pl-c1">cd</span> ..
$ sbt <span class="pl-s"><span class="pl-pds">"</span>project aurora-scala-example<span class="pl-pds">"</span></span> run</pre>
  </div> 
  <h3><a href="https://github.com/gree/aurora#その他のデータソースタイプについて" aria-hidden="true" class="anchor" id="user-content-その他のデータソースタイプについて" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>その他のデータソースタイプについて</h3> 
  <ul> 
   <li>対応しているデータソースタイプ 
    <ul> 
     <li>汎用タイプ(generic)</li> 
     <li>JDBC(jdbc)</li> 
     <li>Redis(redis)</li> 
    </ul> </li> 
  </ul> 
  <h3><a href="https://github.com/gree/aurora#テーブル名シャーディング機能" aria-hidden="true" class="anchor" id="user-content-テーブル名シャーディング機能" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>テーブル名・シャーディング機能</h3> 
  <p>TBD</p> 
  <h2><a href="https://github.com/gree/aurora#ビルド手順コミッタコントリビュータ向け" aria-hidden="true" class="anchor" id="user-content-ビルド手順コミッタコントリビュータ向け" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>ビルド手順(コミッタ・コントリビュータ向け)</h2> 
  <h3><a href="https://github.com/gree/aurora#ビルドに必要なもの" aria-hidden="true" class="anchor" id="user-content-ビルドに必要なもの" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>ビルドに必要なもの</h3> 
  <ul> 
   <li>Java SE 7</li> 
  </ul> 
  <p><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_blank">こちら</a>からダウンロードする。</p> 
  <ul> 
   <li>Scala 2.10.x, 2.11.x</li> 
  </ul> 
  <p>sbtが自動的にダウンロードするのでインストールは不要</p> 
  <ul> 
   <li>sbt</li> 
  </ul> 
  <p>以下の手順でインストール。</p> 
  <div class="highlight highlight-source-shell">
   <pre>$ brew install sbt</pre>
  </div> 
  <h3><a href="https://github.com/gree/aurora#ソースコードの取得" aria-hidden="true" class="anchor" id="user-content-ソースコードの取得" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>ソースコードの取得</h3> 
  <div class="highlight highlight-source-shell">
   <pre>$ git clone git@github.com:gree/aurora.git
$ <span class="pl-c1">cd</span> aurora
aurora $ git config -l <span class="pl-k">|</span> grep user <span class="pl-c"><span class="pl-c">#</span> 意図どおりか確認する</span></pre>
  </div> 
  <h3><a href="https://github.com/gree/aurora#ビルド手順" aria-hidden="true" class="anchor" id="user-content-ビルド手順" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>ビルド手順</h3> 
  <div class="highlight highlight-source-shell">
   <pre>aurora $ sbt clean +package</pre>
  </div> 
  <p>target以下のパスにjarファイルが生成されます。</p> 
  <h3><a href="https://github.com/gree/aurora#intellij-idea" aria-hidden="true" class="anchor" id="user-content-intellij-idea" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>IntelliJ IDEA</h3> 
  <p>以下の手順を行い、IDEA上でOpen Projectを行う。</p> 
  <div class="highlight highlight-source-shell">
   <pre>$ <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>addSbtPlugin("com.github.mpeltonen" % "sbt-idea" % "1.6.0")<span class="pl-pds">'</span></span> <span class="pl-k">&gt;</span>  <span class="pl-k">~</span>/.sbt/0.13/plugins/build.sbt
aurora $ sbt clean gen-idea</pre>
  </div> 
  <h3><a href="https://github.com/gree/aurora#ローカルリポジトリへのデプロイ" aria-hidden="true" class="anchor" id="user-content-ローカルリポジトリへのデプロイ" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>ローカルリポジトリへのデプロイ</h3> 
  <div class="highlight highlight-source-shell">
   <pre>aurora $ sbt clean publish-local</pre>
  </div> 
  <h3><a href="https://github.com/gree/aurora#リモートリポジトリsonatypeへのデプロイ方法コミッタのみの権限" aria-hidden="true" class="anchor" id="user-content-リモートリポジトリsonatypeへのデプロイ方法コミッタのみの権限" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>リモートリポジトリ(Sonatype)へのデプロイ方法(コミッタのみの権限)</h3> 
  <h3><a href="https://github.com/gree/aurora#前提" aria-hidden="true" class="anchor" id="user-content-前提" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>前提</h3> 
  <ul> 
   <li>Sonatype JIRA のアカウントを持っていること。なければ<a href="https://issues.sonatype.org/secure/Dashboard.jspa" target="_blank">ここから</a>サインアップしてアカウントを取得する。</li> 
   <li>Sonatype リポジトリへのデプロイ権限を持っていること。欲しい方は、Issueから申請してください。</li> 
   <li>以下の内容で <code>~/.ivy2/.credentials</code> を作成する。</li> 
  </ul> 
  <div class="highlight highlight-source-scala">
   <pre>realm<span class="pl-k">=</span><span class="pl-en">Sonatype</span> <span class="pl-en">Nexus</span> <span class="pl-en">Repository</span> <span class="pl-en">Manager</span>
host<span class="pl-k">=</span>oss.sonatype.org
user<span class="pl-k">=</span><span class="pl-en">JIRA</span>アカウント名
password<span class="pl-k">=</span>パスワード</pre>
  </div> 
  <ul> 
   <li>gpgで鍵を作る</li> 
  </ul> 
  <p>鍵を生成する</p> 
  <div class="highlight highlight-source-shell">
   <pre>$ gpg --gen-key</pre>
  </div> 
  <p>生成された鍵を確認する</p> 
  <div class="highlight highlight-source-shell">
   <pre>$ gpg --list-keys</pre>
  </div> 
  <div class="highlight highlight-source-shell">
   <pre>/home/user1/.gnupg/pubring.gpg
--------------------------------
pub   2038R/7544FE41 2014-06-15
uid                  XXXXX YYYYY <span class="pl-k">&lt;</span>xxxxx@xxxx.xxx<span class="pl-k">&gt;</span>
sub   2038R/FD94AE63 2014-06-15</pre>
  </div> 
  <p>鍵をサーバに送信する</p> 
  <div class="highlight highlight-source-shell">
   <pre>$ gpg --send-keys 7544FE41</pre>
  </div> 
  <h4><a href="https://github.com/gree/aurora#スナップショット版のデプロイ方法" aria-hidden="true" class="anchor" id="user-content-スナップショット版のデプロイ方法" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>スナップショット版のデプロイ方法</h4> 
  <div class="highlight highlight-source-shell">
   <pre>aurora $ sbt clean +publish</pre>
  </div> 
  <h4><a href="https://github.com/gree/aurora#リリース版のデプロイ方法" aria-hidden="true" class="anchor" id="user-content-リリース版のデプロイ方法" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>リリース版のデプロイ方法</h4> 
  <div class="highlight highlight-source-shell">
   <pre><span class="pl-c"><span class="pl-c">#</span> リリースブランチを作成する</span>
aurora $ git flow release start v0.0.4
<span class="pl-c"><span class="pl-c">#</span> commonSettingsのversionをあげる</span>
aurora $ vi project/Build.scala
aurora $ sbt clean <span class="pl-c1">test</span>
aurora $ git flow release finish v0.0.4
aurora $ git push origin master
aurora $ git push origin develop
aurora $ git push origin refs/tags/v0.0.4
<span class="pl-c"><span class="pl-c">#</span> マスターブランチからデプロイを行う</span>
aurora $ sbt clean
aurora $ sbt +publishSigned
aurora $ sbt +sonatypeRelease</pre>
  </div> 
  <h2><a href="https://github.com/gree/aurora#開発への貢献" aria-hidden="true" class="anchor" id="user-content-開発への貢献" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>開発への貢献</h2> 
  <p>Pull Requestをお待ちしております。</p> 
  <h2><a href="https://github.com/gree/aurora#短縮url" aria-hidden="true" class="anchor" id="user-content-短縮url" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>短縮URL</h2> 
  <p><a href="http://git.io/aurora" target="_blank">http://git.io/aurora</a></p> 
 </article>
</div>