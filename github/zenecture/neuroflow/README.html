<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <p><a href="https://raw.githubusercontent.com/zenecture/zenecture-docs/master/neuroflow/logo.png" target="_blank"><img src="https://raw.githubusercontent.com/zenecture/zenecture-docs/master/neuroflow/logo.png" width="471" height="126" style="max-width:100%;"></a></p> 
  <p>NeuroFlow is a library to construct, sketch, train and evaluate Artificial Neural Networks. It is written in Scala, matrix operations are performed with <a href="https://github.com/scalanlp/breeze" target="_blank">Breeze</a> and <a href="https://github.com/fommil/netlib-java" target="_blank">netlib-java</a>.</p> 
  <h1><a id="user-content-introduction" class="anchor" href="https://github.com/zenecture/neuroflow#introduction" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Introduction</h1> 
  <p>This project consists of three modules:</p> 
  <ul> 
   <li>core: the building blocks to create neural network architectures</li> 
   <li>application: plugins, helpers, functionality related to various applications</li> 
   <li>playground: examples with resources</li> 
  </ul> 
  <h1><a id="user-content-getting-started" class="anchor" href="https://github.com/zenecture/neuroflow#getting-started" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Getting Started</h1> 
  <p>To use NeuroFlow within your project, add these dependencies (Scala Version 2.11.8, 2.12.1):</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">++</span><span class="pl-k">=</span> <span class="pl-en">Seq</span>(
  <span class="pl-s"><span class="pl-pds">"</span>com.zenecture<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>neuroflow-core<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.604<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>com.zenecture<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>neuroflow-application<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.604<span class="pl-pds">"</span></span>
)

resolvers <span class="pl-k">++</span><span class="pl-k">=</span> <span class="pl-en">Seq</span>(<span class="pl-s"><span class="pl-pds">"</span>Sonatype Releases<span class="pl-pds">"</span></span> at <span class="pl-s"><span class="pl-pds">"</span>https://oss.sonatype.org/content/repositories/releases/<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <p>Seeing code examples is a good way to get started. You may have a look at the playground for some inspiration. If you want to use neural nets in your project, you can expect a journey full of fun and experiments.</p> 
  <h1><a id="user-content-net-types" class="anchor" href="https://github.com/zenecture/neuroflow#net-types" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Net Types</h1> 
  <p>It's hard to hammer a nail using a screw driver, so we have different net types.</p> 
  <p><a href="https://raw.githubusercontent.com/zenecture/zenecture-docs/master/neuroflow/nettypes.png" target="_blank"><img src="https://raw.githubusercontent.com/zenecture/zenecture-docs/master/neuroflow/nettypes.png" width="700" height="250" style="max-width:100%;"></a></p> 
  <ul> 
   <li>FFN: A feed forward network. It is good for classification and regression with stationary input.</li> 
   <li>FFN CLUSTER: Use a cluster if you want to represent, compress or cluster your data. Think of word2vec, auto-encoders or principal component analysis.</li> 
   <li>RNN LSTM: A recurrent network. The LSTM model is used here. Use it if you want to do classification and regression with sequential input.</li> 
  </ul> 
  <h1><a id="user-content-construction-of-a-net" class="anchor" href="https://github.com/zenecture/neuroflow#construction-of-a-net" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Construction of a Net</h1> 
  <p><a href="https://raw.githubusercontent.com/zenecture/zenecture-docs/master/neuroflow/arch.png" target="_blank"><img src="https://raw.githubusercontent.com/zenecture/zenecture-docs/master/neuroflow/arch.png" width="443" height="320" style="max-width:100%;"></a></p> 
  <p>Let's construct the FFN net depicted above. First, we have to pick the desired behavior:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">neuroflow.application.plugin.Notation.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">neuroflow.core.Activator.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">neuroflow.core.FFN.WeightProvider.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">neuroflow.core.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">neuroflow.nets.DefaultNetwork.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">shapeless.</span><span class="pl-v">_</span></pre>
  </div> 
  <p>This will give us a fully connected net, which is initialized with random weights in supervised training mode.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">f</span> <span class="pl-k">=</span> <span class="pl-en">Sigmoid</span>
<span class="pl-k">val</span> <span class="pl-en">net</span> <span class="pl-k">=</span> <span class="pl-en">Network</span>(<span class="pl-en">Input</span>(<span class="pl-c1">2</span>) <span class="pl-k">::</span> <span class="pl-en">Hidden</span>(<span class="pl-c1">3</span>, f) <span class="pl-k">::</span> <span class="pl-en">Output</span>(<span class="pl-c1">1</span>, f) <span class="pl-k">::</span> <span class="pl-en">HNil</span>)</pre>
  </div> 
  <p>The architecture of the net is expressed as a list. We use a sigmoid activation function <code>f</code> for our hidden and output layers. A more complex net could look like this, with some rates and rules being defined, like precision or maximum iterations, through a <code>Settings</code> instance:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">neuroflow.core.LBFGSCluster.</span><span class="pl-v">_</span>
<span class="pl-k">val</span> (f, g) <span class="pl-k">=</span> (<span class="pl-en">Sigmoid</span>, <span class="pl-en">Linear</span>)
<span class="pl-k">val</span> <span class="pl-en">settings</span> <span class="pl-k">=</span> <span class="pl-en">Settings</span>(precision <span class="pl-k">=</span> <span class="pl-c1">1E-5</span>, iterations <span class="pl-k">=</span> <span class="pl-c1">200</span>)
<span class="pl-k">val</span> <span class="pl-en">complexNet</span> <span class="pl-k">=</span> <span class="pl-en">Network</span>(
  <span class="pl-en">Input</span>    (<span class="pl-c1">50</span>)    <span class="pl-k">::</span> 
  <span class="pl-en">Hidden</span>   (<span class="pl-c1">20</span>, f) <span class="pl-k">::</span> 
  <span class="pl-en">Cluster</span>  (<span class="pl-c1">10</span>, g) <span class="pl-k">::</span> 
  <span class="pl-en">Hidden</span>   (<span class="pl-c1">20</span>, f) <span class="pl-k">::</span> 
  <span class="pl-en">Output</span>   (<span class="pl-c1">50</span>, f) <span class="pl-k">::</span> <span class="pl-en">HNil</span>, 
  settings
)</pre>
  </div> 
  <p>Be aware that a network must start with one <code>Input(i)</code> layer and end with one <code>Output(i, fn)</code> layer. If a network doesn't follow this rule, it won't compile.</p> 
  <h1><a id="user-content-training" class="anchor" href="https://github.com/zenecture/neuroflow#training" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Training</h1> 
  <p>Let's train our <code>net</code> with the <code>train</code> method. It expects the inputs <code>xs</code> and, since it is supervised training, their desired outputs <code>ys</code>. For our little example, let's quickly define the training data using the vector notation:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">xs</span> <span class="pl-k">=</span> <span class="pl-k">--</span><span class="pl-k">&gt;</span>(<span class="pl-k">-</span><span class="pl-k">&gt;</span>(<span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>), <span class="pl-k">-</span><span class="pl-k">&gt;</span>(<span class="pl-c1">0.0</span>, <span class="pl-c1">1.0</span>), <span class="pl-k">-</span><span class="pl-k">&gt;</span>(<span class="pl-c1">1.0</span>, <span class="pl-c1">0.0</span>), <span class="pl-k">-</span><span class="pl-k">&gt;</span>(<span class="pl-c1">1.0</span>, <span class="pl-c1">1.0</span>))
<span class="pl-k">val</span> <span class="pl-en">ys</span> <span class="pl-k">=</span> <span class="pl-k">--</span><span class="pl-k">&gt;</span>(<span class="pl-k">-</span><span class="pl-k">&gt;</span>(<span class="pl-c1">0.0</span>), <span class="pl-k">-</span><span class="pl-k">&gt;</span>(<span class="pl-c1">1.0</span>), <span class="pl-k">-</span><span class="pl-k">&gt;</span>(<span class="pl-c1">1.0</span>), <span class="pl-k">-</span><span class="pl-k">&gt;</span>(<span class="pl-c1">0.0</span>))
net.train(xs, ys) <span class="pl-c"><span class="pl-c">//</span> it's the XOR-Function :-)</span></pre>
  </div> 
  <p>The training progress will appear on console so we can track it. If you want to visualize the error function graph during training, you can pipe the <code>ErrorFuncOutput</code> to any <code>file</code> like this:</p> 
  <div class="highlight highlight-source-scala">
   <pre>    <span class="pl-en">Settings</span>(
      errorFuncOutput <span class="pl-k">=</span> <span class="pl-en">Some</span>(<span class="pl-en">ErrorFuncOutput</span>(
        file <span class="pl-k">=</span> <span class="pl-en">Some</span>(<span class="pl-s"><span class="pl-pds">"</span>~/NF/errorFunc.txt<span class="pl-pds">"</span></span>), 
        closure <span class="pl-k">=</span> <span class="pl-en">Some</span>(error <span class="pl-k">=&gt;</span> proceed(error))))
    )</pre>
  </div> 
  <p>Let's use beloved gnuplot to come up with a plot of our error function over time:</p> 
  <div class="highlight highlight-source-shell">
   <pre>gnuplot<span class="pl-k">&gt;</span> <span class="pl-c1">set</span> style line 1 lc rgb <span class="pl-s"><span class="pl-pds">'</span>#0060ad<span class="pl-pds">'</span></span> lt 1 lw 1 pt 7 ps 0.5 
gnuplot<span class="pl-k">&gt;</span> plot <span class="pl-s"><span class="pl-pds">'</span>~/NF/errorFunc.txt<span class="pl-pds">'</span></span> with linespoints ls 1</pre>
  </div> 
  <p><a href="https://raw.githubusercontent.com/zenecture/zenecture-docs/master/neuroflow/errgraph.png" target="_blank"><img src="https://raw.githubusercontent.com/zenecture/zenecture-docs/master/neuroflow/errgraph.png" width="400" height="400" style="max-width:100%;"></a></p> 
  <p>If you want to be more flexible, e.g. piping the error over the wire to a real-time dashboard, you can provide a <code>closure</code> of type <code>Double =&gt; Unit</code> that gets asynchronously executed with the respective error as input after each training epoch.</p> 
  <h1><a id="user-content-evaluation" class="anchor" href="https://github.com/zenecture/neuroflow#evaluation" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Evaluation</h1> 
  <p>Our trained net can be evaluated with the <code>evaluate</code> method.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">result</span> <span class="pl-k">=</span> net.evaluate(<span class="pl-k">-</span><span class="pl-k">&gt;</span>(<span class="pl-c1">0.0</span>, <span class="pl-c1">1.0</span>))
<span class="pl-c"><span class="pl-c">//</span> result: Vector(0.9785958704533262)</span></pre>
  </div> 
  <p>This will give us a result vector with the dimension of our specified output layer.</p> 
  <h1><a id="user-content-io" class="anchor" href="https://github.com/zenecture/neuroflow#io" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>IO</h1> 
  <p>Using <code>neuroflow.application.plugin.IO</code> we can store the weights represented as JSON strings. Look at this:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">file</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>/path/to/net.nf<span class="pl-pds">"</span></span>
<span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">wp</span> <span class="pl-k">=</span> <span class="pl-en">IO</span>.<span class="pl-en">File</span>.read(file)
<span class="pl-k">val</span> <span class="pl-en">net</span> <span class="pl-k">=</span> <span class="pl-en">Network</span>(layers)
<span class="pl-en">IO</span>.<span class="pl-en">File</span>.write(net, file)</pre>
  </div> 
  <p>Here, <code>IO.File.read</code> will yield an implicit <code>WeightProvider</code> from file to construct a net. Afterwards, the weights will be saved to the same file with <code>IO.File.write</code>. If the desired target is a database, simply use <code>IO.Json.write</code> instead and save it as a raw JSON string. However, all important types extend <code>Serializable</code>, so feel free to work with the bytes on your own.</p> 
 </article>
</div>