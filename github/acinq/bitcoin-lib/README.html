<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-simple-scala-bitcoin-library" class="anchor" href="https://github.com/acinq/bitcoin-lib#simple-scala-bitcoin-library" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Simple Scala Bitcoin Library</h1> 
  <p>Simple bitcoin library written in Scala.</p> 
  <p><a href="https://travis-ci.org/ACINQ/bitcoin-lib" target="_blank"><img src="https://camo.githubusercontent.com/4a5bc682968704de8403575449a64931371f89a2/68747470733a2f2f7472617669732d63692e6f72672f4143494e512f626974636f696e2d6c69622e706e67" alt="Build Status" data-canonical-src="https://travis-ci.org/ACINQ/bitcoin-lib.png" style="max-width:100%;"></a></p> 
  <h2><a id="user-content-overview" class="anchor" href="https://github.com/acinq/bitcoin-lib#overview" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Overview</h2> 
  <p>This is a simple scala library which implements most of the bitcoin protocol:</p> 
  <ul> 
   <li>base58 encoding/decoding</li> 
   <li>block headers, block and tx parsing</li> 
   <li>tx creation, signature and verification</li> 
   <li>script parsing and execution (including OP_CLTV and OP_CSV)</li> 
   <li>pay to public key tx</li> 
   <li>pay to script tx / multisig tx</li> 
   <li>BIP 32 (deterministic wallets)</li> 
   <li>BIP 39 (mnemonic code for generating deterministic keys)</li> 
   <li>BIP 70</li> 
  </ul> 
  <h2><a id="user-content-objectives" class="anchor" href="https://github.com/acinq/bitcoin-lib#objectives" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Objectives</h2> 
  <p>Our goal is not to re-implement a full Bitcoin node but to build a library that can be used to build applications that rely on bitcoind to interface with the Bitcoin network (to retrieve and index transactions and blocks, for example...). We use it very often to build quick prototypes and test new ideas. Besides, some parts of the protocole are fairly simple and "safe" to re-implement (BIP32/BIP39 for example), especially for indexing/analysis purposes. And, of course, we use it for our own work on Lightning.</p> 
  <h2><a id="user-content-status" class="anchor" href="https://github.com/acinq/bitcoin-lib#status" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Status</h2> 
  <ul class="contains-task-list"> 
   <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked disabled> Message parsing (blocks, transactions, inv, ...)</li> 
   <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked disabled> Building transactions (P2PK, P2PKH, P2SH, P2WPK, P2WSH)</li> 
   <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked disabled> Signing transactions</li> 
   <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked disabled> Verifying signatures</li> 
   <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked disabled> Passing core reference tests (scripts &amp; transactions)</li> 
   <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked disabled> Passing core reference segwit tests</li> 
  </ul> 
  <h2><a id="user-content-configuring-mavensbt" class="anchor" href="https://github.com/acinq/bitcoin-lib#configuring-mavensbt" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Configuring maven/sbt</h2> 
  <ul> 
   <li>releases and milestones are pushed to maven central</li> 
   <li>snapshots are pushed to the sonatype snapshot repository</li> 
  </ul> 
  <div class="highlight highlight-text-xml">
   <pre> &lt;<span class="pl-ent">repositories</span>&gt;
    &lt;<span class="pl-ent">repository</span>&gt;
        &lt;<span class="pl-ent">id</span>&gt;sonatype snapshots&lt;/<span class="pl-ent">id</span>&gt;
        &lt;<span class="pl-ent">url</span>&gt;https://oss.sonatype.org/content/repositories/snapshots/&lt;/<span class="pl-ent">url</span>&gt;
    &lt;/<span class="pl-ent">repository</span>&gt;
&lt;/<span class="pl-ent">repositories</span>&gt;

&lt;<span class="pl-ent">dependencies</span>&gt;
  &lt;<span class="pl-ent">dependency</span>&gt;
    &lt;<span class="pl-ent">groupId</span>&gt;fr.acinq&lt;/<span class="pl-ent">groupId</span>&gt;
    &lt;<span class="pl-ent">artifactId</span>&gt;bitcoin-lib_2.11&lt;/<span class="pl-ent">artifactId</span>&gt;
    &lt;<span class="pl-ent">version</span>&gt;0.9.9&lt;/<span class="pl-ent">version</span>&gt;
  &lt;/<span class="pl-ent">dependency</span>&gt;
&lt;/<span class="pl-ent">dependencies</span>&gt;</pre>
  </div> 
  <p>The latest snapshot (development) version is 0.9.10-SNAPSHOT, the latest released version is 0.9.9</p> 
  <h2><a id="user-content-segwit-support" class="anchor" href="https://github.com/acinq/bitcoin-lib#segwit-support" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Segwit support</h2> 
  <p>Bitcoin-lib, starting with version 0.9.7, fully supports segwit (see below for more information) and is on par with the segwit code in Bitcoin Core 0.13.1.</p> 
  <h2><a id="user-content-usage" class="anchor" href="https://github.com/acinq/bitcoin-lib#usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h2> 
  <p>Please have a look at unit tests, more samples will be added soon.</p> 
  <h3><a id="user-content-basic-type-public-keys-private-keys-addresses" class="anchor" href="https://github.com/acinq/bitcoin-lib#basic-type-public-keys-private-keys-addresses" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Basic type: public keys, private keys, addresses</h3> 
  <p>We defined only a limited set of specific types (private keys, public keys). There is a simple BinaryData type that can be used to convert to/from Array[Byte], Seq[Byte], and hexadecimal Strings.</p> 
  <p>As much as possible, the library uses and produces raw binary data, without fancy wrapper types and encoding. This should make importing/exporting data from/to other libraries easy. It also makes it easy to use binary data used in examples, books, or produced by debugging tools.</p> 
  <p>The following REPL session shows how to create and use keys and addresses:</p> 
  <div class="highlight highlight-source-shell">
   <pre>mvn scala:console
scala<span class="pl-k">&gt;</span> import fr.acinq.bitcoin._
import fr.acinq.bitcoin._

scala<span class="pl-k">&gt;</span> import fr.acinq.bitcoin.Crypto._
import fr.acinq.bitcoin.Crypto._

scala<span class="pl-k">&gt;</span> val priv = PrivateKey(BinaryData(<span class="pl-s"><span class="pl-pds">"</span>1e99423a4ed27608a15a2616a2b0e9e52ced330ac530edcc32c8ffc6a526aedd<span class="pl-pds">"</span></span>), compressed = true)
priv: fr.acinq.bitcoin.Crypto.PrivateKey = 1e99423a4ed27608a15a2616a2b0e9e52ced330ac530edcc32c8ffc6a526aedd01

scala<span class="pl-k">&gt;</span> val priv = PrivateKey(BinaryData(<span class="pl-s"><span class="pl-pds">"</span>1e99423a4ed27608a15a2616a2b0e9e52ced330ac530edcc32c8ffc6a526aedd<span class="pl-pds">"</span></span>), compressed = false)
priv: fr.acinq.bitcoin.Crypto.PrivateKey = 1e99423a4ed27608a15a2616a2b0e9e52ced330ac530edcc32c8ffc6a526aedd

scala<span class="pl-k">&gt;</span> val pubUncompressed = priv.publicKey
pubUncompressed: fr.acinq.bitcoin.Crypto.PublicKey = 04f028892bad7ed57d2fb57bf33081d5cfcf6f9ed3d3d7f159c2e2fff579dc341a07cf33da18bd734c600b96a72bbc4749d5141c90ec8ac328ae52ddfe2e505bdb

scala<span class="pl-k">&gt;</span> Base58Check.encode(Base58.Prefix.PubkeyAddress, pubUncompressed.hash160)
res0: String = 1424C2F4bC9JidNjjTUZCbUxv6Sa1Mt62x

scala<span class="pl-k">&gt;</span> val pubCompressed = priv.publicKey.copy(compressed = true)
pubCompressed: fr.acinq.bitcoin.Crypto.PublicKey = 03f028892bad7ed57d2fb57bf33081d5cfcf6f9ed3d3d7f159c2e2fff579dc341a

scala<span class="pl-k">&gt;</span> Base58Check.encode(Base58.Prefix.PubkeyAddress, pubCompressed.hash160)
res1: String = 1J7mdg5rbQyUHENYdx39WVWK7fsLpEoXZy

scala<span class="pl-k">&gt;</span> Base58Check.encode(Base58.Prefix.SecretKey, priv.toBin)
res2: String = 5J3mBbAH58CpQ3Y5RNJpUKPE62SQ5tfcvU2JpbnkeyhfsYB1Jcn

scala<span class="pl-k">&gt;</span> Base58Check.encode(Base58.Prefix.SecretKey, priv.copy(compressed = true).toBin)
res3: String = KxFC1jmwwCoACiCAWZ3eXa96mBM6tb3TYzGmf6YwgdGWZgawvrtJ</pre>
  </div> 
  <h3><a id="user-content-building-and-verifying-transactions" class="anchor" href="https://github.com/acinq/bitcoin-lib#building-and-verifying-transactions" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Building and verifying transactions</h3> 
  <p>The Transaction class can be used to create, serialize, deserialize, sign and validate bitcoin transactions.</p> 
  <h4><a id="user-content-p2pkh-transactions" class="anchor" href="https://github.com/acinq/bitcoin-lib#p2pkh-transactions" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>P2PKH transactions</h4> 
  <p>A P2PKH transactions sends bitcoins to a public key hash, using a standard P2PKH script:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">pkh</span> <span class="pl-k">=</span> pubKey.hash160
<span class="pl-k">val</span> <span class="pl-en">pubKeyScript</span> <span class="pl-k">=</span> <span class="pl-en">OP_DUP</span> <span class="pl-k">::</span> <span class="pl-en">OP_HASH160</span> <span class="pl-k">::</span> <span class="pl-en">OP_PUSHDATA</span>(pkh) <span class="pl-k">::</span> <span class="pl-en">OP_EQUALVERIFY</span> <span class="pl-k">::</span> <span class="pl-en">OP_CHECKSIG</span> <span class="pl-k">::</span> <span class="pl-c1">Nil</span></pre>
  </div> 
  <p>To spend it, just provide a signature and the public key:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">sigScript</span> <span class="pl-k">=</span> <span class="pl-en">OP_PUSHDATA</span>(sig) <span class="pl-k">::</span> <span class="pl-en">OP_PUSHDATA</span>(pubKey.toBin) <span class="pl-k">::</span> <span class="pl-c1">Nil</span></pre>
  </div> 
  <p>This sample demonstrates how to serialize, create and verify simple P2PKH transactions.</p> 
  <div class="highlight highlight-source-scala">
   <pre>  <span class="pl-c"><span class="pl-c">//</span> simple pay to PK tx</span>

  <span class="pl-c"><span class="pl-c">//</span> we have a tx that was sent to a public key that we own</span>
  <span class="pl-k">val</span> <span class="pl-en">to</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>mi1cMMSL9BZwTQZYpweE1nTmwRxScirPp3<span class="pl-pds">"</span></span>
  <span class="pl-k">val</span> (<span class="pl-en">Base58</span>.<span class="pl-en">Prefix</span>.<span class="pl-en">PubkeyAddressTestnet</span>, pubkeyHash) <span class="pl-k">=</span> <span class="pl-en">Base58Check</span>.decode(to)
  <span class="pl-k">val</span> <span class="pl-en">amount</span> <span class="pl-k">=</span> <span class="pl-c1">10000</span> satoshi

  <span class="pl-k">val</span> <span class="pl-en">privateKey</span> <span class="pl-k">=</span> <span class="pl-en">PrivateKey</span>.fromBase58(<span class="pl-s"><span class="pl-pds">"</span>cRp4uUnreGMZN8vB7nQFX6XWMHU5Lc73HMAhmcDEwHfbgRS66Cqp<span class="pl-pds">"</span></span>, <span class="pl-en">Base58</span>.<span class="pl-en">Prefix</span>.<span class="pl-en">SecretKeyTestnet</span>)
  <span class="pl-k">val</span> <span class="pl-en">publicKey</span> <span class="pl-k">=</span> privateKey.publicKey

  <span class="pl-k">val</span> <span class="pl-en">previousTx</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>.read(<span class="pl-s"><span class="pl-pds">"</span>0100000001b021a77dcaad3a2da6f1611d2403e1298a902af8567c25d6e65073f6b52ef12d000000006a473044022056156e9f0ad7506621bc1eb963f5133d06d7259e27b13fcb2803f39c7787a81c022056325330585e4be39bcf63af8090a2deff265bc29a3fb9b4bf7a31426d9798150121022dfb538041f111bb16402aa83bd6a3771fa8aa0e5e9b0b549674857fafaf4fe0ffffffff0210270000000000001976a91415c23e7f4f919e9ff554ec585cb2a67df952397488ac3c9d1000000000001976a9148982824e057ccc8d4591982df71aa9220236a63888ac00000000<span class="pl-pds">"</span></span>)

  <span class="pl-c"><span class="pl-c">//</span> create a transaction where the sig script is the pubkey script of the tx we want to redeem</span>
  <span class="pl-c"><span class="pl-c">//</span> the pubkey script is just a wrapper around the pub key hash</span>
  <span class="pl-c"><span class="pl-c">//</span> what it means is that we will sign a block of data that contains txid + from + to + amount</span>

  <span class="pl-c"><span class="pl-c">//</span> step  #1: creation a new transaction that reuses the previous transaction's output pubkey script</span>
  <span class="pl-k">val</span> <span class="pl-en">tx1</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>(
    version <span class="pl-k">=</span> <span class="pl-c1">1L</span>,
    txIn <span class="pl-k">=</span> <span class="pl-en">List</span>(
      <span class="pl-en">TxIn</span>(<span class="pl-en">OutPoint</span>(previousTx, <span class="pl-c1">0</span>), signatureScript <span class="pl-k">=</span> <span class="pl-c1">Nil</span>, sequence <span class="pl-k">=</span> <span class="pl-c1">0xFFFFFFFFL</span>)
    ),
    txOut <span class="pl-k">=</span> <span class="pl-en">List</span>(
      <span class="pl-en">TxOut</span>(amount <span class="pl-k">=</span> amount, publicKeyScript <span class="pl-k">=</span> <span class="pl-en">OP_DUP</span> <span class="pl-k">::</span> <span class="pl-en">OP_HASH160</span> <span class="pl-k">::</span> <span class="pl-en">OP_PUSHDATA</span>(pubkeyHash) <span class="pl-k">::</span> <span class="pl-en">OP_EQUALVERIFY</span> <span class="pl-k">::</span> <span class="pl-en">OP_CHECKSIG</span> <span class="pl-k">::</span> <span class="pl-c1">Nil</span>)
    ),
    lockTime <span class="pl-k">=</span> <span class="pl-c1">0L</span>
  )

  <span class="pl-c"><span class="pl-c">//</span> step #2: sign the tx</span>
  <span class="pl-k">val</span> <span class="pl-en">sig</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>.signInput(tx1, <span class="pl-c1">0</span>, previousTx.txOut(<span class="pl-c1">0</span>).publicKeyScript, <span class="pl-en">SIGHASH_ALL</span>, privateKey)
  <span class="pl-k">val</span> <span class="pl-en">tx2</span> <span class="pl-k">=</span> tx1.updateSigScript(<span class="pl-c1">0</span>, <span class="pl-en">OP_PUSHDATA</span>(sig) <span class="pl-k">::</span> <span class="pl-en">OP_PUSHDATA</span>(publicKey) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>)

  <span class="pl-c"><span class="pl-c">//</span> redeem the tx</span>
  <span class="pl-en">Transaction</span>.correctlySpends(tx2, <span class="pl-en">Seq</span>(previousTx), <span class="pl-en">ScriptFlags</span>.<span class="pl-en">MANDATORY_SCRIPT_VERIFY_FLAGS</span>)</pre>
  </div> 
  <h4><a id="user-content-p2sh-transactions" class="anchor" href="https://github.com/acinq/bitcoin-lib#p2sh-transactions" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>P2SH transactions</h4> 
  <p>A P2SH transactions sends bitcoins to a script hash:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">redeemScript</span> <span class="pl-k">=</span> <span class="pl-en">Script</span>.createMultiSigMofN(<span class="pl-c1">2</span>, <span class="pl-en">Seq</span>(pub1, pub2, pub3 ))
<span class="pl-k">val</span> <span class="pl-en">multisigAddress</span> <span class="pl-k">=</span> <span class="pl-en">Crypto</span>.hash160(redeemScript)
<span class="pl-k">val</span> <span class="pl-en">publicKeyScript</span> <span class="pl-k">=</span> <span class="pl-en">OP_HASH160</span> <span class="pl-k">::</span> <span class="pl-en">OP_PUSHDATA</span>(multisigAddress) <span class="pl-k">::</span> <span class="pl-en">OP_EQUAL</span> <span class="pl-k">::</span> <span class="pl-c1">Nil</span></pre>
  </div> 
  <p>To spend it, you must provide data that will match the public key script, and the actual public key script. In our case, we need 2 valid signatures:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">redeemScript</span> <span class="pl-k">=</span> <span class="pl-en">Script</span>.createMultiSigMofN(<span class="pl-c1">2</span>, <span class="pl-en">Seq</span>(pub1, pub2, pub3 ))
<span class="pl-k">val</span> <span class="pl-en">sigScript</span> <span class="pl-k">=</span> <span class="pl-en">OP_0</span> <span class="pl-k">::</span> <span class="pl-en">OP_PUSHDATA</span>(sig1) <span class="pl-k">::</span> <span class="pl-en">OP_PUSHDATA</span>(sig2) <span class="pl-k">::</span> <span class="pl-en">OP_PUSHDATA</span>(redeemScript) <span class="pl-k">::</span> <span class="pl-c1">Nil</span></pre>
  </div> 
  <p>This sample demonstrates how to serialize, create and verify a multisig P2SH transaction</p> 
  <div class="highlight highlight-source-scala">
   <pre>  <span class="pl-k">val</span> <span class="pl-en">priv1</span> <span class="pl-k">=</span> <span class="pl-en">PrivateKey</span>.fromBase58(<span class="pl-s"><span class="pl-pds">"</span>QRY5zPUH6tWhQr2NwFXNpMbiLQq9u2ztcSZ6RwMPjyKv36rHP2xT<span class="pl-pds">"</span></span>, <span class="pl-en">Base58</span>.<span class="pl-en">Prefix</span>.<span class="pl-en">SecretKeySegnet</span>)
  <span class="pl-k">val</span> <span class="pl-en">pub1</span> <span class="pl-k">=</span> priv1.publicKey
  <span class="pl-k">val</span> <span class="pl-en">address1</span> <span class="pl-k">=</span> <span class="pl-en">Base58Check</span>.encode(<span class="pl-en">Base58</span>.<span class="pl-en">Prefix</span>.<span class="pl-en">PubkeyAddressSegnet</span>, pub1.hash160)

  assert(address1 <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>D6YX7dpieYu8j1bV8B4RgksNmDk3sNJ4Ap<span class="pl-pds">"</span></span>)

  <span class="pl-k">val</span> <span class="pl-en">priv2</span> <span class="pl-k">=</span> <span class="pl-en">PrivateKey</span>.fromBase58(<span class="pl-s"><span class="pl-pds">"</span>QUpr3G5ia7K7txSq5k7QpgTfNy33iTQWb1nAUgb77xFesn89xsoJ<span class="pl-pds">"</span></span>, <span class="pl-en">Base58</span>.<span class="pl-en">Prefix</span>.<span class="pl-en">SecretKeySegnet</span>)
  <span class="pl-k">val</span> <span class="pl-en">pub2</span> <span class="pl-k">=</span> priv2.publicKey

  <span class="pl-k">val</span> <span class="pl-en">priv3</span> <span class="pl-k">=</span> <span class="pl-en">PrivateKey</span>.fromBase58(<span class="pl-s"><span class="pl-pds">"</span>QX3AN7b3WCAFaiCvAS2UD7HJZBsFU6r5shjfogJu55411hAF3BVx<span class="pl-pds">"</span></span>, <span class="pl-en">Base58</span>.<span class="pl-en">Prefix</span>.<span class="pl-en">SecretKeySegnet</span>)
  <span class="pl-k">val</span> <span class="pl-en">pub3</span> <span class="pl-k">=</span> priv3.publicKey

  <span class="pl-c"><span class="pl-c">//</span> this is a standard tx that sends 0.5 BTC to D6YX7dpieYu8j1bV8B4RgksNmDk3sNJ4Ap</span>
  <span class="pl-k">val</span> <span class="pl-en">tx1</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>.read(<span class="pl-s"><span class="pl-pds">"</span>010000000240b4f27534e9d5529e67e52619c7addc88eff64c8e7afc9b41afe9a01c6e2aea010000006b48304502210091aed7fe956c4b2471778bfef5a323a96fee21ec6d73a9b7f363beaad135c5f302207f63b0ffc08fd905cdb87b109416c2d6d8ec56ca25dd52529c931aa1154277f30121037cb5789f1ca6c640b6d423ef71390e0b002da81db8fad4466bf6c2fdfb79a24cfeffffff6e21b8c625d9955e48de0a6bbcd57b03624620a93536ddacabc19d024c330f04010000006a47304402203fb779df3ae2bf8404e6d89f83af3adee0d0a0c4ec5a01a1e88b3aa4313df6490220608177ca82cf4f7da9820a8e8bf4266ccece9eb004e73926e414296d0635d7c1012102edc343e7c422e94cca4c2a87a4f7ce54594c1b68682bbeefa130295e471ac019feffffff0280f0fa02000000001976a9140f66351d05269952302a607b4d6fb69517387a9788ace06d9800000000001976a91457572594090c298721e8dddcec3ac1ec593c6dcc88ac205a0000<span class="pl-pds">"</span></span>)

  <span class="pl-c"><span class="pl-c">//</span> now let's create a simple tx that spends tx1 and send 0.5 BTC to a P2WSH output</span>
  <span class="pl-k">val</span> <span class="pl-en">tx2</span> <span class="pl-k">=</span> {
    <span class="pl-c"><span class="pl-c">//</span> our script is a 2-of-2 multisig script</span>
    <span class="pl-k">val</span> <span class="pl-en">redeemScript</span> <span class="pl-k">=</span> <span class="pl-en">Script</span>.createMultiSigMofN(<span class="pl-c1">2</span>, <span class="pl-en">Seq</span>(pub2, pub3))
    <span class="pl-k">val</span> <span class="pl-en">tmp</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>(version <span class="pl-k">=</span> <span class="pl-c1">1</span>,
      txIn <span class="pl-k">=</span> <span class="pl-en">TxIn</span>(<span class="pl-en">OutPoint</span>(tx1.hash, <span class="pl-c1">0</span>), sequence <span class="pl-k">=</span> <span class="pl-c1">0xffffffffL</span>, signatureScript <span class="pl-k">=</span> <span class="pl-c1">Nil</span>) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>,
      txOut <span class="pl-k">=</span> <span class="pl-en">TxOut</span>(<span class="pl-c1">0.49</span> btc, <span class="pl-en">Script</span>.pay2wsh(redeemScript)) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>,
      lockTime <span class="pl-k">=</span> <span class="pl-c1">0</span>
    )
    <span class="pl-en">Transaction</span>.sign(tmp, <span class="pl-en">Seq</span>(<span class="pl-en">SignData</span>(tx1.txOut(<span class="pl-c1">0</span>).publicKeyScript, priv1)))
  }
  <span class="pl-en">Transaction</span>.correctlySpends(tx2, <span class="pl-en">Seq</span>(tx1), <span class="pl-en">ScriptFlags</span>.<span class="pl-en">STANDARD_SCRIPT_VERIFY_FLAGS</span>)
  assert(tx2.txid <span class="pl-k">==</span> <span class="pl-en">BinaryData</span>(<span class="pl-s"><span class="pl-pds">"</span>9d896b6d2b8fc9665da72f5b1942f924a37c5c714f31f40ee2a6c945f74dd355<span class="pl-pds">"</span></span>))
  <span class="pl-c"><span class="pl-c">//</span> this tx was published on segnet as 9d896b6d2b8fc9665da72f5b1942f924a37c5c714f31f40ee2a6c945f74dd355</span>

  <span class="pl-c"><span class="pl-c">//</span> and now we create a segwit tx that spends the P2WSH output</span>
  <span class="pl-k">val</span> <span class="pl-en">tx3</span> <span class="pl-k">=</span> {
    <span class="pl-k">val</span> <span class="pl-en">tmp</span><span class="pl-k">:</span> <span class="pl-en">Transaction</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>(version <span class="pl-k">=</span> <span class="pl-c1">1</span>,
      txIn <span class="pl-k">=</span> <span class="pl-en">TxIn</span>(<span class="pl-en">OutPoint</span>(tx2.hash, <span class="pl-c1">0</span>), sequence <span class="pl-k">=</span> <span class="pl-c1">0xffffffffL</span>, signatureScript <span class="pl-k">=</span> <span class="pl-c1">Nil</span>) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>,
      txOut <span class="pl-k">=</span> <span class="pl-en">TxOut</span>(<span class="pl-c1">0.48</span> btc, <span class="pl-en">Script</span>.pay2wpkh(pub1)) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>,
      lockTime <span class="pl-k">=</span> <span class="pl-c1">0</span>
    )
    <span class="pl-k">val</span> <span class="pl-en">pubKeyScript</span> <span class="pl-k">=</span> <span class="pl-en">Script</span>.write(<span class="pl-en">Script</span>.createMultiSigMofN(<span class="pl-c1">2</span>, <span class="pl-en">Seq</span>(pub2, pub3)))
    <span class="pl-k">val</span> <span class="pl-en">sig2</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>.signInput(tmp, <span class="pl-c1">0</span>, pubKeyScript, <span class="pl-en">SIGHASH_ALL</span>, tx2.txOut(<span class="pl-c1">0</span>).amount, <span class="pl-en">SigVersion</span>.<span class="pl-en">SIGVERSION_WITNESS_V0</span>, priv2)
    <span class="pl-k">val</span> <span class="pl-en">sig3</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>.signInput(tmp, <span class="pl-c1">0</span>, pubKeyScript, <span class="pl-en">SIGHASH_ALL</span>, tx2.txOut(<span class="pl-c1">0</span>).amount, <span class="pl-en">SigVersion</span>.<span class="pl-en">SIGVERSION_WITNESS_V0</span>, priv3)
    <span class="pl-k">val</span> <span class="pl-en">witness</span> <span class="pl-k">=</span> <span class="pl-en">ScriptWitness</span>(<span class="pl-en">Seq</span>(<span class="pl-en">BinaryData</span>.empty, sig2, sig3, pubKeyScript))
    tmp.updateWitness(<span class="pl-c1">0</span>, witness)
  }

  <span class="pl-en">Transaction</span>.correctlySpends(tx3, <span class="pl-en">Seq</span>(tx2), <span class="pl-en">ScriptFlags</span>.<span class="pl-en">STANDARD_SCRIPT_VERIFY_FLAGS</span>)</pre>
  </div> 
  <h4><a id="user-content-p2wpk-transactions" class="anchor" href="https://github.com/acinq/bitcoin-lib#p2wpk-transactions" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>P2WPK transactions</h4> 
  <p>This is the simplest segwit transaction, equivalent to standard P2PKH transactions but more compact:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">pkh</span> <span class="pl-k">=</span> pubKey.hash160
<span class="pl-k">val</span> <span class="pl-en">pubKeyScript</span> <span class="pl-k">=</span> <span class="pl-en">OP_0</span> <span class="pl-k">::</span> <span class="pl-en">OP_PUSHDATA</span>(pkh) <span class="pl-k">::</span> <span class="pl-c1">Nil</span></pre>
  </div> 
  <p>To spend them, you provide a witness that is just a push of a signature and the actual public key:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">witness</span> <span class="pl-k">=</span> <span class="pl-en">ScriptWitness</span>(sig <span class="pl-k">::</span> pubKey <span class="pl-k">::</span> <span class="pl-c1">Nil</span>))</pre>
  </div> 
  <p>This sample demonstrates how to serialize, create and verify a P2WPK transaction</p> 
  <div class="highlight highlight-source-scala">
   <pre>  <span class="pl-k">val</span> <span class="pl-en">priv1</span> <span class="pl-k">=</span> <span class="pl-en">PrivateKey</span>.fromBase58(<span class="pl-s"><span class="pl-pds">"</span>QRY5zPUH6tWhQr2NwFXNpMbiLQq9u2ztcSZ6RwMPjyKv36rHP2xT<span class="pl-pds">"</span></span>, <span class="pl-en">Base58</span>.<span class="pl-en">Prefix</span>.<span class="pl-en">SecretKeySegnet</span>)
  <span class="pl-k">val</span> <span class="pl-en">pub1</span> <span class="pl-k">=</span> priv1.publicKey
  <span class="pl-k">val</span> <span class="pl-en">address1</span> <span class="pl-k">=</span> <span class="pl-en">Base58Check</span>.encode(<span class="pl-en">Base58</span>.<span class="pl-en">Prefix</span>.<span class="pl-en">PubkeyAddressSegnet</span>, pub1.hash160)

  assert(address1 <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>D6YX7dpieYu8j1bV8B4RgksNmDk3sNJ4Ap<span class="pl-pds">"</span></span>)

  <span class="pl-c"><span class="pl-c">//</span> this is a standard tx that sends 0.4 BTC to D6YX7dpieYu8j1bV8B4RgksNmDk3sNJ4Ap</span>
  <span class="pl-k">val</span> <span class="pl-en">tx1</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>.read(<span class="pl-s"><span class="pl-pds">"</span>010000000001014d5a1833ddd78613408d66b0189e3171aa3b5d1a5b2df4392749d39291ea73cd0000000000feffffff02005a6202000000001976a9140f66351d05269952302a607b4d6fb69517387a9788ac048b9800000000001976a914eb7c97a96fa9205b8a772d0c1d170e90a8a3098388ac02483045022100e2ccc1ab7e7e0c6bcbbdd4d9935448011b415fc1ec774416aa2760c3ae08431d022064ad6fd7c952df2b3f06a9cf94ddc9856c734c46ad43d0ab45d5ddf3b7deeef0012102edc343e7c422e94cca4c2a87a4f7ce54594c1b68682bbeefa130295e471ac019ae590000<span class="pl-pds">"</span></span>)

  <span class="pl-c"><span class="pl-c">//</span> now let's create a simple tx that spends tx1 and send 0.39 BTC to P2WPK output</span>
  <span class="pl-k">val</span> <span class="pl-en">tx2</span> <span class="pl-k">=</span> {
    <span class="pl-k">val</span> <span class="pl-en">tmp</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>(version <span class="pl-k">=</span> <span class="pl-c1">1</span>,
      txIn <span class="pl-k">=</span> <span class="pl-en">TxIn</span>(<span class="pl-en">OutPoint</span>(tx1.hash, <span class="pl-c1">0</span>), sequence <span class="pl-k">=</span> <span class="pl-c1">0xffffffffL</span>, signatureScript <span class="pl-k">=</span> <span class="pl-c1">Nil</span>, witness <span class="pl-k">=</span> <span class="pl-en">ScriptWitness</span>.empty) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>,
      txOut <span class="pl-k">=</span> <span class="pl-en">TxOut</span>(<span class="pl-c1">0.39</span> btc, <span class="pl-en">Script</span>.pay2wpkh(pub1)) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>,
      lockTime <span class="pl-k">=</span> <span class="pl-c1">0</span>
    )
    <span class="pl-en">Transaction</span>.sign(tmp, <span class="pl-en">Seq</span>(<span class="pl-en">SignData</span>(tx1.txOut(<span class="pl-c1">0</span>).publicKeyScript, priv1)))
  }
  <span class="pl-en">Transaction</span>.correctlySpends(tx2, <span class="pl-en">Seq</span>(tx1), <span class="pl-en">ScriptFlags</span>.<span class="pl-en">STANDARD_SCRIPT_VERIFY_FLAGS</span>)
  assert(tx2.txid <span class="pl-k">==</span> <span class="pl-en">BinaryData</span>(<span class="pl-s"><span class="pl-pds">"</span>3acf933cd1dbffbb81bb5c6fab816fdebf85875a3b77754a28f00d717f450e1e<span class="pl-pds">"</span></span>))
  <span class="pl-c"><span class="pl-c">//</span> this tx was published on segnet as 3acf933cd1dbffbb81bb5c6fab816fdebf85875a3b77754a28f00d717f450e1e</span>

  <span class="pl-c"><span class="pl-c">//</span> and now we create a segwit tx that spends the P2WPK output</span>
  <span class="pl-k">val</span> <span class="pl-en">tx3</span> <span class="pl-k">=</span> {
    <span class="pl-k">val</span> <span class="pl-en">tmp</span><span class="pl-k">:</span> <span class="pl-en">Transaction</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>(version <span class="pl-k">=</span> <span class="pl-c1">1</span>,
      txIn <span class="pl-k">=</span> <span class="pl-en">TxIn</span>(<span class="pl-en">OutPoint</span>(tx2.hash, <span class="pl-c1">0</span>), sequence <span class="pl-k">=</span> <span class="pl-c1">0xffffffffL</span>, signatureScript <span class="pl-k">=</span> <span class="pl-c1">Nil</span>, witness <span class="pl-k">=</span> <span class="pl-en">ScriptWitness</span>.empty) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>,
      txOut <span class="pl-k">=</span> <span class="pl-en">TxOut</span>(<span class="pl-c1">0.38</span> btc, <span class="pl-en">Script</span>.pay2wpkh(pub1)) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>, <span class="pl-c"><span class="pl-c">//</span> we reuse the same output script but if could be anything else</span>
      lockTime <span class="pl-k">=</span> <span class="pl-c1">0</span>
    )
    <span class="pl-c"><span class="pl-c">//</span> mind this: the pubkey script used for signing is not the prevout pubscript (which is just a push</span>
    <span class="pl-c"><span class="pl-c">//</span> of the pubkey hash), but the actual script that is evaluated by the script engine, in this case a PAY2PKH script</span>
    <span class="pl-k">val</span> <span class="pl-en">pubKeyScript</span> <span class="pl-k">=</span> <span class="pl-en">Script</span>.pay2pkh(pub1)
    <span class="pl-k">val</span> <span class="pl-en">sig</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>.signInput(tmp, <span class="pl-c1">0</span>, pubKeyScript, <span class="pl-en">SIGHASH_ALL</span>, tx2.txOut(<span class="pl-c1">0</span>).amount, <span class="pl-en">SigVersion</span>.<span class="pl-en">SIGVERSION_WITNESS_V0</span>, priv1)
    <span class="pl-k">val</span> <span class="pl-en">witness</span> <span class="pl-k">=</span> <span class="pl-en">ScriptWitness</span>(<span class="pl-en">Seq</span>(sig, pub1))
    tmp.updateWitness(<span class="pl-c1">0</span>, witness)
  }

  <span class="pl-en">Transaction</span>.correctlySpends(tx3, <span class="pl-en">Seq</span>(tx2), <span class="pl-en">ScriptFlags</span>.<span class="pl-en">STANDARD_SCRIPT_VERIFY_FLAGS</span>)
  <span class="pl-c"><span class="pl-c">//</span> this tx was published on segnet as a474219df20b95210b8dac45bb5ed49f0979f8d9b6c17420f3e50f6abc071af8</span></pre>
  </div> 
  <h4><a id="user-content-p2wsh-transactions" class="anchor" href="https://github.com/acinq/bitcoin-lib#p2wsh-transactions" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>P2WSH transactions</h4> 
  <p>P2WSH transactions are the segwit version of P2SH transactions:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">redeemScript</span> <span class="pl-k">=</span> <span class="pl-en">Script</span>.createMultiSigMofN(<span class="pl-c1">2</span>, <span class="pl-en">Seq</span>(pub2, pub3))
<span class="pl-k">val</span> <span class="pl-en">pubKeyScript</span> <span class="pl-k">=</span> <span class="pl-en">OP_0</span> <span class="pl-k">::</span> <span class="pl-en">OP_PUSHDATA</span>(<span class="pl-en">Crypto</span>.sha256(redeemScript)) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>,</pre>
  </div> 
  <p>To spend them, you provide data that wil match the publick key script, and the actual public key script:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">redeemScript</span> <span class="pl-k">=</span> <span class="pl-en">Script</span>.createMultiSigMofN(<span class="pl-c1">2</span>, <span class="pl-en">Seq</span>(pub2, pub3))
<span class="pl-k">val</span> <span class="pl-en">witness</span> <span class="pl-k">=</span> <span class="pl-en">ScriptWitness</span>(<span class="pl-en">Seq</span>(<span class="pl-en">BinaryData</span>.empty, sig2, sig3, redeemScript))</pre>
  </div> 
  <p>This sample demonstrates how to serialize, create and verify a P2WPSH transaction</p> 
  <div class="highlight highlight-source-scala">
   <pre>  <span class="pl-k">val</span> <span class="pl-en">priv1</span> <span class="pl-k">=</span> <span class="pl-en">PrivateKey</span>.fromBase58(<span class="pl-s"><span class="pl-pds">"</span>QRY5zPUH6tWhQr2NwFXNpMbiLQq9u2ztcSZ6RwMPjyKv36rHP2xT<span class="pl-pds">"</span></span>, <span class="pl-en">Base58</span>.<span class="pl-en">Prefix</span>.<span class="pl-en">SecretKeySegnet</span>)
  <span class="pl-k">val</span> <span class="pl-en">pub1</span> <span class="pl-k">=</span> priv1.publicKey
  <span class="pl-k">val</span> <span class="pl-en">address1</span> <span class="pl-k">=</span> <span class="pl-en">Base58Check</span>.encode(<span class="pl-en">Base58</span>.<span class="pl-en">Prefix</span>.<span class="pl-en">PubkeyAddressSegnet</span>, pub1.hash160)

  assert(address1 <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>D6YX7dpieYu8j1bV8B4RgksNmDk3sNJ4Ap<span class="pl-pds">"</span></span>)

  <span class="pl-k">val</span> <span class="pl-en">priv2</span> <span class="pl-k">=</span> <span class="pl-en">PrivateKey</span>.fromBase58(<span class="pl-s"><span class="pl-pds">"</span>QUpr3G5ia7K7txSq5k7QpgTfNy33iTQWb1nAUgb77xFesn89xsoJ<span class="pl-pds">"</span></span>, <span class="pl-en">Base58</span>.<span class="pl-en">Prefix</span>.<span class="pl-en">SecretKeySegnet</span>)
  <span class="pl-k">val</span> <span class="pl-en">pub2</span> <span class="pl-k">=</span> priv2.publicKey

  <span class="pl-k">val</span> <span class="pl-en">priv3</span> <span class="pl-k">=</span> <span class="pl-en">PrivateKey</span>.fromBase58(<span class="pl-s"><span class="pl-pds">"</span>QX3AN7b3WCAFaiCvAS2UD7HJZBsFU6r5shjfogJu55411hAF3BVx<span class="pl-pds">"</span></span>, <span class="pl-en">Base58</span>.<span class="pl-en">Prefix</span>.<span class="pl-en">SecretKeySegnet</span>)
  <span class="pl-k">val</span> <span class="pl-en">pub3</span> <span class="pl-k">=</span> priv3.publicKey

  <span class="pl-c"><span class="pl-c">//</span> this is a standard tx that sends 0.5 BTC to D6YX7dpieYu8j1bV8B4RgksNmDk3sNJ4Ap</span>
  <span class="pl-k">val</span> <span class="pl-en">tx1</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>.read(<span class="pl-s"><span class="pl-pds">"</span>010000000240b4f27534e9d5529e67e52619c7addc88eff64c8e7afc9b41afe9a01c6e2aea010000006b48304502210091aed7fe956c4b2471778bfef5a323a96fee21ec6d73a9b7f363beaad135c5f302207f63b0ffc08fd905cdb87b109416c2d6d8ec56ca25dd52529c931aa1154277f30121037cb5789f1ca6c640b6d423ef71390e0b002da81db8fad4466bf6c2fdfb79a24cfeffffff6e21b8c625d9955e48de0a6bbcd57b03624620a93536ddacabc19d024c330f04010000006a47304402203fb779df3ae2bf8404e6d89f83af3adee0d0a0c4ec5a01a1e88b3aa4313df6490220608177ca82cf4f7da9820a8e8bf4266ccece9eb004e73926e414296d0635d7c1012102edc343e7c422e94cca4c2a87a4f7ce54594c1b68682bbeefa130295e471ac019feffffff0280f0fa02000000001976a9140f66351d05269952302a607b4d6fb69517387a9788ace06d9800000000001976a91457572594090c298721e8dddcec3ac1ec593c6dcc88ac205a0000<span class="pl-pds">"</span></span>)

  <span class="pl-c"><span class="pl-c">//</span> now let's create a simple tx that spends tx1 and send 0.5 BTC to a P2WSH output</span>
  <span class="pl-k">val</span> <span class="pl-en">tx2</span> <span class="pl-k">=</span> {
    <span class="pl-c"><span class="pl-c">//</span> our script is a 2-of-2 multisig script</span>
    <span class="pl-k">val</span> <span class="pl-en">redeemScript</span> <span class="pl-k">=</span> <span class="pl-en">Script</span>.createMultiSigMofN(<span class="pl-c1">2</span>, <span class="pl-en">Seq</span>(pub2, pub3))
    <span class="pl-k">val</span> <span class="pl-en">tmp</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>(version <span class="pl-k">=</span> <span class="pl-c1">1</span>,
      txIn <span class="pl-k">=</span> <span class="pl-en">TxIn</span>(<span class="pl-en">OutPoint</span>(tx1.hash, <span class="pl-c1">0</span>), sequence <span class="pl-k">=</span> <span class="pl-c1">0xffffffffL</span>, signatureScript <span class="pl-k">=</span> <span class="pl-c1">Nil</span>) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>,
      txOut <span class="pl-k">=</span> <span class="pl-en">TxOut</span>(<span class="pl-c1">0.49</span> btc, <span class="pl-en">Script</span>.pay2wsh(redeemScript)) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>,
      lockTime <span class="pl-k">=</span> <span class="pl-c1">0</span>
    )
    <span class="pl-en">Transaction</span>.sign(tmp, <span class="pl-en">Seq</span>(<span class="pl-en">SignData</span>(tx1.txOut(<span class="pl-c1">0</span>).publicKeyScript, priv1)))
  }
  <span class="pl-en">Transaction</span>.correctlySpends(tx2, <span class="pl-en">Seq</span>(tx1), <span class="pl-en">ScriptFlags</span>.<span class="pl-en">STANDARD_SCRIPT_VERIFY_FLAGS</span>)
  assert(tx2.txid <span class="pl-k">==</span> <span class="pl-en">BinaryData</span>(<span class="pl-s"><span class="pl-pds">"</span>9d896b6d2b8fc9665da72f5b1942f924a37c5c714f31f40ee2a6c945f74dd355<span class="pl-pds">"</span></span>))
  <span class="pl-c"><span class="pl-c">//</span> this tx was published on segnet as 9d896b6d2b8fc9665da72f5b1942f924a37c5c714f31f40ee2a6c945f74dd355</span>

  <span class="pl-c"><span class="pl-c">//</span> and now we create a segwit tx that spends the P2WSH output</span>
  <span class="pl-k">val</span> <span class="pl-en">tx3</span> <span class="pl-k">=</span> {
    <span class="pl-k">val</span> <span class="pl-en">tmp</span><span class="pl-k">:</span> <span class="pl-en">Transaction</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>(version <span class="pl-k">=</span> <span class="pl-c1">1</span>,
      txIn <span class="pl-k">=</span> <span class="pl-en">TxIn</span>(<span class="pl-en">OutPoint</span>(tx2.hash, <span class="pl-c1">0</span>), sequence <span class="pl-k">=</span> <span class="pl-c1">0xffffffffL</span>, signatureScript <span class="pl-k">=</span> <span class="pl-c1">Nil</span>) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>,
      txOut <span class="pl-k">=</span> <span class="pl-en">TxOut</span>(<span class="pl-c1">0.48</span> btc, <span class="pl-en">Script</span>.pay2wpkh(pub1)) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>,
      lockTime <span class="pl-k">=</span> <span class="pl-c1">0</span>
    )
    <span class="pl-k">val</span> <span class="pl-en">pubKeyScript</span> <span class="pl-k">=</span> <span class="pl-en">Script</span>.write(<span class="pl-en">Script</span>.createMultiSigMofN(<span class="pl-c1">2</span>, <span class="pl-en">Seq</span>(pub2, pub3)))
    <span class="pl-k">val</span> <span class="pl-en">sig2</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>.signInput(tmp, <span class="pl-c1">0</span>, pubKeyScript, <span class="pl-en">SIGHASH_ALL</span>, tx2.txOut(<span class="pl-c1">0</span>).amount, <span class="pl-en">SigVersion</span>.<span class="pl-en">SIGVERSION_WITNESS_V0</span>, priv2)
    <span class="pl-k">val</span> <span class="pl-en">sig3</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>.signInput(tmp, <span class="pl-c1">0</span>, pubKeyScript, <span class="pl-en">SIGHASH_ALL</span>, tx2.txOut(<span class="pl-c1">0</span>).amount, <span class="pl-en">SigVersion</span>.<span class="pl-en">SIGVERSION_WITNESS_V0</span>, priv3)
    <span class="pl-k">val</span> <span class="pl-en">witness</span> <span class="pl-k">=</span> <span class="pl-en">ScriptWitness</span>(<span class="pl-en">Seq</span>(<span class="pl-en">BinaryData</span>.empty, sig2, sig3, pubKeyScript))
    tmp.updateWitness(<span class="pl-c1">0</span>, witness)
  }

  <span class="pl-en">Transaction</span>.correctlySpends(tx3, <span class="pl-en">Seq</span>(tx2), <span class="pl-en">ScriptFlags</span>.<span class="pl-en">STANDARD_SCRIPT_VERIFY_FLAGS</span>)
  assert(tx3.txid <span class="pl-k">==</span> <span class="pl-en">BinaryData</span>(<span class="pl-s"><span class="pl-pds">"</span>943e07f0c66a9766d0cec81d65a03db4157bc0bfac4d36e400521b947be55aeb<span class="pl-pds">"</span></span>))
  <span class="pl-c"><span class="pl-c">//</span> this tx was published on segnet as 943e07f0c66a9766d0cec81d65a03db4157bc0bfac4d36e400521b947be55aeb</span></pre>
  </div> 
  <h4><a id="user-content-segwit-transactions-embedded-in-standard-p2sh-transactions" class="anchor" href="https://github.com/acinq/bitcoin-lib#segwit-transactions-embedded-in-standard-p2sh-transactions" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Segwit transactions embedded in standard P2SH transactions</h4> 
  <div class="highlight highlight-source-scala">
   <pre>  <span class="pl-k">val</span> <span class="pl-en">priv1</span> <span class="pl-k">=</span> <span class="pl-en">PrivateKey</span>.fromBase58(<span class="pl-s"><span class="pl-pds">"</span>QRY5zPUH6tWhQr2NwFXNpMbiLQq9u2ztcSZ6RwMPjyKv36rHP2xT<span class="pl-pds">"</span></span>, <span class="pl-en">Base58</span>.<span class="pl-en">Prefix</span>.<span class="pl-en">SecretKeySegnet</span>)
  <span class="pl-k">val</span> <span class="pl-en">pub1</span> <span class="pl-k">=</span> priv1.publicKey

  <span class="pl-c"><span class="pl-c">//</span> p2wpkh script</span>
  <span class="pl-k">val</span> <span class="pl-en">script</span> <span class="pl-k">=</span> <span class="pl-en">Script</span>.write(<span class="pl-en">Script</span>.pay2wpkh(pub1))

  <span class="pl-c"><span class="pl-c">//</span> which we embeed into a standard p2sh script</span>
  <span class="pl-k">val</span> <span class="pl-en">p2shaddress</span> <span class="pl-k">=</span> <span class="pl-en">Base58Check</span>.encode(<span class="pl-en">Base58</span>.<span class="pl-en">Prefix</span>.<span class="pl-en">ScriptAddressSegnet</span>, <span class="pl-en">Crypto</span>.hash160(script))
  assert(p2shaddress <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>MDbNMghDbaaizHz8pSgMqu9qJXvKwouqkM<span class="pl-pds">"</span></span>)

  <span class="pl-c"><span class="pl-c">//</span> this tx send 0.5 btc to our p2shaddress</span>
  <span class="pl-k">val</span> <span class="pl-en">tx</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>.read(<span class="pl-s"><span class="pl-pds">"</span>010000000175dd435bf25e5d77567272f7d6eefcf37b7156b78bb233490140d6fa7545cfca010000006a47304402206e601a482b301141cb3a1712c18729fa1f1731fce5c4205ac9d344af38bb24bf022003fe70edcbd1a5b3957b3c939e583739eadb8de8d3d2cc2ad2903b19c991cb80012102ba2558223d7cd5df2d8decc4506a62ccaa96159f685360335c280952b25e7adefeffffff02692184df000000001976a9148b3ee15d631122010d31e1774aa318ca9ca8b67088ac80f0fa020000000017a9143e73638f202bb880a28e8df1946adc3058227d11878c730000<span class="pl-pds">"</span></span>)

  <span class="pl-c"><span class="pl-c">//</span> let's spend it:</span>

  <span class="pl-k">val</span> <span class="pl-en">tx1</span> <span class="pl-k">=</span> {
    <span class="pl-k">val</span> <span class="pl-en">tmp</span><span class="pl-k">:</span> <span class="pl-en">Transaction</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>(version <span class="pl-k">=</span> <span class="pl-c1">1</span>,
      txIn <span class="pl-k">=</span> <span class="pl-en">TxIn</span>(<span class="pl-en">OutPoint</span>(tx.hash, <span class="pl-c1">1</span>), sequence <span class="pl-k">=</span> <span class="pl-c1">0xffffffffL</span>, signatureScript <span class="pl-k">=</span> <span class="pl-en">Seq</span>.empty[<span class="pl-k">Byte</span>]) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>,
      txOut <span class="pl-k">=</span> <span class="pl-en">TxOut</span>(<span class="pl-c1">0.49</span> btc, <span class="pl-en">OP_0</span> <span class="pl-k">::</span> <span class="pl-en">OP_PUSHDATA</span>(pub1.hash160) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>,
      lockTime <span class="pl-k">=</span> <span class="pl-c1">0</span>
    )
    <span class="pl-k">val</span> <span class="pl-en">pubKeyScript</span> <span class="pl-k">=</span> <span class="pl-en">Script</span>.pay2pkh(pub1)
    <span class="pl-k">val</span> <span class="pl-en">sig</span> <span class="pl-k">=</span> <span class="pl-en">Transaction</span>.signInput(tmp, <span class="pl-c1">0</span>, pubKeyScript, <span class="pl-en">SIGHASH_ALL</span>, tx.txOut(<span class="pl-c1">1</span>).amount, <span class="pl-en">SigVersion</span>.<span class="pl-en">SIGVERSION_WITNESS_V0</span>, priv1)
    <span class="pl-k">val</span> <span class="pl-en">witness</span> <span class="pl-k">=</span> <span class="pl-en">ScriptWitness</span>(<span class="pl-en">Seq</span>(sig, pub1))
    tmp.updateSigScript(<span class="pl-c1">0</span>, <span class="pl-en">OP_PUSHDATA</span>(script) <span class="pl-k">::</span> <span class="pl-c1">Nil</span>).updateWitness(<span class="pl-c1">0</span>, witness)
  }

  <span class="pl-en">Transaction</span>.correctlySpends(tx1, <span class="pl-en">Seq</span>(tx), <span class="pl-en">ScriptFlags</span>.<span class="pl-en">STANDARD_SCRIPT_VERIFY_FLAGS</span>)
  assert(tx1.txid <span class="pl-k">==</span> <span class="pl-en">BinaryData</span>(<span class="pl-s"><span class="pl-pds">"</span>98f5668176b0c1b14653f96f71987fd325c3d46b9efb677ab0606ea5555791d5<span class="pl-pds">"</span></span>))
  <span class="pl-c"><span class="pl-c">//</span> this tx was published on segnet as 98f5668176b0c1b14653f96f71987fd325c3d46b9efb677ab0606ea5555791d5</span></pre>
  </div> 
  <h3><a id="user-content-wallet-features" class="anchor" href="https://github.com/acinq/bitcoin-lib#wallet-features" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Wallet features</h3> 
  <p>Bitcoin-lib provides and simple and complete implementation of BIP32 and BIP39.</p> 
  <h4><a id="user-content-hd-wallet-bip32" class="anchor" href="https://github.com/acinq/bitcoin-lib#hd-wallet-bip32" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>HD Wallet (BIP32)</h4> 
  <p>Let's play with the scala console and the first test vector from <a href="https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki" target="_blank">https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki</a></p> 
  <div class="highlight highlight-source-shell">
   <pre>mvn scala:console
[INFO] Scanning <span class="pl-k">for</span> projects...
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building bitcoin-lib 0.9.4-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] --- scala-maven-plugin:3.2.0:console (default-cli) @ bitcoin-lib_2.11 ---
[WARNING]  Expected all dependencies to require Scala version: 2.11.4
[WARNING]  fr.acinq:bitcoin-lib_2.11:0.9.4-SNAPSHOT requires scala version: 2.11.4
[WARNING]  com.github.scopt:scopt_2.11:3.2.0 requires scala version: 2.11.0
[WARNING] Multiple versions of scala libraries detected<span class="pl-k">!</span>
[WARNING] scala-maven-plugin cannot fork scala console<span class="pl-k">!!</span>  Running <span class="pl-k">in</span> process
Welcome to Scala version 2.11.1 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_31).
Type <span class="pl-k">in</span> expressions to have them evaluated.
Type :help <span class="pl-k">for</span> more information.

scala<span class="pl-k">&gt;</span> import fr.acinq.bitcoin._
import fr.acinq.bitcoin._

scala<span class="pl-k">&gt;</span> import fr.acinq.bitcoin.DeterministicWallet
DeterministicWallet   DeterministicWalletSpec

scala<span class="pl-k">&gt;</span> import fr.acinq.bitcoin.DeterministicWallet._
import fr.acinq.bitcoin.DeterministicWallet._

scala<span class="pl-k">&gt;</span> val m = generate(fromHexString(<span class="pl-s"><span class="pl-pds">"</span>000102030405060708090a0b0c0d0e0f<span class="pl-pds">"</span></span>))
m: fr.acinq.bitcoin.DeterministicWallet.ExtendedPrivateKey = ExtendedPrivateKey(e8f32e723decf4051aefac8e2c93c9c5b214313817cdb01a1494b917c8436b35,873dff81c02f525623fd1fe5167eac3a55a049de3d314bb42ee227ffed37d508,0,m,0)

scala<span class="pl-k">&gt;</span> encode(m, false)
res1: String = xprv9s21ZrQH143K3QTDL4LXw2F7HEK3wJUD2nW2nRk4stbPy6cq3jPPqjiChkVvvNKmPGJxWUtg6LnF5kejMRNNU3TGtRBeJgk33yuGBxrMPHi

scala<span class="pl-k">&gt;</span> publicKey(m)
res2: fr.acinq.bitcoin.DeterministicWallet.ExtendedPublicKey = ExtendedPublicKey(0339a36013301597daef41fbe593a02cc513d0b55527ec2df1050e2e8ff49c85c2,873dff81c02f525623fd1fe5167eac3a55a049de3d314bb42ee227ffed37d508,0,m,0)

scala<span class="pl-k">&gt;</span> encode(publicKey(m), false)
res3: String = xpub661MyMwAqRbcFtXgS5sYJABqqG9YLmC4Q1Rdap9gSE8NqtwybGhePY2gZ29ESFjqJoCu1Rupje8YtGqsefD265TMg7usUDFdp6W1EGMcet8

scala<span class="pl-k">&gt;</span> val priv = derivePrivateKey(m, hardened(0) :: 1L :: hardened(2) :: 2L :: Nil)
priv: fr.acinq.bitcoin.DeterministicWallet.ExtendedPrivateKey = ExtendedPrivateKey(0f479245fb19a38a1954c5c7c0ebab2f9bdfd96a17563ef28a6a4b1a2a764ef4,cfb71883f01676f587d023cc53a35bc7f88f724b1f8c2892ac1275ac822a3edd,4,m/0h/1/2h/2,4001020172)

scala<span class="pl-k">&gt;</span> encode(priv, false)
res5: String = xprvA2JDeKCSNNZky6uBCviVfJSKyQ1mDYahRjijr5idH2WwLsEd4Hsb2Tyh8RfQMuPh7f7RtyzTtdrbdqqsunu5Mm3wDvUAKRHSC34sJ7in334

scala<span class="pl-k">&gt;</span> encode(publicKey(priv), false)
res6: String = xpub6FHa3pjLCk84BayeJxFW2SP4XRrFd1JYnxeLeU8EqN3vDfZmbqBqaGJAyiLjTAwm6ZLRQUMv1ZACTj37sR62cfN7fe5JnJ7dh8zL4fiyLHV

scala<span class="pl-k">&gt;</span> val k2 = derivePrivateKey(m, hardened(0) :: 1L :: hardened(2) :: Nil)
k2: fr.acinq.bitcoin.DeterministicWallet.ExtendedPrivateKey = ExtendedPrivateKey(cbce0d719ecf7431d88e6a89fa1483e02e35092
af60c042b1df2ff59fa424dca,04466b9cc8e161e966409ca52986c584f07e9dc81f735db683c3ff6ec7b1503f,3,m/0h/1/2h,3203769081)

scala<span class="pl-k">&gt;</span> val K2 = publicKey(k2)
K2: fr.acinq.bitcoin.DeterministicWallet.ExtendedPublicKey = ExtendedPublicKey(0357bfe1e341d01c69fe5654309956cbea516822f
ba8a601743a012a7896ee8dc2,04466b9cc8e161e966409ca52986c584f07e9dc81f735db683c3ff6ec7b1503f,3,m/0h/1/2h,3203769081)

scala<span class="pl-k">&gt;</span> derivePublicKey(K2, 2L :: 1000000000L :: Nil)
res8: fr.acinq.bitcoin.DeterministicWallet.ExtendedPublicKey = ExtendedPublicKey(022a471424da5e657499d1ff51cb43c47481a03b1e77f951fe64cec9f5a48f7011,c783e67b921d2beb8f6b389cc646d7263b4145701dadd2161548a8b078e65e9e,5,m/0h/1/2h/2/1000000000,3632322520)

scala<span class="pl-k">&gt;</span> encode(derivePublicKey(K2, 2L :: 1000000000L :: Nil), false)
res10: String = xpub6H1LXWLaKsWFhvm6RVpEL9P4KfRZSW7abD2ttkWP3SSQvnyA8FSVqNTEcYFgJS2UaFcxupHiYkro49S8yGasTvXEYBVPamhGW6cFJodrTHy
</pre>
  </div> 
  <h4><a id="user-content-mnemonic-code-bip39" class="anchor" href="https://github.com/acinq/bitcoin-lib#mnemonic-code-bip39" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Mnemonic code (BIP39)</h4> 
  <div class="highlight highlight-source-shell">
   <pre>mvn scala:console
[INFO] Scanning <span class="pl-k">for</span> projects...
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building bitcoin-lib 0.9.4-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] --- scala-maven-plugin:3.2.0:console (default-cli) @ bitcoin-lib_2.11 ---
[WARNING]  Expected all dependencies to require Scala version: 2.11.6
[WARNING]  fr.acinq:bitcoin-lib_2.11:0.9.4-SNAPSHOT requires scala version: 2.11.6
[WARNING]  org.json4s:json4s-jackson_2.11:3.2.11 requires scala version: 2.11.0
[WARNING] Multiple versions of scala libraries detected<span class="pl-k">!</span>
[WARNING] scala-maven-plugin cannot fork scala console<span class="pl-k">!!</span>  Running <span class="pl-k">in</span> process
Welcome to Scala version 2.11.6 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_45).
Type <span class="pl-k">in</span> expressions to have them evaluated.
Type :help <span class="pl-k">for</span> more information.

scala<span class="pl-k">&gt;</span> import fr.acinq.bitcoin._
import fr.acinq.bitcoin._

scala<span class="pl-k">&gt;</span> import MnemonicCode._
import MnemonicCode._

scala<span class="pl-k">&gt;</span> val mnemonics = toMnemonics(fromHexString(<span class="pl-s"><span class="pl-pds">"</span>77c2b00716cec7213839159e404db50d<span class="pl-pds">"</span></span>))
mnemonics: List[String] = List(jelly, better, achieve, collect, unaware, mountain, thought, cargo, oxygen, act, hood, bridge)

scala<span class="pl-k">&gt;</span> val key:BinaryData = toSeed(mnemonics, <span class="pl-s"><span class="pl-pds">"</span>TREZOR<span class="pl-pds">"</span></span>)
key: fr.acinq.bitcoin.BinaryData = b5b6d0127db1a9d2226af0c3346031d77af31e918dba64287a1b44b8ebf63cdd52676f672a290aae502472cf2d602c051f3e6f18055e84e4c43
897fc4e51a6ff</pre>
  </div> 
 </article>
</div>