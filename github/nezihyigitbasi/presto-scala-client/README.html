<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <p>##scala-presto</p> 
  <p>scala-presto is a Scala client for the <a href="http://prestodb.io/" target="_blank">Presto</a> SQL engine. The client exposes three easy to use interfaces: a cursor interface, a callback interface, and an actor interface.</p> 
  <p>##Usage</p> 
  <p>###Cursor Usage</p> 
  <p>####Print the raw query results</p> 
  <pre><code>client.submitQuery(query).foreach {
  queryResult =&gt; println(queryResult)
}
</code></pre> 
  <p>####Print each list of data in the results</p> 
  <pre><code>client.submitQuery(query).filter {
  result =&gt; result.getData != null
}.foreach {
  result =&gt; result.getData.asScala.foreach {
    println
  }
}
</code></pre> 
  <p>####Can also use for-comprehensions</p> 
  <pre><code>val data = for {
  queryResult &lt;- client.submitQuery(query) if queryResult.getData != null
} yield queryResult.getData.asScala

val nRows = data.foldLeft(0)((c,list) =&gt; c + list.size)
println(s"${nRows} rows retrieved")
</code></pre> 
  <p>###Callback Usage</p> 
  <pre><code>client.submitQuery(query,
  queryResult =&gt; {
    println(s"got result ${queryResult}")
  })
</code></pre> 
  <p>###Actor Usage</p> 
  <pre><code>class ClientActor (prestoActor: ActorRef) extends Actor {
  def receive = {
    case QUERY_RESULTS (queryResults) =&gt; {
      if(queryResults.getData != null) {
        queryResults.getData.asScala.map(data =&gt; {
          println(data)
        })
      }
      if (queryResults.getNextUri == null) { //no more results
        println("Shutting down actor system")
        context.system.shutdown()
      }
    }
    case SUBMIT_QUERY (query) =&gt; {
      prestoActor ! SUBMIT_QUERY(query)
    }
    case _ =&gt;  println("Unknown message")
  }
}

object ActorSample extends BaseSample{
  def main(args: Array[String]) {
    val client = createPrestoClient(args)
    val query = args(0)
    val schema = args(1)
    val catalog = args(2)

    println(s"Will run query=${query} on schema=${schema} catalog=${catalog}")
    val system = ActorSystem("PrestoTestActorSystem")
    val prestoActor = system.actorOf(Props(new PrestoActor(client.config)), name = "presto_actor")
    val prestoClientActor = system.actorOf(Props(new ClientActor(prestoActor)), name = "client_actor")
    prestoClientActor ! SUBMIT_QUERY(query)
  }
}
</code></pre> 
  <p>###Other Functionality</p> 
  <p>####Query Statistics</p> 
  <pre><code>val cursor = client.submitQuery(query)
cursor.foreach {
  queryResult =&gt; println(queryResult)
}

println("Query statistics:")
client.getQueryStatistics(queryId, statistics =&gt;
  for ((key,value) &lt;- statistics)
    println(s"${key} =&gt; ${value}")
)
</code></pre> 
  <p>####Getting All Nodes</p> 
  <pre><code>client.forEachPrestoNode(prestoNode =&gt; println(prestoNode))
</code></pre> 
  <p>##Using the Library Add the following dependency to your build script</p> 
  <pre><code>"com.github.nezihyigitbasi" %% "presto-scala-client" % "0.2"
</code></pre> 
  <p>##Building from the Source</p> 
  <pre><code>sbt doc package
</code></pre> 
 </article>
</div>