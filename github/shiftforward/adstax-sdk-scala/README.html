<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-adstax-scala-sdk--" class="anchor" href="https://github.com/shiftforward/adstax-sdk-scala#adstax-scala-sdk--" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>AdStax Scala SDK <a href="https://travis-ci.org/ShiftForward/adstax-sdk-scala" target="_blank"><img src="https://camo.githubusercontent.com/f2f8446256b8bb71ff1b2c97a504a49185d30541/68747470733a2f2f7472617669732d63692e6f72672f5368696674466f72776172642f6164737461782d73646b2d7363616c612e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/ShiftForward/adstax-sdk-scala.svg?branch=master" style="max-width:100%;"></a> <a href="https://maven-badges.herokuapp.com/maven-central/eu.shiftforward/adstax-sdk-scala_2.11" target="_blank"><img src="https://camo.githubusercontent.com/f7f693e38c1c00cd7b5953072ffc0bc97a95d422/68747470733a2f2f696d672e736869656c64732e696f2f6d6176656e2d63656e7472616c2f762f65752e7368696674666f72776172642f6164737461782d73646b2d7363616c615f322e31312e737667" alt="Maven Central" data-canonical-src="https://img.shields.io/maven-central/v/eu.shiftforward/adstax-sdk-scala_2.11.svg" style="max-width:100%;"></a></h1> 
  <p>The AdStax Scala SDK provides tools for programmatic interaction with an AdStax instance using Scala. Please take into account that the SDK is still in an experimental stage and the interfaces might change for subsequent releases.</p> 
  <h2><a id="user-content-installation" class="anchor" href="https://github.com/shiftforward/adstax-sdk-scala#installation" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Installation</h2> 
  <p>The latest release of AdStax Scala SDK is <code>0.5.3</code> and is built against Scala 2.11.</p> 
  <p>To use it in an existing SBT project, add the following dependency to your <code>build.sbt</code>:</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>eu.shiftforward<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>adstax-sdk-scala<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.5.3<span class="pl-pds">"</span></span></pre>
  </div> 
  <p>If you need to interact with Spark in an AdStax instance, you also need to add:</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>eu.shiftforward<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>adstax-sdk-scala-spark<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.5.0<span class="pl-pds">"</span></span></pre>
  </div> 
  <h2><a id="user-content-usage" class="anchor" href="https://github.com/shiftforward/adstax-sdk-scala#usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h2> 
  <h3><a id="user-content-products" class="anchor" href="https://github.com/shiftforward/adstax-sdk-scala#products" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Products</h3> 
  <p>Product details can be manipulated by using an instance of <code>ProductFeederClient</code>. A <code>ProductFeederClient</code> supplies the following interface:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">trait</span> <span class="pl-en">ProductFeederClient</span> {
  <span class="pl-k">def</span> <span class="pl-en">getProduct</span>(
    <span class="pl-v">clientId</span>: <span class="pl-k">String</span>,
    <span class="pl-v">siteId</span>: <span class="pl-k">String</span>,
    <span class="pl-v">productId</span>: <span class="pl-k">String</span>)<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">Option</span>[<span class="pl-en">ProductItem</span>]]

  <span class="pl-k">def</span> <span class="pl-en">updateProduct</span>(
    <span class="pl-v">clientId</span>: <span class="pl-k">String</span>,
    <span class="pl-v">siteId</span>: <span class="pl-k">String</span>,
    <span class="pl-v">productId</span>: <span class="pl-k">String</span>,
    <span class="pl-v">productAttributes</span>: <span class="pl-en">Map</span>[<span class="pl-k">String</span>, <span class="pl-en">Any</span>])<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-k">Boolean</span>]

  <span class="pl-k">def</span> <span class="pl-en">deleteProduct</span>(
    <span class="pl-v">clientId</span>: <span class="pl-k">String</span>,
    <span class="pl-v">siteId</span>: <span class="pl-k">String</span>,
    <span class="pl-v">productId</span>: <span class="pl-k">String</span>)<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-k">Boolean</span>]
}</pre>
  </div> 
  <p>The <code>getProduct</code> method returns a <code>Future</code> of an optional <code>ProductItem</code> that stores product information. The <code>updateProduct</code> method allows one to create or update the attributes associated with a given product, returning a <code>Future</code> of a <code>Boolean</code> that signals that the update was successful. The <code>deleteProduct</code> method allows one to delete a given product, returning a <code>Future</code> of a <code>Boolean</code> that signals that the update was successful.</p> 
  <p>The <code>ProductItem</code> class is something that represents a product through its id, a map of attributes and a last updated timestamp:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">ProductItem</span>(<span class="pl-v">id</span>: <span class="pl-k">String</span>, <span class="pl-v">attributes</span>: <span class="pl-en">Map</span>[<span class="pl-k">String</span>, <span class="pl-en">Any</span>], <span class="pl-v">lastUpdated</span>: <span class="pl-en">DateTime</span>)</pre>
  </div> 
  <p>The AdStax Scala SDK provides an implementation of <code>ProductFeederClient</code> using a RPC system built around AdStax <a href="https://www.amqp.org/" target="_blank">AMQP-compatible</a> message bus. In order to create a <code>ProductFeederAmqpRpcClient</code> it is necessary to have access to a <a href="http://doc.akka.io/api/akka/2.4.4/index.html#akka.actor.ActorRefFactory" target="_blank"><code>ActorRefFactory</code></a> from Akka. <code>ActorSystem</code> and <code>AkkaContext</code> both implement <code>ActorRefFactory</code>. You must also provide the configuration parameters both for AMQP and the RPC protocol. These are supplied as domain objects, which are loaded from <a href="https://typesafehub.github.io/config/latest/api/com/typesafe/config/Config.html" target="_blank">Typesafe config</a> objects using <a href="https://github.com/melrief/pureconfig" target="_blank">PureConfig</a>. The <code>config.RabbitMQ</code> object should provide definitions for the <code>host</code>, <code>port</code>, <code>username</code>, <code>password</code> and <code>timeout</code> (for the operations). Here's the default configuration object that is loaded from <code>reference.conf</code>:</p> 
  <pre><code>{
  host = "localhost"
  port = 5672
  username = "guest"
  password = "guest"
  timeout = 5m
}
</code></pre> 
  <p>The RPC protocol needs to be configured at the level of the AMQP exchange name and routing key prefix to use in the requests. Here's the default configuration object:</p> 
  <pre><code>{
  exchange-name = "sf.data"
  routing-key-prefix = "productfeeder."
}
</code></pre> 
  <p>The <code>ProductFeederAmqpRpcClient</code> constructor also requires an implicit <code>ExecutionContext</code> to deal with futures. Here's how you create a product feeder client and interact with it. We're assuming the AMQP message broker is available at <code>mq.sample-adstax-instance.dev.adstax.io</code> (with credentials <code>guest</code>/<code>guest</code>) and using the default RPC configuration:</p> 
  <div class="highlight highlight-source-scala">
   <pre>scala<span class="pl-k">&gt;</span> <span class="pl-k">import</span> <span class="pl-v">eu.shiftforward.adstax.productfeeder.api.rpc.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">eu.shiftforward.adstax.productfeeder.api.rpc.</span><span class="pl-v">_</span>

scala<span class="pl-k">&gt;</span> <span class="pl-k">import</span> <span class="pl-v">akka.actor.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">akka.actor.</span><span class="pl-v">_</span>

scala<span class="pl-k">&gt;</span> <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">system</span> <span class="pl-k">=</span> <span class="pl-en">ActorSystem</span>(<span class="pl-s"><span class="pl-pds">"</span>test-actor-system<span class="pl-pds">"</span></span>)
system<span class="pl-k">:</span> akka.actor.<span class="pl-en">ActorSystem</span> <span class="pl-k">=</span> akka<span class="pl-k">:</span><span class="pl-c"><span class="pl-c">//</span>test-actor-system</span>

scala<span class="pl-k">&gt;</span> <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">ec</span> <span class="pl-k">=</span> system.dispatcher
ec<span class="pl-k">:</span> scala.concurrent.<span class="pl-en">ExecutionContextExecutor</span> <span class="pl-k">=</span> <span class="pl-en">Dispatcher</span>[akka.actor.default<span class="pl-k">-</span>dispatcher]

scala<span class="pl-k">&gt;</span> <span class="pl-k">val</span> <span class="pl-en">client</span> <span class="pl-k">=</span> <span class="pl-en">ProductFeederAmqpRpcClient</span>()
client<span class="pl-k">:</span> eu.shiftforward.adstax.productfeeder.api.rpc.<span class="pl-en">ProductFeederAmqpRpcClient</span> <span class="pl-k">=</span> eu.shiftforward.adstax.productfeeder.api.rpc.<span class="pl-en">ProductFeederAmqpRpcClient</span><span class="pl-k">@</span>227fdc4e

scala<span class="pl-k">&gt;</span> client.updateProduct(<span class="pl-s"><span class="pl-pds">"</span>client1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>site1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>p1<span class="pl-pds">"</span></span>, <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>price<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">2</span>, <span class="pl-s"><span class="pl-pds">"</span>somethingElse<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>xpto<span class="pl-pds">"</span></span>)).onComplete(println)
<span class="pl-en">Success</span>(<span class="pl-c1">true</span>)

scala<span class="pl-k">&gt;</span> client.getProduct(<span class="pl-s"><span class="pl-pds">"</span>client1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>site1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>p1<span class="pl-pds">"</span></span>).onComplete(println)
<span class="pl-en">Success</span>(<span class="pl-en">Some</span>(<span class="pl-en">ProductItem</span>(p1,<span class="pl-en">Map</span>(price <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">2</span>, somethingElse <span class="pl-k">-</span><span class="pl-k">&gt;</span> xpto),<span class="pl-c1">2016</span><span class="pl-k">-</span><span class="pl-c1">07</span><span class="pl-k">-</span>07T13<span class="pl-k">:</span><span class="pl-c1">08</span><span class="pl-k">:</span><span class="pl-c1">58.741</span><span class="pl-k">+</span><span class="pl-c1">01</span><span class="pl-k">:</span><span class="pl-c1">00</span>)))

scala<span class="pl-k">&gt;</span> client.updateProduct(<span class="pl-s"><span class="pl-pds">"</span>client1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>site1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>p1<span class="pl-pds">"</span></span>, <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>price<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">5</span>)).onComplete(println)
<span class="pl-en">Success</span>(<span class="pl-c1">true</span>)

scala<span class="pl-k">&gt;</span> client.getProduct(<span class="pl-s"><span class="pl-pds">"</span>client1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>site1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>p1<span class="pl-pds">"</span></span>).onComplete(println)
<span class="pl-en">Success</span>(<span class="pl-en">Some</span>(<span class="pl-en">ProductItem</span>(p1,<span class="pl-en">Map</span>(price <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">5</span>),<span class="pl-c1">2016</span><span class="pl-k">-</span><span class="pl-c1">07</span><span class="pl-k">-</span>07T13<span class="pl-k">:</span><span class="pl-c1">10</span><span class="pl-k">:</span><span class="pl-c1">06.113</span><span class="pl-k">+</span><span class="pl-c1">01</span><span class="pl-k">:</span><span class="pl-c1">00</span>)))

scala<span class="pl-k">&gt;</span> client.deleteProduct(<span class="pl-s"><span class="pl-pds">"</span>client1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>site1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>p1<span class="pl-pds">"</span></span>).onComplete(println)
<span class="pl-en">Success</span>(<span class="pl-c1">true</span>)

scala<span class="pl-k">&gt;</span> client.getProduct(<span class="pl-s"><span class="pl-pds">"</span>client1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>site1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>p1<span class="pl-pds">"</span></span>).onComplete(println)
<span class="pl-en">Success</span>(<span class="pl-c1">None</span>)</pre>
  </div> 
  <h3><a id="user-content-users" class="anchor" href="https://github.com/shiftforward/adstax-sdk-scala#users" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Users</h3> 
  <p>User attributes can be manipulated by using an instance of <code>UserProfileStorageClient</code>. A <code>UserProfileStorageClient</code> supplies the following interface:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">trait</span> <span class="pl-en">UserProfileStorageClient</span> {
  <span class="pl-k">def</span> <span class="pl-en">get</span>(
    <span class="pl-v">userId</span>: <span class="pl-k">String</span>,
    <span class="pl-v">clientId</span>: <span class="pl-k">String</span>)<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">Option</span>[<span class="pl-en">UserAttributes</span>]]

  <span class="pl-k">def</span> <span class="pl-en">update</span>(
    <span class="pl-v">userId</span>: <span class="pl-k">String</span>,
    <span class="pl-v">clientId</span>: <span class="pl-k">String</span>,
    <span class="pl-v">attributes</span>: <span class="pl-en">UserAttributes</span>,
    <span class="pl-v">mergeStrategy</span>: <span class="pl-en">AttributeMergingStrategy</span> <span class="pl-k">=</span> <span class="pl-en">JoinMergingStrategy</span>)<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-k">Boolean</span>]

  <span class="pl-k">def</span> <span class="pl-en">delete</span>(
    <span class="pl-v">userId</span>: <span class="pl-k">String</span>,
    <span class="pl-v">clientId</span>: <span class="pl-k">String</span>)<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-k">Boolean</span>]
}</pre>
  </div> 
  <p>The <code>get</code> method returns a <code>Future</code> of an optional <code>UserAttributes</code> object that stores user attributes information. The <code>update</code> method allows one to create or update the attributes associated with a given user, returning a <code>Future</code> of a <code>Boolean</code> that signals that the update was successful. The <code>mergeStrategy</code> parameter allows one to specify how the newly sent attributes should be merged with the previous ones, either retaining the ones that aren't specified in the <code>attributes</code> parameter (with <code>JoinMergingStrategy</code>) or replacing all of them with the ones that are specified (with <code>ReplaceMergingStrategy</code>). The <code>delete</code> method allows one to delete a given user, returning a <code>Future</code> of a <code>Boolean</code> that signals that the update was successful.</p> 
  <p>The <code>UserAttributes</code> class is something that represents a user through its attributes:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">UserAttributes</span>(<span class="pl-v">attributes</span>: <span class="pl-en">Map</span>[<span class="pl-k">String</span>, <span class="pl-en">AttributeValue</span>])</pre>
  </div> 
  <p>An <code>AttributeValue</code> can assume various forms:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">StringAttrValue</span>(<span class="pl-v">value</span>: <span class="pl-k">String</span>) <span class="pl-k">extends</span> <span class="pl-e">AttributeValue</span>
<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">NumericAttrValue</span>(<span class="pl-v">value</span>: <span class="pl-k">Double</span>) <span class="pl-k">extends</span> <span class="pl-e">AttributeValue</span>
<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">BooleanAttrValue</span>(<span class="pl-v">value</span>: <span class="pl-k">Boolean</span>) <span class="pl-k">extends</span> <span class="pl-e">AttributeValue</span>
<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">GeoAttrValue</span>(<span class="pl-v">lat</span>: <span class="pl-k">Double</span>, <span class="pl-v">lon</span>: <span class="pl-k">Double</span>) <span class="pl-k">extends</span> <span class="pl-e">AttributeValue</span> 
<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">ArrayAttrValue</span>(<span class="pl-v">arr</span>: <span class="pl-en">Seq</span>[<span class="pl-en">AttributeValue</span>]) <span class="pl-k">extends</span> <span class="pl-e">AttributeValue</span>
<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">MapAttrValue</span>(<span class="pl-v">map</span>: <span class="pl-en">Map</span>[<span class="pl-k">String</span>, <span class="pl-en">AttributeValue</span>]) <span class="pl-k">extends</span> <span class="pl-e">AttributeValue</span></pre>
  </div> 
  <p>The AdStax Scala SDK provides an implementation of <code>UserProfileStorageClient</code> using a RPC system built around AdStax <a href="https://www.amqp.org/" target="_blank">AMQP-compatible</a> message bus. In order to create a <code>UserProfileStorageAmqpRpcClient</code> it is necessary to have access to a <a href="http://doc.akka.io/api/akka/2.4.4/index.html#akka.actor.ActorRefFactory" target="_blank"><code>ActorRefFactory</code></a> from Akka. <code>ActorSystem</code> and <code>AkkaContext</code> both implement <code>ActorRefFactory</code>. You must also provide the configuration parameters both for AMQP and the RPC protocol. These are supplied as domain objects, which are loaded from <a href="https://typesafehub.github.io/config/latest/api/com/typesafe/config/Config.html" target="_blank">Typesafe config</a> objects using <a href="https://github.com/melrief/pureconfig" target="_blank">PureConfig</a>. The <code>config.RabbitMQ</code> object should provide definitions for the <code>host</code>, <code>port</code>, <code>username</code>, <code>password</code> and <code>timeout</code> (for the operations). Here's the default configuration object that is loaded from <code>reference.conf</code>:</p> 
  <pre><code>{
  host = "localhost"
  port = 5672
  username = "guest"
  password = "guest"
  timeout = 5m
}
</code></pre> 
  <p>The RPC protocol needs to be configured at the level of the AMQP exchange name and routing key prefix to use in the requests. Here's the default configuration object:</p> 
  <pre><code>{
  exchange-name = "sf.data"
  routing-key-prefix = "user-profile-storage."
}
</code></pre> 
  <p>The <code>UserProfileStorageAmqpRpcClient</code> constructor also requires an implicit <code>ExecutionContext</code> to deal with futures. Here's how you create a user profile storage client and interact with it. We're assuming the AMQP message broker is available at <code>mq.sample-adstax-instance.dev.adstax.io</code> (with credentials <code>guest</code>/<code>guest</code>) and using the default RPC configuration:</p> 
  <div class="highlight highlight-source-scala">
   <pre>scala<span class="pl-k">&gt;</span> <span class="pl-k">import</span> <span class="pl-v">eu.shiftforward.adstax.ups.api.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">eu.shiftforward.adstax.ups.api.</span><span class="pl-v">_</span>

scala<span class="pl-k">&gt;</span> <span class="pl-k">import</span> <span class="pl-v">eu.shiftforward.adstax.ups.api.rpc.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">eu.shiftforward.adstax.ups.api.rpc.</span><span class="pl-v">_</span>

scala<span class="pl-k">&gt;</span> <span class="pl-k">import</span> <span class="pl-v">akka.actor.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">akka.actor.</span><span class="pl-v">_</span>

scala<span class="pl-k">&gt;</span> <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">system</span> <span class="pl-k">=</span> <span class="pl-en">ActorSystem</span>(<span class="pl-s"><span class="pl-pds">"</span>test-actor-system<span class="pl-pds">"</span></span>)
system<span class="pl-k">:</span> akka.actor.<span class="pl-en">ActorSystem</span> <span class="pl-k">=</span> akka<span class="pl-k">:</span><span class="pl-c"><span class="pl-c">//</span>test-actor-system</span>

scala<span class="pl-k">&gt;</span> <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">ec</span> <span class="pl-k">=</span> system.dispatcher
ec<span class="pl-k">:</span> scala.concurrent.<span class="pl-en">ExecutionContextExecutor</span> <span class="pl-k">=</span> <span class="pl-en">Dispatcher</span>[akka.actor.default<span class="pl-k">-</span>dispatcher]

scala<span class="pl-k">&gt;</span> <span class="pl-k">val</span> <span class="pl-en">client</span> <span class="pl-k">=</span> <span class="pl-en">UserProfileStorageAmqpRpcClient</span>()
client<span class="pl-k">:</span> eu.shiftforward.adstax.ups.api.rpc.<span class="pl-en">UserProfileStorageAmqpRpcClient</span> <span class="pl-k">=</span> eu.shiftforward.adstax.storage.rpc.<span class="pl-en">UserProfileStorageAmqpRpcClient</span><span class="pl-k">@</span>750147c3

scala<span class="pl-k">&gt;</span> client.update(<span class="pl-s"><span class="pl-pds">"</span>user1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>client1<span class="pl-pds">"</span></span>, <span class="pl-en">UserAttributes</span>(<span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>nAttr<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">NumericAttrValue</span>(<span class="pl-c1">2.0</span>), <span class="pl-s"><span class="pl-pds">"</span>sAttr<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">StringAttrValue</span>(<span class="pl-s"><span class="pl-pds">"</span>val<span class="pl-pds">"</span></span>)))).onComplete(println)
<span class="pl-en">Success</span>(<span class="pl-c1">true</span>)

scala<span class="pl-k">&gt;</span> client.get(<span class="pl-s"><span class="pl-pds">"</span>user1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>client1<span class="pl-pds">"</span></span>).onComplete(println)
<span class="pl-en">Success</span>(<span class="pl-en">Some</span>(<span class="pl-en">UserAttributes</span>(<span class="pl-en">Map</span>(nAttr <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">NumericAttrValue</span>(<span class="pl-c1">2.0</span>), sAttr <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">StringAttrValue</span>(val)))))

scala<span class="pl-k">&gt;</span> client.update(<span class="pl-s"><span class="pl-pds">"</span>user1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>client1<span class="pl-pds">"</span></span>, <span class="pl-en">UserAttributes</span>(<span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>nAttr<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">NumericAttrValue</span>(<span class="pl-c1">5.0</span>)))).onComplete(println)
<span class="pl-en">Success</span>(<span class="pl-c1">true</span>)

scala<span class="pl-k">&gt;</span> client.get(<span class="pl-s"><span class="pl-pds">"</span>user1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>client1<span class="pl-pds">"</span></span>).onComplete(println)
<span class="pl-en">Success</span>(<span class="pl-en">Some</span>(<span class="pl-en">UserAttributes</span>(<span class="pl-en">Map</span>(nAttr <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">NumericAttrValue</span>(<span class="pl-c1">5.0</span>), sAttr <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">StringAttrValue</span>(val)))))

scala<span class="pl-k">&gt;</span> client.delete(<span class="pl-s"><span class="pl-pds">"</span>user1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>client1<span class="pl-pds">"</span></span>).onComplete(println)
<span class="pl-en">Success</span>(<span class="pl-c1">true</span>)

scala<span class="pl-k">&gt;</span> client.get(<span class="pl-s"><span class="pl-pds">"</span>user1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>client1<span class="pl-pds">"</span></span>).onComplete(println)
<span class="pl-en">Success</span>(<span class="pl-c1">None</span>)</pre>
  </div> 
  <h3><a id="user-content-spark-jobs" class="anchor" href="https://github.com/shiftforward/adstax-sdk-scala#spark-jobs" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Spark Jobs</h3> 
  <p>The AdStax Scala SDK allows one to define jobs to run on Spark and that are able to access AdStax events. In order to define a spark job, one should create a class that implements the <code>SparkJob</code> trait. The <code>SparkJob</code> trait has the following interface:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">trait</span> <span class="pl-en">SparkJob</span> {
  <span class="pl-k">def</span> <span class="pl-en">name</span><span class="pl-k">:</span> <span class="pl-k">String</span>
  <span class="pl-k">def</span> <span class="pl-en">run</span>(<span class="pl-v">args</span>: <span class="pl-en">Array</span>[<span class="pl-k">String</span>])(<span class="pl-k">implicit</span> <span class="pl-v">context</span>: <span class="pl-en">AdStaxSparkContext</span>)<span class="pl-k">:</span> <span class="pl-k">Unit</span>
}</pre>
  </div> 
  <p>The <code>name</code> method should return the name of the job, whereas the <code>run</code> method should implement the primary job logic. The <code>run</code> method accepts as parameter the command-line arguments of the job, and is supplied with an implicit <code>AdStaxSparkContext</code>. The <code>AdStaxSparkContext</code> has an <code>eventsRDD</code> method to access AdStax events:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">eventsRDD</span>(<span class="pl-v">eventTypes</span>: <span class="pl-en">Set</span>[<span class="pl-k">String</span>], <span class="pl-v">startDateTime</span>: <span class="pl-en">DateTime</span>, <span class="pl-v">endDateTime</span>: <span class="pl-en">DateTime</span>)<span class="pl-k">:</span> <span class="pl-en">RDD</span>[<span class="pl-k">String</span>]</pre>
  </div> 
  <p>The returned <code>RDD</code> provides access to the events in JSON format. Refer to AdStax public documentation for the expected event format. Once implemented, you can submit the Spark job to run on your AdStax instance using the <a href="https://github.com/ShiftForward/adstax-spark-job-manager" target="_blank"><code>adstax-spark-job-manager</code></a> command line utility. You can find examples of Spark jobs to run on AdStax <a href="https://github.com/ShiftForward/adstax-spark-examples" target="_blank">here</a>.</p> 
  <h3><a id="user-content-tracking" class="anchor" href="https://github.com/shiftforward/adstax-sdk-scala#tracking" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Tracking</h3> 
  <p>The AdStax Scala SDK provides a way to make any <a href="http://doc.akka.io/docs/akka/current/scala/actors.html" target="_blank">Akka Actor</a> start receiving AdStax tracking events. A <code>TrackingListenerActor</code> is able to connect to the Tracking module in an AdStax system and have AdStax events directed to an actor. Consider a very simple actor that prints all events to stdout:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">akka.actor.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">eu.shiftforward.adstax.tracking.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">com.typesafe.config.</span><span class="pl-v">_</span>

<span class="pl-k">class</span> <span class="pl-en">ListenerActor</span> <span class="pl-k">extends</span> <span class="pl-e">Actor</span> {
  <span class="pl-k">def</span> <span class="pl-en">receive</span> <span class="pl-k">=</span> {
    <span class="pl-k">case</span> x <span class="pl-k">=&gt;</span> println(<span class="pl-s"><span class="pl-pds">"</span>Got <span class="pl-pds">"</span></span> <span class="pl-k">+</span> x)
  }
}</pre>
  </div> 
  <p>After providing the AMQP configuration and the routing keys in the same way as the modules above, you can start having the AdStax events forwarded to your actor:</p> 
  <div class="highlight highlight-source-scala">
   <pre>scala<span class="pl-k">&gt;</span> <span class="pl-k">import</span> <span class="pl-v">eu.shiftforward.adstax.tracking.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">eu.shiftforward.adstax.tracking.</span><span class="pl-v">_</span>

scala<span class="pl-k">&gt;</span> <span class="pl-k">import</span> <span class="pl-v">akka.actor.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">akka.actor.</span><span class="pl-v">_</span>

scala<span class="pl-k">&gt;</span> <span class="pl-k">val</span> <span class="pl-en">system</span> <span class="pl-k">=</span> <span class="pl-en">ActorSystem</span>(<span class="pl-s"><span class="pl-pds">"</span>test-actor-system<span class="pl-pds">"</span></span>)
system<span class="pl-k">:</span> akka.actor.<span class="pl-en">ActorSystem</span> <span class="pl-k">=</span> akka<span class="pl-k">:</span><span class="pl-c"><span class="pl-c">//</span>test-actor-system</span>

scala<span class="pl-k">&gt;</span> <span class="pl-k">val</span> <span class="pl-en">listener</span> <span class="pl-k">=</span> system.actorOf(<span class="pl-en">TrackingListenerActor</span>.props(<span class="pl-en">Props</span>[<span class="pl-en">ListenerActor</span>]))
listener<span class="pl-k">:</span> akka.actor.<span class="pl-en">ActorRef</span> <span class="pl-k">=</span> <span class="pl-en">Actor</span>[akka<span class="pl-k">:</span><span class="pl-c"><span class="pl-c">//</span>test-actor-system/user/$b#342189667]</span>
<span class="pl-en">Got</span> {<span class="pl-s"><span class="pl-pds">"</span>meta<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>userCreation<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>uid<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>673da5b975164db8900eff5014578036<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>timestamp<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>2016-07-12T15:05:20.733Z<span class="pl-pds">"</span></span>}}
<span class="pl-en">Got</span> {<span class="pl-s"><span class="pl-pds">"</span>meta<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>userCookieSticky<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>uid<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>673da5b975164db8900eff5014578036<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>timestamp<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>2016-07-12T15:05:21.344Z<span class="pl-pds">"</span></span>}}
<span class="pl-en">Got</span> {<span class="pl-s"><span class="pl-pds">"</span>method<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>GET<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>cookieCheck<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>},<span class="pl-s"><span class="pl-pds">"</span>uri<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>path<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>/events<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>full<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>http://tr.sample-adstax-instance.dev.adstax.io/events?cookieCheck=true&amp;<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>query<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>cookieCheck<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>},<span class="pl-s"><span class="pl-pds">"</span>scheme<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>http<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>authority<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>host<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>tr.sample-adstax-instance.dev.adstax.io<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>port<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-c1">0</span>,<span class="pl-s"><span class="pl-pds">"</span>userinfo<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>}},<span class="pl-s"><span class="pl-pds">"</span>meta<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>city<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>Philadelphia<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>location<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>39.953,-75.1756<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>timestamp<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>2016-07-12T15:05:21.902Z<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>country<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>United States<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>cookie<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>sticky<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-c1">true</span>},<span class="pl-s"><span class="pl-pds">"</span>uid<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>673da5b975164db8900eff5014578036<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>null<span class="pl-pds">"</span></span>},<span class="pl-s"><span class="pl-pds">"</span>entity<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-c1">null</span>,<span class="pl-s"><span class="pl-pds">"</span>headers<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>X-Forwarded-For<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>76.72.167.0<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Connection<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>keep-alive<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>X-Forwarded-Port<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>80<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>X-Forwarded-Proto<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>http<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Cookie<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>adstax_uid<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>673da5b975164db8900eff5014578036<span class="pl-pds">"</span></span>},<span class="pl-s"><span class="pl-pds">"</span>Accept-Encoding<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>gzip, deflate, identity<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>User-Agent<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>Pingdom.com_bot_version_1.4_ (http://www.pingdom.com)<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Host<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>tr.sample-adstax-instance.dev.adstax.io<span class="pl-pds">"</span></span>},<span class="pl-s"><span class="pl-pds">"</span>protocol<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>HTTP/1.1<span class="pl-pds">"</span></span>}
<span class="pl-en">Got</span> {<span class="pl-s"><span class="pl-pds">"</span>meta<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>userCreation<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>uid<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>92f41b2799ea4b96ad196f70e7ce6cc7<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>timestamp<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>2016-07-12T15:06:21.146Z<span class="pl-pds">"</span></span>}}
<span class="pl-en">Got</span> {<span class="pl-s"><span class="pl-pds">"</span>meta<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>userCookieSticky<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>uid<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>92f41b2799ea4b96ad196f70e7ce6cc7<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>timestamp<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>2016-07-12T15:06:21.176Z<span class="pl-pds">"</span></span>}}
<span class="pl-en">Got</span> {<span class="pl-s"><span class="pl-pds">"</span>method<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>GET<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>cookieCheck<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>},<span class="pl-s"><span class="pl-pds">"</span>uri<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>path<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>/events<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>full<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>http://tr.sample-adstax-instance.dev.adstax.io/events?cookieCheck=true&amp;<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>query<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>cookieCheck<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>},<span class="pl-s"><span class="pl-pds">"</span>scheme<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>http<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>authority<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>host<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>tr.sample-adstax-instance.dev.adstax.io<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>port<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-c1">0</span>,<span class="pl-s"><span class="pl-pds">"</span>userinfo<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>}},<span class="pl-s"><span class="pl-pds">"</span>meta<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>city<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>Atlanta<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>location<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>33.7516,-84.3915<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>timestamp<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>2016-07-12T15:06:21.180Z<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>country<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>United States<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>cookie<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>sticky<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-c1">true</span>},<span class="pl-s"><span class="pl-pds">"</span>uid<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>92f41b2799ea4b96ad196f70e7ce6cc7<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>null<span class="pl-pds">"</span></span>},<span class="pl-s"><span class="pl-pds">"</span>entity<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-c1">null</span>,<span class="pl-s"><span class="pl-pds">"</span>headers<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>X-Forwarded-For<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>174.34.162.0<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Connection<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>keep-alive<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>X-Forwarded-Port<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>80<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>X-Forwarded-Proto<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>http<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Cookie<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>adstax_uid<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>92f41b2799ea4b96ad196f70e7ce6cc7<span class="pl-pds">"</span></span>},<span class="pl-s"><span class="pl-pds">"</span>Accept-Encoding<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>gzip, deflate, identity<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>User-Agent<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>Pingdom.com_bot_version_1.4_ (http://www.pingdom.com)<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Host<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>tr.sample-adstax-instance.dev.adstax.io<span class="pl-pds">"</span></span>},<span class="pl-s"><span class="pl-pds">"</span>protocol<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>HTTP/1.1<span class="pl-pds">"</span></span>}
<span class="pl-en">Got</span> {<span class="pl-s"><span class="pl-pds">"</span>meta<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>userCreation<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>uid<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>459d80d56d7d4535ac48eb563e189f0f<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>timestamp<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>2016-07-12T15:07:20.325Z<span class="pl-pds">"</span></span>}}
<span class="pl-en">Got</span> {<span class="pl-s"><span class="pl-pds">"</span>meta<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>userCookieSticky<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>uid<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>459d80d56d7d4535ac48eb563e189f0f<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>timestamp<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>2016-07-12T15:07:20.443Z<span class="pl-pds">"</span></span>}}
<span class="pl-en">Got</span> {<span class="pl-s"><span class="pl-pds">"</span>method<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>GET<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>cookieCheck<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>},<span class="pl-s"><span class="pl-pds">"</span>uri<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>path<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>/events<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>full<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>http://tr.sample-adstax-instance.dev.adstax.io/events?cookieCheck=true&amp;<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>query<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>cookieCheck<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>},<span class="pl-s"><span class="pl-pds">"</span>scheme<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>http<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>authority<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>host<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>tr.sample-adstax-instance.dev.adstax.io<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>port<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-c1">0</span>,<span class="pl-s"><span class="pl-pds">"</span>userinfo<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>}},<span class="pl-s"><span class="pl-pds">"</span>meta<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>city<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>Marco<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>location<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>45.85,11.0<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>timestamp<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>2016-07-12T15:07:20.448Z<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>country<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>Italy<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>cookie<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>sticky<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-c1">true</span>},<span class="pl-s"><span class="pl-pds">"</span>uid<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>459d80d56d7d4535ac48eb563e189f0f<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>null<span class="pl-pds">"</span></span>},<span class="pl-s"><span class="pl-pds">"</span>entity<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-c1">null</span>,<span class="pl-s"><span class="pl-pds">"</span>headers<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>X-Forwarded-For<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>95.141.32.0<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Connection<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>keep-alive<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>X-Forwarded-Port<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>80<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>X-Forwarded-Proto<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>http<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Cookie<span class="pl-pds">"</span></span><span class="pl-k">:</span>{<span class="pl-s"><span class="pl-pds">"</span>adstax_uid<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>459d80d56d7d4535ac48eb563e189f0f<span class="pl-pds">"</span></span>},<span class="pl-s"><span class="pl-pds">"</span>Accept-Encoding<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>gzip, deflate, identity<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>User-Agent<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>Pingdom.com_bot_version_1.4_ (http://www.pingdom.com)<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>Host<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>tr.sample-adstax-instance.dev.adstax.io<span class="pl-pds">"</span></span>},<span class="pl-s"><span class="pl-pds">"</span>protocol<span class="pl-pds">"</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">"</span>HTTP/1.1<span class="pl-pds">"</span></span>}
...</pre>
  </div> 
 </article>
</div>