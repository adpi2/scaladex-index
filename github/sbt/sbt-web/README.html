<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a href="https://github.com/sbt/sbt-web#sbt-web" aria-hidden="true" class="anchor" id="user-content-sbt-web" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>sbt-web</h1> 
  <p><a href="https://travis-ci.org/sbt/sbt-web" target="_blank"><img src="https://camo.githubusercontent.com/d1f1bab92552f7546dacedb4119afea721a731d6/68747470733a2f2f6170692e7472617669732d63692e6f72672f7362742f7362742d7765622e706e673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://api.travis-ci.org/sbt/sbt-web.png?branch=master" style="max-width:100%;"></a> <a href="https://bintray.com/sbt-web/sbt-plugin-releases/sbt-web/_latestVersion" target="_blank"><img src="https://camo.githubusercontent.com/aac464390e91ba5582cf5691715e4fe0cc890515/68747470733a2f2f6170692e62696e747261792e636f6d2f7061636b616765732f7362742d7765622f7362742d706c7567696e2d72656c65617365732f7362742d7765622f696d616765732f646f776e6c6f61642e737667" alt="Download" data-canonical-src="https://api.bintray.com/packages/sbt-web/sbt-plugin-releases/sbt-web/images/download.svg" style="max-width:100%;"></a></p> 
  <p>This project provides the building blocks for web oriented sbt plugins by bringing together the following concerns:</p> 
  <ul> 
   <li>File directory layout conventions for resources intended to be served by a web server (otherwise known as assets)</li> 
   <li>Incremental execution of fine-grained operations within sbt tasks</li> 
   <li>Utilities for managing <a href="http://akka.io/" target="_blank">Akka</a> from within sbt (sbt-web based plugins use Akka)</li> 
   <li>Utilities for managing <a href="http://www.webjars.org/" target="_blank">WebJars</a> including the ability to extract a WebJar's contents on to disk</li> 
   <li>Standardised reporting of compilation style errors</li> 
  </ul> 
  <p>sbt-web was driven from the desire to factor out client-side web concerns from the <a href="http://www.playframework.com/" target="_blank">Play Framework</a>. However sbt-web is entirely independent of Play and can be used for any project that uses sbt as its build system.</p> 
  <p>For an overview of sbt-web: <a href="http://www.ustream.tv/recorded/42774873" target="_blank">http://www.ustream.tv/recorded/42774873</a></p> 
  <h2><a href="https://github.com/sbt/sbt-web#available-plugins" aria-hidden="true" class="anchor" id="user-content-available-plugins" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Available Plugins</h2> 
  <p>The following is a list of plugins we know of that are built on sbt-web:</p> 
  <ul> 
   <li><a href="https://github.com/matthewrennie/sbt-autoprefixer" target="_blank">sbt-autoprefixer</a></li> 
   <li><a href="https://github.com/ground5hark/sbt-closure#sbt-closure" target="_blank">sbt-closure</a></li> 
   <li><a href="https://github.com/sbt/sbt-coffeescript#sbt-coffeescript" target="_blank">sbt-coffeescript</a></li> 
   <li><a href="https://github.com/ShaggyYeti/sbt-coffeescript-reactjs" target="_blank">sbt-coffeescript-reactjs</a></li> 
   <li><a href="https://github.com/ground5hark/sbt-concat#sbt-concat" target="_blank">sbt-concat</a></li> 
   <li><a href="https://github.com/ground5hark/sbt-css-compress#sbt-css-compress" target="_blank">sbt-css-compress</a></li> 
   <li><a href="https://github.com/sbt/sbt-digest#sbt-digest" target="_blank">sbt-digest</a></li> 
   <li><a href="https://github.com/jmparsons/sbt-dustjs-linkedin" target="_blank">sbt-dustjs-linkedin</a></li> 
   <li><a href="https://github.com/dwickern/sbt-emberjs" target="_blank">sbt-emberjs</a></li> 
   <li><a href="https://github.com/rgcottrell/sbt-filter" target="_blank">sbt-filter</a></li> 
   <li><a href="https://github.com/sbt/sbt-gzip#sbt-gzip" target="_blank">sbt-gzip</a></li> 
   <li><a href="https://github.com/Amadeus82/sbt-handlebars" target="_blank">sbt-handlebars</a></li> 
   <li><a href="https://github.com/bicouy0/sbt-hbs" target="_blank">sbt-hbs</a></li> 
   <li><a href="https://github.com/kolloch/sbt-html-js-wrap" target="_blank">sbt-html-js-wrap</a></li> 
   <li><a href="https://github.com/rgcottrell/sbt-html-minifier" target="_blank">sbt-html-minifier</a></li> 
   <li><a href="https://github.com/rgcottrell/sbt-imagemin" target="_blank">sbt-imagemin</a></li> 
   <li><a href="https://github.com/joost-de-vries/sbt-jasmine" target="_blank">sbt-jasmine</a></li> 
   <li><a href="https://github.com/sbt/sbt-jshint#sbt-jshint" target="_blank">sbt-jshint</a></li> 
   <li><a href="https://github.com/matthewrennie/sbt-jst" target="_blank">sbt-jst</a></li> 
   <li><a href="https://github.com/sbt/sbt-less#sbt-less" target="_blank">sbt-less</a></li> 
   <li><a href="https://github.com/sbt/sbt-mocha" target="_blank">sbt-mocha</a></li> 
   <li><a href="https://github.com/eamelink/sbt-purescript" target="_blank">sbt-purescript</a></li> 
   <li><a href="https://github.com/ddispaltro/sbt-reactjs" target="_blank">sbt-reactjs</a></li> 
   <li><a href="https://github.com/sbt/sbt-rjs#sbt-rjs" target="_blank">sbt-rjs</a></li> 
   <li><a href="https://github.com/madoushi/sbt-sass" target="_blank">sbt-sass</a></li> 
   <li><a href="https://github.com/irundaia/sbt-sassify" target="_blank">sbt-sassify</a></li> 
   <li><a href="https://github.com/neomaclin/sbt-simple-url-update#sbt-simple-url-update" target="_blank">sbt-simple-url-update</a></li> 
   <li><a href="https://github.com/sbt/sbt-stylus" target="_blank">sbt-stylus</a></li> 
   <li><a href="https://github.com/LuigiPeace/sbt-traceur" target="_blank">sbt-traceur</a></li> 
   <li><a href="https://github.com/joost-de-vries/sbt-tslint" target="_blank">sbt-tslint</a></li> 
   <li><a href="https://github.com/joost-de-vries/sbt-typescript" target="_blank">sbt-typescript</a></li> 
   <li><a href="https://github.com/sbt/sbt-uglify" target="_blank">sbt-uglify</a></li> 
   <li><a href="https://github.com/vmunier/sbt-web-scalajs" target="_blank">sbt-web-scalajs</a></li> 
  </ul> 
  <h2><a href="https://github.com/sbt/sbt-web#ideas-for-plugins" aria-hidden="true" class="anchor" id="user-content-ideas-for-plugins" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Ideas for Plugins</h2> 
  <ul> 
   <li><a href="http://jasmine.github.io/" target="_blank">jasmine</a></li> 
   <li><a href="http://handlebarsjs.com/" target="_blank">handlebars</a></li> 
  </ul> 
  <h2><a href="https://github.com/sbt/sbt-web#plugins-in-development" aria-hidden="true" class="anchor" id="user-content-plugins-in-development" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Plugins in Development</h2> 
  <ul> 
   <li>C'mon community, get involved! Watch the talk on the anatomy of an <a href="https://www.youtube.com/watch?v=lIznJSBW-GU" target="_blank">sbt-web plugin</a></li> 
  </ul> 
  <h2><a href="https://github.com/sbt/sbt-web#file-directory-layout" aria-hidden="true" class="anchor" id="user-content-file-directory-layout" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>File Directory Layout</h2> 
  <p>The following directory layout is declared by sbt-web with an indication of the associated settings:</p> 
  <pre><code>+ src
--+ main
----+ assets .....(sourceDirectory in Assets)
------+ js
----+ public .....(resourceDirectory in Assets)
------+ css
------+ images
------+ js
--+ test
----+ assets .....(sourceDirectory in TestAssets)
------+ js
----+ public .....(resourceDirectory in TestAssets)
------+ css
------+ images
------+ js

+ target
--+ web ............(webTarget)
----+ public
------+ main .......(resourceManaged in Assets)
--------+ css
--------+ images
--------+ js
------+ test .......(resourceManaged in TestAssets)
--------+ css
--------+ images
--------+ js
----+ stage ........(stagingDirectory)
</code></pre> 
  <p>The plugin introduces the notion of <code>assets</code> to sbt. Assets are public resources that are intended for client-side consumption e.g. by a browser. This is also distinct from sbt's existing notion of <code>resources</code> as project resources are generally not made public by a web server.</p> 
  <p>In sbt, asset source files are considered the source for plugins that process them. When they are processed any resultant files go into a <code>public</code> directory in the classpath. By configuration, sbt-web apps serve static assets from the <code>public</code> directory on the classpath. For example a CoffeeScript plugin would use files from <code>sourceDirectory in Assets</code> and produce them to <code>resourceManaged in Assets</code>.</p> 
  <p>All assets whether they need processing or are static in nature, will be copied to the resourceManaged destinations.</p> 
  <p>Assets can be organized however desired within the <code>assets</code> directory.</p> 
  <p>One last thing regarding the public and public-test folders... any WebJar depended on by the project will be automatically extracted into these folders e.g. target/web/public/main/lib/jquery/jquery.js. In addition the public-test folder receives the contents of the public folder as well as test assets. This eases the support of test frameworks given that all files are locatable from one root.</p> 
  <p>The "stage" directory is product of processing the asset pipeline and results in files prepared for deployment to a web server.</p> 
  <h2><a href="https://github.com/sbt/sbt-web#configurations" aria-hidden="true" class="anchor" id="user-content-configurations" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Configurations</h2> 
  <p>sbt holds the notion of configurations which are similar to Maven's phases. Configurations aggregate settings and tasks. Familiar configurations will be <code>Compile</code> and <code>Test</code>. sbt-web introduces two new configurations named <code>Assets</code> and <code>TestAssets</code> correlating roughly with <code>Compile</code> and <code>Test</code>, but for web assets.</p> 
  <h2><a href="https://github.com/sbt/sbt-web#incremental-execution" aria-hidden="true" class="anchor" id="user-content-incremental-execution" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Incremental Execution</h2> 
  <p>The incremental task API lets tasks run more quickly when they are called more than once. The idea is to do less work when tasks are called a second time, by skipping any work that has already been done. In other words, tasks only perform the "incremental" work that is necessary since they were last run.</p> 
  <p>To analyse which work needs to be done, a task's work is broken up into a number of sub-operations, each of which can be run independently. Each operation takes input parameters and can read and write files. The incremental task API keeps a record of which operations have been run so that that those operations don't need to be repeated in the future.</p> 
  <h2><a href="https://github.com/sbt/sbt-web#asset-pipeline" aria-hidden="true" class="anchor" id="user-content-asset-pipeline" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Asset Pipeline</h2> 
  <p>There are two categories of sbt-web based tasks:</p> 
  <ul> 
   <li>those that operate on source files</li> 
   <li>those that operate on web assets</li> 
  </ul> 
  <p>Examples of source file tasks as plugins are CoffeeScript, LESS and JSHint. Some of these take a source file and produce a target web asset e.g. CoffeeScript produces JS files. Plugins in this category are mutually exclusive to each other in terms of their function i.e. only one CoffeeScript plugin will take CoffeeScript sources and produce target JS files. In summary, source file plugins produce web assets.</p> 
  <p>Asset tasks operate on web assets directly. The assets they operate on depend on a "stage" in the asset pipeline. Examples of web asset tasks as plugins include RequireJs optimisation, gzip and md5 hashing.</p> 
  <p>Source file tasks can be considered to provide files for the first stage of asset pipeline processing and they will be executed often e.g. for each compilation of your project's source files. Asset pipeline tasks are generally executed at the time that you wish to prepare a distribution for deployment into, say, production.</p> 
  <h2><a href="https://github.com/sbt/sbt-web#exporting-assets" aria-hidden="true" class="anchor" id="user-content-exporting-assets" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Exporting Assets</h2> 
  <p>Assets are automatically available across subproject dependencies using sbt's classpath setup. The assets are exported in the webjar format and are imported in the same way as other webjar dependencies.</p> 
  <p>So given a project dependency like this, where project A depends on project B:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">lazy</span> <span class="pl-k">val</span> <span class="pl-en">a</span> <span class="pl-k">=</span> (project in file(<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>))
  .enablePlugins(<span class="pl-en">SbtWeb</span>)
  .dependsOn(b)

<span class="pl-k">lazy</span> <span class="pl-k">val</span> <span class="pl-en">b</span> <span class="pl-k">=</span> (project in file(<span class="pl-s"><span class="pl-pds">"</span>b<span class="pl-pds">"</span></span>))
  .enablePlugins(<span class="pl-en">SbtWeb</span>)</pre>
  </div> 
  <p>Assets from project B are available to project A under <code>lib/b/</code>.</p> 
  <p>The module name for imported assets is the same as the project module name (the normalized name of the project). This can be changed with the <code>moduleName in Assets</code> setting.</p> 
  <p>Test assets are also exported if a test dependency is specified. For example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">lazy</span> <span class="pl-k">val</span> <span class="pl-en">a</span> <span class="pl-k">=</span> (project in file(<span class="pl-s"><span class="pl-pds">"</span>a<span class="pl-pds">"</span></span>))
  .enablePlugins(<span class="pl-en">SbtWeb</span>)
  .dependsOn(b <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>compile;test-&gt;test<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <h3><a href="https://github.com/sbt/sbt-web#packaging-and-publishing" aria-hidden="true" class="anchor" id="user-content-packaging-and-publishing" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Packaging and Publishing</h3> 
  <p><em>The packaging and publishing behavior is documented for sbt-web version <code>1.1.0</code> and above.</em></p> 
  <p>Assets are automatically packaged and published along with project classes at the following path inside the jar: <code>META-INF/resources/webjars/module/version/</code>. This means that assets can be shared as external library dependencies. Simply publish the project and use as a library dependency. The assets will be extracted and available under <code>lib/module/</code> in the same way as other webjar dependencies or internal dependencies.</p> 
  <p>To package all assets for production there is a <code>packageBin in Assets</code> task, <code>web-assets:package</code> in the sbt shell. This packages the result of the asset pipeline. An optional path prefix can be specified with the <code>packagePrefix in Assets</code> setting. For example, to have assets packaged under a <code>public</code> directory, as used for Play Framework distributions:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">WebKeys</span>.packagePrefix in <span class="pl-en">Assets</span> <span class="pl-k">:</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>public/<span class="pl-pds">"</span></span></pre>
  </div> 
  <p>To automatically add the production-ready assets to classpath, the following might be useful:</p> 
  <div class="highlight highlight-source-scala">
   <pre>(managedClasspath in <span class="pl-en">Runtime</span>) <span class="pl-k">+</span><span class="pl-k">=</span> (packageBin in <span class="pl-en">Assets</span>).value</pre>
  </div> 
  <h2><a href="https://github.com/sbt/sbt-web#writing-a-source-file-task" aria-hidden="true" class="anchor" id="user-content-writing-a-source-file-task" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Writing a Source File task</h2> 
  <p>The following represents the minimum amount of code required in a <code>build.sbt</code> to create a task that operates on source files i.e. those files that are available for processing from <code>src/main/assets</code>. Source file tasks are resource generators in sbt terms.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">mySourceFileTask</span> <span class="pl-k">=</span> taskKey[<span class="pl-en">Seq</span>[<span class="pl-en">File</span>]](<span class="pl-s"><span class="pl-pds">"</span>Some source file task<span class="pl-pds">"</span></span>)

mySourceFileTask <span class="pl-k">:</span><span class="pl-k">=</span> <span class="pl-c1">Nil</span>

sourceGenerators in <span class="pl-en">Assets</span> <span class="pl-k">+</span><span class="pl-k">=</span> mySourceFileTask.taskValue</pre>
  </div> 
  <p>The addition of the <code>mySourceFileTask</code> to <code>sourceGenerators in Assets</code> declares the task as a resource generator and, as such, will be executed in parallel with other resource generators during the <code>WebKeys.assets</code> task execution. Using sbt's <code>show</code> command will yield the directory where all source file assets have been written to e.g.:</p> 
  <div class="highlight highlight-source-scala">
   <pre>show web<span class="pl-k">-</span>assets<span class="pl-k">:</span>assets</pre>
  </div> 
  <p>Source file tasks take input, typically from <code>sourceDirectory in Assets</code> (and/or <code>TestAssets</code>) and produce a sequence of files that have been generated from that input.</p> 
  <p>The following code illustrates a more complete example where input files matching *.coffee are taken and copied to an output folder:</p> 
  <div class="highlight highlight-source-scala">
   <pre>mySourceFileTask <span class="pl-k">:</span><span class="pl-k">=</span> {
  <span class="pl-c"><span class="pl-c">//</span> translate .coffee files into .js files</span>
  <span class="pl-k">val</span> <span class="pl-en">sourceDir</span> <span class="pl-k">=</span> (sourceDirectory in <span class="pl-en">Assets</span>).value
  <span class="pl-k">val</span> <span class="pl-en">targetDir</span> <span class="pl-k">=</span> webTarget.value <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>cs-plugin<span class="pl-pds">"</span></span>
  <span class="pl-k">val</span> <span class="pl-en">sources</span> <span class="pl-k">=</span> sourceDir <span class="pl-k">**</span> <span class="pl-s"><span class="pl-pds">"</span>*.coffee<span class="pl-pds">"</span></span>
  <span class="pl-k">val</span> <span class="pl-en">mappings</span> <span class="pl-k">=</span> sources pair relativeTo(sourceDir)
  <span class="pl-k">val</span> <span class="pl-en">renamed</span> <span class="pl-k">=</span> mappings map { <span class="pl-k">case</span> (file, path) <span class="pl-k">=&gt;</span> file <span class="pl-k">-</span><span class="pl-k">&gt;</span> path.replaceAll(<span class="pl-s"><span class="pl-pds">"</span>coffee<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>js<span class="pl-pds">"</span></span>) }
  <span class="pl-k">val</span> <span class="pl-en">copies</span> <span class="pl-k">=</span> renamed map { <span class="pl-k">case</span> (file, path) <span class="pl-k">=&gt;</span> file <span class="pl-k">-</span><span class="pl-k">&gt;</span> (resourceManaged in <span class="pl-en">Assets</span>).value <span class="pl-k">/</span> path }
  <span class="pl-en">IO</span>.copy(copies)
  copies map (_._2)
}</pre>
  </div> 
  <p>Using the <code>WebKeys.assets</code> task will perform source file tasks in parallel. If you find yourself using a source file task across many projects then consider wrapping it with an sbt plugin. Example source file plugins are <code>sbt-jshint</code>, <code>sbt-coffeescript</code> and <code>sbt-stylus</code>.</p> 
  <p>As a final note, if you plugin depends on node modules e.g. those that are extracted from WebJars or from NPM, then you will need to have your task depend on the node module extraction task. The following illustrates how given the <code>Assets</code> scope:</p> 
  <div class="highlight highlight-source-scala">
   <pre>mySourceFileTask <span class="pl-k">:</span><span class="pl-k">=</span> <span class="pl-en">Def</span>.task {
  <span class="pl-c1">Nil</span>
}.dependsOn(<span class="pl-en">WebKeys</span>.nodeModules in <span class="pl-en">Assets</span>).value</pre>
  </div> 
  <p>If you're wrapping the task within a plugin then you will need the Plugin's scope as opposed to the <code>Assets</code> scope i.e.:</p> 
  <div class="highlight highlight-source-scala">
   <pre>mySourceFileTask <span class="pl-k">:</span><span class="pl-k">=</span> <span class="pl-en">Def</span>.task {
  <span class="pl-c1">Nil</span>
}.dependsOn(<span class="pl-en">WebKeys</span>.nodeModules in <span class="pl-en">Plugin</span>).value</pre>
  </div> 
  <h2><a href="https://github.com/sbt/sbt-web#writing-an-asset-pipeline-task" aria-hidden="true" class="anchor" id="user-content-writing-an-asset-pipeline-task" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Writing an Asset Pipeline task</h2> 
  <p>The following represents the minimum amount of code required to create a pipeline stage in a <code>build.sbt</code> file:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.typesafe.sbt.web.pipeline.</span><span class="pl-v">Pipeline</span>

<span class="pl-k">val</span> <span class="pl-en">myPipelineTask</span> <span class="pl-k">=</span> taskKey[<span class="pl-en">Pipeline</span>.<span class="pl-en">Stage</span>](<span class="pl-s"><span class="pl-pds">"</span>Some pipeline task<span class="pl-pds">"</span></span>)

myPipelineTask <span class="pl-k">:</span><span class="pl-k">=</span> identity

pipelineStages <span class="pl-k">:</span><span class="pl-k">=</span> <span class="pl-en">Seq</span>(myPipelineTask)</pre>
  </div> 
  <p><code>myPipelineTask</code> is a function that receives a <code>Seq[PathMapping]</code> and produces a <code>Seq[PathMapping]</code>. <code>PathMapping</code> is a tuple of <code>(File, String)</code> where the first member provides the full path to a file, and the second member declares the portion of that path which is to be considered relative. For example <code>(file("/a/b/c"), "b/c").</code>PathMapping` types are commonly used in sbt and are useful in terms of providing access to a file and preserving information about its relative path; the latter being typically useful for copying files to a target folder where the relative portion of the path must be retained.</p> 
  <p>In the above example an identity function is used i.e. what is passed in is simply returned. The task is included within a sequence and assigned to <code>pipelineStages</code> i.e. the sequence represents the asset pipeline. Each stage in the asset pipeline is executed after any previous stage has completed. A stage therefore receives the product of files any previous stage as input. A stage's output then becomes the input to any subsequent stage. The first stage will always receive the output of having executed source file tasks as its input.</p> 
  <p>If you have some need for the assets produced by the <code>pipelineStages</code> in your development environment (during <code>play run</code>), then you can scope the <code>pipelineStages</code> to the <code>Assets</code> config.</p> 
  <div class="highlight highlight-source-scala">
   <pre>pipelineStages in <span class="pl-en">Assets</span> <span class="pl-k">:</span><span class="pl-k">=</span> <span class="pl-en">Seq</span>(myPipelineTask)</pre>
  </div> 
  <p>To perform the asset pipeline tasks use the <code>WebKeys.stage</code> task. If you use sbt's <code>show</code> command from the console then you will see the directory that the pipeline has been written to e.g.:</p> 
  <div class="highlight highlight-source-scala">
   <pre>show web<span class="pl-k">-</span>stage</pre>
  </div> 
  <p>Returning what is passed in is not particularly useful. Stages tend to add and remove files from the input as expressed in the output returned. The following expanded task simulates minifying some js files and consequently adds files to the pipeline:</p> 
  <div class="highlight highlight-source-scala">
   <pre>myPipelineTask <span class="pl-k">:</span><span class="pl-k">=</span> { <span class="pl-v">mappings</span>: <span class="pl-en">Seq</span>[<span class="pl-en">PathMapping</span>] <span class="pl-k">=&gt;</span>
  <span class="pl-c"><span class="pl-c">//</span> pretend to combine all .js files into one .min.js file</span>
  <span class="pl-k">val</span> <span class="pl-en">targetDir</span> <span class="pl-k">=</span> webTarget.value <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>myPipelineTask<span class="pl-pds">"</span></span> <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>target<span class="pl-pds">"</span></span>
  <span class="pl-k">val</span> (js, other) <span class="pl-k">=</span> mappings partition (_._2.endsWith(<span class="pl-s"><span class="pl-pds">"</span>.js<span class="pl-pds">"</span></span>))
  <span class="pl-k">val</span> <span class="pl-en">minFile</span> <span class="pl-k">=</span> targetDir <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>js<span class="pl-pds">"</span></span> <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>all.min.js<span class="pl-pds">"</span></span>
  <span class="pl-en">IO</span>.touch(minFile)
  <span class="pl-k">val</span> <span class="pl-en">minMappings</span> <span class="pl-k">=</span> <span class="pl-en">Seq</span>(minFile) pair relativeTo(targetDir)
  minMappings <span class="pl-k">++</span> other
}</pre>
  </div> 
  <p>If you find yourself commonly using a pipeline stage task across projects then you should consider wrapping it with an sbt plugin. Examples of such plugins are <code>sbt-digest</code>, <code>sbt-gzip</code>, <code>sbt-rjs</code> and <code>sbt-uglify</code>. The first two illustrate stages implemented using JVM based libraries while the latter two illustrate invoking JavaScript via js-engine.</p> 
  <h2><a href="https://github.com/sbt/sbt-web#webdriver-and-js-engine" aria-hidden="true" class="anchor" id="user-content-webdriver-and-js-engine" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>WebDriver and js-engine</h2> 
  <p>The <a href="https://github.com/typesafehub/webdriver" target="_blank">WebDriver</a> and <a href="https://github.com/typesafehub/js-engine" target="_blank">js-engine</a> projects build on sbt-web and provide a DOM oriented and DOM-less means of JavaScript execution respectively. sbt-web plugins will use one of the two of these plugins depending on their DOM requirements.</p> 
 </article>
</div>