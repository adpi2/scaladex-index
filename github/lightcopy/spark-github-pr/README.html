<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-spark-github-pr" class="anchor" href="https://github.com/lightcopy/spark-github-pr#spark-github-pr" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>spark-github-pr</h1> 
  <p>Spark SQL datasource for GitHub PR API.</p> 
  <p><a href="https://travis-ci.org/lightcopy/spark-github-pr" target="_blank"><img src="https://camo.githubusercontent.com/11d534d755982a529a87af4aba3cb5c86621e565/68747470733a2f2f7472617669732d63692e6f72672f6c69676874636f70792f737061726b2d6769746875622d70722e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/lightcopy/spark-github-pr.svg?branch=master" style="max-width:100%;"></a> <a href="https://coveralls.io/github/lightcopy/spark-github-pr?branch=master" target="_blank"><img src="https://camo.githubusercontent.com/f8ceccf2dff254151ea159dec650ed7771db4bb6/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6769746875622f6c69676874636f70792f737061726b2d6769746875622d70722f62616467652e7376673f6272616e63683d6d6173746572" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/github/lightcopy/spark-github-pr/badge.svg?branch=master" style="max-width:100%;"></a></p> 
  <h2><a id="user-content-overview" class="anchor" href="https://github.com/lightcopy/spark-github-pr#overview" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Overview</h2> 
  <p>Package allows to query GitHub API v3 to fetch pull request information. Launches first requests on driver to list available pull requests, and creates tasks with pull requests details to execute. PRs are cached in <code>cacheDir</code> value to save rate limit. It is recommended to use token to remove 60 requests/hour constraint. Most of JSON keys are supported, see schema <a href="https://github.com/lightcopy/spark-github-pr/blob/master/src/main/scala/com/github/lightcopy/spark/pr/PullRequestRelation.scala#L106" target="_blank">here</a>, here is an example output for subset of columns you might see:</p> 
  <div class="highlight highlight-source-shell">
   <pre>scala<span class="pl-k">&gt;</span> df.<span class="pl-k">select</span>(<span class="pl-s"><span class="pl-pds">"</span>number<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>state<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>base.repo.full_name<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>user.login<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>commits<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>additions<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>deletions<span class="pl-pds">"</span></span>)

+------+--------------------+-----+------------+------------+-------+---------+---------+
<span class="pl-k">|</span>number<span class="pl-k">|</span>               title<span class="pl-k">|</span>state<span class="pl-k">|</span>   full_name<span class="pl-k">|</span>       login<span class="pl-k">|</span>commits<span class="pl-k">|</span>additions<span class="pl-k">|</span>deletions<span class="pl-k">|</span>
+------+--------------------+-----+------------+------------+-------+---------+---------+
<span class="pl-k">|</span> 15599<span class="pl-k">|</span>[SPARK-18022][SQL...<span class="pl-k">|</span> open<span class="pl-k">|</span>apache/spark<span class="pl-k">|</span>      srowen<span class="pl-k">|</span>      1<span class="pl-k">|</span>        1<span class="pl-k">|</span>        1<span class="pl-k">|</span>
<span class="pl-k">|</span> 15598<span class="pl-k">|</span>[SPARK-18027][YAR...<span class="pl-k">|</span> open<span class="pl-k">|</span>apache/spark<span class="pl-k">|</span>      srowen<span class="pl-k">|</span>      1<span class="pl-k">|</span>        2<span class="pl-k">|</span>        0<span class="pl-k">|</span>
<span class="pl-k">|</span> 15597<span class="pl-k">|</span>[SPARK-18063][SQL...<span class="pl-k">|</span> open<span class="pl-k">|</span>apache/spark<span class="pl-k">|</span> jiangxb1987<span class="pl-k">|</span>      2<span class="pl-k">|</span>       16<span class="pl-k">|</span>        6<span class="pl-k">|</span>
<span class="pl-k">|</span> 15596<span class="pl-k">|</span>[SQL] Remove shuf...<span class="pl-k">|</span> open<span class="pl-k">|</span>apache/spark<span class="pl-k">|</span>      viirya<span class="pl-k">|</span>      1<span class="pl-k">|</span>       13<span class="pl-k">|</span>       12<span class="pl-k">|</span>
+------+--------------------+-----+------------+------------+-------+---------+---------+</pre>
  </div> 
  <h2><a id="user-content-requirements" class="anchor" href="https://github.com/lightcopy/spark-github-pr#requirements" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Requirements</h2> 
  <table>
   <thead> 
    <tr> 
     <th>Spark version</th> 
     <th>spark-github-pr latest version</th> 
    </tr> 
   </thead>
   <tbody> 
    <tr> 
     <td>1.6.x</td> 
     <td><a href="http://spark-packages.org/package/lightcopy/spark-github-pr" target="_blank">1.1.0</a></td> 
    </tr> 
    <tr> 
     <td>2.x.x</td> 
     <td><a href="http://spark-packages.org/package/lightcopy/spark-github-pr" target="_blank">1.1.0</a></td> 
    </tr> 
   </tbody>
  </table> 
  <h2><a id="user-content-linking" class="anchor" href="https://github.com/lightcopy/spark-github-pr#linking" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Linking</h2> 
  <p>The spark-github-pr package can be added to Spark by using the <code>--packages</code> command line option. For example, run this to include it when starting the spark shell:</p> 
  <div class="highlight highlight-source-shell">
   <pre> <span class="pl-smi">$SPARK_HOME</span>/bin/spark-shell --packages lightcopy:spark-github-pr:1.1.0-s_2.10</pre>
  </div> 
  <p>Change to <code>lightcopy:spark-github-pr:1.1.0-s_2.11</code> for Scala 2.11.x</p> 
  <h3><a id="user-content-options" class="anchor" href="https://github.com/lightcopy/spark-github-pr#options" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Options</h3> 
  <p>Currently supported options:</p> 
  <table>
   <thead> 
    <tr> 
     <th>Name</th> 
     <th align="center">Since</th> 
     <th align="center">Example</th> 
     <th>Description</th> 
    </tr> 
   </thead>
   <tbody> 
    <tr> 
     <td><code>user</code></td> 
     <td align="center"><code>1.0.0</code></td> 
     <td align="center"><em>apache</em></td> 
     <td>GitHub username or organization, default is <code>apache</code></td> 
    </tr> 
    <tr> 
     <td><code>repo</code></td> 
     <td align="center"><code>1.0.0</code></td> 
     <td align="center"><em>spark</em></td> 
     <td>GitHub repository name for provided user, default is <code>spark</code></td> 
    </tr> 
    <tr> 
     <td><code>batch</code></td> 
     <td align="center"><code>1.0.0</code></td> 
     <td align="center"><em>100</em></td> 
     <td>number of pull requests to fetch, default is 25, must be &gt;= 1 and &lt;= 1000</td> 
    </tr> 
    <tr> 
     <td><code>token</code></td> 
     <td align="center"><code>1.0.0</code></td> 
     <td align="center"><em>auth_token</em></td> 
     <td>authentication token to increase rate limit from 60 to 5000, see <a href="https://developer.github.com/v3/#oauth2-token-sent-in-a-header" target="_blank">GitHub Auth for more info</a></td> 
    </tr> 
    <tr> 
     <td><code>cacheDir</code></td> 
     <td align="center"><code>1.0.0</code></td> 
     <td align="center"><em>file:/tmp/.spark-github-pr</em></td> 
     <td>directory to store cached pull requests information, currently required to be shared folder on local file system or directory on HDFS.</td> 
    </tr> 
   </tbody>
  </table> 
  <h2><a id="user-content-example" class="anchor" href="https://github.com/lightcopy/spark-github-pr#example" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Example</h2> 
  <h3><a id="user-content-scala-api" class="anchor" href="https://github.com/lightcopy/spark-github-pr#scala-api" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Scala API</h3> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c">// Load default number of pull requests from apache/spark</span>
<span class="pl-k">val</span> <span class="pl-en">df</span> <span class="pl-k">=</span> sqlContext.read.format(<span class="pl-s"><span class="pl-pds">"</span>com.github.lightcopy.spark.pr<span class="pl-pds">"</span></span>).load().
  select(<span class="pl-s"><span class="pl-pds">"</span>number<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>user.login<span class="pl-pds">"</span></span>)

<span class="pl-k">val</span> <span class="pl-en">df</span> <span class="pl-k">=</span> sqlContext.read.format(<span class="pl-s"><span class="pl-pds">"</span>com.github.lightcopy.spark.pr<span class="pl-pds">"</span></span>).
  option(<span class="pl-s"><span class="pl-pds">"</span>user<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>apache<span class="pl-pds">"</span></span>).option(<span class="pl-s"><span class="pl-pds">"</span>repo<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>spark<span class="pl-pds">"</span></span>).load().
  select(<span class="pl-s"><span class="pl-pds">"</span>number<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>state<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>base.repo.full_name<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>user.login<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>commits<span class="pl-pds">"</span></span>)

<span class="pl-c">// You can also specify batch size for number of pull requests to fetch</span>
<span class="pl-k">val</span> <span class="pl-en">df</span> <span class="pl-k">=</span> sqlContext.read.format(<span class="pl-s"><span class="pl-pds">"</span>com.github.lightcopy.spark.pr<span class="pl-pds">"</span></span>).
  option(<span class="pl-s"><span class="pl-pds">"</span>user<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>apache<span class="pl-pds">"</span></span>).option(<span class="pl-s"><span class="pl-pds">"</span>repo<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>spark<span class="pl-pds">"</span></span>).option(<span class="pl-s"><span class="pl-pds">"</span>batch<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>52<span class="pl-pds">"</span></span>).load()</pre>
  </div> 
  <h3><a id="user-content-python-api" class="anchor" href="https://github.com/lightcopy/spark-github-pr#python-api" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Python API</h3> 
  <div class="highlight highlight-source-python">
   <pre>df <span class="pl-k">=</span> sqlContext.read.format(<span class="pl-s"><span class="pl-pds">"</span>com.github.lightcopy.spark.pr<span class="pl-pds">"</span></span>).
  option(<span class="pl-s"><span class="pl-pds">"</span>user<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>apache<span class="pl-pds">"</span></span>).option(<span class="pl-s"><span class="pl-pds">"</span>repo<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>spark<span class="pl-pds">"</span></span>)load()

res <span class="pl-k">=</span> df.where(<span class="pl-s"><span class="pl-pds">"</span>commits &gt; 10<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <h3><a id="user-content-sql-api" class="anchor" href="https://github.com/lightcopy/spark-github-pr#sql-api" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>SQL API</h3> 
  <div class="highlight highlight-source-sql">
   <pre>CREATE TEMPORARY TABLE prs
USING <span class="pl-c1">com</span>.<span class="pl-c1">github</span>.<span class="pl-c1">lightcopy</span>.<span class="pl-c1">spark</span>.pr
OPTIONS (user <span class="pl-s"><span class="pl-pds">"</span>apache<span class="pl-pds">"</span></span>, repo <span class="pl-s"><span class="pl-pds">"</span>spark<span class="pl-pds">"</span></span>);

<span class="pl-k">SELECT</span> <span class="pl-k">number</span>, title <span class="pl-k">FROM</span> prs <span class="pl-k">LIMIT</span> <span class="pl-c1">10</span>;</pre>
  </div> 
  <h2><a id="user-content-building-from-source" class="anchor" href="https://github.com/lightcopy/spark-github-pr#building-from-source" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Building From Source</h2> 
  <p>This library is built using <code>sbt</code>, to build a JAR file simply run <code>sbt package</code> from project root.</p> 
  <h2><a id="user-content-testing" class="anchor" href="https://github.com/lightcopy/spark-github-pr#testing" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Testing</h2> 
  <p>Run <code>sbt test</code> from project root. CI runs for Spark 2.0 only.</p> 
 </article>
</div>