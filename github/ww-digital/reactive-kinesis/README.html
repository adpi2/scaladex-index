<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-reactive-kinesis--" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#reactive-kinesis--" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>reactive-kinesis <a href="https://travis-ci.org/WW-Digital/reactive-kinesis" target="_blank"><img src="https://camo.githubusercontent.com/cc08e96eacfc3df9dabf391fd180a467be00676a/68747470733a2f2f7472617669732d63692e6f72672f57572d4469676974616c2f72656163746976652d6b696e657369732e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/WW-Digital/reactive-kinesis.svg?branch=master" style="max-width:100%;"></a> <a href="https://coveralls.io/github/WW-Digital/reactive-kinesis?branch=master" target="_blank"><img src="https://camo.githubusercontent.com/107f49571cb6dc5d27798d57eccd25da0bbe7299/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6769746875622f57572d4469676974616c2f72656163746976652d6b696e657369732f62616467652e7376673f6272616e63683d6d6173746572" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/github/WW-Digital/reactive-kinesis/badge.svg?branch=master" style="max-width:100%;"></a></h1> 
  <p>Kinesis client built upon Amazon's KCL (<a href="http://docs.aws.amazon.com/streams/latest/dev/developing-consumers-with-kcl.html" target="_blank">Kinesis Client Library</a>) &amp; KPL (<a href="http://docs.aws.amazon.com/streams/latest/dev/developing-producers-with-kpl.html" target="_blank">Kinesis Producer Library</a>).</p> 
  <p>It's worth familiarising yourself with <a href="http://docs.aws.amazon.com/streams/latest/dev/kinesis-kpl-consumer-deaggregation.html" target="_blank">Sequence numbers and Sub sequence numbers</a>.</p> 
  <h1><a id="user-content-contents" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#contents" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Contents</h1> 
  <ul> 
   <li><a href="https://github.com/ww-digital/reactive-kinesis#dependency-resolution" target="_blank">Dependency Resolution</a></li> 
   <li><a href="https://github.com/ww-digital/reactive-kinesis#considerations-when-using-kinesis-in-a-distributed-environment" target="_blank">Considerations When Using Kinesis in a Distributed Environment</a> 
    <ul> 
     <li><a href="https://github.com/ww-digital/reactive-kinesis#considerations-when-using-kinesis-in-a-distributed-environment-required-minimum-sharding-for-read-based-applications" target="_blank">Required Minimum Sharding for Read-Based Applications</a></li> 
     <li><a href="https://github.com/ww-digital/reactive-kinesis#considerations-when-using-kinesis-in-a-distributed-environment-dynamodb-checkpoint-storage" target="_blank">DynamoDB Checkpoint Storage</a></li> 
    </ul> </li> 
   <li><a href="https://github.com/ww-digital/reactive-kinesis#usage" target="_blank">Usage</a> 
    <ul> 
     <li><a href="https://github.com/ww-digital/reactive-kinesis#usage-kinesis-streams-and-auth" target="_blank">Kinesis streams and auth</a></li> 
     <li><a href="https://github.com/ww-digital/reactive-kinesis#usage-defining-a-config-file-in-the-client-application" target="_blank">Defining a config file in the client application</a> 
      <ul> 
       <li><a href="https://github.com/ww-digital/reactive-kinesis#usage-defining-a-config-file-in-the-client-application-notable-consumer-configuration-values" target="_blank">Notable Consumer Configuration Values</a></li> 
       <li><a href="https://github.com/ww-digital/reactive-kinesis#usage-defining-a-config-file-in-the-client-application-notable-producer-configuration-values" target="_blank">Notable Producer Configuration Values</a></li> 
      </ul> </li> 
     <li><a href="https://github.com/ww-digital/reactive-kinesis#usage-usage-consumer" target="_blank">Usage: Consumer</a> 
      <ul> 
       <li><a href="https://github.com/ww-digital/reactive-kinesis#usage-usage-consumer-important-considerations-when-implementing-the-event-processor" target="_blank">Important considerations when implementing the Event Processor</a></li> 
       <li><a href="https://github.com/ww-digital/reactive-kinesis#usage-usage-consumer-checkpointing" target="_blank">Checkpointing</a></li> 
       <li><a href="https://github.com/ww-digital/reactive-kinesis#usage-usage-consumer-graceful-shutdown" target="_blank">Graceful Shutdown</a></li> 
      </ul> </li> 
     <li><a href="https://github.com/ww-digital/reactive-kinesis#usage-usage-producer" target="_blank">Usage: Producer</a> 
      <ul> 
       <li><a href="https://github.com/ww-digital/reactive-kinesis#usage-usage-producer-actor-based-implementation" target="_blank">Actor Based Implementation</a></li> 
       <li><a href="https://github.com/ww-digital/reactive-kinesis#usage-usage-producer-pure-scala-based-implementation-simple-wrapper-around-kpl" target="_blank">Pure Scala based implementation (simple wrapper around KPL)</a></li> 
      </ul> </li> 
    </ul> </li> 
   <li><a href="https://github.com/ww-digital/reactive-kinesis#running-the-reliability-test" target="_blank">Running the reliability test</a> 
    <ul> 
     <li><a href="https://github.com/ww-digital/reactive-kinesis#running-the-reliability-test-delete-recreate-kinesisstreams-and-dynamo-table" target="_blank">Delete &amp; recreate kinesisstreams and dynamo table</a></li> 
     <li><a href="https://github.com/ww-digital/reactive-kinesis#running-the-reliability-test-running-the-producer-consumer-test" target="_blank">Running the producer-consumer test</a></li> 
    </ul> </li> 
   <li><a href="https://github.com/ww-digital/reactive-kinesis#faq" target="_blank">FAQ</a></li> 
   <li><a href="https://github.com/ww-digital/reactive-kinesis#contributor-guide" target="_blank">Contributor Guide</a> 
    <ul> 
     <li><a href="https://github.com/ww-digital/reactive-kinesis#contributor-guide-code-formatting" target="_blank">Code Formatting</a></li> 
     <li><a href="https://github.com/ww-digital/reactive-kinesis#contributor-guide-tag-requirements" target="_blank">Tag Requirements</a> 
      <ul> 
       <li><a href="https://github.com/ww-digital/reactive-kinesis#contributor-guide-tag-requirements-version-information" target="_blank">Version information</a></li> 
       <li><a href="https://github.com/ww-digital/reactive-kinesis#contributor-guide-tag-requirements-valid-release-tag-examples" target="_blank">Valid Release Tag Examples:</a></li> 
       <li><a href="https://github.com/ww-digital/reactive-kinesis#contributor-guide-tag-requirements-invalid-release-tag-examples" target="_blank">Invalid Release Tag Examples:</a></li> 
      </ul> </li> 
    </ul> </li> 
   <li><a href="https://github.com/ww-digital/reactive-kinesis#contribution-policy" target="_blank">Contribution policy</a></li> 
   <li><a href="https://github.com/ww-digital/reactive-kinesis#license" target="_blank">License</a></li> 
  </ul> 
  <p><a name="user-content-dependency-resolution" target="_blank" href=""></a></p> 
  <h1><a id="user-content-dependency-resolution" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#dependency-resolution" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Dependency Resolution</h1> 
  <p>SBT</p> 
  <pre><code>"com.weightwatchers" %% "reactive-kinesis" % 0.5.0
</code></pre> 
  <p>Maven</p> 
  <pre><code>&lt;dependency&gt;
  &lt;groupId&gt;com.weightwatchers&lt;/groupId&gt;
  &lt;artifactId&gt;reactive-kinesis_2.11&lt;/artifactId&gt;
  &lt;version&gt;0.5.0&lt;/version&gt;
  &lt;type&gt;pom&lt;/type&gt;
&lt;/dependency&gt;
</code></pre> 
  <p>Snapshots will be published <a href="https://oss.jfrog.org/webapp/#/artifacts/browse/simple/General/oss-snapshot-local/com/weightwatchers" target="_blank">here</a></p> 
  <p>You will need the following resolver for snapshots: <code>https://oss.jfrog.org/artifactory/oss-snapshot-local</code></p> 
  <p><a name="user-content-considerations-when-using-kinesis-in-a-distributed-environment" target="_blank" href=""></a></p> 
  <h1><a id="user-content-considerations-when-using-kinesis-in-a-distributed-environment" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#considerations-when-using-kinesis-in-a-distributed-environment" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Considerations When Using Kinesis in a Distributed Environment</h1> 
  <p><a name="user-content-considerations-when-using-kinesis-in-a-distributed-environment-required-minimum-sharding-for-read-based-applications" target="_blank" href=""></a></p> 
  <h2><a id="user-content-required-minimum-sharding-for-read-based-applications" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#required-minimum-sharding-for-read-based-applications" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Required Minimum Sharding for Read-Based Applications</h2> 
  <p>From <a href="http://docs.aws.amazon.com/streams/latest/dev/kinesis-record-processor-scaling.html" target="_blank">http://docs.aws.amazon.com/streams/latest/dev/kinesis-record-processor-scaling.html</a>:</p> 
  <blockquote> 
   <p>Typically, when you use the KCL, you should ensure that the number of instances does not exceed the number of shards (except for failure standby purposes). Each shard is processed by exactly one KCL worker and has exactly one corresponding record processor, so you never need multiple instances to process one shard. However, one worker can process any number of shards, so it's fine if the number of shards exceeds the number of instances.</p> 
  </blockquote> 
  <p>For our purposes, this means <em>any service reading from Kinesis should expect to have one shard per instance, as a minimum</em>. Note that this is specifically for consuming events. Producers don't have the same shard restrictions.</p> 
  <p><a name="user-content-considerations-when-using-kinesis-in-a-distributed-environment-dynamodb-checkpoint-storage" target="_blank" href=""></a></p> 
  <h2><a id="user-content-dynamodb-checkpoint-storage" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#dynamodb-checkpoint-storage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>DynamoDB Checkpoint Storage</h2> 
  <p>Amazon's KCL uses DynamoDB to checkpoint progress through reading the stream. When DynamoDB tables are provisioned automatically, for this purpose, they may have a relatively high write-throughput, which can incur additional cost.</p> 
  <p>You should make sure that the DynamoDB table used for checkpointing your stream</p> 
  <ol> 
   <li> <p>Has a reasonable write throughput defined</p> </li> 
   <li> <p>Is cleaned up when you're done with it -- KCL will not automatically delete it for you</p> </li> 
  </ol> 
  <p>The checkpointer will automatically throttle if the write throughput is not sufficient, look out for the following info log:</p> 
  <p><code>Throttled by DynamoDB on checkpointing -- backing off...</code></p> 
  <p><a name="user-content-usage" target="_blank" href=""></a></p> 
  <h1><a id="user-content-usage" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h1> 
  <p><a name="user-content-usage-kinesis-streams-and-auth" target="_blank" href=""></a></p> 
  <h2><a id="user-content-kinesis-streams-and-auth" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#kinesis-streams-and-auth" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Kinesis streams and auth</h2> 
  <p>The stream you have configured must already exist in AWS, e.g.</p> 
  <pre><code>aws kinesis create-stream --stream-name core-test-foo --shard-count 1
</code></pre> 
  <p>For local development, it's expected that you already have a file called <code>~/.aws/credentials</code>, which contains an AWS access key and secret e.g.</p> 
  <pre><code>[default]
aws_access_key_id=AKIAXXXXXXXXX999999X
aws_secret_access_key=AAAAAAAAAAAA000000000+AAAAAAAAAAAAAAAAAA
</code></pre> 
  <p>Both the producer and consumer use the <a href="http://docs.aws.amazon.com/java-sdk/latest/developer-guide/credentials.html#id6" target="_blank">DefaultAWSCredentialsProviderChain</a>.</p> 
  <p><a name="user-content-usage-defining-a-config-file-in-the-client-application" target="_blank" href=""></a></p> 
  <h2><a id="user-content-defining-a-config-file-in-the-client-application" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#defining-a-config-file-in-the-client-application" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Defining a config file in the client application</h2> 
  <p>You'll need some configuration values provided in the application which leverages this library, As a minimum you'll need:</p> 
  <pre><code>kinesis {

   application-name = "SampleService"

   # The name of the this producer, we can have many producers per application.
   # MUST contain the stream-name as a minimum. Any additional settings defined will override
   # defaults in the kinesis.producer reference.conf for this producer only.
   some-producer {
      # The name of the producer stream
      stream-name = "sample-producer"

      kpl {
         Region = us-east-1
      }
   }

   # The name of the consumer, we can have many consumers per application
   some-consumer {
      # The name of the consumer stream, MUST be specified per consumer and MUST exist
      stream-name = "sample-consumer"
   }
   
   some-other-consumer {
      stream-name = "another-sample-consumer"
   }
}
</code></pre> 
  <p>These values will override the default reference.conf. See <code>src/main/resources/reference.conf</code> for a complete reference configuration. and <code>src/it/resources/application.conf</code> for a more detailed override example.</p> 
  <p>The name of the producer/consumer configuration value MUST match what is specified when instantiating the library. This will be merged with the <code>default-consumer</code>/<code>default-producer</code> from <code>reference.conf</code>configuration at runtime.</p> 
  <p>Once these are defined, you can pass them into the Kinesis producer and consumer using a config object (see code examples below).</p> 
  <p>Note that the <code>application-name</code> is combined with the <code>stream-name</code> for each consumer to define the DynamoDB table for checkpointing. For example: <code>SampleService-sample-consumer</code>.</p> 
  <p><a name="user-content-usage-defining-a-config-file-in-the-client-application-notable-consumer-configuration-values" target="_blank" href=""></a></p> 
  <h3><a id="user-content-notable-consumer-configuration-values" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#notable-consumer-configuration-values" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Notable Consumer Configuration Values</h3> 
  <ul> 
   <li><code>kinesis.&lt;consumer-name&gt;.akka.dispatcher</code> - Sets the dispatcher for the consumer, defaults to <code>kinesis.akka.default-dispatcher</code></li> 
   <li><code>kinesis.&lt;consumer-name&gt;.worker.batchTimeoutSeconds</code> - The timeout for processing a batch. Note that any messages not processed within this time will be retried (according to the configuration). After retrying any unconfirmed messages will be considered failed.</li> 
   <li><code>kinesis.&lt;consumer-name&gt;.worker.failedMessageRetries</code> - The number of times to retry failed messages within a batch, after the batch timeout.</li> 
   <li><code>kinesis.&lt;consumer-name&gt;.worker.failureTolerancePercentage</code> - If, after retrying, messages are still unconfirmed. We will either continue processing the next batch, or shutdown processing completely depending on this tolerance percentage.</li> 
   <li><code>kinesis.&lt;consumer-name&gt;.checkpointer.backoffMillis</code> - When DynamoDB throttles us (due to hitting the write threshold) we wait for this amount of time.</li> 
   <li><code>kinesis.&lt;consumer-name&gt;.checkpointer.intervalMillis</code> - The interval between checkpoints. Setting this too high will cause lots of messages to be duplicated in event of a failed node. Setting it too low will result in throttling from DynamoDB.</li> 
   <li><code>kinesis.&lt;consumer-name&gt;.kcl.initialPositionInStream</code> - Controls our strategy for pulling from Kinesis (LATEST, TRIM_HORIZON, ..)</li> 
   <li><code>kinesis.&lt;consumer-name&gt;.kcl.maxRecords</code> - The maximum batch size.</li> 
  </ul> 
  <p><a name="user-content-usage-defining-a-config-file-in-the-client-application-notable-producer-configuration-values" target="_blank" href=""></a></p> 
  <h3><a id="user-content-notable-producer-configuration-values" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#notable-producer-configuration-values" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Notable Producer Configuration Values</h3> 
  <ul> 
   <li><code>kinesis.&lt;producer-name&gt;.akka.dispatcher</code> - Sets the dispatcher for the producer, defaults to <code>kinesis.akka.default-dispatcher</code></li> 
   <li><code>kinesis.&lt;producer-name&gt;.akka.max-outstanding-requests</code> - Enables artificial throttling within the Producer. This limits the number of futures in play at any one time. Each message creates a new future (internally in the KPL), which allows us to track the progress of sent messages when they go with the next batch.</li> 
   <li><code>kinesis.&lt;producer-name&gt;.akka.throttling-retry-millis</code> - How soon to retry after hitting the above throttling cap.</li> 
   <li><code>kinesis.&lt;producer-name&gt;.kpl.AggregationEnabled</code> - Enables <a href="http://docs.aws.amazon.com/streams/latest/dev/kinesis-producer-adv-aggregation.html" target="_blank">aggregation of messages</a>.</li> 
   <li><code>kinesis.&lt;producer-name&gt;.kpl.Region</code> - The AWS Region to use.</li> 
   <li><code>kinesis.&lt;producer-name&gt;.kpl.RateLimit</code> - Limits the maximum allowed put rate for a shard, as a percentage of the backend limits.</li> 
  </ul> 
  <p><a name="user-content-usage-usage-consumer" target="_blank" href=""></a></p> 
  <h2><a id="user-content-usage-consumer" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#usage-consumer" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage: Consumer</h2> 
  <p><a href="https://camo.githubusercontent.com/1283e5a283c778cc09c9983bb48aa90e73132f52/68747470733a2f2f7777772e6c7563696463686172742e636f6d2f7075626c69635365676d656e74732f766965772f36396237623764312d626330392d346463632d616231622d6130663763366531666663362f696d6167652e706e67" target="_blank"><img src="https://camo.githubusercontent.com/1283e5a283c778cc09c9983bb48aa90e73132f52/68747470733a2f2f7777772e6c7563696463686172742e636f6d2f7075626c69635365676d656e74732f766965772f36396237623764312d626330392d346463632d616231622d6130663763366531666663362f696d6167652e706e67" alt="Consumer Architecture" data-canonical-src="https://www.lucidchart.com/publicSegments/view/69b7b7d1-bc09-4dcc-ab1b-a0f7c6e1ffc6/image.png" style="max-width:100%;"></a></p> 
  <p>Implementing the consumer requires a simple actor which is responsible for processing messages sent to it by the library. We call this the <code>Event Processor</code>. Upon creating an instance of the <code>KinesisConsumer</code>, internally one <code>ConsumerWorker</code> (this is different from the KCL Worker) is created per shard (shards are distributed amongst consumers automatically). This consumer worker is what sends messages to the <code>Event Processor</code>. Note that the <code>Event Processor</code> is shared amongst ALL shards, so it is important not to cache the sender of previous messages. It is perfectly valid to use a router to spread the work amongst many <code>Event Processor</code> actors.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">akka.actor.</span>{<span class="pl-v">Actor</span>, <span class="pl-v">Props</span>}
<span class="pl-k">import</span> <span class="pl-v">com.typesafe.config.</span><span class="pl-v">ConfigFactory</span>
<span class="pl-k">import</span> <span class="pl-v">com.typesafe.scalalogging.</span><span class="pl-v">LazyLogging</span>
<span class="pl-k">import</span> <span class="pl-v">com.weightwatchers.reactive.kinesis.consumer.ConsumerWorker.</span>{<span class="pl-v">ConsumerShutdown</span>, <span class="pl-v">ConsumerWorkerFailure</span>, <span class="pl-v">EventProcessed</span>, <span class="pl-v">ProcessEvent</span>}
<span class="pl-k">import</span> <span class="pl-v">com.weightwatchers.reactive.kinesis.consumer.</span><span class="pl-v">KinesisConsumer</span>
<span class="pl-k">import</span> <span class="pl-v">com.weightwatchers.reactive.kinesis.consumer.KinesisConsumer.</span><span class="pl-v">ConsumerConf</span>

<span class="pl-k">class</span> <span class="pl-en">TestEventProcessor</span>() <span class="pl-k">extends</span> <span class="pl-e">Actor</span> <span class="pl-k">with</span> <span class="pl-e">LazyLogging</span> {

  <span class="pl-k">import</span> <span class="pl-v">scala.concurrent.duration.</span><span class="pl-v">_</span>

  <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">timeout</span> <span class="pl-k">=</span> akka.util.<span class="pl-en">Timeout</span>(<span class="pl-c1">5.</span>minutes)


  <span class="pl-c"><span class="pl-c">//</span> scalastyle:off method.length</span>
  <span class="pl-k">override</span> <span class="pl-k">def</span> <span class="pl-en">receive</span><span class="pl-k">:</span> <span class="pl-en">Receive</span> <span class="pl-k">=</span> {

    <span class="pl-k">case</span> <span class="pl-en">ProcessEvent</span>(event) <span class="pl-k">=&gt;</span> {
      <span class="pl-c"><span class="pl-c">//</span>Do some processing here...</span>
      sender <span class="pl-k">!</span> <span class="pl-en">EventProcessed</span>(event.sequenceNumber)
    }
    <span class="pl-k">case</span> <span class="pl-en">ConsumerWorkerFailure</span>(failedEvents, shardId) <span class="pl-k">=&gt;</span>
    <span class="pl-c"><span class="pl-c">//</span> Consumer failure, no more messages will be consumed!! Depending on the purpose of this service this may be critical.</span>

    <span class="pl-k">case</span> <span class="pl-en">ConsumerShutdown</span>(shardId) <span class="pl-k">=&gt;</span>
    <span class="pl-c"><span class="pl-c">//</span> The Consumer has shutdown all shards on this instance (gracefully, or as a result of a failure).</span>
  }
}

<span class="pl-k">object</span> <span class="pl-en">Consumer</span> <span class="pl-k">extends</span> <span class="pl-e">App</span> {
  <span class="pl-k">val</span> <span class="pl-en">system</span> <span class="pl-k">=</span> akka.actor.<span class="pl-en">ActorSystem</span>.create(<span class="pl-s"><span class="pl-pds">"</span>test-system<span class="pl-pds">"</span></span>)
  <span class="pl-k">val</span> <span class="pl-en">config</span> <span class="pl-k">=</span> <span class="pl-en">ConfigFactory</span>.load()
  <span class="pl-k">val</span> <span class="pl-en">eventProcessor</span> <span class="pl-k">=</span> system.actorOf(<span class="pl-en">Props</span>[<span class="pl-en">TestEventProcessor</span>], <span class="pl-s"><span class="pl-pds">"</span>test-processor<span class="pl-pds">"</span></span>)
  <span class="pl-k">val</span> <span class="pl-en">consumer</span> <span class="pl-k">=</span> <span class="pl-en">KinesisConsumer</span>(<span class="pl-en">ConsumerConf</span>(config.getConfig(<span class="pl-s"><span class="pl-pds">"</span>kinesis<span class="pl-pds">"</span></span>), <span class="pl-s"><span class="pl-pds">"</span>some-consumer<span class="pl-pds">"</span></span>), 
                                 eventProcessor, system)
  consumer.start()
}</pre>
  </div> 
  <p>The following types must be handled:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.weightwatchers.reactive.kinesis.consumer.ConsumerWorker.</span>{<span class="pl-v">ConsumerShutdown</span>, <span class="pl-v">ConsumerWorkerFailure</span>, <span class="pl-v">EventProcessed</span>, <span class="pl-v">ProcessEvent</span>}

<span class="pl-c"><span class="pl-c">/**</span></span>
<span class="pl-c">  * Sent to the eventProcessor for each message in the batch.</span>
<span class="pl-c">  <span class="pl-c">*/</span></span>
  <span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">ProcessEvent</span>(<span class="pl-v">consumerEvent</span>: <span class="pl-en">ConsumerEvent</span>)

<span class="pl-c"><span class="pl-c">/**</span></span>
<span class="pl-c">  * Expected in response to a [[<span class="pl-e">ProcessEvent</span>]] message after processing is complete</span>
<span class="pl-c">  *</span>
<span class="pl-c">  * <span class="pl-k">@param</span> <span class="pl-v">compoundSeqNo</span> This is a combination of the sequence and subsequence numbers</span>
<span class="pl-c">  * <span class="pl-k">@param</span> <span class="pl-v">successful</span>    Set this to false to skip this message.</span>
<span class="pl-c">  <span class="pl-c">*/</span></span>
<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">EventProcessed</span>(<span class="pl-v">compoundSeqNo</span>: <span class="pl-en">CompoundSequenceNumber</span>, <span class="pl-v">successful</span>: <span class="pl-k">Boolean</span> <span class="pl-k">=</span> <span class="pl-c1">true</span>)

<span class="pl-c"><span class="pl-c">/**</span></span>
<span class="pl-c">  * Sent to the eventProcessor if batch processing fails (above the tolerance after retrying)</span>
<span class="pl-c">  * before shutting down processing on this shard.</span>
<span class="pl-c">  * <span class="pl-k">@param</span> <span class="pl-v">failedEvents</span> The events that failed processing within the time.</span>
<span class="pl-c">  * <span class="pl-k">@param</span> <span class="pl-v">shardId</span>      The shardId of the worker causing the failure.</span>
<span class="pl-c">  <span class="pl-c">*/</span></span>
<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">ConsumerWorkerFailure</span>(<span class="pl-v">failedEvents</span>: <span class="pl-en">Seq</span>[<span class="pl-en">ConsumerEvent</span>], <span class="pl-v">shardId</span>: <span class="pl-k">String</span>)

<span class="pl-c"><span class="pl-c">/**</span></span>
<span class="pl-c">  * Sent to the eventProcessor upon shutdown of this worker.</span>
<span class="pl-c">  <span class="pl-c">*/</span></span>
<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">ConsumerShutdown</span>(<span class="pl-v">shardId</span>: <span class="pl-k">String</span>)</pre>
  </div> 
  <p><a name="user-content-usage-usage-consumer-important-considerations-when-implementing-the-event-processor" target="_blank" href=""></a></p> 
  <h3><a id="user-content-important-considerations-when-implementing-the-event-processor" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#important-considerations-when-implementing-the-event-processor" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Important considerations when implementing the Event Processor</h3> 
  <ul> 
   <li>The Event Processor MUST handle [[ProcessEvent]] messages (for each message)</li> 
   <li>The Event Processor MUST respond with [[EventProcessed]] after processing of the [[ProcessEvent]]</li> 
   <li>The Event Processor may set <code>successful</code> to false to indicate the message can be skipped</li> 
   <li>The Event Processor SHOULD handle [[ConsumerWorkerFailure]] messages which signal a critical failure in the Consumer.</li> 
   <li>The Event Processor SHOULD handle [[ConsumerShutdown]] messages which siganl a graceful shutdown of the Consumer.</li> 
  </ul> 
  <p><a name="user-content-usage-usage-consumer-checkpointing" target="_blank" href=""></a></p> 
  <h3><a id="user-content-checkpointing" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#checkpointing" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Checkpointing</h3> 
  <p>The client will handle checkpointing asynchronously PER SHARD according to the configuration using a separate actor.</p> 
  <p><a name="user-content-usage-usage-consumer-graceful-shutdown" target="_blank" href=""></a></p> 
  <h3><a id="user-content-graceful-shutdown" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#graceful-shutdown" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Graceful Shutdown</h3> 
  <p>Currently the KinesisConsumer Shutdown works as follows:</p> 
  <ul> 
   <li>Shutdown is called on the <code>KinesisConsumer</code> (either explicitly or via the jvm shutdown hook)</li> 
   <li>This then calls <code>requestShutdown</code> on the KCL Worker, blocking until completion.</li> 
   <li>The KCL Worker propagates this down to the <code>ConsumerProcessingManager</code> (Which is the <code>IRecordProcessor</code>) - calling <code>shutdownRequested</code> on each instance (one per shard).</li> 
   <li>When <code>shutdownRequested</code> is called, this sends a <code>GracefulShutdown</code> message to the <code>ConsumerWorker</code> Actor, blocking until a response is received (Ask + Await).</li> 
   <li>On receipt of this message, the <code>ConsumerWorker</code> switches context to ignore all future messages. If a batch is currently being processed, it responds to the sender of that batch (the manager), which will currently be blocking awaiting confirmation of the batch (this is by design, the KCL requires that we don't complete the <code>processRecords</code> function until we have finished the batch, otherwise the next batch is immediately sent)</li> 
   <li>The <code>ConsumerWorker</code> then forces a final checkpoint, responding to the manager once completed (or failed), which allows shutdown to continue and the <code>KinesisConsumer</code> to shutdown.</li> 
   <li>The shutdown timeout is configured by: <code>kinesis.&lt;consumer-name&gt;.worker.shutdownTimeoutSeconds</code></li> 
   <li>The shutdown hooks can be disabled using: <code>kinesis.&lt;consumer-name&gt;.worker.gracefulShutdownHook</code></li> 
  </ul> 
  <p><a name="user-content-usage-usage-producer" target="_blank" href=""></a></p> 
  <h2><a id="user-content-usage-producer" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#usage-producer" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage: Producer</h2> 
  <p>The KPL Client sends messages in batches, each message creates a Future which completes upon successful send or failure.</p> 
  <p>See Amazon's documentation for more information: <a href="https://github.com/awslabs/amazon-kinesis-producer" target="_blank">https://github.com/awslabs/amazon-kinesis-producer</a></p> 
  <p><a name="user-content-usage-usage-producer-actor-based-implementation" target="_blank" href=""></a></p> 
  <h3><a id="user-content-actor-based-implementation" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#actor-based-implementation" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Actor Based Implementation</h3> 
  <p>This implementation will optionally throttle of the number of futures currently in play, according to the <code>max-outstanding-requests</code> property.</p> 
  <p>Each future is handled within the actor and a message will be returned to the sender upon completion.</p> 
  <p>The following messages are supported:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.weightwatchers.reactive.kinesis.producer.KinesisProducerActor.</span>{<span class="pl-v">SendFailed</span>, <span class="pl-v">SendSuccessful</span>, <span class="pl-v">SendWithCallback</span>}

<span class="pl-c"><span class="pl-c">/**</span></span>
<span class="pl-c">  * Send a message to Kinesis, registering a callback response of [[<span class="pl-e">SendSuccessful</span>]] or [[<span class="pl-e">SendFailed</span>]] accordingly.</span>
<span class="pl-c">  <span class="pl-c">*/</span></span>
<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">SendWithCallback</span>(<span class="pl-v">producerEvent</span>: <span class="pl-en">ProducerEvent</span>, <span class="pl-v">messageId</span>: <span class="pl-k">String</span> <span class="pl-k">=</span> <span class="pl-en">UUID_GENERATOR</span>.generate().toString)

<span class="pl-c"><span class="pl-c">/**</span></span>
<span class="pl-c">  * Send a message to Kinesis witout any callbacks. Fire and forget.</span>
<span class="pl-c">  <span class="pl-c">*/</span></span>
<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Send</span>(<span class="pl-v">producerEvent</span>: <span class="pl-en">ProducerEvent</span>)

<span class="pl-c"><span class="pl-c">/**</span></span>
<span class="pl-c">  * Sent to the sender in event of a successful completion.</span>
<span class="pl-c">  *</span>
<span class="pl-c">  * <span class="pl-k">@param</span> <span class="pl-v">messageId</span>        The id of the event that was sent.</span>
<span class="pl-c">  * <span class="pl-k">@param</span> <span class="pl-v">userRecordResult</span> The Kinesis data regarding the send.</span>
<span class="pl-c">  <span class="pl-c">*/</span></span>
<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">SendSuccessful</span>(<span class="pl-v">messageId</span>: <span class="pl-k">String</span>, <span class="pl-v">userRecordResult</span>: <span class="pl-en">UserRecordResult</span>)

<span class="pl-c"><span class="pl-c">/**</span></span>
<span class="pl-c">  * Sent to the sender in event of a failed completion.</span>
<span class="pl-c">  *</span>
<span class="pl-c">  * <span class="pl-k">@param</span> <span class="pl-v">messageId</span> The id of the event that failed.</span>
<span class="pl-c">  * <span class="pl-k">@param</span> <span class="pl-v">reason</span>    The exception causing the failure. Likely to be of type [[<span class="pl-e">UserRecordFailedException</span>]]</span>
<span class="pl-c">  <span class="pl-c">*/</span></span>
<span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">SendFailed</span>(<span class="pl-v">messageId</span>: <span class="pl-k">String</span>, <span class="pl-v">reason</span>: <span class="pl-en">Throwable</span>)</pre>
  </div> 
  <p><a name="user-content-usage-usage-producer-actor-based-implementation-within-an-actor-strongly-recommended" target="_blank" href=""></a></p> 
  <h4><a id="user-content-within-an-actor-strongly-recommended" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#within-an-actor-strongly-recommended" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Within an Actor (Strongly recommended)</h4> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">java.util.</span><span class="pl-v">UUID</span>

<span class="pl-k">import</span> <span class="pl-v">akka.actor.</span><span class="pl-v">Actor</span>
<span class="pl-k">import</span> <span class="pl-v">com.typesafe.config.</span><span class="pl-v">Config</span>
<span class="pl-k">import</span> <span class="pl-v">com.weightwatchers.reactive.kinesis.models.</span><span class="pl-v">ProducerEvent</span>
<span class="pl-k">import</span> <span class="pl-v">com.weightwatchers.reactive.kinesis.producer.</span><span class="pl-v">KinesisProducerActor</span>
<span class="pl-k">import</span> <span class="pl-v">com.weightwatchers.reactive.kinesis.producer.KinesisProducerActor.</span>{<span class="pl-v">SendFailed</span>, <span class="pl-v">SendSuccessful</span>, <span class="pl-v">SendWithCallback</span>}
<span class="pl-k">import</span> <span class="pl-v">samples.SomeActor.</span><span class="pl-v">DoSomething</span>

<span class="pl-k">object</span> <span class="pl-en">SomeActor</span> {
  <span class="pl-k">case</span> <span class="pl-k">object</span> <span class="pl-en">DoSomething</span>
}

<span class="pl-k">class</span> <span class="pl-en">SomeActor</span>(<span class="pl-v">kinesisConfig</span>: <span class="pl-en">Config</span>) <span class="pl-k">extends</span> <span class="pl-e">Actor</span> {

  <span class="pl-k">val</span> <span class="pl-en">kpa</span> <span class="pl-k">=</span> context.actorOf(
    <span class="pl-en">KinesisProducerActor</span>.props(kinesisConfig, <span class="pl-s"><span class="pl-pds">"</span>some-producer<span class="pl-pds">"</span></span>))

  <span class="pl-k">override</span> <span class="pl-k">def</span> <span class="pl-en">receive</span><span class="pl-k">:</span> <span class="pl-en">Receive</span> <span class="pl-k">=</span> {
    <span class="pl-k">case</span> <span class="pl-en">DoSomething</span> <span class="pl-k">=&gt;</span>
      <span class="pl-c"><span class="pl-c">//</span>Do something exciting!</span>
      <span class="pl-k">val</span> <span class="pl-en">producerEvent</span> <span class="pl-k">=</span> <span class="pl-en">ProducerEvent</span>(<span class="pl-en">UUID</span>.randomUUID.toString, <span class="pl-s"><span class="pl-pds">"</span>{Some Payload}<span class="pl-pds">"</span></span>)
      kpa <span class="pl-k">!</span> <span class="pl-en">SendWithCallback</span>(producerEvent)

    <span class="pl-c"><span class="pl-c">//</span>Callbacks from the KinesisProducerActor</span>
    <span class="pl-k">case</span> <span class="pl-en">SendSuccessful</span>(messageId, _) <span class="pl-k">=&gt;</span>
      println(s<span class="pl-s"><span class="pl-pds">"</span>Successfully sent $messageId<span class="pl-pds">"</span></span>)

    <span class="pl-k">case</span> <span class="pl-en">SendFailed</span>(messageId, reason) <span class="pl-k">=&gt;</span>
      println(s<span class="pl-s"><span class="pl-pds">"</span>Failed to send $messageId, cause: ${reason.getMessage}<span class="pl-pds">"</span></span>)
  }
}</pre>
  </div> 
  <p><a name="user-content-usage-usage-producer-actor-based-implementation-from-outside-of-an-actor" target="_blank" href=""></a></p> 
  <h4><a id="user-content-from-outside-of-an-actor" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#from-outside-of-an-actor" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>From outside of an Actor</h4> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">java.util.</span><span class="pl-v">UUID</span>
<span class="pl-k">import</span> <span class="pl-v">com.typesafe.config.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">com.weightwatchers.reactive.kinesis.models.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">com.weightwatchers.reactive.kinesis.producer.</span><span class="pl-v">KinesisProducerActor</span>
<span class="pl-k">import</span> <span class="pl-v">com.weightwatchers.reactive.kinesis.producer.KinesisProducerActor.</span><span class="pl-v">Send</span>

<span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">system</span> <span class="pl-k">=</span> akka.actor.<span class="pl-en">ActorSystem</span>.create()

<span class="pl-k">val</span> <span class="pl-en">kinesisConfig</span><span class="pl-k">:</span> <span class="pl-en">Config</span> <span class="pl-k">=</span> <span class="pl-en">ConfigFactory</span>.load().getConfig(<span class="pl-s"><span class="pl-pds">"</span>kinesis<span class="pl-pds">"</span></span>)

<span class="pl-c"><span class="pl-c">//</span> where testProducer is the name in the configuration</span>
<span class="pl-k">val</span> <span class="pl-en">kpa</span> <span class="pl-k">=</span> system.actorOf(<span class="pl-en">KinesisProducerActor</span>.props(kinesisConfig, <span class="pl-s"><span class="pl-pds">"</span>some-producer<span class="pl-pds">"</span></span>))

<span class="pl-k">val</span> <span class="pl-en">producerEvent</span> <span class="pl-k">=</span> <span class="pl-en">ProducerEvent</span>(<span class="pl-en">UUID</span>.randomUUID.toString, <span class="pl-s"><span class="pl-pds">"</span>{Some Payload}<span class="pl-pds">"</span></span>)
kpa <span class="pl-k">!</span> <span class="pl-en">Send</span>(producerEvent) <span class="pl-c"><span class="pl-c">//</span>Send without a callback confirmation</span></pre>
  </div> 
  <p><a name="user-content-usage-usage-producer-pure-scala-based-implementation-simple-wrapper-around-kpl" target="_blank" href=""></a></p> 
  <h3><a id="user-content-pure-scala-based-implementation-simple-wrapper-around-kpl" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#pure-scala-based-implementation-simple-wrapper-around-kpl" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Pure Scala based implementation (simple wrapper around KPL)</h3> 
  <p><em>Note that throttling will be unavailable using this method.</em></p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">java.util.</span><span class="pl-v">UUID</span>
<span class="pl-k">import</span> <span class="pl-v">com.amazonaws.services.kinesis.producer.</span>{<span class="pl-v">UserRecordFailedException</span>, <span class="pl-v">UserRecordResult</span>}
<span class="pl-k">import</span> <span class="pl-v">com.typesafe.config.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">com.weightwatchers.reactive.kinesis.models.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">com.weightwatchers.reactive.kinesis.producer.</span><span class="pl-v">KinesisProducerKPL</span>
<span class="pl-k">import</span> <span class="pl-v">scala.concurrent.</span><span class="pl-v">Future</span>
<span class="pl-k">import</span> <span class="pl-v">scala.concurrent.ExecutionContext.Implicits.</span><span class="pl-v">global </span><span class="pl-c"><span class="pl-c">//</span>Not for production</span>

<span class="pl-k">val</span> <span class="pl-en">kinesisConfig</span><span class="pl-k">:</span> <span class="pl-en">Config</span> <span class="pl-k">=</span> <span class="pl-en">ConfigFactory</span>.load().getConfig(<span class="pl-s"><span class="pl-pds">"</span>kinesis<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">producerConfig</span><span class="pl-k">:</span> <span class="pl-en">Config</span> <span class="pl-k">=</span> kinesisConfig.getConfig(<span class="pl-s"><span class="pl-pds">"</span>some-producer<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">streamName</span><span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> producerConfig.getString(<span class="pl-s"><span class="pl-pds">"</span>stream-name<span class="pl-pds">"</span></span>)

<span class="pl-k">val</span> <span class="pl-en">kpl</span> <span class="pl-k">=</span> <span class="pl-en">KinesisProducerKPL</span>(kinesisConfig.getConfig(<span class="pl-s"><span class="pl-pds">"</span>kpl<span class="pl-pds">"</span></span>), streamName)

<span class="pl-k">val</span> <span class="pl-en">producerEvent</span> <span class="pl-k">=</span> <span class="pl-en">ProducerEvent</span>(<span class="pl-en">UUID</span>.randomUUID.toString, <span class="pl-s"><span class="pl-pds">"</span>{Some Payload}<span class="pl-pds">"</span></span>)

<span class="pl-k">val</span> <span class="pl-en">callback</span><span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">UserRecordResult</span>] <span class="pl-k">=</span> kpl.addUserRecord(producerEvent)

callback onSuccess {
  <span class="pl-k">case</span> result <span class="pl-k">=&gt;</span>
    println(<span class="pl-s"><span class="pl-pds">"</span>Success!!<span class="pl-pds">"</span></span>)
}

callback onFailure {
  <span class="pl-k">case</span> <span class="pl-v">ex</span>: <span class="pl-en">UserRecordFailedException</span> <span class="pl-k">=&gt;</span>
    println(s<span class="pl-s"><span class="pl-pds">"</span>Failure! ${ex.getMessage}<span class="pl-pds">"</span></span>)
  <span class="pl-k">case</span> ex <span class="pl-k">=&gt;</span>
    println(s<span class="pl-s"><span class="pl-pds">"</span>Critical Failure! ${ex.getMessage}<span class="pl-pds">"</span></span>)
}</pre>
  </div> 
  <p><a name="user-content-running-the-reliability-test" target="_blank" href=""></a></p> 
  <h1><a id="user-content-running-the-reliability-test" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#running-the-reliability-test" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Running the reliability test</h1> 
  <p><a name="user-content-running-the-reliability-test-delete-recreate-kinesisstreams-and-dynamo-table" target="_blank" href=""></a></p> 
  <h2><a id="user-content-delete--recreate-kinesisstreams-and-dynamo-table" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#delete--recreate-kinesisstreams-and-dynamo-table" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Delete &amp; recreate kinesisstreams and dynamo table</h2> 
  <p>Execute this command in a shell. If you don't have access to WW AWS resources, you'll need it:</p> 
  <pre><code>aws kinesis delete-stream --stream-name test-kinesis-reliability &amp;&amp; aws dynamodb delete-table --table-name KinesisReliabilitySpec &amp;&amp; sleep 90 &amp;&amp; aws kinesis create-stream --stream-name test-kinesis-reliability --shard-count 2
</code></pre> 
  <p><a name="user-content-running-the-reliability-test-running-the-producer-consumer-test" target="_blank" href=""></a></p> 
  <h2><a id="user-content-running-the-producer-consumer-test" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#running-the-producer-consumer-test" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Running the producer-consumer test</h2> 
  <p>Run the <code>SimpleKinesisProducer</code> using the App object.</p> 
  <p>Wait for hte producer to publish all messages.</p> 
  <p>At the end the producer will print the number of unconfirmed and failed messages (both should be 0!).</p> 
  <p>Run the <code>SimpleKinesisConsumer</code> using the App object.</p> 
  <p>Now, wait for two messages that look like this to appear in the consumer window:</p> 
  <pre><code>2016-06-14 20:09:24,938 c.w.c.e.KinesisRecordProcessingManager - Initializing record processor for shard: shardId-000000000001
2016-06-14 20:09:24,963 c.w.c.e.KinesisRecordProcessingManager - Initializing record processor for shard: shardId-000000000000
</code></pre> 
  <p>As the test progresses, watch the consumer window for a message of this format:</p> 
  <pre><code>**** PIT STOP OK
</code></pre> 
  <p>You'll see some stats logged regarding messages/sec processed, near that line.</p> 
  <p><a name="user-content-faq" target="_blank" href=""></a></p> 
  <h1><a id="user-content-faq" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#faq" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>FAQ</h1> 
  <ul> 
   <li>How is DynamoDB used in relation to out checkpointing? 
    <ul> 
     <li>DynamoDB tables will be automatically created, however the write throughput must be configured appropriately using the AWS console or CLI. There is a cost associated with this, but note that setting it too low will cause checkpoint throttling. Configure <code>kinesis.&lt;consumer-name&gt;.checkpointer.intervalMillis</code> accordingly.</li> 
    </ul> </li> 
   <li>How is data sharded? 
    <ul> 
     <li>Sharding relates to the distribution of messages across the shards for a given stream. Ideally you want an even distribution amongst our shards. However ordering is only guaranteed within a given shard, it is therefore important to group related messages by shard. For example if a specific user performs several operations, in which the order of execution matters, then ensuring they land on the same shard will guarantee the order is maintained.</li> 
     <li>For this, the <code>partition key</code> is used. Messages with the same partition key will land on the same shard. In the example above a userId may be a good <code>partition key</code>.</li> 
     <li>Note that if the number of partition keys exceeds the number of shards, some shards necessarily contain records with different partition keys. From a design standpoint, to ensure that all your shards are well utilized, the number of shards should be substantially less than the number of unique partition keys.</li> 
    </ul> </li> 
   <li>How long do we keep data? 
    <ul> 
     <li>By default Kinesis stores data for 24 hours, however this can be extended to 7 days for a fee.</li> 
    </ul> </li> 
   <li>What data is already in the Stream and from where is it consumed? 
    <ul> 
     <li>Kinesis persists data up until the retention period, consuming data does not remove it from the stream. Rather, it moves your <code>checkpoint</code> to the appropriate position.</li> 
     <li>There are a number of options for configuring at which position in the stream a consumer will start, configured by the <code>initialPositionInStream</code> setting.</li> 
     <li>This library default to <code>TRIM_HORIZON</code>, note that if a checkpoint exists in DynamoDB, the application will <strong>always</strong> continue from the last checkpoint. 
      <ul> 
       <li><code>AT_SEQUENCE_NUMBER</code> - Start reading from the position denoted by a specific sequence number, provided in the value StartingSequenceNumber.</li> 
       <li><code>AFTER_SEQUENCE_NUMBER</code> - Start reading right after the position denoted by a specific sequence number, provided in the value StartingSequenceNumber.</li> 
       <li><code>AT_TIMESTAMP</code> - Start reading from the position denoted by a specific timestamp, provided in the value Timestamp.</li> 
       <li><code>TRIM_HORIZON</code> - Start reading at the last untrimmed record in the shard in the system, which is the oldest data record in the shard.</li> 
       <li><code>LATEST</code> - Start reading just after the most recent record in the shard, so that you always read the most recent data in the shard.</li> 
      </ul> </li> 
    </ul> </li> 
   <li>How do sequence numbers work? 
    <ul> 
     <li>Sequence numbers for the same partition key generally increase over time, but <strong>NOT</strong> necessarily in a continuous sequence. The longer the time period between records, the bigger the gap between the sequence numbers.</li> 
     <li>To uniquely identify a record on a shard, you need to use <strong>BOTH</strong> the <code>sequence number</code> and the <code>sub-sequence number</code>. This is because messages that are aggregated together have the same sequence number (they are treated as one messages by Kinesis). Therefore it is important to also use the sub-sequence number to distinguish between them.</li> 
    </ul> </li> 
  </ul> 
  <p><a name="user-content-contributor-guide" target="_blank" href=""></a></p> 
  <h1><a id="user-content-contributor-guide" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#contributor-guide" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Contributor Guide</h1> 
  <p><a name="user-content-contributor-guide-code-formatting" target="_blank" href=""></a></p> 
  <h2><a id="user-content-code-formatting" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#code-formatting" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Code Formatting</h2> 
  <p>This project uses <a href="http://scalameta.org/scalafmt/" target="_blank">scalafmt</a> and will automatically fail the build if any files do not match the expected formatting.</p> 
  <p>Please run <code>sbt scalafmt</code> before committing and pushing changes.</p> 
  <p><a name="user-content-contributor-guide-tag-requirements" target="_blank" href=""></a></p> 
  <h2><a id="user-content-tag-requirements" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#tag-requirements" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Tag Requirements</h2> 
  <p>Uses tags and <a href="https://github.com/sbt/sbt-git" target="_blank">sbt-git</a> to determine the current version.</p> 
  <ul> 
   <li>Each merge into master will automatically build a snapshot and publish to <a href="https://www.jfrog.com/confluence/display/RTF/Deploying+Snapshots+to+oss.jfrog.org" target="_blank">bintray OSS artifactory</a>.</li> 
   <li>Tagging the master branch will automatically build and publish both Scala 2.11 &amp; Scala 2.12 artifacts (to bintray and maven central).</li> 
   <li>Tags are in the format vX.X.X</li> 
  </ul> 
  <p><a name="user-content-contributor-guide-tag-requirements-version-information" target="_blank" href=""></a></p> 
  <h3><a id="user-content-version-information" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#version-information" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Version information</h3> 
  <ul> 
   <li>IF the current commit is tagged with "vX.Y.Z" (ie semantic-versioning), the version is "X.Y.Z"</li> 
   <li>ELSE IF the current commit is tagged with "vX.Y.Z-Mx", the version is "X.Y.Z-Mx"</li> 
   <li>ELSE IF the latest found tag is "vX.Y.Z", the version is "X.Y.Z-commitsSinceVersion-gCommitHash-SNAPSHOT"</li> 
   <li>ELSE the version is "0.0.0-commitHash-SNAPSHOT"</li> 
  </ul> 
  <p><a name="user-content-contributor-guide-tag-requirements-valid-release-tag-examples" target="_blank" href=""></a></p> 
  <h3><a id="user-content-valid-release-tag-examples" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#valid-release-tag-examples" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Valid Release Tag Examples:</h3> 
  <p>v1.2.3 (version=1.2.3) v1.2.3-M1 (version=1.2.3-M1)</p> 
  <p><a name="user-content-contributor-guide-tag-requirements-invalid-release-tag-examples" target="_blank" href=""></a></p> 
  <h3><a id="user-content-invalid-release-tag-examples" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#invalid-release-tag-examples" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Invalid Release Tag Examples:</h3> 
  <p>v1.2.3-SNAPSHOT v1.2.3-M1-SNAPSHOT v1.2.3-X1 1.2.3</p> 
  <p>If the current version on master is a snapshot (release tag + x commits), then the artifact will be deployed to the <a href="https://oss.jfrog.org/webapp/#/artifacts/browse/simple/General/oss-snapshot-local/com/weightwatchers" target="_blank">JFrog OSS repository</a>:</p> 
  <p><a name="user-content-contribution-policy" target="_blank" href=""></a></p> 
  <h1><a id="user-content-contribution-policy" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#contribution-policy" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Contribution policy</h1> 
  <p>Contributions via GitHub pull requests are gladly accepted from their original author. Along with any pull requests, please state that the contribution is your original work and that you license the work to the project under the project's open source license. Whether or not you state this explicitly, by submitting any copyrighted material via pull request, email, or other means you agree to license the material under the project's open source license and warrant that you have the legal authority to do so.</p> 
  <p><a name="user-content-license" target="_blank" href=""></a></p> 
  <h1><a id="user-content-license" class="anchor" href="https://github.com/ww-digital/reactive-kinesis#license" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>License</h1> 
  <p>This code is open source software licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank">Apache 2.0</a> license.</p> 
 </article>
</div>