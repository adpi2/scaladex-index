<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-lift-salatauth-module" class="anchor" href="https://github.com/limansky/lift-salatauth#lift-salatauth-module" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Lift SalatAuth module</h1> 
  <p>Authentication and authorization module for <a href="http://liftweb.net" target="_blank">Lift</a> web framework based on <a href="https://github.com/novus/salat" target="_blank">Salat</a> library. This project inspired by <a href="https://github.com/eltimn/lift-mongoauth" target="_blank">lift-mongoauth</a> module. The goal is to avoid using different ORMs in project using Salat.</p> 
  <h2><a id="user-content-installing" class="anchor" href="https://github.com/limansky/lift-salatauth#installing" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Installing</h2> 
  <p>The module is available in Sonatype repository. So, if you using sbt just add it to libraryDependencies.</p> 
  <p>For Lift 3.0.x <code>lift-salatauth</code> suports only Scala 2.11 (Scala 2.12 is not available yet, because there is not Salat for Scala 2.12):</p> 
  <pre><code>"net.liftmodules" %% "salatauth_3.0" % "1.2"

</code></pre> 
  <p>For Lift 2.6.x it supports Scala 2.10 and 2.11:</p> 
  <pre><code>"net.liftmodules" %% "salatauth_2.6" % "1.2"

</code></pre> 
  <p>For Lift 2.5.x use <code>lift-salatauth</code> 1.1 which supports Scala 2.10 and 2.9.2:</p> 
  <pre><code>"net.liftmodules" %% "salatauth_2.5" % "1.1"

</code></pre> 
  <p>Or you can use current snapshot version: <a href="https://travis-ci.org/limansky/lift-salatauth" target="_blank"><img src="https://camo.githubusercontent.com/2ab61e7d6d7f6c6fb3e125a7eb4ac15941afb92b/68747470733a2f2f7472617669732d63692e6f72672f6c696d616e736b792f6c6966742d73616c6174617574682e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/limansky/lift-salatauth.svg?branch=master" style="max-width:100%;"></a></p> 
  <pre><code>"net.liftmodules" %% "salatauth_2.6" % "1.3-SNAPSHOT"

</code></pre> 
  <h2><a id="user-content-usage" class="anchor" href="https://github.com/limansky/lift-salatauth#usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h2> 
  <p>Lift SalatAuth provides several base classes and default implementations for them. You should choose if you want to implement them yourself or use default implementation.</p> 
  <h3><a id="user-content-user-entity" class="anchor" href="https://github.com/limansky/lift-salatauth#user-entity" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>User entity</h3> 
  <p>The user entity can be implemented as a case class extending ProtoUser.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">User</span>(
  <span class="pl-k">val</span> <span class="pl-en">_id</span><span class="pl-k">:</span> <span class="pl-en">ObjectId</span>,
  <span class="pl-k">override</span> <span class="pl-k">val</span> <span class="pl-en">username</span><span class="pl-k">:</span> <span class="pl-k">String</span>,
  <span class="pl-k">override</span> <span class="pl-k">val</span> <span class="pl-en">password</span><span class="pl-k">:</span> <span class="pl-k">String</span>,
  <span class="pl-k">val</span> <span class="pl-en">realName</span><span class="pl-k">:</span> <span class="pl-k">String</span>,
  <span class="pl-k">override</span> <span class="pl-k">val</span> <span class="pl-en">email</span><span class="pl-k">:</span> <span class="pl-k">String</span>,
  <span class="pl-k">override</span> <span class="pl-k">val</span> <span class="pl-en">roles</span><span class="pl-k">:</span> <span class="pl-en">Set</span>[<span class="pl-k">String</span>]
) <span class="pl-k">extends</span> <span class="pl-e">ProtoUser</span>(username, password, email, roles)</pre>
  </div> 
  <p>The <code>ProtoUser</code> class uses your roles collection to set permissions properly. To make it work you have to set the collection during your application initialization:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">Boot</span> {
  <span class="pl-k">def</span> <span class="pl-en">boot</span>() {
    ...
    <span class="pl-en">SalatAuth</span>.rolesCollection.default.set(<span class="pl-en">Some</span>(<span class="pl-en">MongoConnection</span>()(<span class="pl-s"><span class="pl-pds">"</span>mydb<span class="pl-pds">"</span></span>)(<span class="pl-s"><span class="pl-pds">"</span>roles<span class="pl-pds">"</span></span>)))
    ...</pre>
  </div> 
  <p>If the default field set of <code>ProtoUser</code> is enough for you you can not define your own user class, but use <code>SimpleUser</code> instead.</p> 
  <h3><a id="user-content-permissions-model" class="anchor" href="https://github.com/limansky/lift-salatauth#permissions-model" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Permissions model</h3> 
  <p>Each user has a list of roles defined as strings. However role itself is a case class. The role name is an <code>_id</code> for a role. As it was described you need to set roles collection in boot to allow roles works properly. Roles contains a list of <code>Permission</code>s. Permissions are defined as a triplets of domain, action and entity.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">adminRole</span> <span class="pl-k">=</span> <span class="pl-en">Role</span>(<span class="pl-s"><span class="pl-pds">"</span>admin<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>, <span class="pl-en">List</span>(<span class="pl-en">Permission</span>.<span class="pl-en">All</span>))
<span class="pl-k">val</span> <span class="pl-en">userRole</span> <span class="pl-k">=</span> <span class="pl-en">Role</span>(<span class="pl-s"><span class="pl-pds">"</span>user<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>, <span class="pl-en">List</span>(<span class="pl-en">Permission</span>(<span class="pl-s"><span class="pl-pds">"</span>Messages<span class="pl-pds">"</span></span>), <span class="pl-en">Permission</span>(<span class="pl-s"><span class="pl-pds">"</span>Reports<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>view<span class="pl-pds">"</span></span>), <span class="pl-en">Permission</span>(<span class="pl-s"><span class="pl-pds">"</span>Reports<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>print<span class="pl-pds">"</span></span>), <span class="pl-en">Permission</span>(<span class="pl-s"><span class="pl-pds">"</span>Profile<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>view<span class="pl-pds">"</span></span>)))

<span class="pl-en">RolesDAO</span>.save(adminRole)
<span class="pl-en">RolesDAO</span>.save(userRole)

<span class="pl-k">val</span> <span class="pl-en">user</span> <span class="pl-k">=</span> <span class="pl-en">SimpleUser</span>(<span class="pl-s"><span class="pl-pds">"</span>admin<span class="pl-pds">"</span></span>, <span class="pl-en">ProtoUser</span>.hashPassword(<span class="pl-s"><span class="pl-pds">"</span>secret<span class="pl-pds">"</span></span>), <span class="pl-s"><span class="pl-pds">"</span>admin@example.com<span class="pl-pds">"</span></span>, <span class="pl-en">Set</span>(<span class="pl-s"><span class="pl-pds">"</span>admin<span class="pl-pds">"</span></span>))
<span class="pl-en">UserDAO</span>.save(user)</pre>
  </div> 
  <h3><a id="user-content-loginmanager" class="anchor" href="https://github.com/limansky/lift-salatauth#loginmanager" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>LoginManager</h3> 
  <p>Login manager is a core object of SalatAuth module. You can use <code>SimpleLoginManager</code> with <code>SimpleUser</code>s or implement your own one for custom entities. If you use "Simple" solution than you must define a collection in Boot:</p> 
  <div class="highlight highlight-source-scala">
   <pre>    <span class="pl-en">SalatAuth</span>.simpleCollection.default.set(<span class="pl-en">Some</span>(<span class="pl-en">MongoConnection</span>()(<span class="pl-s"><span class="pl-pds">"</span>mydb<span class="pl-pds">"</span></span>)(<span class="pl-s"><span class="pl-pds">"</span>users<span class="pl-pds">"</span></span>)))</pre>
  </div> 
  <p>Else, you need to define your LoginManager to find users in MongoDB:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">object</span> <span class="pl-en">MyLoginManager</span> <span class="pl-k">extends</span> <span class="pl-e">LoginManager</span>[<span class="pl-en">MyUser</span>, <span class="pl-en">ObjectId</span>] {
    
  <span class="pl-k">override</span> <span class="pl-k">def</span> <span class="pl-en">findUserById</span>(<span class="pl-v">id</span>: <span class="pl-en">ObjectId</span>)<span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-en">MyUser</span>] <span class="pl-k">=</span> {
    <span class="pl-en">MyUserDAO</span>.findOneById(id)
  }

  <span class="pl-k">override</span> <span class="pl-k">def</span> <span class="pl-en">getUserId</span>(<span class="pl-v">user</span>: <span class="pl-en">MyUser</span>)<span class="pl-k">:</span> <span class="pl-en">ObjectId</span> <span class="pl-k">=</span> user._id
}</pre>
  </div> 
  <p>Now, when you have a <code>LoginManager</code> instance you must set it in Boot (<code>SimpleLoginManager</code> is the default setting):</p> 
  <div class="highlight highlight-source-scala">
   <pre>    <span class="pl-en">SalatAuth</span>.loginManager.default.set(<span class="pl-en">MyLoginManager</span>)</pre>
  </div> 
  <h3><a id="user-content-defining-sitemap" class="anchor" href="https://github.com/limansky/lift-salatauth#defining-sitemap" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Defining SiteMap</h3> 
  <p>There are several methods defined in trait <code>Locs</code> helps you to set required permissions on the entries in site map. Here is the example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">net.liftmodules.salatauth.Locs.</span><span class="pl-v">_</span>

<span class="pl-k">def</span> <span class="pl-en">siteMap</span>() <span class="pl-k">=</span> <span class="pl-en">SiteMap</span>(
  <span class="pl-en">Menu</span>.i(<span class="pl-s"><span class="pl-pds">"</span>index<span class="pl-pds">"</span></span>) <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>index<span class="pl-pds">"</span></span> <span class="pl-k">&gt;&gt;</span> <span class="pl-en">Hidden</span>,
  <span class="pl-en">Menu</span>.i(<span class="pl-s"><span class="pl-pds">"</span>messages<span class="pl-pds">"</span></span>) <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>messages<span class="pl-pds">"</span></span> <span class="pl-k">&gt;&gt;</span> <span class="pl-en">RequireLoggedIn</span>,
  <span class="pl-en">Menu</span>.i(<span class="pl-s"><span class="pl-pds">"</span>users<span class="pl-pds">"</span></span>) <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>users<span class="pl-pds">"</span></span> <span class="pl-k">&gt;&gt;</span> <span class="pl-en">HasRole</span>(<span class="pl-s"><span class="pl-pds">"</span>admin<span class="pl-pds">"</span></span>),
  <span class="pl-en">Menu</span>.i(<span class="pl-s"><span class="pl-pds">"</span>reports<span class="pl-pds">"</span></span>) <span class="pl-k">/</span> <span class="pl-s"><span class="pl-pds">"</span>reports<span class="pl-pds">"</span></span> <span class="pl-k">&gt;&gt;</span> <span class="pl-en">HasPermission</span>(<span class="pl-s"><span class="pl-pds">"</span>Reports<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>view<span class="pl-pds">"</span></span>)
  buildLogin(<span class="pl-s"><span class="pl-pds">"</span>login<span class="pl-pds">"</span></span>, <span class="pl-en">Hidden</span> <span class="pl-k">::</span> <span class="pl-c1">Nil</span>),
  buildLogout(<span class="pl-s"><span class="pl-pds">"</span>logout<span class="pl-pds">"</span></span>, <span class="pl-c1">Nil</span>)
  )</pre>
  </div> 
  <p>In this example user has to be logged in for all pages except index, but to see users he must have "admin" role, and to see the reports he must have corresponding permission.</p> 
  <h3><a id="user-content-session-handling" class="anchor" href="https://github.com/limansky/lift-salatauth#session-handling" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Session handling</h3> 
  <p>Session support was added in 1.1. This feature allows you to add "remember me" functionality. To do it you need to setup cookie settings you your Boot.scala, and add session check hook:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">SalatAuth</span>.loginManager.default.set(<span class="pl-en">MyLoginManager</span>)
<span class="pl-en">SalatAuth</span>.sessionCookieName.default.set(<span class="pl-s"><span class="pl-pds">"</span>MyAppLoginCookie<span class="pl-pds">"</span></span>)
<span class="pl-en">SalatAuth</span>.sessionsCollection.default.set(<span class="pl-en">Some</span>(mongoDB(<span class="pl-s"><span class="pl-pds">"</span>authcookies<span class="pl-pds">"</span></span>)))
<span class="pl-en">LiftRules</span>.earlyInStateful.append(<span class="pl-en">MyLoginManager</span>.checkSession)</pre>
  </div> 
  <p>Now you can pass additional parameter to LoginManager.logUserIn function to set if user was authenticated and shall the login cookie be created.</p> 
  <p>In addition you can check if the user was authenticated using <code>RequireAuthenticated</code> parameter in your site map.</p> 
 </article>
</div>