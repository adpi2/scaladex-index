<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-scala-xml-security" class="anchor" href="https://github.com/arturopala/scala-xml-security#scala-xml-security" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Scala XML Security</h1> 
  <p><a href="https://semaphoreci.com/arturopala/scala-xml-security" target="_blank"><img src="https://camo.githubusercontent.com/e565b405c5bd9901fc6997fea3ddc893cc83e2bf/68747470733a2f2f73656d6170686f726563692e636f6d2f6170692f76312f61727475726f70616c612f7363616c612d786d6c2d73656375726974792f6272616e636865732f6d61737465722f62616467652e737667" alt="Build Status" data-canonical-src="https://semaphoreci.com/api/v1/arturopala/scala-xml-security/branches/master/badge.svg" style="max-width:100%;"></a></p> 
  <p>Dealing with XML signatures or encryption requires usually a lot of magic config code followed by copy-pasted boilerplate. This small library wraps for you all the necessary configuration and logic to finally expose simple but essential API.</p> 
  <h1><a id="user-content-main-features" class="anchor" href="https://github.com/arturopala/scala-xml-security#main-features" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Main Features</h1> 
  <ul> 
   <li><strong>signature</strong> creation and validation,</li> 
   <li><strong>encryption</strong> of XML document,</li> 
   <li><strong>decryption</strong> of XML document</li> 
  </ul> 
  <h1><a id="user-content-installation" class="anchor" href="https://github.com/arturopala/scala-xml-security#installation" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Installation</h1> 
  <p>Add the following line to your project description in <code>build.sbt</code>:</p> 
  <pre><code>libraryDependencies += "com.github.arturopala" % "scala-xml-security_2.12" % "1.1.0"
</code></pre> 
  <p>You can find available versions here:</p> 
  <p><a href="http://search.maven.org/#search%7Cga%7C1%7Cscala-xml-security" target="_blank">http://search.maven.org/#search|ga|1|scala-xml-security</a></p> 
  <h2><a id="user-content-dependencies" class="anchor" href="https://github.com/arturopala/scala-xml-security#dependencies" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Dependencies</h2> 
  <p>This library brings into your project few transitive dependencies:</p> 
  <ul> 
   <li>org.apache.santuario:xmlsec - <a href="http://santuario.apache.org/javaindex.html" target="_blank">Apache XML Security utils</a></li> 
   <li>org.bouncycastle:bcprov-jdk15on - <a href="https://www.bouncycastle.org/" target="_blank">Cryptography provider</a></li> 
   <li>org.bouncycastle:bcpkix-jdk15on - <a href="https://www.bouncycastle.org/" target="_blank">PKI support</a></li> 
   <li>org.json4s:json4s-native - <a href="https://github.com/json4s/json4s" target="_blank">Scala JSON library</a></li> 
   <li>commons-codec:commons-codec - <a href="https://commons.apache.org/proper/commons-codec/" target="_blank">Apache Commons Codec</a></li> 
  </ul> 
  <h1><a id="user-content-usage" class="anchor" href="https://github.com/arturopala/scala-xml-security#usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h1> 
  <h2><a id="user-content-parse-xml-as-a-document-dom" class="anchor" href="https://github.com/arturopala/scala-xml-security#parse-xml-as-a-document-dom" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Parse XML as a Document (DOM)</h2> 
  <p>API:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">parseDocument</span>(<span class="pl-v">document</span>: <span class="pl-k">String</span>)<span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-en">Document</span>]</pre>
  </div> 
  <p>Example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">scala.util.</span><span class="pl-v">Try</span>
<span class="pl-k">import</span> <span class="pl-v">org.w3c.dom.</span><span class="pl-v">Document</span>
<span class="pl-k">import</span> <span class="pl-v">com.github.arturopala.xmlsecurity.</span><span class="pl-v">XmlUtils</span>

<span class="pl-k">val</span> <span class="pl-en">xml</span><span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;hello world=<span class="pl-pds">"</span></span><span class="pl-k">!</span><span class="pl-s"><span class="pl-pds">"</span>&gt;&lt;/hello&gt;<span class="pl-pds">"</span></span> <span class="pl-c"><span class="pl-c">//</span>some XML</span>
<span class="pl-k">val</span> <span class="pl-en">dom</span><span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-en">Document</span>] <span class="pl-k">=</span> <span class="pl-en">XmlUtils</span>.parseDocument(xml)</pre>
  </div> 
  <h2><a id="user-content-load-schema-and-validate-xml-document" class="anchor" href="https://github.com/arturopala/scala-xml-security#load-schema-and-validate-xml-document" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Load schema and validate XML document</h2> 
  <p>API:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">loadSchema</span>(<span class="pl-v">schemaUrl</span>: <span class="pl-en">URL</span><span class="pl-k">*</span>)<span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-en">Schema</span>]
<span class="pl-k">def</span> <span class="pl-en">validateDocument</span>(<span class="pl-v">schema</span>: <span class="pl-en">Schema</span>)(<span class="pl-v">dom</span>: <span class="pl-en">Document</span>)<span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-en">Document</span>]</pre>
  </div> 
  <p>Example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">java.net.</span><span class="pl-v">URL</span>
<span class="pl-k">import</span> <span class="pl-v">scala.util.</span><span class="pl-v">Try</span>
<span class="pl-k">import</span> <span class="pl-v">org.w3c.dom.</span><span class="pl-v">Document</span>
<span class="pl-k">import</span> <span class="pl-v">com.github.arturopala.xmlsecurity.</span><span class="pl-v">XmlUtils</span>

<span class="pl-k">def</span> <span class="pl-en">getResource</span>(<span class="pl-v">r</span>: <span class="pl-k">String</span>)<span class="pl-k">:</span> <span class="pl-en">URL</span> <span class="pl-k">=</span> <span class="pl-c1">classOf</span>[<span class="pl-en">Document</span>].getResource(r)
<span class="pl-k">val</span> <span class="pl-en">xml</span><span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> <span class="pl-k">???</span> <span class="pl-c"><span class="pl-c">//</span>some XML</span>
<span class="pl-k">val</span> <span class="pl-en">document</span><span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-en">Document</span>] <span class="pl-k">=</span> <span class="pl-k">for</span> {
  schema    <span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-en">XmlUtils</span>.loadSchema(
                  getResource(<span class="pl-s"><span class="pl-pds">"</span>/saml-schema-protocol-2.0.xsd<span class="pl-pds">"</span></span>), <span class="pl-c"><span class="pl-c">//</span> relevant schemas</span>
                  getResource(<span class="pl-s"><span class="pl-pds">"</span>/saml-schema-assertion-2.0.xsd<span class="pl-pds">"</span></span>),
                  getResource(<span class="pl-s"><span class="pl-pds">"</span>/xenc-schema.xsd<span class="pl-pds">"</span></span>),
                  getResource(<span class="pl-s"><span class="pl-pds">"</span>/xmldsig-core-schema.xsd<span class="pl-pds">"</span></span>)
               )
  dom       <span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-en">XmlUtils</span>.parseDocument(xml)
  validated <span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-en">XmlUtils</span>.validateDocument(schema)(dom)
} <span class="pl-k">yield</span> validated</pre>
  </div> 
  <h2><a id="user-content-sign-xml-document" class="anchor" href="https://github.com/arturopala/scala-xml-security#sign-xml-document" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Sign XML document</h2> 
  <p>API:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">signDocument</span>(
    <span class="pl-v">signatureAlgorithm</span>: <span class="pl-k">String</span>,
    <span class="pl-v">digestAlgorithm</span>:    <span class="pl-k">String</span>,
    <span class="pl-v">privateKey</span>:         <span class="pl-en">PrivateKey</span>,
    <span class="pl-v">publicKey</span>:          <span class="pl-en">Option</span>[<span class="pl-en">PublicKey</span>] <span class="pl-k">=</span> <span class="pl-c1">None</span>)(<span class="pl-v">dom</span>: <span class="pl-en">Document</span>)<span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-en">Document</span>]
    
<span class="pl-k">def</span> <span class="pl-en">signDocument</span>(
    <span class="pl-v">signatureAlgorithm</span>: <span class="pl-k">String</span>,
    <span class="pl-v">digestAlgorithm</span>:    <span class="pl-k">String</span>,
    <span class="pl-v">privateKey</span>:         <span class="pl-en">PrivateKey</span>,
    <span class="pl-v">cert</span>:               <span class="pl-en">X509Certificate</span>)(<span class="pl-v">dom</span>: <span class="pl-en">Document</span>)<span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-en">Document</span>]</pre>
  </div> 
  <p>Example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">java.security.</span><span class="pl-v">KeyPair</span>
<span class="pl-k">import</span> <span class="pl-v">javax.security.cert.</span><span class="pl-v">X509Certificate</span>
<span class="pl-k">import</span> <span class="pl-v">scala.util.</span><span class="pl-v">Try</span>
<span class="pl-k">import</span> <span class="pl-v">org.w3c.dom.</span><span class="pl-v">Document</span>
<span class="pl-k">import</span> <span class="pl-v">com.github.arturopala.xmlsecurity.</span>{<span class="pl-v">XmlUtils</span>,<span class="pl-v">XmlSecurity</span>}

<span class="pl-k">val</span> <span class="pl-en">keyPair</span><span class="pl-k">:</span> <span class="pl-en">KeyPair</span> <span class="pl-k">=</span> <span class="pl-k">???</span>
<span class="pl-k">val</span> <span class="pl-en">cerificate</span><span class="pl-k">:</span> <span class="pl-en">X509Certificate</span> <span class="pl-k">=</span> <span class="pl-k">???</span>
<span class="pl-k">val</span> <span class="pl-en">xml</span><span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;hello world=<span class="pl-pds">"</span></span><span class="pl-k">!</span><span class="pl-s"><span class="pl-pds">"</span>&gt;&lt;/hello&gt;<span class="pl-pds">"</span></span> <span class="pl-c"><span class="pl-c">//</span>some XML</span>
<span class="pl-k">val</span> <span class="pl-en">document</span><span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-en">Document</span>] <span class="pl-k">=</span> <span class="pl-k">for</span> {
  dom     <span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-en">XmlUtils</span>.parseDocument(xml)
  signed  <span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-en">XmlSecurity</span>.signDocument(
                <span class="pl-s"><span class="pl-pds">"</span>http://www.w3.org/2001/04/xmldsig-more#rsa-sha256<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>http://www.w3.org/2001/04/xmlenc#sha256<span class="pl-pds">"</span></span>,
                keyPair.getPrivate,
                certificate
             )(dom)
} <span class="pl-k">yield</span> signed</pre>
  </div> 
  <h2><a id="user-content-validate-xml-signature" class="anchor" href="https://github.com/arturopala/scala-xml-security#validate-xml-signature" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Validate XML signature</h2> 
  <p>API:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">validateSignature</span><span class="pl-k">:</span> <span class="pl-en">Document</span> <span class="pl-k">=&gt;</span> <span class="pl-en">Try</span>[<span class="pl-en">Document</span>]
<span class="pl-k">def</span> <span class="pl-en">validateSignature</span>(<span class="pl-v">publicKey</span>: <span class="pl-en">PublicKey</span>)<span class="pl-k">:</span> <span class="pl-en">Document</span> <span class="pl-k">=&gt;</span> <span class="pl-en">Try</span>[<span class="pl-en">Document</span>]
<span class="pl-k">def</span> <span class="pl-en">validateSignature</span>(<span class="pl-v">keySelector</span>: <span class="pl-en">KeySelector</span>)(<span class="pl-v">dom</span>: <span class="pl-en">Document</span>)<span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-en">Document</span>]</pre>
  </div> 
  <p>Example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">scala.util.</span><span class="pl-v">Try</span>
<span class="pl-k">import</span> <span class="pl-v">org.w3c.dom.</span><span class="pl-v">Document</span>
<span class="pl-k">import</span> <span class="pl-v">com.github.arturopala.xmlsecurity.</span>{<span class="pl-v">XmlUtils</span>,<span class="pl-v">XmlSecurity</span>}

<span class="pl-k">val</span> <span class="pl-en">xml</span><span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> <span class="pl-k">???</span> <span class="pl-c"><span class="pl-c">//</span> some signed XML</span>
<span class="pl-k">val</span> <span class="pl-en">document</span><span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-en">Document</span>] <span class="pl-k">=</span> <span class="pl-k">for</span> {
  dom    <span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-en">XmlUtils</span>.parseDocument(xml)
  valid  <span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-en">XmlSecurity</span>.validateSignature(dom)
} <span class="pl-k">yield</span> valid</pre>
  </div> 
  <h2><a id="user-content-encrypt-xml-document" class="anchor" href="https://github.com/arturopala/scala-xml-security#encrypt-xml-document" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Encrypt XML document</h2> 
  <p>API:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">encryptDocument</span>(
    <span class="pl-v">cert</span>:                <span class="pl-en">X509Certificate</span>,
    <span class="pl-v">encryptionAlgorithm</span>: <span class="pl-k">String</span>,
    <span class="pl-v">keyWrapAlgorithm</span>:    <span class="pl-k">String</span>,
    <span class="pl-v">digestAlgorithm</span>:     <span class="pl-k">String</span>,
    <span class="pl-v">mgfAlgorithm</span>:        <span class="pl-k">String</span>          <span class="pl-k">=</span> <span class="pl-c1">null</span>,
    <span class="pl-v">oaepParams</span>:          <span class="pl-en">Array</span>[<span class="pl-k">Byte</span>]     <span class="pl-k">=</span> <span class="pl-c1">null</span>)(<span class="pl-v">dom</span>: <span class="pl-en">Document</span>)<span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-en">Document</span>]</pre>
  </div> 
  <p>Example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">scala.util.</span><span class="pl-v">Try</span>
<span class="pl-k">import</span> <span class="pl-v">org.w3c.dom.</span><span class="pl-v">Document</span>
<span class="pl-k">import</span> <span class="pl-v">javax.security.cert.</span><span class="pl-v">X509Certificate</span>
<span class="pl-k">import</span> <span class="pl-v">com.github.arturopala.xmlsecurity.</span>{<span class="pl-v">XmlUtils</span>,<span class="pl-v">XmlSecurity</span>}

<span class="pl-k">val</span> <span class="pl-en">cerificate</span><span class="pl-k">:</span> <span class="pl-en">X509Certificate</span> <span class="pl-k">=</span> <span class="pl-k">???</span>
<span class="pl-k">val</span> <span class="pl-en">xml</span><span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> <span class="pl-k">???</span> <span class="pl-c"><span class="pl-c">//</span> some XML</span>
<span class="pl-k">val</span> <span class="pl-en">document</span><span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-en">Document</span>] <span class="pl-k">=</span> <span class="pl-k">for</span> {
  dom       <span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-en">XmlUtils</span>.parseDocument(xml)
  encrypted <span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-en">XmlSecurity</span>.encryptDocument(
                  certificate,
                  <span class="pl-s"><span class="pl-pds">"</span>http://www.w3.org/2001/04/xmlenc#aes256-cbc<span class="pl-pds">"</span></span>,
                  <span class="pl-s"><span class="pl-pds">"</span>http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p<span class="pl-pds">"</span></span>,
                  <span class="pl-s"><span class="pl-pds">"</span>http://www.w3.org/2001/04/xmlenc#sha256<span class="pl-pds">"</span></span>
               )(dom)
} <span class="pl-k">yield</span> encrypted</pre>
  </div> 
  <h2><a id="user-content-decrypt-xml-document" class="anchor" href="https://github.com/arturopala/scala-xml-security#decrypt-xml-document" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Decrypt XML document</h2> 
  <p>API:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">decryptDocument</span>(<span class="pl-v">key</span>: <span class="pl-en">Key</span>)(<span class="pl-v">dom</span>: <span class="pl-en">Document</span>)<span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-en">Document</span>]</pre>
  </div> 
  <p>Example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">scala.util.</span><span class="pl-v">Try</span>
<span class="pl-k">import</span> <span class="pl-v">org.w3c.dom.</span><span class="pl-v">Document</span>
<span class="pl-k">import</span> <span class="pl-v">java.security.</span><span class="pl-v">KeyPair</span>
<span class="pl-k">import</span> <span class="pl-v">com.github.arturopala.xmlsecurity.</span>{<span class="pl-v">XmlUtils</span>,<span class="pl-v">XmlSecurity</span>}

<span class="pl-k">val</span> <span class="pl-en">keyPair</span><span class="pl-k">:</span> <span class="pl-en">KeyPair</span> <span class="pl-k">=</span> <span class="pl-k">???</span>
<span class="pl-k">val</span> <span class="pl-en">xml</span><span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> <span class="pl-k">???</span> <span class="pl-c"><span class="pl-c">//</span> some XML</span>
<span class="pl-k">val</span> <span class="pl-en">document</span><span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-en">Document</span>] <span class="pl-k">=</span> <span class="pl-k">for</span> {
  dom       <span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-en">XmlUtils</span>.parseDocument(xml)
  decrypted <span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-en">XmlSecurity</span>.decryptDocument(keyPair.getPrivate)(dom)
} <span class="pl-k">yield</span> decrypted</pre>
  </div> 
  <h2><a id="user-content-handy-implicit-methods---dom-api-extensions" class="anchor" href="https://github.com/arturopala/scala-xml-security#handy-implicit-methods---dom-api-extensions" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Handy implicit methods - DOM api extensions</h2> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.github.arturopala.xmlsecurity.XmlOps.</span><span class="pl-v">_</span></pre>
  </div> 
  <h3><a id="user-content-orgw3cdomdocument" class="anchor" href="https://github.com/arturopala/scala-xml-security#orgw3cdomdocument" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>org.w3c.dom.Document</h3> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">selectNodes</span>(<span class="pl-v">query</span>: <span class="pl-k">String</span>, <span class="pl-v">ns</span>: <span class="pl-en">Option</span>[<span class="pl-en">NamespaceContext</span>] <span class="pl-k">=</span> <span class="pl-c1">None</span>)<span class="pl-k">:</span> <span class="pl-en">Seq</span>[<span class="pl-en">Node</span>]
<span class="pl-k">def</span> <span class="pl-en">getTagTextContent</span>(<span class="pl-v">tag</span>: <span class="pl-k">String</span>)<span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-k">String</span>]
<span class="pl-k">def</span> <span class="pl-en">getAttributeValue</span>(<span class="pl-v">tag</span>: <span class="pl-k">String</span>, <span class="pl-v">attribute</span>: <span class="pl-k">String</span>)<span class="pl-k">:</span> <span class="pl-en">Option</span>[<span class="pl-k">String</span>]
<span class="pl-k">def</span> <span class="pl-en">copy</span><span class="pl-k">:</span> <span class="pl-en">Document</span></pre>
  </div> 
  <h3><a id="user-content-orgw3cdomnodelist" class="anchor" href="https://github.com/arturopala/scala-xml-security#orgw3cdomnodelist" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>org.w3c.dom.NodeList</h3> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">toSeq</span><span class="pl-k">:</span> <span class="pl-en">Seq</span>[<span class="pl-en">Node</span>]</pre>
  </div> 
  <h3><a id="user-content-orgw3cdomnode" class="anchor" href="https://github.com/arturopala/scala-xml-security#orgw3cdomnode" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>org.w3c.dom.Node</h3> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">children</span><span class="pl-k">:</span> <span class="pl-en">Seq</span>[<span class="pl-en">Node</span>]
<span class="pl-k">def</span> <span class="pl-en">attributes</span><span class="pl-k">:</span> collection.<span class="pl-en">Map</span>[<span class="pl-k">String</span>, <span class="pl-k">String</span>]
<span class="pl-k">def</span> <span class="pl-en">toJson</span><span class="pl-k">:</span> org.json4s.<span class="pl-en">JObject</span></pre>
  </div> 
  <h2><a id="user-content-document-rendering" class="anchor" href="https://github.com/arturopala/scala-xml-security#document-rendering" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Document rendering</h2> 
  <p>API:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">printDocument</span>(<span class="pl-v">dom</span>: <span class="pl-en">Document</span>)<span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-k">String</span>]
<span class="pl-k">def</span> <span class="pl-en">prettyPrint</span>(<span class="pl-v">indent</span>: <span class="pl-k">Int</span>)(<span class="pl-v">dom</span>: <span class="pl-en">Document</span>)<span class="pl-k">:</span> <span class="pl-en">Try</span>[<span class="pl-k">String</span>]</pre>
  </div> 
 </article>
</div>