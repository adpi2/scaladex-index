<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-scathon---scala-marathon-client" class="anchor" href="https://github.com/appministry/scathon#scathon---scala-marathon-client" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>scathon - Scala Marathon Client</h1> 
  <p>This is a Scala Marathon Client. The aim is to provide a 100% coverage of the Marathon API (<code>v0.16.0+</code>) as a Scala SBT project.</p> 
  <h2><a id="user-content-build-status" class="anchor" href="https://github.com/appministry/scathon#build-status" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Build status</h2> 
  <p><a href="https://travis-ci.org/AppMinistry/scathon" target="_blank"><img src="https://camo.githubusercontent.com/52974f7cbf10843d584e12495ad400ea7d0b9553/68747470733a2f2f7472617669732d63692e6f72672f4170704d696e69737472792f73636174686f6e2e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/AppMinistry/scathon.svg?branch=master" style="max-width:100%;"></a></p> 
  <h2><a id="user-content-usage" class="anchor" href="https://github.com/appministry/scathon#usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h2> 
  <h3><a id="user-content-dependencies" class="anchor" href="https://github.com/appministry/scathon#dependencies" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Dependencies</h3> 
  <pre><code>libraryDependencies ++= Seq(
  "uk.co.appministry" %% "scathon-models" % "0.2.0",
  "uk.co.appministry" %% "scathon-client" % "0.2.0"
)
</code></pre> 
  <p>In <code>project/plugins.sbt</code>, add:</p> 
  <pre><code>addSbtPlugin("org.scoverage" % "sbt-scoverage" % "1.5.0")
</code></pre> 
  <h3><a id="user-content-scala-212" class="anchor" href="https://github.com/appministry/scathon#scala-212" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Scala 2.12</h3> 
  <pre><code>SCALA_VERSION=2.12.1
sbt ++$SCALA_VERSION -Dscala.version=$SCALA_VERSION clean test
sbt ++$SCALA_VERSION -Dscala.version=$SCALA_VERSION publishLocal
# and so on...
</code></pre> 
  <h3><a id="user-content-creating-the-client" class="anchor" href="https://github.com/appministry/scathon#creating-the-client" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Creating the client</h3> 
  <pre><code>import uk.co.appministry.scathon.apiClient._
val client = new Client
</code></pre> 
  <h2><a id="user-content-examples" class="anchor" href="https://github.com/appministry/scathon#examples" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Examples</h2> 
  <p>The client comes with a rich unit tests suite. A lot of examples can be found inside those. A few quickstart examples below.</p> 
  <h3><a id="user-content-loading-applications" class="anchor" href="https://github.com/appministry/scathon#loading-applications" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Loading applications:</h3> 
  <pre><code>client.getApps().onComplete {
  case Success(apps) =&gt; apps.foreach { app =&gt; /* ... */ }
  case Failure(ex) =&gt; println(s"There was an error while loading applications ${ex.getMessage}")
}
</code></pre> 
  <h3><a id="user-content-loading-an-application-by-id" class="anchor" href="https://github.com/appministry/scathon#loading-an-application-by-id" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Loading an application by ID</h3> 
  <pre><code>client.getApp("/an/app/id").onComplete {
  case Success(app) =&gt; /* ... */
  case Failure(ex) =&gt; ex match {
    case _: NotFound =&gt; println(s"Application not found: ${ex.getMessage}")
    case _ =&gt; println(s"Error while loading an application: ${ex.getMessage}")
  }
}
</code></pre> 
  <h3><a id="user-content-creating-an-application" class="anchor" href="https://github.com/appministry/scathon#creating-an-application" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Creating an application</h3> 
  <pre><code>import uk.co.appministry.scathon.models.mesos.UniqueConstraint
import uk.co.appministry.scathon.apiClient._
import uk.co.appministry.scathon.models._

val app = Application( id = "/app/test",
                       cmd = Some("/bin/sleep"),
                       args = Some(List("10")),
                       ports = Some(List(10000,10001,10002)),
                       instances = 2,
                       container = Some(Container(
                        docker = Some(ContainerDocker(
                          image = testAppContainerDockerImage,
                          network = DockerNetworkTypes.BRIDGE,
                          portMappings = Some(List(
                            ContainerPortMapping(10000, 0, None, PortMappingTypes.TCP),
                            ContainerPortMapping(10001, 0, None, PortMappingTypes.TCP),
                            ContainerPortMapping(10002, 0, None, PortMappingTypes.TCP)
                          ))
                        ))
                       )),
                       env = Map("ENV_VAR" -&gt; "some-value"),
                       labels = Map( "consul.watch" -&gt; "true",
                                     "consul.id" -&gt; "test-app-0",
                                     "consul.name" -&gt; "test-app",
                                     "consul.tags" -&gt; "tag1,tag2" ),
                       acceptedResourceRoles = Some(List("*")),
                       constraints = Some(List(UniqueConstraint("hostname"))),
                       fetch = Some(List(FetchUri("http://www.apache.org/dyn/closer.lua/spark/spark-1.6.1/spark-1.6.1.tgz"))),
                       healthChecks = Some(List(HttpHealthCheck())) )
client.createApp(app).onComplete {
  case Success(createdApp) =&gt;
    /* ... */
  case Failure(ex) =&gt; println(s"Error while creating an application: ${ex.getMessage}")
}
</code></pre> 
  <h3><a id="user-content-subscribing-to-the-event-bus" class="anchor" href="https://github.com/appministry/scathon#subscribing-to-the-event-bus" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Subscribing to the event bus</h3> 
  <pre><code>val callbackUri = "http://localhost:9000/marathon/callbacks"
client.createEventSubscription(new URI(callbackUri)).onComplete {
  case Success(event) =&gt;
    /* ... */
  case Failure(ex) =&gt; println(s"Failed to subscribe to the event bus: ${ex.getMessage}")
}
</code></pre> 
  <h2><a id="user-content-code-structure" class="anchor" href="https://github.com/appministry/scathon#code-structure" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Code structure</h2> 
  <p>This project comes in three modules:</p> 
  <ul> 
   <li><code>scathon-client</code>: Marathon client</li> 
   <li><code>scathon-models</code>: models used by the client and...</li> 
   <li><code>scathon-test-server</code>: test server used by the client for unit tests</li> 
  </ul> 
  <h2><a id="user-content-test-server" class="anchor" href="https://github.com/appministry/scathon#test-server" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Test server</h2> 
  <p>This is a simplistic implementation of Marathon. It does not necessarily implement correct Marathon functionality but it simulates the responses Marathon would issue.<br> The project is very helpful is one's goal is to write a Marathon based application without having to run a complex infrastructure like <code>mini-mesos</code>.<br> To use the test server in one's unit tests:</p> 
  <pre><code>libraryDependencies ++= Seq(
  "org.appministry" %% "scathon-test-server" % "0.1.2" % "test"
)
</code></pre> 
  <p>In the unit tests:</p> 
  <pre><code>import uk.co.appministry.scathon.apiClient._
import org.appministry.scathon.testServer._

val server = new TestMarathon
server.start()
val client = new Client(port = server.port.get)
/* ... */
</code></pre> 
  <h3><a id="user-content-configuring-test-server" class="anchor" href="https://github.com/appministry/scathon#configuring-test-server" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Configuring test server</h3> 
  <ul> 
   <li><code>testMarathon.bind-host</code>: host to bind test server on, default <code>localhost</code></li> 
   <li><code>testMarathon.bind-port</code>: port to bind test server on, default <code>random free port</code></li> 
   <li><code>testMarathon.executor-capacity</code>: thread executor capacity, default <code>10</code></li> 
   <li><code>testMarathon.api-version</code>: Marathon API version, default <code>v2</code></li> 
   <li><code>testMarathon.for-unit-tests</code>: used by the test server unit tests to verify correctness of the uris served, default <code>false</code>; usually, there is no need to play with this property</li> 
  </ul> 
  <h2><a id="user-content-license" class="anchor" href="https://github.com/appministry/scathon#license" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>License</h2> 
  <p>Author: Rad Gruchalski (<a href="mailto:radek@gruchalski.com" target="_blank">radek@gruchalski.com</a>)</p> 
  <p>This work will be available under Apache License, Version 2.0.</p> 
  <p>Copyright 2016 Rad Gruchalski (<a href="mailto:radek@gruchalski.com" target="_blank">radek@gruchalski.com</a>)</p> 
  <p>Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p> 
  <p><a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank">http://www.apache.org/licenses/LICENSE-2.0</a></p> 
  <p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p> 
 </article>
</div>