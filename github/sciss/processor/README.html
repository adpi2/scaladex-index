<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-processor" class="anchor" href="https://github.com/sciss/processor#processor" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Processor</h1> 
  <p><a href="https://flattr.com/submit/auto?user_id=sciss&amp;url=https%3A%2F%2Fgithub.com%2FSciss%2FProcessor&amp;title=Processor%20Library&amp;language=Scala&amp;tags=github&amp;category=software" target="_blank"><img src="https://camo.githubusercontent.com/739a757846f69c1cc10163619eec008e871b591b/687474703a2f2f6170692e666c617474722e636f6d2f627574746f6e2f666c617474722d62616467652d6c617267652e706e67" alt="Flattr this" data-canonical-src="http://api.flattr.com/button/flattr-badge-large.png" style="max-width:100%;"></a> <a href="https://travis-ci.org/Sciss/Processor" target="_blank"><img src="https://camo.githubusercontent.com/4c869def5c8e27ba550e5113d34ead4b323d3d87/68747470733a2f2f7472617669732d63692e6f72672f53636973732f50726f636573736f722e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/Sciss/Processor.svg?branch=master" style="max-width:100%;"></a> <a href="https://maven-badges.herokuapp.com/maven-central/de.sciss/processor_2.11" target="_blank"><img src="https://camo.githubusercontent.com/e349a4b2f5d26204e6f2b2014beef10227810ee7/68747470733a2f2f6d6176656e2d6261646765732e6865726f6b756170702e636f6d2f6d6176656e2d63656e7472616c2f64652e73636973732f70726f636573736f725f322e31312f62616467652e737667" alt="Maven Central" data-canonical-src="https://maven-badges.herokuapp.com/maven-central/de.sciss/processor_2.11/badge.svg" style="max-width:100%;"></a></p> 
  <h2><a id="user-content-statement" class="anchor" href="https://github.com/sciss/processor#statement" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>statement</h2> 
  <p>Processor is a simple building block for the Scala programming language, launching asynchronous processing tasks. It is (C)opyright 2013â€“2016 by Hanns Holger Rutz. All rights reserved. This project is released under the <a href="https://raw.github.com/Sciss/Processor/master/LICENSE" target="_blank">GNU Lesser General Public License</a> and comes with absolutely no warranties. To contact the author, send an email to <code>contact at sciss.de</code></p> 
  <h2><a id="user-content-linking" class="anchor" href="https://github.com/sciss/processor#linking" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>linking</h2> 
  <p>To link to this library:</p> 
  <pre><code>libraryDependencies += "de.sciss" %% "processor" % v
</code></pre> 
  <p>The current version <code>v</code> is <code>"0.4.0"</code></p> 
  <h2><a id="user-content-building" class="anchor" href="https://github.com/sciss/processor#building" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>building</h2> 
  <p>This project currently builds against Scala 2.11 and 2.10, using sbt 0.13.</p> 
  <h2><a id="user-content-contributing" class="anchor" href="https://github.com/sciss/processor#contributing" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>contributing</h2> 
  <p>Please see the file <a href="https://github.com/sciss/processor/blob/master/CONTRIBUTING.md" target="_blank">CONTRIBUTING.md</a></p> 
  <h2><a id="user-content-documentation" class="anchor" href="https://github.com/sciss/processor#documentation" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>documentation</h2> 
  <p>A <code>Processor</code> is a future which can be observed through the <code>Model</code> trait and aborted via an <code>abort</code> method. The model dispatches an event when the processor is completed either successfully or via failure, and during the processing progress reports are dispatched as <code>Processor.Progress</code> events.</p> 
  <p>The <code>Processor</code> trait takes as type constructor parameter the product or payload of the future. The super trait <code>ProcessorLike</code> also takes the self or representation type which allows a more specific type to appear in the processor's model updates.</p> 
  <p>Simple wrappers for existing <code>Future</code> or <code>Process</code> instances are provided on the <code>Processor</code> companion object:</p> 
  <div class="highlight highlight-source-scala">
   <pre>    <span class="pl-k">import</span> <span class="pl-v">de.sciss.processor.</span><span class="pl-v">_</span>
    <span class="pl-k">import</span> <span class="pl-v">scala.concurrent.</span><span class="pl-v">_</span>
    <span class="pl-k">import</span> <span class="pl-v">ExecutionContext.Implicits.</span><span class="pl-v">global</span>
    <span class="pl-k">import</span> <span class="pl-v">scala.sys.process.</span><span class="pl-v">_</span>

    <span class="pl-k">val</span> <span class="pl-en">p0</span>  <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>sleep 100<span class="pl-pds">"</span></span>.run()
    <span class="pl-k">val</span> <span class="pl-en">p1</span>  <span class="pl-k">=</span> <span class="pl-en">Processor</span>.fromProcess(<span class="pl-s"><span class="pl-pds">"</span>sleep<span class="pl-pds">"</span></span>, p0)
    p1.monitor()
    println(<span class="pl-s"><span class="pl-pds">"</span>Sleeping...<span class="pl-pds">"</span></span>)
    <span class="pl-en">Thread</span>.sleep(<span class="pl-c1">2000</span>)
    p1.abort()</pre>
  </div> 
  <p>The <code>Processor</code> object also contains an <code>apply</code> method to create a processor from a simple function:</p> 
  <div class="highlight highlight-source-scala">
   <pre>    <span class="pl-k">import</span> <span class="pl-v">de.sciss.processor.</span><span class="pl-v">_</span>
    <span class="pl-k">import</span> <span class="pl-v">scala.concurrent.</span><span class="pl-v">_</span>
    <span class="pl-k">import</span> <span class="pl-v">ExecutionContext.Implicits.</span><span class="pl-v">global</span>

    <span class="pl-k">val</span> <span class="pl-en">p</span> <span class="pl-k">=</span> <span class="pl-en">Processor</span>[<span class="pl-k">String</span>](<span class="pl-s"><span class="pl-pds">"</span>make-tea<span class="pl-pds">"</span></span>) { <span class="pl-c1">self</span> <span class="pl-k">=&gt;</span>
      blocking {
        <span class="pl-k">for</span> (i <span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-c1">1</span> to <span class="pl-c1">10</span>) {
          <span class="pl-en">Thread</span>.sleep(<span class="pl-c1">1000</span>)
          <span class="pl-c1">self</span>.checkAborted()
          <span class="pl-c1">self</span>.progress <span class="pl-k">=</span> i <span class="pl-k">*</span> <span class="pl-c1">0.1</span>
        }
      }
      <span class="pl-s"><span class="pl-pds">"</span>tea<span class="pl-pds">"</span></span>
    }

    p.monitor()</pre>
  </div> 
  <p>Processors are typically instantiated through a <code>ProcessorFactory</code> which also specifies a <code>Config</code> parameter which can be used to configure the processor. An implementation of <code>ProcessorFactory</code> needs to provide the <code>prepare</code> which returns the processor with a mixin of <code>Processor.Prepared</code> (which essentially adds a <code>start</code> method).</p> 
  <p>A convenient trait <code>ProcessorImpl</code> managed the whole processor and merely asks for the implementation of the <code>body</code> method. The process presented by the processor runs within this method, and should typically call <code>process</code> in regular intervals for observations such as GUIs to keep track of the advancement of the process. It should also either override the <code>notifyAborted</code> method or make sure to call into <code>checkAborted</code> at regular intervals in order to quickly respond to an abortion request.</p> 
  <p>Here is an example that shows most of the functionality, running two instances of the same processor type in parallel, monitoring their progress, and upon completion of either of them, abort the remaining processor:</p> 
  <div class="highlight highlight-source-scala">
   <pre>    <span class="pl-k">import</span> <span class="pl-v">de.sciss.processor.</span><span class="pl-v">_</span>
    <span class="pl-k">import</span> <span class="pl-v">scala.concurrent.</span><span class="pl-v">_</span>
    <span class="pl-k">import</span> <span class="pl-v">duration.Duration.</span><span class="pl-v">Inf</span>

    <span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Tea</span>(<span class="pl-v">variety</span>: <span class="pl-k">String</span>)

    <span class="pl-k">object</span> <span class="pl-en">MakeTea</span> <span class="pl-k">extends</span> <span class="pl-e">ProcessorFactory</span> {
      <span class="pl-k">type</span> <span class="pl-en">Product</span> <span class="pl-k">=</span> <span class="pl-en">Tea</span>
      <span class="pl-k">case</span> <span class="pl-k">class</span> <span class="pl-en">Config</span>(<span class="pl-v">variety</span>: <span class="pl-k">String</span>, <span class="pl-v">minutes</span>: <span class="pl-k">Int</span>)
      <span class="pl-k">type</span> <span class="pl-en">Repr</span> <span class="pl-k">=</span> <span class="pl-en">MakeTea</span>

      <span class="pl-k">protected</span> <span class="pl-k">def</span> <span class="pl-en">prepare</span>(<span class="pl-v">config</span>: <span class="pl-en">Config</span>)<span class="pl-k">:</span> <span class="pl-en">Prepared</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Impl</span>(config)

      <span class="pl-k">private</span> <span class="pl-k">class</span> <span class="pl-en">Impl</span>(<span class="pl-k">val</span> <span class="pl-en">config</span><span class="pl-k">:</span> <span class="pl-en">Config</span>) <span class="pl-k">extends</span> <span class="pl-e">MakeTea</span> <span class="pl-k">with</span> <span class="pl-e">impl.ProcessorImpl</span>[<span class="pl-en">Tea</span>, <span class="pl-en">MakeTea</span>] {
        <span class="pl-k">protected</span> <span class="pl-k">def</span> <span class="pl-en">body</span>()<span class="pl-k">:</span> <span class="pl-en">Tea</span> <span class="pl-k">=</span> blocking {
          <span class="pl-k">val</span> <span class="pl-en">seconds</span> <span class="pl-k">=</span> config.minutes <span class="pl-k">*</span> <span class="pl-c1">60</span>
          <span class="pl-k">for</span> (i <span class="pl-k">&lt;</span><span class="pl-k">-</span> <span class="pl-c1">1</span> to seconds) {
            <span class="pl-en">Thread</span>.sleep(<span class="pl-c1">1000</span>)
            checkAborted()
            progress <span class="pl-k">=</span> i.toDouble<span class="pl-k">/</span>seconds
          }
          <span class="pl-k">new</span> <span class="pl-en">Tea</span>(config.variety)
        }
      }
    }
    <span class="pl-k">trait</span> <span class="pl-en">MakeTea</span> <span class="pl-k">extends</span> <span class="pl-e">ProcessorLike</span>[<span class="pl-en">Tea</span>, <span class="pl-en">MakeTea</span>] { <span class="pl-k">def</span> <span class="pl-en">config</span><span class="pl-k">:</span> <span class="pl-en">MakeTea</span>.config }

    <span class="pl-k">val</span> <span class="pl-en">black</span> <span class="pl-k">=</span> <span class="pl-en">MakeTea</span>(<span class="pl-en">MakeTea</span>.<span class="pl-en">Config</span>(<span class="pl-s"><span class="pl-pds">"</span>black<span class="pl-pds">"</span></span>, <span class="pl-c1">4</span>))
    <span class="pl-k">val</span> <span class="pl-en">green</span> <span class="pl-k">=</span> <span class="pl-en">MakeTea</span>(<span class="pl-en">MakeTea</span>.<span class="pl-en">Config</span>(<span class="pl-s"><span class="pl-pds">"</span>green<span class="pl-pds">"</span></span>, <span class="pl-c1">3</span>))
    <span class="pl-k">val</span> <span class="pl-en">all</span>   <span class="pl-k">=</span> black <span class="pl-k">::</span> green <span class="pl-k">::</span> <span class="pl-c1">Nil</span>

    <span class="pl-k">val</span> <span class="pl-en">obs</span><span class="pl-k">:</span> <span class="pl-en">MakeTea</span>.<span class="pl-en">Observer</span> <span class="pl-k">=</span> {
      <span class="pl-k">case</span> prog <span class="pl-k">@</span> <span class="pl-en">Processor</span>.<span class="pl-en">Progress</span>(p, _)  <span class="pl-k">=&gt;</span> println(s<span class="pl-s"><span class="pl-pds">"</span>${p.config.variety} brew ${prog.toInt}%<span class="pl-pds">"</span></span>)
      <span class="pl-k">case</span> <span class="pl-en">Processor</span>.<span class="pl-en">Result</span>(_, v)           <span class="pl-k">=&gt;</span> println(v)
    }

    all.foreach(_.addListener(obs))

    <span class="pl-k">import</span> <span class="pl-v">ExecutionContext.Implicits.</span><span class="pl-v">global</span>
    all.foreach(_.start())

    <span class="pl-en">Await</span>.ready(<span class="pl-en">Future</span>.firstCompletedOf(all), <span class="pl-en">Inf</span>)
    all.foreach { p <span class="pl-k">=&gt;</span>
      p.abort() <span class="pl-c"><span class="pl-c">//</span> don't bother about the remaining teas</span>
      <span class="pl-en">Await</span>.ready(p, <span class="pl-en">Inf</span>)
    }</pre>
  </div> 
 </article>
</div>