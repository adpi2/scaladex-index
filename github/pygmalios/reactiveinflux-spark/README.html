<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-reactiveinflux-spark-041" class="anchor" href="https://github.com/pygmalios/reactiveinflux-spark#reactiveinflux-spark-041" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>reactiveinflux-spark 0.4.1</h1> 
  <p><a href="http://spark.apache.org/" target="_blank">Apache Spark</a> support for <a href="https://github.com/pygmalios/reactiveinflux" target="_blank">reactiveinflux - non-blocking InfluxDB driver for Scala and Java</a>.</p> 
  <h2><a id="user-content-get-it-from-maven-central-repository" class="anchor" href="https://github.com/pygmalios/reactiveinflux-spark#get-it-from-maven-central-repository" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Get it from Maven Central repository</h2> 
  <p><strong>Maven:</strong></p> 
  <div class="highlight highlight-text-xml">
   <pre>&lt;<span class="pl-ent">dependency</span>&gt;
  &lt;<span class="pl-ent">groupId</span>&gt;com.pygmalios&lt;/<span class="pl-ent">groupId</span>&gt;
  &lt;<span class="pl-ent">artifactId</span>&gt;reactiveinflux-spark_2.10&lt;/<span class="pl-ent">artifactId</span>&gt;
  &lt;<span class="pl-ent">version</span>&gt;1.4.0.10.0.4.1&lt;/<span class="pl-ent">version</span>&gt;
&lt;/<span class="pl-ent">dependency</span>&gt;</pre>
  </div> 
  <p><strong>SBT:</strong></p> 
  <pre><code>libraryDependencies += "com.pygmalios" % "reactiveinflux" %% "1.4.0.10.0.4.1"
</code></pre> 
  <h2><a id="user-content-compatibility" class="anchor" href="https://github.com/pygmalios/reactiveinflux-spark#compatibility" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Compatibility</h2> 
  <ul> 
   <li>Apache Spark 1.4 and above</li> 
   <li>InfluxDB 0.11, 0.10 and 0.9 (maybe even older too)</li> 
   <li>Scala 2.11 and 2.10</li> 
   <li>Java 7 and above</li> 
  </ul> 
  <h2><a id="user-content-scala-example" class="anchor" href="https://github.com/pygmalios/reactiveinflux-spark#scala-example" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Scala example</h2> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">package</span> <span class="pl-en">com.pygmalios.reactiveinflux.spark.examples</span>

<span class="pl-k">import</span> <span class="pl-v">com.pygmalios.reactiveinflux.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">com.pygmalios.reactiveinflux.spark.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">org.apache.spark.</span>{<span class="pl-v">SparkConf</span>, <span class="pl-v">SparkContext</span>}
<span class="pl-k">import</span> <span class="pl-v">org.apache.spark.rdd.</span><span class="pl-v">RDD</span>
<span class="pl-k">import</span> <span class="pl-v">org.joda.time.</span><span class="pl-v">DateTime</span>

<span class="pl-k">import</span> <span class="pl-v">scala.concurrent.duration.</span><span class="pl-v">_</span>

<span class="pl-c">/**</span>
<span class="pl-c">  * This example requires that:</span>
<span class="pl-c">  * 1. There exists "application.conf" resource containing Influx URL and other settings.</span>
<span class="pl-c">  * 2. "Example" database exists in Influx.</span>
<span class="pl-c">  */</span>
<span class="pl-k">object</span> <span class="pl-en">Example</span> <span class="pl-k">extends</span> <span class="pl-e">App</span> {
  <span class="pl-k">val</span> <span class="pl-en">conf</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">SparkConf</span>()
    .setMaster(<span class="pl-s"><span class="pl-pds">"</span>local[*]<span class="pl-pds">"</span></span>)
    .setAppName(<span class="pl-s"><span class="pl-pds">"</span>Example<span class="pl-pds">"</span></span>)
  <span class="pl-k">val</span> <span class="pl-en">sc</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">SparkContext</span>(conf)

  <span class="pl-k">val</span> <span class="pl-en">point1</span> <span class="pl-k">=</span> <span class="pl-en">Point</span>(
    time        <span class="pl-k">=</span> <span class="pl-en">DateTime</span>.now(),
    measurement <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>measurement1<span class="pl-pds">"</span></span>,
    tags        <span class="pl-k">=</span> <span class="pl-en">Map</span>(
      <span class="pl-s"><span class="pl-pds">"</span>tagKey1<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>tagValue1<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>tagKey2<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>tagValue2<span class="pl-pds">"</span></span>),
    fields      <span class="pl-k">=</span> <span class="pl-en">Map</span>(
      <span class="pl-s"><span class="pl-pds">"</span>fieldKey1<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>fieldValue1<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>fieldKey2<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">10.7</span>)
  )

  <span class="pl-c">// Provide settings for reactiveinflux</span>
  <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">params</span> <span class="pl-k">=</span> <span class="pl-en">ReactiveInfluxDbName</span>(<span class="pl-s"><span class="pl-pds">"</span>example<span class="pl-pds">"</span></span>)
  <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">awaitAtMost</span> <span class="pl-k">=</span> <span class="pl-c1">1.</span>second

  <span class="pl-c">// Create RDD with Influx point</span>
  <span class="pl-k">val</span> <span class="pl-en">rdd</span><span class="pl-k">:</span> <span class="pl-en">RDD</span>[<span class="pl-en">Point</span>] <span class="pl-k">=</span> sc.parallelize(<span class="pl-en">Seq</span>(point1))

  <span class="pl-c">// Save RDD to Influx</span>
  rdd.saveToInflux()

  <span class="pl-c">// Stop Spark context</span>
  sc.stop()
}</pre>
  </div> 
  <h2><a id="user-content-scala-streaming-example" class="anchor" href="https://github.com/pygmalios/reactiveinflux-spark#scala-streaming-example" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Scala streaming example</h2> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">package</span> <span class="pl-en">com.pygmalios.reactiveinflux.spark.examples</span>

<span class="pl-k">import</span> <span class="pl-v">com.pygmalios.reactiveinflux.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">com.pygmalios.reactiveinflux.spark.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">org.apache.spark.</span><span class="pl-v">SparkConf</span>
<span class="pl-k">import</span> <span class="pl-v">org.apache.spark.rdd.</span><span class="pl-v">RDD</span>
<span class="pl-k">import</span> <span class="pl-v">org.apache.spark.streaming.dstream.</span><span class="pl-v">DStream</span>
<span class="pl-k">import</span> <span class="pl-v">org.apache.spark.streaming.</span>{<span class="pl-v">Seconds</span>, <span class="pl-v">StreamingContext</span>}
<span class="pl-k">import</span> <span class="pl-v">org.joda.time.</span><span class="pl-v">DateTime</span>

<span class="pl-k">import</span> <span class="pl-v">scala.concurrent.duration.</span><span class="pl-v">_</span>

<span class="pl-c">/**</span>
<span class="pl-c">  * This example requires that:</span>
<span class="pl-c">  * 1. There exists "application.conf" resource containing Influx URL and other settings.</span>
<span class="pl-c">  * 2. "Example" database exists in Influx.</span>
<span class="pl-c">  */</span>
<span class="pl-k">object</span> <span class="pl-en">StreamingExample</span> <span class="pl-k">extends</span> <span class="pl-e">App</span> {
  <span class="pl-k">val</span> <span class="pl-en">conf</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">SparkConf</span>()
    .setMaster(<span class="pl-s"><span class="pl-pds">"</span>local[*]<span class="pl-pds">"</span></span>)
    .setAppName(<span class="pl-s"><span class="pl-pds">"</span>Example<span class="pl-pds">"</span></span>)
  <span class="pl-k">val</span> <span class="pl-en">ssc</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">StreamingContext</span>(conf, <span class="pl-en">Seconds</span>(<span class="pl-c1">1</span>))

  <span class="pl-k">val</span> <span class="pl-en">point1</span> <span class="pl-k">=</span> <span class="pl-en">Point</span>(
    time        <span class="pl-k">=</span> <span class="pl-en">DateTime</span>.now(),
    measurement <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>measurement1<span class="pl-pds">"</span></span>,
    tags        <span class="pl-k">=</span> <span class="pl-en">Map</span>(
      <span class="pl-s"><span class="pl-pds">"</span>tagKey1<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>tagValue1<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>tagKey2<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>tagValue2<span class="pl-pds">"</span></span>),
    fields      <span class="pl-k">=</span> <span class="pl-en">Map</span>(
      <span class="pl-s"><span class="pl-pds">"</span>fieldKey1<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>fieldValue1<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>fieldKey2<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-c1">10.7</span>)
  )

  <span class="pl-c">// Provide settings for reactiveinflux</span>
  <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">params</span> <span class="pl-k">=</span> <span class="pl-en">ReactiveInfluxDbName</span>(<span class="pl-s"><span class="pl-pds">"</span>example<span class="pl-pds">"</span></span>)
  <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">awaitAtMost</span> <span class="pl-k">=</span> <span class="pl-c1">1.</span>second

  <span class="pl-c">// Create DStream of Influx points</span>
  <span class="pl-k">val</span> <span class="pl-en">queue</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">scala.collection.mutable.Queue</span>[<span class="pl-en">RDD</span>[<span class="pl-en">Point</span>]]
  <span class="pl-k">val</span> <span class="pl-en">queueStream</span><span class="pl-k">:</span> <span class="pl-en">DStream</span>[<span class="pl-en">Point</span>] <span class="pl-k">=</span> ssc.queueStream(queue)

  <span class="pl-c">// Add single RDD with a single Influx point to the DStream</span>
  queue.enqueue(ssc.sparkContext.parallelize(<span class="pl-en">Seq</span>(point1)))

  <span class="pl-c">// Save DStream to Influx</span>
  queueStream.saveToInflux()

  <span class="pl-c">// Start Spark streaming</span>
  ssc.start()
  ssc.awaitTermination()
}</pre>
  </div> 
  <h2><a id="user-content-java-example" class="anchor" href="https://github.com/pygmalios/reactiveinflux-spark#java-example" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Java example</h2> 
  <div class="highlight highlight-source-java">
   <pre><span class="pl-k">package</span> <span class="pl-smi">com.pygmalios.reactiveinflux.spark.examples</span>;

<span class="pl-k">import</span> <span class="pl-smi">com.pygmalios.reactiveinflux.jawa.*</span>;
<span class="pl-k">import</span> <span class="pl-smi">com.pygmalios.reactiveinflux.spark.jawa.SparkInflux</span>;
<span class="pl-k">import</span> <span class="pl-smi">org.apache.spark.SparkConf</span>;
<span class="pl-k">import</span> <span class="pl-smi">org.apache.spark.api.java.JavaRDD</span>;
<span class="pl-k">import</span> <span class="pl-smi">org.apache.spark.api.java.JavaSparkContext</span>;
<span class="pl-k">import</span> <span class="pl-smi">org.joda.time.DateTime</span>;

<span class="pl-k">import</span> <span class="pl-smi">java.util.Collections</span>;
<span class="pl-k">import</span> <span class="pl-smi">java.util.HashMap</span>;
<span class="pl-k">import</span> <span class="pl-smi">java.util.Map</span>;

<span class="pl-c">/**</span>
<span class="pl-c"> * This example requires that:</span>
<span class="pl-c"> * 1. There exists "application.conf" resource containing Influx URL and other settings.</span>
<span class="pl-c"> * 2. "Example" database exists in Influx.</span>
<span class="pl-c"> */</span>
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">JavaExample</span> {
    <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">main</span>(<span class="pl-k">String</span>[] <span class="pl-v">args</span>) {
        <span class="pl-c">// Initialize Spark</span>
        <span class="pl-smi">SparkConf</span> conf <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">SparkConf</span>()
            .setMaster(<span class="pl-s"><span class="pl-pds">"</span>local[*]<span class="pl-pds">"</span></span>)
            .setAppName(<span class="pl-s"><span class="pl-pds">"</span>Example<span class="pl-pds">"</span></span>);
        <span class="pl-smi">JavaSparkContext</span> sc <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">JavaSparkContext</span>(conf);

        <span class="pl-c">// Initialize SparkInflux instance</span>
        <span class="pl-smi">SparkInflux</span> sparkInflux <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">SparkInflux</span>(<span class="pl-s"><span class="pl-pds">"</span>example<span class="pl-pds">"</span></span>, <span class="pl-c1">1000</span>);

        <span class="pl-c">// Define tags for the point</span>
        <span class="pl-k">Map&lt;<span class="pl-smi">String</span>, <span class="pl-smi">String</span>&gt;</span> tags <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-k">HashMap&lt;&gt;</span>();
        tags<span class="pl-k">.</span>put(<span class="pl-s"><span class="pl-pds">"</span>t1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>A<span class="pl-pds">"</span></span>);
        tags<span class="pl-k">.</span>put(<span class="pl-s"><span class="pl-pds">"</span>t2<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>B<span class="pl-pds">"</span></span>);

        <span class="pl-c">// Define fields for the point</span>
        <span class="pl-k">Map&lt;<span class="pl-smi">String</span>, <span class="pl-smi">Object</span>&gt;</span> fields <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-k">HashMap&lt;&gt;</span>();
        fields<span class="pl-k">.</span>put(<span class="pl-s"><span class="pl-pds">"</span>f1<span class="pl-pds">"</span></span>, <span class="pl-c1">10.3</span>);
        fields<span class="pl-k">.</span>put(<span class="pl-s"><span class="pl-pds">"</span>f2<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>x<span class="pl-pds">"</span></span>);
        fields<span class="pl-k">.</span>put(<span class="pl-s"><span class="pl-pds">"</span>f3<span class="pl-pds">"</span></span>, <span class="pl-k">-</span><span class="pl-c1">1</span>);
        fields<span class="pl-k">.</span>put(<span class="pl-s"><span class="pl-pds">"</span>f4<span class="pl-pds">"</span></span>, <span class="pl-c1">true</span>);

        <span class="pl-c">// Write a single point to "measurement1"</span>
        <span class="pl-smi">Point</span> point <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">JavaPoint</span>(
                <span class="pl-smi">DateTime</span><span class="pl-k">.</span>now(),
                <span class="pl-s"><span class="pl-pds">"</span>measurement1<span class="pl-pds">"</span></span>,
                tags,
                fields
        );

        <span class="pl-c">// Create RDD with Influx point</span>
        <span class="pl-k">JavaRDD&lt;<span class="pl-smi">Point</span>&gt;</span> rdd <span class="pl-k">=</span> sc<span class="pl-k">.</span>parallelize(<span class="pl-smi">Collections</span><span class="pl-k">.</span>singletonList(point));

        <span class="pl-c">// Save RDD to Influx</span>
        sparkInflux<span class="pl-k">.</span>saveToInflux(rdd);

        <span class="pl-c">// Stop Spark context</span>
        sc<span class="pl-k">.</span>stop();
    }
}</pre>
  </div> 
  <h2><a id="user-content-java-streaming-example" class="anchor" href="https://github.com/pygmalios/reactiveinflux-spark#java-streaming-example" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Java streaming example</h2> 
  <div class="highlight highlight-source-java">
   <pre><span class="pl-k">package</span> <span class="pl-smi">com.pygmalios.reactiveinflux.spark.examples</span>;

<span class="pl-k">import</span> <span class="pl-smi">com.pygmalios.reactiveinflux.jawa.JavaPoint</span>;
<span class="pl-k">import</span> <span class="pl-smi">com.pygmalios.reactiveinflux.jawa.Point</span>;
<span class="pl-k">import</span> <span class="pl-smi">com.pygmalios.reactiveinflux.spark.jawa.SparkInflux</span>;
<span class="pl-k">import</span> <span class="pl-smi">org.apache.spark.SparkConf</span>;
<span class="pl-k">import</span> <span class="pl-smi">org.apache.spark.api.java.JavaRDD</span>;
<span class="pl-k">import</span> <span class="pl-smi">org.apache.spark.streaming.Durations</span>;
<span class="pl-k">import</span> <span class="pl-smi">org.apache.spark.streaming.api.java.JavaDStream</span>;
<span class="pl-k">import</span> <span class="pl-smi">org.apache.spark.streaming.api.java.JavaStreamingContext</span>;
<span class="pl-k">import</span> <span class="pl-smi">org.joda.time.DateTime</span>;

<span class="pl-k">import</span> <span class="pl-smi">java.util.*</span>;

<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">JavaStreamingExample</span> {
    <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">main</span>(<span class="pl-k">String</span>[] <span class="pl-v">args</span>) {
        <span class="pl-c">// Initialize Spark</span>
        <span class="pl-smi">SparkConf</span> conf <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">SparkConf</span>()
                .setMaster(<span class="pl-s"><span class="pl-pds">"</span>local[*]<span class="pl-pds">"</span></span>)
                .setAppName(<span class="pl-s"><span class="pl-pds">"</span>Example<span class="pl-pds">"</span></span>);
        <span class="pl-smi">JavaStreamingContext</span> ssc <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">JavaStreamingContext</span>(conf, <span class="pl-smi">Durations</span><span class="pl-k">.</span>seconds(<span class="pl-c1">1</span>));

        <span class="pl-c">// Initialize SparkInflux instance</span>
        <span class="pl-smi">SparkInflux</span> sparkInflux <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">SparkInflux</span>(<span class="pl-s"><span class="pl-pds">"</span>example<span class="pl-pds">"</span></span>, <span class="pl-c1">1000</span>);

        <span class="pl-c">// Define tags for the point</span>
        <span class="pl-k">Map&lt;<span class="pl-smi">String</span>, <span class="pl-smi">String</span>&gt;</span> tags <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-k">HashMap&lt;&gt;</span>();
        tags<span class="pl-k">.</span>put(<span class="pl-s"><span class="pl-pds">"</span>t1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>A<span class="pl-pds">"</span></span>);
        tags<span class="pl-k">.</span>put(<span class="pl-s"><span class="pl-pds">"</span>t2<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>B<span class="pl-pds">"</span></span>);

        <span class="pl-c">// Define fields for the point</span>
        <span class="pl-k">Map&lt;<span class="pl-smi">String</span>, <span class="pl-smi">Object</span>&gt;</span> fields <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-k">HashMap&lt;&gt;</span>();
        fields<span class="pl-k">.</span>put(<span class="pl-s"><span class="pl-pds">"</span>f1<span class="pl-pds">"</span></span>, <span class="pl-c1">10.3</span>);
        fields<span class="pl-k">.</span>put(<span class="pl-s"><span class="pl-pds">"</span>f2<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>x<span class="pl-pds">"</span></span>);
        fields<span class="pl-k">.</span>put(<span class="pl-s"><span class="pl-pds">"</span>f3<span class="pl-pds">"</span></span>, <span class="pl-k">-</span><span class="pl-c1">1</span>);
        fields<span class="pl-k">.</span>put(<span class="pl-s"><span class="pl-pds">"</span>f4<span class="pl-pds">"</span></span>, <span class="pl-c1">true</span>);

        <span class="pl-c">// Write a single point to "measurement1"</span>
        <span class="pl-smi">Point</span> point <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">JavaPoint</span>(
            <span class="pl-smi">DateTime</span><span class="pl-k">.</span>now(),
            <span class="pl-s"><span class="pl-pds">"</span>measurement1<span class="pl-pds">"</span></span>,
            tags,
            fields
        );

        <span class="pl-c">// Create DStream of Influx points</span>
        <span class="pl-k">Queue&lt;<span class="pl-k">JavaRDD&lt;<span class="pl-smi">Point</span>&gt;</span>&gt;</span> queue <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-k">LinkedList&lt;&gt;</span>();

        <span class="pl-c">// Add single RDD with a single Influx point to the DStream</span>
        queue<span class="pl-k">.</span>add(ssc<span class="pl-k">.</span>sparkContext()<span class="pl-k">.</span>parallelize(<span class="pl-smi">Collections</span><span class="pl-k">.</span>singletonList(point)));
        <span class="pl-k">JavaDStream&lt;<span class="pl-smi">Point</span>&gt;</span> queueStream <span class="pl-k">=</span> ssc<span class="pl-k">.</span>queueStream(queue);

        <span class="pl-c">// Save DStream to Influx</span>
        sparkInflux<span class="pl-k">.</span>saveToInflux(queueStream);

        <span class="pl-c">// Start Spark streaming</span>
        ssc<span class="pl-k">.</span>start();
        ssc<span class="pl-k">.</span>awaitTermination();
    }
}</pre>
  </div> 
  <h2><a id="user-content-versioning-explained" class="anchor" href="https://github.com/pygmalios/reactiveinflux-spark#versioning-explained" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Versioning explained</h2> 
  <p>Version number (1.4.0.10.0.4.1-SNAPSHOT) of reactiveinflux-spark consists of four parts:</p> 
  <ol> 
   <li>Apache Spark major and minor versions. (1.4)</li> 
   <li>InfluxDB major and minor versions. (0.10)</li> 
   <li>Reactiveinflux major and minor versions. (0.4)</li> 
   <li>Reactiveinflux-spark version. (1-SNAPSHOT)</li> 
  </ol> 
  <p>Additionally Scala 2.11 and 2.10 versions are supported by adding "_2.11" or "_2.10" suffix to the artifact name.</p> 
 </article>
</div>