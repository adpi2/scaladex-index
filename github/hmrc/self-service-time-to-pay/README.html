<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-self-service-time-to-pay" class="anchor" href="https://github.com/hmrc/self-service-time-to-pay#self-service-time-to-pay" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>self-service-time-to-pay</h1> 
  <p><a href="https://travis-ci.org/hmrc/self-service-time-to-pay" target="_blank"><img src="https://camo.githubusercontent.com/98c27a9ff419e000c903ba4475325d15371dd662/68747470733a2f2f7472617669732d63692e6f72672f686d72632f73656c662d736572766963652d74696d652d746f2d7061792e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/hmrc/self-service-time-to-pay.svg?branch=master" style="max-width:100%;"></a> <a href="https://bintray.com/hmrc/releases/self-service-time-to-pay/_latestVersion" target="_blank"> <img src="https://camo.githubusercontent.com/a7b8b3514133b2c0d23067e00f5a1f24396c9857/68747470733a2f2f6170692e62696e747261792e636f6d2f7061636b616765732f686d72632f72656c65617365732f73656c662d736572766963652d74696d652d746f2d7061792f696d616765732f646f776e6c6f61642e737667" alt="Download" data-canonical-src="https://api.bintray.com/packages/hmrc/releases/self-service-time-to-pay/images/download.svg" style="max-width:100%;"> </a></p> 
  <h2><a id="user-content-endpoint-urls" class="anchor" href="https://github.com/hmrc/self-service-time-to-pay#endpoint-urls" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Endpoint URLs</h2> 
  <p>POST <code>/paymentschedule</code></p> 
  <h2><a id="user-content-service-definitions" class="anchor" href="https://github.com/hmrc/self-service-time-to-pay#service-definitions" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Service Definitions</h2> 
  <p>All requests use the HTTP <code>POST</code> method</p> 
  <h3><a id="user-content-multiple-payment-schedule-calculator-external-facing-api---paymentschedule" class="anchor" href="https://github.com/hmrc/self-service-time-to-pay#multiple-payment-schedule-calculator-external-facing-api---paymentschedule" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Multiple Payment Schedule Calculator (external facing API - <code>/paymentschedule</code>)</h3> 
  <h4><a id="user-content-functionality" class="anchor" href="https://github.com/hmrc/self-service-time-to-pay#functionality" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Functionality</h4> 
  <p>Return a set of payment schedules for a bounded period (next 'event' date)</p> 
  <ul> 
   <li><p>Given:</p> 
    <ul> 
     <li>A collection of <code>liability</code> items (type, amount, interest already accrued, interest calculated to date)</li> 
     <li>A <code>start date</code> for the arrangement (default to today)</li> 
     <li>An <code>end date</code> for the arrangement (default to start date + 11 months)</li> 
     <li>An <code>initial payment</code> amount affordable</li> 
    </ul></li> 
   <li><p>For each "number of arrangements" (<code>months</code> = 2 .. <code>end date</code> months)</p> 
    <ul> 
     <li>Invoke the <code>Payment Schedule Calculator</code> (below) with an end date set to <code>months</code> in the future</li> 
    </ul></li> 
   <li>Collate results in a PaymentSchedules element and return</li> 
  </ul> 
  <h4><a id="user-content-input-structure" class="anchor" href="https://github.com/hmrc/self-service-time-to-pay#input-structure" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Input structure</h4> 
  <p>Calculator input model:</p> 
  <table>
   <thead> 
    <tr> 
     <th align="center">Parameter</th> 
     <th align="center">Type</th> 
     <th align="center">Description</th> 
    </tr> 
   </thead>
   <tbody> 
    <tr> 
     <td align="center">liabilities</td> 
     <td align="center">List[Liability]</td> 
     <td align="center">Collection of debts owed</td> 
    </tr> 
    <tr> 
     <td align="center">initialPayment</td> 
     <td align="center">BigDecimal</td> 
     <td align="center">How much they can pay now</td> 
    </tr> 
    <tr> 
     <td align="center">startDate</td> 
     <td align="center">LocalDate</td> 
     <td align="center">The start date of the TTP arrangement</td> 
    </tr> 
    <tr> 
     <td align="center">endDate</td> 
     <td align="center">LocalDate</td> 
     <td align="center">The end date of the TTP arrangement</td> 
    </tr> 
    <tr> 
     <td align="center">paymentFrequency [DAILY|WEEKLY|MONTHLY]</td> 
     <td align="center">String</td> 
     <td align="center">The frequency of the instalment payments</td> 
    </tr> 
   </tbody>
  </table> 
  <p>Liability input model:</p> 
  <table>
   <thead> 
    <tr> 
     <th>Parameter</th> 
     <th>Type</th> 
     <th>Description</th> 
    </tr> 
   </thead>
   <tbody> 
    <tr> 
     <td>type</td> 
     <td>String</td> 
     <td>The type of the debt</td> 
    </tr> 
    <tr> 
     <td>amount</td> 
     <td>BigDecimal</td> 
     <td>The amount owed for that debt</td> 
    </tr> 
    <tr> 
     <td>interestAccrued</td> 
     <td>BigDecimal</td> 
     <td>How much interest has been accumulated to date</td> 
    </tr> 
    <tr> 
     <td>interestCalculationDate</td> 
     <td>LocalDate</td> 
     <td>At what date was the interest last calculated up to</td> 
    </tr> 
    <tr> 
     <td>dueDate (optional)</td> 
     <td>LocalDate</td> 
     <td>The due date of the debt, used to calculate which debt to pay off first</td> 
    </tr> 
   </tbody>
  </table> 
  <p>Sample input request:</p> 
  <pre><code>{
  "liabilities" : [
   {
     "type": "POA2";
     "amount": 250.52,
     "interestAccrued": 42.32,
     "interestCalculationDate": "2016-06-01",
     "dueDate": "2016-01-31"
   },
   {
     "type": "POA1";
     "amount": 134.07,
     "interestAccrued": 10.50,
     "interestCalculationDate": "2016-02-01",
     "dueDate": ""
   }
  ]
  "initialPayment": 50,
  "startDate": "2016-09-01",
  "endDate": "2017-08-01",
  "paymentFrequency": "MONTHLY"
}
</code></pre> 
  <h4><a id="user-content-output-structure" class="anchor" href="https://github.com/hmrc/self-service-time-to-pay#output-structure" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Output structure</h4> 
  <p>Payment schedule output model:</p> 
  <table>
   <thead> 
    <tr> 
     <th align="center">Parameter</th> 
     <th align="center">Type</th> 
     <th align="center">Description</th> 
    </tr> 
   </thead>
   <tbody> 
    <tr> 
     <td align="center">initialPayment</td> 
     <td align="center">BigDecimal</td> 
     <td align="center">How much they can pay now</td> 
    </tr> 
    <tr> 
     <td align="center">amountToPay</td> 
     <td align="center">BigDecimal</td> 
     <td align="center">Total debt owed</td> 
    </tr> 
    <tr> 
     <td align="center">instalmentBalance</td> 
     <td align="center">BigDecimal</td> 
     <td align="center">The amount to pay over the instalments</td> 
    </tr> 
    <tr> 
     <td align="center">totalInterestCharged</td> 
     <td align="center">BigDecimal</td> 
     <td align="center">How much interest has been applied</td> 
    </tr> 
    <tr> 
     <td align="center">totalPayable</td> 
     <td align="center">BigDecimal</td> 
     <td align="center">The amount to be paid from today including interest</td> 
    </tr> 
    <tr> 
     <td align="center">instalments</td> 
     <td align="center">List[Instalment]</td> 
     <td align="center">List of the instalment payment amounts and dates</td> 
    </tr> 
   </tbody>
  </table> 
  <p>Instalment (inner class) output model:</p> 
  <table>
   <thead> 
    <tr> 
     <th align="center">Parameter</th> 
     <th align="center">Type</th> 
     <th align="center">Description</th> 
    </tr> 
   </thead>
   <tbody> 
    <tr> 
     <td align="center">paymentDate</td> 
     <td align="center">LocalDate</td> 
     <td align="center">The date that the payment is due</td> 
    </tr> 
    <tr> 
     <td align="center">amount</td> 
     <td align="center">BigDecimal</td> 
     <td align="center">The amount to pay for that instalment</td> 
    </tr> 
   </tbody>
  </table> 
  <p>Sample successful output response:</p> 
  <pre><code>[
  {
    "initialPayment": 50,
    "amountToPay": 5000,
    "instalmentBalance": 4950,
    "totalInterestCharged": 22.91,
    "totalPayable": 5022.91,
    "instalments": [
      {
        "paymentDate": "2016-10-01",
        "amount": 2486.45
      },
      {
        "paymentDate": "2016-11-01",
        "amount": 2486.45
      }
    ]
  },
  {
    "initialPayment": 50,
    "amountToPay": 5000,
    "instalmentBalance": 4950,
    "totalInterestCharged": 34.18,
    "totalPayable": 5034.18,
    "instalments": [
      {
        "paymentDate": "2016-10-01",
        "amount": 1661.39
      },
      {
        "paymentDate": "2016-11-01",
        "amount": 1661.39
      },
      {
        "paymentDate": "2016-12-01",
        "amount": 1661.39
      }
    ]
  },
  {
    "initialPayment": 50,
    "amountToPay": 5000,
    "instalmentBalance": 4950,
    "totalInterestCharged": 45.83,
    "totalPayable": 5045.83,
    "instalments": [
      {
        "paymentDate": "2016-10-01",
        "amount": 1248.95
      },
      {
        "paymentDate": "2016-11-01",
        "amount": 1248.95
      },
      {
        "paymentDate": "2016-12-01",
        "amount": 1248.95
      },
      {
        "paymentDate": "2017-01-01",
        "amount": 1248.95
      }
    ]
  },
  {
    "initialPayment": 50,
    "amountToPay": 5000,
    "instalmentBalance": 4950,
    "totalInterestCharged": 57.5,
    "totalPayable": 5057.5,
    "instalments": [
      {
        "paymentDate": "2016-10-01",
        "amount": 1001.5
      },
      {
        "paymentDate": "2016-11-01",
        "amount": 1001.5
      },
      {
        "paymentDate": "2016-12-01",
        "amount": 1001.5
      },
      {
        "paymentDate": "2017-01-01",
        "amount": 1001.5
      },
      {
        "paymentDate": "2017-02-01",
        "amount": 1001.5
      }
    ]
  },
  {
    "initialPayment": 50,
    "amountToPay": 5000,
    "instalmentBalance": 4950,
    "totalInterestCharged": 68.05,
    "totalPayable": 5068.05,
    "instalments": [
      {
        "paymentDate": "2016-10-01",
        "amount": 836.34
      },
      {
        "paymentDate": "2016-11-01",
        "amount": 836.34
      },
      {
        "paymentDate": "2016-12-01",
        "amount": 836.34
      },
      {
        "paymentDate": "2017-01-01",
        "amount": 836.34
      },
      {
        "paymentDate": "2017-02-01",
        "amount": 836.34
      },
      {
        "paymentDate": "2017-03-01",
        "amount": 836.34
      }
    ]
  },
  {
    "initialPayment": 50,
    "amountToPay": 5000,
    "instalmentBalance": 4950,
    "totalInterestCharged": 79.73,
    "totalPayable": 5079.73,
    "instalments": [
      {
        "paymentDate": "2016-10-01",
        "amount": 718.53
      },
      {
        "paymentDate": "2016-11-01",
        "amount": 718.53
      },
      {
        "paymentDate": "2016-12-01",
        "amount": 718.53
      },
      {
        "paymentDate": "2017-01-01",
        "amount": 718.53
      },
      {
        "paymentDate": "2017-02-01",
        "amount": 718.53
      },
      {
        "paymentDate": "2017-03-01",
        "amount": 718.53
      },
      {
        "paymentDate": "2017-04-01",
        "amount": 718.53
      }
    ]
  },
  {
    "initialPayment": 50,
    "amountToPay": 5000,
    "instalmentBalance": 4950,
    "totalInterestCharged": 91.03,
    "totalPayable": 5091.03,
    "instalments": [
      {
        "paymentDate": "2016-10-01",
        "amount": 630.12
      },
      {
        "paymentDate": "2016-11-01",
        "amount": 630.12
      },
      {
        "paymentDate": "2016-12-01",
        "amount": 630.12
      },
      {
        "paymentDate": "2017-01-01",
        "amount": 630.12
      },
      {
        "paymentDate": "2017-02-01",
        "amount": 630.12
      },
      {
        "paymentDate": "2017-03-01",
        "amount": 630.12
      },
      {
        "paymentDate": "2017-04-01",
        "amount": 630.12
      },
      {
        "paymentDate": "2017-05-01",
        "amount": 630.12
      }
    ]
  },
  {
    "initialPayment": 50,
    "amountToPay": 5000,
    "instalmentBalance": 4950,
    "totalInterestCharged": 102.71,
    "totalPayable": 5102.71,
    "instalments": [
      {
        "paymentDate": "2016-10-01",
        "amount": 561.41
      },
      {
        "paymentDate": "2016-11-01",
        "amount": 561.41
      },
      {
        "paymentDate": "2016-12-01",
        "amount": 561.41
      },
      {
        "paymentDate": "2017-01-01",
        "amount": 561.41
      },
      {
        "paymentDate": "2017-02-01",
        "amount": 561.41
      },
      {
        "paymentDate": "2017-03-01",
        "amount": 561.41
      },
      {
        "paymentDate": "2017-04-01",
        "amount": 561.41
      },
      {
        "paymentDate": "2017-05-01",
        "amount": 561.41
      },
      {
        "paymentDate": "2017-06-01",
        "amount": 561.41
      }
    ]
  },
  {
    "initialPayment": 50,
    "amountToPay": 5000,
    "instalmentBalance": 4950,
    "totalInterestCharged": 114.01,
    "totalPayable": 5114.01,
    "instalments": [
      {
        "paymentDate": "2016-10-01",
        "amount": 506.4
      },
      {
        "paymentDate": "2016-11-01",
        "amount": 506.4
      },
      {
        "paymentDate": "2016-12-01",
        "amount": 506.4
      },
      {
        "paymentDate": "2017-01-01",
        "amount": 506.4
      },
      {
        "paymentDate": "2017-02-01",
        "amount": 506.4
      },
      {
        "paymentDate": "2017-03-01",
        "amount": 506.4
      },
      {
        "paymentDate": "2017-04-01",
        "amount": 506.4
      },
      {
        "paymentDate": "2017-05-01",
        "amount": 506.4
      },
      {
        "paymentDate": "2017-06-01",
        "amount": 506.4
      },
      {
        "paymentDate": "2017-07-01",
        "amount": 506.4
      }
    ]
  },
  {
    "initialPayment": 50,
    "amountToPay": 5000,
    "instalmentBalance": 4950,
    "totalInterestCharged": 125.69,
    "totalPayable": 5125.69,
    "instalments": [
      {
        "paymentDate": "2016-10-01",
        "amount": 461.42
      },
      {
        "paymentDate": "2016-11-01",
        "amount": 461.42
      },
      {
        "paymentDate": "2016-12-01",
        "amount": 461.42
      },
      {
        "paymentDate": "2017-01-01",
        "amount": 461.42
      },
      {
        "paymentDate": "2017-02-01",
        "amount": 461.42
      },
      {
        "paymentDate": "2017-03-01",
        "amount": 461.42
      },
      {
        "paymentDate": "2017-04-01",
        "amount": 461.42
      },
      {
        "paymentDate": "2017-05-01",
        "amount": 461.42
      },
      {
        "paymentDate": "2017-06-01",
        "amount": 461.42
      },
      {
        "paymentDate": "2017-07-01",
        "amount": 461.42
      },
      {
        "paymentDate": "2017-08-01",
        "amount": 461.42
      }
    ]
  },
  {
    "initialPayment": 50,
    "amountToPay": 5000,
    "instalmentBalance": 4950,
    "totalInterestCharged": 137.37,
    "totalPayable": 5137.37,
    "instalments": [
      {
        "paymentDate": "2016-10-01",
        "amount": 423.94
      },
      {
        "paymentDate": "2016-11-01",
        "amount": 423.94
      },
      {
        "paymentDate": "2016-12-01",
        "amount": 423.94
      },
      {
        "paymentDate": "2017-01-01",
        "amount": 423.94
      },
      {
        "paymentDate": "2017-02-01",
        "amount": 423.94
      },
      {
        "paymentDate": "2017-03-01",
        "amount": 423.94
      },
      {
        "paymentDate": "2017-04-01",
        "amount": 423.94
      },
      {
        "paymentDate": "2017-05-01",
        "amount": 423.94
      },
      {
        "paymentDate": "2017-06-01",
        "amount": 423.94
      },
      {
        "paymentDate": "2017-07-01",
        "amount": 423.94
      },
      {
        "paymentDate": "2017-08-01",
        "amount": 423.94
      },
      {
        "paymentDate": "2017-09-01",
        "amount": 423.94
      }
    ]
  }
]
</code></pre> 
  <h3><a id="user-content-payment-schedule-calculator-definition-internal---for-information-only" class="anchor" href="https://github.com/hmrc/self-service-time-to-pay#payment-schedule-calculator-definition-internal---for-information-only" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Payment Schedule Calculator definition (internal - for information only)</h3> 
  <ul> 
   <li><p>Given:</p> 
    <ul> 
     <li>A collection of debt line items (<code>type</code>, <code>amount</code>, <code>interest already accrued</code>, <code>interest calculated to date</code>)</li> 
     <li>A <code>start date</code> for the arrangement (default to today)</li> 
     <li>An <code>end date</code> for the arrangement (end date)</li> 
     <li>An initial payable now amount</li> 
    </ul></li> 
   <li><p>Order debt line items by their due date (earliest date first)</p></li> 
   <li>For each debt line item - establish the <code>liability to start date</code> and <code>interest over arrangement</code> values: 
    <ul> 
     <li>Establish interest rates for period between <code>interest calculated to date</code> and <code>start date</code></li> 
     <li>For each interest rate within that period: 
      <ul> 
       <li>Establish <code>number of days</code> @ <code>interest rate</code></li> 
       <li>Apply simple interest rate formula using <code>number of days</code>, <code>interest rate</code> &amp; debt line item <code>amount</code></li> 
      </ul></li> 
     <li>Sum all interest values calculated (no precision loss - <code>interest to start date</code>)</li> 
     <li>Subtract any remaining <code>payable now</code> amount from the <code>amount</code> (<code>remaining amount</code>) 
      <ul> 
       <li>If this results in a negative number (debt line item fully paid off - only interest remaining), move to the next line and reduce the <code>payable now</code> amount remaining to apply to that line by the value of this line item's <code>amount</code>, set <code>liability to start date</code> of this line to <code>interest to start date</code> (only the interest component remains)</li> 
      </ul></li> 
     <li>For the final interest period, add a further calculation based on <code>remaining amount</code> for interest from <code>start date</code> to arrangement <code>end date</code></li> 
    </ul></li> 
   <li>Sum all debt line item interest costs (<code>total interest</code> no precision loss)</li> 
   <li>Sum <code>total interest</code> calculated with sum of all debt line item <code>amounts</code> (<code>total liability</code> over period of TTP)</li> 
   <li>Establish <code>number of payments</code> (using monthly frequency and end date to establish number)</li> 
   <li>Divide <code>total liability</code> by <code>number of payments</code> &amp; truncate (FLOOR) the value to 2 decimal places (monthly payment amounts for months-1 payments)</li> 
   <li>Multiply monthly payment amount by months-1 (total paid over all but last period)</li> 
   <li>Subtract the "total for all but last period" from the total liability to establish the potentially slightly higher (but never lower) final payment</li> 
   <li>Build a payment plan based on the calculations</li> 
  </ul> 
  <h3><a id="user-content-license" class="anchor" href="https://github.com/hmrc/self-service-time-to-pay#license" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>License</h3> 
  <p>This code is open source software licensed under the Apache 2.0 License.</p> 
 </article>
</div>