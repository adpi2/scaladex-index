<div class="announce instapaper_body asciidoc" data-path="README.asciidoc" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a href="https://github.com/milenkovicm/kamon-prometheus#kamon-prometheus" aria-hidden="true" class="anchor" id="user-content-kamon-prometheus" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>kamon-prometheus</h1> 
  <div id="user-content-preamble"> 
   <div> 
    <div> 
     <p><a href="https://bintray.com/monsanto/maven/kamon-prometheus/_latestVersion" target="_blank"><img src="https://camo.githubusercontent.com/47f00d47818399023c76afe4111f3f76c449cc6d/68747470733a2f2f6170692e62696e747261792e636f6d2f7061636b616765732f6d6f6e73616e746f2f6d6176656e2f6b616d6f6e2d70726f6d6574686575732f696d616765732f646f776e6c6f61642e737667" alt="download" data-canonical-src="https://api.bintray.com/packages/monsanto/maven/kamon-prometheus/images/download.svg" style="max-width:100%;"></a> <a href="https://coveralls.io/github/MonsantoCo/kamon-prometheus?branch=master" target="_blank"><img src="https://camo.githubusercontent.com/1f795572f15251caf6dd836dca5bf3e0741116f9/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6769746875622f4d6f6e73616e746f436f2f6b616d6f6e2d70726f6d6574686575732f62616467652e7376673f6272616e63683d6d6173746572" alt="Coverage status" data-canonical-src="https://coveralls.io/repos/github/MonsantoCo/kamon-prometheus/badge.svg?branch=master" style="max-width:100%;"></a> <a href="https://travis-ci.org/MonsantoCo/kamon-prometheus" target="_blank"><img src="https://camo.githubusercontent.com/63f9b44649aacf2722bdf111c1fafb47f54a40d2/68747470733a2f2f7472617669732d63692e6f72672f4d6f6e73616e746f436f2f6b616d6f6e2d70726f6d6574686575732e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/MonsantoCo/kamon-prometheus.svg?branch=master" style="max-width:100%;"></a></p> 
    </div> 
    <div> 
     <p>This library provides a Kamon module that can serve metrics to <a href="http://prometheus.io/" target="_blank">Prometheus</a>, an open source service monitoring system and time series database. Since Prometheus uses a scraping mechanism and its own data model, this module bridges the gap between the two. It converts Kamon metrics into a Prometheus-friendly format and provides integrations for both Spray and Akka HTTP so that your application can serve metrics to Prometheus.</p> 
    </div> 
   </div> 
  </div> 
  <div> 
   <h2 id="user-content-features"><a href="https://github.com/milenkovicm/kamon-prometheus#features" aria-hidden="true" class="anchor" id="user-content-features" target="_blank">
     <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
      <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
     </svg></a>Features</h2> 
   <div> 
    <div> 
     <ul> 
      <li> <p>Converts Kamon metrics data to conform to Prometheus’ data model, including:</p> 
       <div> 
        <ul> 
         <li> <p>Reasonably handles all Kamon entities, including custom entities</p> </li> 
         <li> <p>Preservation of units of measurement</p> </li> 
        </ul> 
       </div> </li> 
      <li> <p>Provides Spray and Akka HTTP route that supports:</p> 
       <div> 
        <ul> 
         <li> <p>Both text and <a href="https://developers.google.com/protocol-buffers/" target="_blank">Protocol buffer</a> representation formats</p> </li> 
         <li> <p>Optional gzip compression</p> </li> 
        </ul> 
       </div> </li> 
      <li> <p>Allows collection of snapshots without an endpoint using an actor</p> </li> 
      <li> <p>Allows configuration of:</p> 
       <div> 
        <ul> 
         <li> <p>Refresh interval to match Prometheus</p> </li> 
         <li> <p>Metric subscriptions to export</p> </li> 
         <li> <p>Additional Prometheus labels on exported metrics</p> </li> 
        </ul> 
       </div> </li> 
     </ul> 
    </div> 
   </div> 
  </div> 
  <div> 
   <h2 id="user-content-installation"><a href="https://github.com/milenkovicm/kamon-prometheus#installation" aria-hidden="true" class="anchor" id="user-content-installation" target="_blank">
     <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
      <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
     </svg></a>Installation</h2> 
   <div> 
    <div> 
     <p>In order to use this module, you will need to add the following dependency to your <code>build.sbt</code>:</p> 
    </div> 
    <div> 
     <div> 
      <div class="highlight highlight-source-scala">
       <pre>libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>com.monsanto.arch<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>kamon-prometheus<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.2.0<span class="pl-pds">"</span></span></pre>
      </div> 
     </div> 
    </div> 
    <div> 
     <p>You may also need to add JCenter as a resolver:</p> 
    </div> 
    <div> 
     <div> 
      <div class="highlight highlight-source-scala">
       <pre>resolvers <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-en">Resolver</span>.jcenterRepo</pre>
      </div> 
     </div> 
    </div> 
    <div> 
     <p>Kamon’s module loader should automatically detect the presence of <em>kamon-prometheus</em> and start it. However, in order to be useful, you will need to <a href="https://github.com/milenkovicm/kamon-prometheus#usage" target="_blank">include the extension’s Spray or Akka HTTP routes somewhere in your service</a> so that Prometheus can invoke it.</p> 
    </div> 
   </div> 
  </div> 
  <div> 
   <h2 id="user-content-dependencies"><a href="https://github.com/milenkovicm/kamon-prometheus#dependencies" aria-hidden="true" class="anchor" id="user-content-dependencies" target="_blank">
     <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
      <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
     </svg></a>Dependencies</h2> 
   <div> 
    <div> 
     <p>This module depends on:</p> 
    </div> 
    <div> 
     <ul> 
      <li> <p><a href="http://akka.io" target="_blank">Akka actors</a></p> </li> 
      <li> <p><a href="http://kamon.io" target="_blank">Kamon core</a></p> </li> 
      <li> <p><a href="https://github.com/typesafehub/config" target="_blank">Typesafe config</a></p> </li> 
      <li> <p><a href="https://developers.google.com/protocol-buffers/" target="_blank">Protocol buffers for Java</a></p> </li> 
      <li> <p><a href="http://akka.io" target="_blank">Akka HTTP</a> <em>(optional)</em></p> </li> 
      <li> <p><a href="http://spray.io/" target="_blank">Spray routing</a> <em>(optional)</em></p> </li> 
      <li> <p><a href="https://github.com/scala/scala-parser-combinators" target="_blank">Scala parser combinators</a> <em>(optional)</em></p> </li> 
     </ul> 
    </div> 
    <div> 
     <p>Additional dependencies are required if you are interested in <a href="https://github.com/milenkovicm/kamon-prometheus#building" target="_blank">building the library</a>.</p> 
    </div> 
   </div> 
  </div> 
  <div> 
   <h2 id="user-content-configuration"><a href="https://github.com/milenkovicm/kamon-prometheus#configuration" aria-hidden="true" class="anchor" id="user-content-configuration" target="_blank">
     <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
      <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
     </svg></a>Configuration</h2> 
   <div> 
    <div> 
     <p>You can configure the module much like any other Kamon module, by modifying your <code>application.conf</code>. All of the configuration entries for <em>kamon-prometheus</em> are placed under <code>kamon.prometheus</code>.</p> 
    </div> 
    <div> 
     <h3 id="user-content-refresh-interval"><a href="https://github.com/milenkovicm/kamon-prometheus#refresh-interval" aria-hidden="true" class="anchor" id="user-content-refresh-interval" target="_blank">
       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
        <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
       </svg></a>Refresh interval</h3> 
     <div> 
      <p>The <code>kamon.prometheus.refresh-interval</code> setting determines how often the <em>kamon-prometheus</em> will flush and serve new data. This setting must be at least as large as <code>kamon.metric.tick-interval</code>, and should match Prometheus’ <code>scrape_interval</code>. The default refresh interval is one minute, which matches Prometheus’ default.</p> 
     </div> 
    </div> 
    <div> 
     <h3 id="user-content-subscriptions"><a href="https://github.com/milenkovicm/kamon-prometheus#subscriptions" aria-hidden="true" class="anchor" id="user-content-subscriptions" target="_blank">
       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
        <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
       </svg></a>Subscriptions</h3> 
     <div> 
      <p>Like most other Kamon reporting module, <em>kamon-prometheus</em> allows you to configure the metric categories to which the module will subscribe. By default, the following subscriptions are included:</p> 
     </div> 
     <div> 
      <div>
       The default 
       <em>kamon-prometheus</em> subscriptions
      </div> 
      <div> 
       <div class="highlight highlight-source-scala">
        <pre>kamon.prometheus {
  subscriptions {
    histogram        <span class="pl-k">=</span> [ <span class="pl-s"><span class="pl-pds">"</span>**<span class="pl-pds">"</span></span> ]
    min<span class="pl-k">-</span>max<span class="pl-k">-</span>counter  <span class="pl-k">=</span> [ <span class="pl-s"><span class="pl-pds">"</span>**<span class="pl-pds">"</span></span> ]
    gauge            <span class="pl-k">=</span> [ <span class="pl-s"><span class="pl-pds">"</span>**<span class="pl-pds">"</span></span> ]
    counter          <span class="pl-k">=</span> [ <span class="pl-s"><span class="pl-pds">"</span>**<span class="pl-pds">"</span></span> ]
    trace            <span class="pl-k">=</span> [ <span class="pl-s"><span class="pl-pds">"</span>**<span class="pl-pds">"</span></span> ]
    trace<span class="pl-k">-</span>segment    <span class="pl-k">=</span> [ <span class="pl-s"><span class="pl-pds">"</span>**<span class="pl-pds">"</span></span> ]
    akka<span class="pl-k">-</span>actor       <span class="pl-k">=</span> [ <span class="pl-s"><span class="pl-pds">"</span>**<span class="pl-pds">"</span></span> ]
    akka<span class="pl-k">-</span>dispatcher  <span class="pl-k">=</span> [ <span class="pl-s"><span class="pl-pds">"</span>**<span class="pl-pds">"</span></span> ]
    akka<span class="pl-k">-</span>router      <span class="pl-k">=</span> [ <span class="pl-s"><span class="pl-pds">"</span>**<span class="pl-pds">"</span></span> ]
    system<span class="pl-k">-</span>metric    <span class="pl-k">=</span> [ <span class="pl-s"><span class="pl-pds">"</span>**<span class="pl-pds">"</span></span> ]
    http<span class="pl-k">-</span>server      <span class="pl-k">=</span> [ <span class="pl-s"><span class="pl-pds">"</span>**<span class="pl-pds">"</span></span> ]
    spray<span class="pl-k">-</span>can<span class="pl-k">-</span>server <span class="pl-k">=</span> [ <span class="pl-s"><span class="pl-pds">"</span>**<span class="pl-pds">"</span></span> ]
  }</pre>
       </div> 
      </div> 
     </div> 
    </div> 
    <div> 
     <h3 id="user-content-additional-labels"><a href="https://github.com/milenkovicm/kamon-prometheus#additional-labels" aria-hidden="true" class="anchor" id="user-content-additional-labels" target="_blank">
       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
        <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
       </svg></a>Additional labels</h3> 
     <div> 
      <p><em>kamon-prometheus</em> will automatically add a metric’s tags, name, and category to a published metric as labels. If you which to add additional labels, you can add them under the <code>kamon.prometheus.labels</code> path, which is empty by default.</p> 
     </div> 
     <div> 
      <p>For example, given:</p> 
     </div> 
     <div> 
      <div>
       The default 
       <em>kamon-prometheus</em> subscriptions
      </div> 
      <div> 
       <div class="highlight highlight-source-scala">
        <pre>kamon.prometheus {
  labels {
    application_name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>my cool app<span class="pl-pds">"</span></span>
    application_version <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>42<span class="pl-pds">"</span></span>
  }
}</pre>
       </div> 
      </div> 
     </div> 
     <div> 
      <p>All metrics published by <em>kamon-prometheus</em> will add the labels <code>application_name="my cool app"</code> and <code>application_version="42"</code> to all published metrics. Keep in mind that label names may munged to fit <a href="http://prometheus.io/docs/concepts/data_model/#metric-names-and-labels" target="_blank">Prometheus’ naming requirements</a>.</p> 
     </div> 
    </div> 
   </div> 
  </div> 
  <div> 
   <h2 id="user-content-usage"><a href="https://github.com/milenkovicm/kamon-prometheus#usage" aria-hidden="true" class="anchor" id="user-content-usage" target="_blank">
     <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
      <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
     </svg></a>Usage</h2> 
   <div> 
    <div> 
     <p>There are currently three principal ways to use <em>kamon-prometheus</em>:</p> 
    </div> 
    <div> 
     <ol> 
      <li> <p>Using the Spray endpoint</p> </li> 
      <li> <p>Using the Akka HTTP endpoint</p> </li> 
      <li> <p>Collecting metrics via an Actor</p> </li> 
     </ol> 
    </div> 
    <div> 
     <p>Once you have made the metrics available, you will need to configure Prometheus to scrape your application.</p> 
    </div> 
    <div> 
     <h3 id="user-content-using-the-spray-endpoint"><a href="https://github.com/milenkovicm/kamon-prometheus#using-the-spray-endpoint" aria-hidden="true" class="anchor" id="user-content-using-the-spray-endpoint" target="_blank">
       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
        <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
       </svg></a>Using the Spray endpoint</h3> 
     <div> 
      <p>The module provides a Spray route which you can access via <code>SprayEndpoint(system).route</code> where <code>system</code> is an actor system. You can place this route anywhere in your application, but keep in mind that Prometheus scrapes <code>/metrics</code> by default. The following is the code for a minimal application that will serve metrics from <code>http://localhost:8888/metrics</code>:</p> 
     </div> 
     <div> 
      <div>
       A minimal Spray application
      </div> 
      <div> 
       <div class="highlight highlight-source-scala">
        <pre><span class="pl-k">import</span> <span class="pl-v">akka.actor.</span><span class="pl-v">ActorSystem</span>
<span class="pl-k">import</span> <span class="pl-v">com.monsanto.arch.kamon.prometheus.spray.</span><span class="pl-v">SprayEndpoint</span>
<span class="pl-k">import</span> <span class="pl-v">spray.routing.</span><span class="pl-v">SimpleRoutingApp</span>

<span class="pl-k">object</span> <span class="pl-en">Main</span> <span class="pl-k">extends</span> <span class="pl-e">App</span> <span class="pl-k">with</span> <span class="pl-e">SimpleRoutingApp</span> {
  <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">actorSystem</span> <span class="pl-k">=</span> <span class="pl-en">ActorSystem</span>()

  startServer(<span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-c1">8888</span>) {
    path(<span class="pl-s"><span class="pl-pds">"</span>metrics<span class="pl-pds">"</span></span>) {
      <span class="pl-en">SprayEndpoint</span>(actorSystem).route
    }
  }
}</pre>
       </div> 
      </div> 
     </div> 
     <div> 
      <p>Note that the route will only respond to <code>GET</code> requests and will automatically handle compression and media type negotiation. If there is no content yet (generally before the first set of metrics has been collected), the route will return a <em>No Content</em> response (204).</p> 
     </div> 
    </div> 
    <div> 
     <h3 id="user-content-using-the-akka-http-endpoint"><a href="https://github.com/milenkovicm/kamon-prometheus#using-the-akka-http-endpoint" aria-hidden="true" class="anchor" id="user-content-using-the-akka-http-endpoint" target="_blank">
       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
        <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
       </svg></a>Using the Akka HTTP endpoint</h3> 
     <div> 
      <p>Using the Akka HTTP endpoint is just like using the Spray endpoint above, except that you use a different Akka extension.</p> 
     </div> 
     <div> 
      <div>
       A minimal Akka HTTP application
      </div> 
      <div> 
       <div class="highlight highlight-source-scala">
        <pre><span class="pl-k">import</span> <span class="pl-v">akka.actor.</span><span class="pl-v">ActorSystem</span>
<span class="pl-k">import</span> <span class="pl-v">akka.http.scaladsl.</span><span class="pl-v">Http</span>
<span class="pl-k">import</span> <span class="pl-v">akka.http.scaladsl.server.Directives.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">akka.stream.</span><span class="pl-v">ActorMaterializer</span>
<span class="pl-k">import</span> <span class="pl-v">com.monsanto.arch.kamon.prometheus.akka_http.</span><span class="pl-v">AkkaHttpEndpoint</span>

<span class="pl-k">object</span> <span class="pl-en">Main</span> <span class="pl-k">extends</span> <span class="pl-e">App</span> {
  <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">system</span> <span class="pl-k">=</span> <span class="pl-en">ActorSystem</span>()
  <span class="pl-k">implicit</span> <span class="pl-k">val</span> <span class="pl-en">materializer</span> <span class="pl-k">=</span> <span class="pl-en">ActorMaterializer</span>()

  <span class="pl-k">val</span> <span class="pl-en">route</span> <span class="pl-k">=</span> {
    path(<span class="pl-s"><span class="pl-pds">"</span>metrics<span class="pl-pds">"</span></span>) {
      <span class="pl-en">AkkaHttpEndpoint</span>(system).route
    }
  }

  <span class="pl-k">val</span> <span class="pl-en">bindingFuture</span> <span class="pl-k">=</span> <span class="pl-en">Http</span>().bindAndHandle(route, <span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-c1">8888</span>)
}</pre>
       </div> 
      </div> 
     </div> 
    </div> 
    <div> 
     <h3 id="user-content-getting-snapshots-with-an-actor"><a href="https://github.com/milenkovicm/kamon-prometheus#getting-snapshots-with-an-actor" aria-hidden="true" class="anchor" id="user-content-getting-snapshots-with-an-actor" target="_blank">
       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
        <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
       </svg></a>Getting snapshots with an actor</h3> 
     <div> 
      <p>For this functionality, please consult the documentation for <a href="http://monsantoco.github.io/kamon-prometheus/api/0.2.0/#com.monsanto.arch.kamon.prometheus.PrometheusExtension" target="_blank">PrometheusExtension</a>.</p> 
     </div> 
    </div> 
    <div> 
     <h3 id="user-content-consuming-the-metrics"><a href="https://github.com/milenkovicm/kamon-prometheus#consuming-the-metrics" aria-hidden="true" class="anchor" id="user-content-consuming-the-metrics" target="_blank">
       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
        <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
       </svg></a>Consuming the metrics</h3> 
     <div> 
      <p>Finally, all you need to do is <a href="http://prometheus.io/docs/operating/configuration/#scrape-configurations-scrape_config" target="_blank">configure a scrape configuration in Prometheus</a>. The following snippet is a minimal example that shold work with the minimal server from the previous section.</p> 
     </div> 
     <div> 
      <div>
       A minimal Prometheus configuration snippet
      </div> 
      <div> 
       <div class="highlight highlight-source-yaml">
        <pre><span class="pl-ent">scrape_configs</span>:
  - <span class="pl-ent">job_name</span>: <span class="pl-s">example</span>
    <span class="pl-ent">target_groups</span>:
      - <span class="pl-ent">targets</span>: <span class="pl-s">['localhost:8888']</span></pre>
       </div> 
      </div> 
     </div> 
     <div> 
      <p>Note that the above configuration uses the default <code>scrape_interval</code> (one minute, matching <em>kamon-prometheus’</em> default.) and <code>metrics_path</code> (<code>/metrics</code>).</p> 
     </div> 
    </div> 
   </div> 
  </div> 
  <div> 
   <h2 id="user-content-development"><a href="https://github.com/milenkovicm/kamon-prometheus#development" aria-hidden="true" class="anchor" id="user-content-development" target="_blank">
     <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
      <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
     </svg></a>Development</h2> 
   <div> 
    <div> 
     <h3 id="user-content-building"><a href="https://github.com/milenkovicm/kamon-prometheus#building-the-library" aria-hidden="true" class="anchor" id="user-content-building-the-library" target="_blank">
       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
        <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
       </svg></a>Building the library</h3> 
     <div> 
      <p>You can use <code>sbt</code> to build the library, but you will need to have Google’s protocol buffers compiler <code>protoc</code> on your path. You can <a href="https://developers.google.com/protocol-buffers/docs/downloads" target="_blank">download</a> Protocol buffers directly from Google. However, there may be simpler options. For example, on OS X, you can use <a href="http://brew.sh" target="_blank">homebrew</a> and just <code>brew install protobuf</code>.</p> 
     </div> 
     <div> 
      <p>Additionally, to build the demo, you will need to have Docker set up.</p> 
     </div> 
    </div> 
    <div> 
     <h3 id="user-content-contributing-to-the-project"><a href="https://github.com/milenkovicm/kamon-prometheus#contributing-to-the-project" aria-hidden="true" class="anchor" id="user-content-contributing-to-the-project" target="_blank">
       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
        <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
       </svg></a>Contributing to the project</h3> 
     <div> 
      <p>Outside contributions to this project are welcome! Please review <a href="https://github.com/milenkovicm/kamon-prometheus/blob/master/CONTRIBUTING.md" target="_blank">CONTRIBUTING.md</a> for more information.</p> 
     </div> 
    </div> 
   </div> 
  </div> 
  <div> 
   <h2 id="user-content-future-plans"><a href="https://github.com/milenkovicm/kamon-prometheus#future-plans" aria-hidden="true" class="anchor" id="user-content-future-plans" target="_blank">
     <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
      <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
     </svg></a>Future plans</h2> 
   <div> 
    <div> 
     <p>Check out the <a href="https://github.com/MonsantoCo/kamon-prometheus/issues" target="_blank">issues</a> page. Please star issues that are important to you.</p> 
    </div> 
   </div> 
  </div>
 </article>
</div>