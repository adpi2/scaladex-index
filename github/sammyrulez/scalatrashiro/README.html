<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-scalatrashiro" class="anchor" href="https://github.com/sammyrulez/scalatrashiro#scalatrashiro" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>ScalatraShiro</h1> 
  <p><a href="https://travis-ci.org/sammyrulez/ScalatraShiro" target="_blank"><img src="https://camo.githubusercontent.com/6edb5bcdfd63ebd7a4077ead3b28b4478420a931/68747470733a2f2f7472617669732d63692e6f72672f73616d6d7972756c657a2f5363616c61747261536869726f2e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/sammyrulez/ScalatraShiro.svg?branch=master" style="max-width:100%;"></a> <a href="https://coveralls.io/r/sammyrulez/ScalatraShiro" target="_blank"><img src="https://camo.githubusercontent.com/26a82f03f130f11d861bdeb12dec47b434adeb05/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f73616d6d7972756c657a2f5363616c61747261536869726f2f62616467652e737667" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/sammyrulez/ScalatraShiro/badge.svg" style="max-width:100%;"></a> <a href="https://www.versioneye.com/user/projects/55f7d40d3ed8940017000594" target="_blank"><img src="https://camo.githubusercontent.com/456b9628d01be8c8033354539b7c8185764faf24/68747470733a2f2f7777772e76657273696f6e6579652e636f6d2f757365722f70726f6a656374732f3535663764343064336564383934303031373030303539342f62616467652e7376673f7374796c653d666c6174" alt="Dependency Status" data-canonical-src="https://www.versioneye.com/user/projects/55f7d40d3ed8940017000594/badge.svg?style=flat" style="max-width:100%;"></a></p> 
  <p>ScalatraShiro is an integration to enable the use of Apache Shiro in Scalatra Application. It is not a replacement for scalatra auth (Scentry) but extends it with a authorization layer ( roles and permissions). Also Shiro provides several implementations for persistence and integrations with SSO systems ( CAS etc.)</p> 
  <h2><a id="user-content-installation" class="anchor" href="https://github.com/sammyrulez/scalatrashiro#installation" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Installation</h2> 
  <h3><a id="user-content-maven" class="anchor" href="https://github.com/sammyrulez/scalatrashiro#maven" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Maven</h3> 
  <div class="highlight highlight-text-xml">
   <pre>&lt;<span class="pl-ent">dependency</span>&gt;
            &lt;<span class="pl-ent">groupId</span>&gt;com.github.sammyrulez&lt;/<span class="pl-ent">groupId</span>&gt;
            &lt;<span class="pl-ent">artifactId</span>&gt;scalatrashiro_2.11&lt;/<span class="pl-ent">artifactId</span>&gt;
            &lt;<span class="pl-ent">version</span>&gt;1.0.2&lt;/<span class="pl-ent">version</span>&gt;
&lt;/<span class="pl-ent">dependency</span>&gt;</pre>
  </div> 
  <h3><a id="user-content-sbt" class="anchor" href="https://github.com/sammyrulez/scalatrashiro#sbt" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>SBT</h3> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>com.github.sammyrulez<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>scalatrashiro<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>1.0.2<span class="pl-pds">"</span></span></pre>
  </div> 
  <h2><a id="user-content-usage" class="anchor" href="https://github.com/sammyrulez/scalatrashiro#usage" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h2> 
  <p>In order to make use of Shiro in our web application we must first define a Shiro servlet filter. Any requests that we want to secure must go through this Shiro filter.</p> 
  <div class="highlight highlight-text-xml">
   <pre>&lt;<span class="pl-ent">listener</span>&gt;
        &lt;<span class="pl-ent">listenerclass</span>&gt;
          org.apache.shiro.web.env.EnvironmentLoaderListener
        &lt;/<span class="pl-ent">listener-class</span>&gt;
    &lt;/<span class="pl-ent">listener</span>&gt;

    &lt;<span class="pl-ent">filter</span>&gt;
        &lt;<span class="pl-ent">filter-name</span>&gt;securityFilter&lt;/<span class="pl-ent">filter-name</span>&gt;
        &lt;<span class="pl-ent">filterclass</span>&gt;
          org.apache.shiro.web.servlet.ShiroFilter
        &lt;/<span class="pl-ent">filter-class</span>&gt;
    &lt;/<span class="pl-ent">filter</span>&gt;
    &lt;<span class="pl-ent">filter-mapping</span>&gt;
            &lt;<span class="pl-ent">filter-name</span>&gt;securityFilter&lt;/<span class="pl-ent">filter-name</span>&gt;
            &lt;<span class="pl-ent">url-pattern</span>&gt;/*&lt;/<span class="pl-ent">url-pattern</span>&gt;
            &lt;<span class="pl-ent">dispatcher</span>&gt;REQUEST&lt;/<span class="pl-ent">dispatcher</span>&gt;
            &lt;<span class="pl-ent">dispatcher</span>&gt;FORWARD&lt;/<span class="pl-ent">dispatcher</span>&gt;
            &lt;<span class="pl-ent">dispatcher</span>&gt;INCLUDE&lt;/<span class="pl-ent">dispatcher</span>&gt;
            &lt;<span class="pl-ent">dispatcher</span>&gt;ERROR&lt;/<span class="pl-ent">dispatcher</span>&gt;
        &lt;/<span class="pl-ent">filter-mapping</span>&gt;</pre>
  </div> 
  <p>Configure Shiro through an INI file. For complete details refer to <a href="https://shiro.apache.org/configuration.html" target="_blank">Shiro Documentation</a></p> 
  <p>This is an example of minimal configuration with two users ( 'testuser' and 'admin' ) and two roles ('user' and 'admin')</p> 
  <pre><code>[main]
securityManager.rememberMeManager.cookie.name = rememberMe
# Create a Session Manager
sessionManager = org.apache.shiro.web.session.mgt.DefaultWebSessionManager
securityManager.sessionManager = $sessionManager

# Session Timeout = 1 hour (3600000 miliseconds)
securityManager.sessionManager.globalSessionTimeout = 3600000

sessionDAO = org.apache.shiro.session.mgt.eis.EnterpriseCacheSessionDAO
securityManager.sessionManager.sessionDAO = $sessionDAO

# Login URL:
user.loginUrl = /login

[users]
testUser = password, user
admin = admin, admin

[roles]
user = BasicAccess
admin = *

</code></pre> 
  <p>Every controller you want to perform security checks must extends the Authentication Trait</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">class</span> <span class="pl-en">MainServlet</span> <span class="pl-k">extends</span> <span class="pl-e">ScalatraServlet</span> <span class="pl-k">with</span> <span class="pl-e">Authentication</span> <span class="pl-k">with</span> <span class="pl-e">...</span>

<span class="pl-k">override</span> <span class="pl-k">protected</span> <span class="pl-k">val</span> <span class="pl-en">loginUrl</span><span class="pl-k">:</span> <span class="pl-k">String</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>/login<span class="pl-pds">"</span></span>
</pre>
  </div> 
  <p>You might choose to run the authorization checks in a before() filter in your controller, rather than hitting it in each action, to secure every method. As a best practice you should group routes with same access policies in one controller.</p> 
  <h3><a id="user-content-login-and-logout" class="anchor" href="https://github.com/sammyrulez/scalatrashiro#login-and-logout" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Login and Logout</h3> 
  <p>If you just have a user/password based authentication a <a href="https://github.com/sammyrulez/ScalatraShiro/blob/master/src/main/scala/scalatrashiro/UserAuthServlet.scala" target="_blank">UserAuthServlet</a> is provided by ScalatraShiro. Just register it in your bootstrap class and point to the login/logout routes.</p> 
  <p>If you have complex / custom authentication you can use <a href="https://shiro.apache.org/authentication.html#Authentication-Step1%3ACollecttheSubject%27sprincipalsandcredentials" target="_blank">Apache Shiro authentication api</a> directly</p> 
  <div class="highlight highlight-source-scala">
   <pre>    <span class="pl-k">val</span> <span class="pl-en">currentUser</span> <span class="pl-k">=</span> <span class="pl-en">SecurityUtils</span>.getSubject()

    <span class="pl-k">try</span> {
      <span class="pl-k">val</span> <span class="pl-en">token</span> <span class="pl-k">=</span> <span class="pl-c">// generate a  org.apache.shiro.authc.AuthenticationToken</span>

        currentUser.login(token)
      } <span class="pl-k">catch</span> {
            <span class="pl-k">case</span> <span class="pl-v">uae</span>: <span class="pl-en">UnknownAccountException</span> <span class="pl-k">=&gt;</span> {
             ...
            }
            <span class="pl-k">case</span> <span class="pl-v">ice</span>: <span class="pl-en">IncorrectCredentialsException</span> <span class="pl-k">=&gt;</span> {
              ...
            }
            <span class="pl-k">case</span> <span class="pl-v">lae</span>: <span class="pl-en">LockedAccountException</span> <span class="pl-k">=&gt;</span> {
             ...
            }
            <span class="pl-k">case</span> <span class="pl-v">ae</span>: <span class="pl-en">AuthenticationException</span> <span class="pl-k">=&gt;</span> {
              ...
            }
          }
</pre>
  </div> 
  <h3><a id="user-content-access-control-methods" class="anchor" href="https://github.com/sammyrulez/scalatrashiro#access-control-methods" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Access control methods</h3> 
  <p>You can check both <a href="https://shiro.apache.org/authorization.html#Authorization-Permissions" target="_blank">roles and permissions</a></p> 
  <ul> 
   <li><p>requiresAuthentication: current user must be authenticated</p></li> 
   <li><p>requiresRole: current user must have the role specified as parameter ( or at least one of the role if a List[String] is passed )</p></li> 
   <li><p>requiresAllRoles: current user must have all the roles in a List[String] specified as parameter</p></li> 
   <li><p>requiresPermission: current user must have the permission specified as parameter</p></li> 
   <li><p>requiresAllPermissions: current user must have all the permissions in a List[String] specified as parameter</p></li> 
  </ul> 
  <h2><a id="user-content-credits" class="anchor" href="https://github.com/sammyrulez/scalatrashiro#credits" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Credits</h2> 
  <p>Original work on Scalatra / Apache Shiro integration by Ethan Way (blog post <a href="http://ethanway.com/securing-scalatra-with-apache-shiro/" target="_blank">http://ethanway.com/securing-scalatra-with-apache-shiro/</a> source: <a href="https://github.com/waye929/ScalatraShiro" target="_blank">https://github.com/waye929/ScalatraShiro</a>)</p> 
 </article>
</div>