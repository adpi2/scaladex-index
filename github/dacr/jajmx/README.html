<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-jajmx---high-level-scala-jmx-api----" class="anchor" href="https://github.com/dacr/jajmx#jajmx---high-level-scala-jmx-api----" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>JAJMX - High level scala JMX API <a href="https://travis-ci.org/dacr/jajmx" target="_blank"><img src="https://camo.githubusercontent.com/3ca80a2d40f887a450991298b577c3b8e8accf2a/68747470733a2f2f696d672e736869656c64732e696f2f7472617669732f646163722f6a616a6d782e737667" alt="Build Status" data-canonical-src="https://img.shields.io/travis/dacr/jajmx.svg" style="max-width:100%;"></a> <a href="https://github.com/dacr/jajmx/blob/master/LICENSE" target="_blank"><img src="https://camo.githubusercontent.com/031f08df5f896238138274f974fecdef348794c0/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f646163722f6a616a6d782e737667" alt="License" data-canonical-src="https://img.shields.io/github/license/dacr/jajmx.svg" style="max-width:100%;"></a> <a href="https://www.codacy.com/app/dacr/jajmx/dashboard" target="_blank"><img src="https://camo.githubusercontent.com/e7afedaef95e725a1f988786e8327fff68caf0c3/68747470733a2f2f696d672e736869656c64732e696f2f636f646163792f65626634376231373839636434616234616265613861326466303966356431312e737667" alt="Codacy" data-canonical-src="https://img.shields.io/codacy/ebf47b1789cd4ab4abea8a2df09f5d11.svg" style="max-width:100%;"></a> <a href="http://codecov.io/github/dacr/jajmx?branch=master" target="_blank"><img src="https://camo.githubusercontent.com/8011dd5ee24d3a10e1569d0696f1430e07deb330/68747470733a2f2f696d672e736869656c64732e696f2f636f6465636f762f632f6769746875622f646163722f6a616a6d782f6d61737465722e737667" alt="codecov" data-canonical-src="https://img.shields.io/codecov/c/github/dacr/jajmx/master.svg" style="max-width:100%;"></a></h1> 
  <p>The goal is to simplify jmx operations on remote (or local) JVM. Work on this library is still in progress... but implemented features work well. One of the main usages of this jmx abstraction layer is to simplify extraction of jmx metrics such as getting jdbc connections or busy threads usage trends. This library only requires one IP and one PORT in order to connect to a remote JMX plateform, no service url is required !</p> 
  <p><a href="http://www.janalyse.fr/scaladocs/janalyse-jmx" target="_blank"><em>Scala docs</em></a></p> 
  <p>In your build.sbt, add this (available in maven central) :</p> 
  <pre><code>libraryDependencies += "fr.janalyse"   %% "janalyse-ssh" % version
</code></pre> 
  <p><em>(starting from 0.10, java 8 bytecodes are used, and scala 2.10, 2.11 and 2.12 are supported)</em></p> 
  <p>Latest <code>version</code>: <a href="https://search.maven.org/#search%7Cga%7C1%7Cfr.janalyse.janalyse-jmx" target="_blank"><img src="https://camo.githubusercontent.com/e5c20ce63a13b9e6c612c4f2e867470a709ccdd9/68747470733a2f2f696d672e736869656c64732e696f2f6d6176656e2d63656e7472616c2f762f66722e6a616e616c7973652f6a616e616c7973652d6a6d785f322e31322e737667" alt="Maven" data-canonical-src="https://img.shields.io/maven-central/v/fr.janalyse/janalyse-jmx_2.12.svg" style="max-width:100%;"></a> <a href="https://index.scala-lang.org/dacr/jajmx" target="_blank"><img src="https://camo.githubusercontent.com/e0c03cbd18560f1c3115275bf4dfec0a8f885c5b/68747470733a2f2f696e6465782e7363616c612d6c616e672e6f72672f646163722f6a616a6d782f6a616e616c7973652d6a6d782f6c61746573742e737667" alt="Scaladex" data-canonical-src="https://index.scala-lang.org/dacr/jajmx/janalyse-jmx/latest.svg" style="max-width:100%;"></a></p> 
  <p><em>Old release</em> :</p> 
  <ul> 
   <li>0.7.2 (for scala 2.10 and 2.11) 
    <ul> 
     <li>requires this resolver :<br> <code>resolvers += "JAnalyse Repository" at "http://www.janalyse.fr/repository/"</code></li> 
    </ul> </li> 
  </ul> 
  <h2><a id="user-content-console-mode-usage-example-" class="anchor" href="https://github.com/dacr/jajmx#console-mode-usage-example-" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Console mode usage example :</h2> 
  <pre><code> $ java -jar jajmx.jar 
Welcome to Scala version 2.10.1 (Java HotSpot(TM) 64-Bit Server VM, Java 1.6.0_45).
Type in expressions to have them evaluated.
Type :help for more information.

scala&gt; import jajmx._
import jajmx._

scala&gt; val jmx = JMX()

scala&gt; import jmx._
import jmx._

scala&gt; verbosegc()

scala&gt; gcforce()
[GC 62584K-&gt;30221K(310080K), 0.0015270 secs]
[Full GC 30221K-&gt;30014K(310080K), 0.1879440 secs]

scala&gt; osVersion
res3: Option[String] = Some(3.7.10-gentoo)

scala&gt; osName
res4: Option[String] = Some(Linux)

scala&gt; mbeans.take(10).map(_.name).foreach{println _}
java.lang:type=Memory
java.lang:type=MemoryPool,name=PS Eden Space
java.lang:type=MemoryPool,name=PS Survivor Space
java.lang:type=MemoryPool,name=Code Cache
java.lang:type=GarbageCollector,name=PS MarkSweep
java.lang:type=Runtime
java.lang:type=ClassLoading
java.lang:type=Threading
java.util.logging:type=Logging
java.lang:type=Compilation

scala&gt; val mythreading=get("java.lang:type=Runtime")
mythreading: Option[fr.janalyse.jmx.RichMBean] = Some(RichMBean(java.lang:type=Runtime,&lt;function0&gt;,&lt;function1&gt;,&lt;function2&gt;,&lt;function2&gt;))

scala&gt; mythreading.map{_.attributes.foreach{attr =&gt; println(attr.name)}}
SynchronizerUsageSupported
ThreadCount
TotalStartedThreadCount
ThreadAllocatedMemorySupported
ThreadContentionMonitoringSupported
ThreadAllocatedMemoryEnabled
AllThreadIds
DaemonThreadCount
ThreadContentionMonitoringEnabled
CurrentThreadUserTime
PeakThreadCount
ObjectMonitorUsageSupported
ThreadCpuTimeSupported
CurrentThreadCpuTime
ThreadCpuTimeEnabled
CurrentThreadCpuTimeSupported

scala&gt; close

scala&gt; :q

</code></pre> 
  <h2><a id="user-content-gcforce-script" class="anchor" href="https://github.com/dacr/jajmx#gcforce-script" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>gcforce script</h2> 
  <p>Only provide to the script, host and port of a remote JVM with JMX enabled, and this script will force the JVM to Garbage Collect major operation.</p> 
  <div class="highlight highlight-source-scala">
   <pre>#<span class="pl-k">!</span><span class="pl-k">/</span>bin<span class="pl-k">/</span>sh
exec java <span class="pl-k">-</span>verbosegc <span class="pl-k">-</span>jar jajmx.jar <span class="pl-s"><span class="pl-pds">"</span>$0<span class="pl-pds">"</span></span> <span class="pl-s"><span class="pl-pds">"</span>$@<span class="pl-pds">"</span></span>
<span class="pl-k">!</span>#

<span class="pl-k">if</span> (args.size <span class="pl-k">&lt;</span> <span class="pl-c1">2</span>) {
  println(<span class="pl-s"><span class="pl-pds">"</span>Usage   : jmxgrep host port<span class="pl-pds">"</span></span>)
  println(<span class="pl-s"><span class="pl-pds">"</span>  args are not compliant so now let's connecting to myself, and force a gc...<span class="pl-pds">"</span></span>) 
}

<span class="pl-k">import</span> <span class="pl-v">fr.janalyse.jmx.</span><span class="pl-v">_</span>

<span class="pl-k">val</span> <span class="pl-en">options</span> <span class="pl-k">=</span> args.toList <span class="pl-k">match</span> {
  <span class="pl-k">case</span> host<span class="pl-k">::</span>port<span class="pl-k">::</span>_ <span class="pl-k">=&gt;</span> <span class="pl-en">Some</span>(<span class="pl-en">JMXOptions</span>(host,port.toInt))
  <span class="pl-k">case</span> _ <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
}
<span class="pl-en">JMX</span>.once(options) { _.gcforce }</pre>
  </div> 
  <p>A short gc force script (a self test) :</p> 
  <div class="highlight highlight-source-scala">
   <pre>#<span class="pl-k">!</span><span class="pl-k">/</span>bin<span class="pl-k">/</span>sh
exec java <span class="pl-k">-</span>jar jajmx.jar <span class="pl-s"><span class="pl-pds">"</span>$0<span class="pl-pds">"</span></span> <span class="pl-s"><span class="pl-pds">"</span>$@<span class="pl-pds">"</span></span>
<span class="pl-k">!</span>#

jajmx.<span class="pl-en">JMX</span>.once() { jmx <span class="pl-k">=&gt;</span>
  jmx.verbosegc() 
  jmx.gcforce()
}
</pre>
  </div> 
  <h2><a id="user-content-lsnum-script" class="anchor" href="https://github.com/dacr/jajmx#lsnum-script" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>lsnum script</h2> 
  <p>This scala script search for jmx numerical values. This jmxgrep script can be tested against itself : "lsnum"</p> 
  <div class="highlight highlight-source-scala">
   <pre>#<span class="pl-k">!</span><span class="pl-k">/</span>bin<span class="pl-k">/</span>sh
exec java <span class="pl-k">-</span>jar jajmx.jar <span class="pl-s"><span class="pl-pds">"</span>$0<span class="pl-pds">"</span></span> <span class="pl-s"><span class="pl-pds">"</span>$@<span class="pl-pds">"</span></span>
<span class="pl-k">!</span>#

<span class="pl-k">import</span> <span class="pl-v">fr.janalyse.jmx.</span><span class="pl-v">_</span>

<span class="pl-k">val</span> <span class="pl-en">options</span> <span class="pl-k">=</span> args.toList <span class="pl-k">match</span> {
  <span class="pl-k">case</span> host<span class="pl-k">::</span>port<span class="pl-k">::</span>_ <span class="pl-k">=&gt;</span> <span class="pl-en">Some</span>(<span class="pl-en">JMXOptions</span>(host,port.toInt))
  <span class="pl-k">case</span> _ <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
}

<span class="pl-en">JMX</span>.once(options) { jmx <span class="pl-k">=&gt;</span>
  <span class="pl-k">for</span> {
    mbean <span class="pl-k">&lt;</span><span class="pl-k">-</span> jmx.mbeans
    attr  <span class="pl-k">&lt;</span><span class="pl-k">-</span> mbean.attributes.collect{<span class="pl-k">case</span> n<span class="pl-k">:</span><span class="pl-en">RichNumberAttribute</span> <span class="pl-k">=&gt;</span> n}
    value <span class="pl-k">&lt;</span><span class="pl-k">-</span> mbean.getLong(attr)
    } {
    println(s<span class="pl-s"><span class="pl-pds">"</span>${mbean.name} - ${attr.name} = ${value}<span class="pl-pds">"</span></span>)
  }
}
</pre>
  </div> 
  <h2><a id="user-content-jmxgrep-script" class="anchor" href="https://github.com/dacr/jajmx#jmxgrep-script" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>jmxgrep script</h2> 
  <p>This scala script search matching mbean name, attribute name, or value satisfying the given set of regular exception. This jmxgrep script can be tested against itself : "jmxgrep - vendor version"</p> 
  <div class="highlight highlight-source-scala">
   <pre>#<span class="pl-k">!</span><span class="pl-k">/</span>bin<span class="pl-k">/</span>sh
exec java <span class="pl-k">-</span>jar jajmx.jar <span class="pl-s"><span class="pl-pds">"</span>$0<span class="pl-pds">"</span></span> <span class="pl-s"><span class="pl-pds">"</span>$@<span class="pl-pds">"</span></span>
<span class="pl-k">!</span>#

<span class="pl-k">import</span> <span class="pl-v">jajmx.</span><span class="pl-v">_</span>

<span class="pl-k">if</span> (args.size <span class="pl-k">==</span> <span class="pl-c1">0</span>) {
  println(<span class="pl-s"><span class="pl-pds">"</span>Usage   : jmxgrep host port - searchMask1 ... searchMaskN<span class="pl-pds">"</span></span>)
  println(<span class="pl-s"><span class="pl-pds">"</span>  if no args given so now let's connecting to myself, and list my mbeans...<span class="pl-pds">"</span></span>) 
}

<span class="pl-k">val</span> (options, masks) <span class="pl-k">=</span> args.toList <span class="pl-k">match</span> {
  <span class="pl-k">case</span> host<span class="pl-k">::</span>port<span class="pl-k">::</span><span class="pl-s"><span class="pl-pds">"</span>-<span class="pl-pds">"</span></span><span class="pl-k">::</span>masks <span class="pl-k">=&gt;</span> 
            (<span class="pl-en">Some</span>(<span class="pl-en">JMXOptions</span>(host,port.toInt)), masks.map{s<span class="pl-k">=&gt;</span>(<span class="pl-s"><span class="pl-pds">"</span>(?i)<span class="pl-pds">"</span></span><span class="pl-k">+</span>s).r})
  <span class="pl-k">case</span> <span class="pl-s"><span class="pl-pds">"</span>-<span class="pl-pds">"</span></span><span class="pl-k">::</span>masks <span class="pl-k">=&gt;</span> (<span class="pl-c1">None</span>, masks.map{s<span class="pl-k">=&gt;</span>(<span class="pl-s"><span class="pl-pds">"</span>(?i)<span class="pl-pds">"</span></span><span class="pl-k">+</span>s).r})
  <span class="pl-k">case</span> _ <span class="pl-k">=&gt;</span> (<span class="pl-c1">None</span>,<span class="pl-en">List</span>.empty[util.matching.<span class="pl-en">Regex</span>])
}

<span class="pl-k">def</span> <span class="pl-en">truncate</span>(str<span class="pl-k">:</span><span class="pl-k">String</span>, n<span class="pl-k">:</span><span class="pl-k">Int</span><span class="pl-k">=</span><span class="pl-c1">60</span>) <span class="pl-k">=</span> {
  <span class="pl-k">val</span> <span class="pl-en">nonl</span><span class="pl-k">=</span>str.replaceAll(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\n</span><span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span> <span class="pl-pds">"</span></span>).replaceAll(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\r</span><span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>)
  <span class="pl-k">if</span> (nonl.size<span class="pl-k">&gt;</span>n) nonl.take(n)<span class="pl-k">+</span><span class="pl-s"><span class="pl-pds">"</span>...<span class="pl-pds">"</span></span> <span class="pl-k">else</span> nonl
}

<span class="pl-en">JMX</span>.once(options) { jmx <span class="pl-k">=&gt;</span>
  <span class="pl-k">for</span> {
     mbean <span class="pl-k">&lt;</span><span class="pl-k">-</span> jmx.mbeans
     attr  <span class="pl-k">&lt;</span><span class="pl-k">-</span> mbean.attributes
     value <span class="pl-k">&lt;</span><span class="pl-k">-</span> mbean.getString(attr) } {
     
    <span class="pl-k">val</span> <span class="pl-en">found</span> <span class="pl-k">=</span> <span class="pl-en">List</span>(mbean.name, attr.name, value).exists{item <span class="pl-k">=&gt;</span>
       masks.exists{_.findFirstIn(item).isDefined }
    }
    <span class="pl-k">if</span> (masks.isEmpty <span class="pl-k">||</span> found) 
      println(s<span class="pl-s"><span class="pl-pds">"</span>${mbean.name} - ${attr.name} = ${truncate(value)}<span class="pl-pds">"</span></span>)
  }
}</pre>
  </div> 
  <h2><a id="user-content-lsthreads-script" class="anchor" href="https://github.com/dacr/jajmx#lsthreads-script" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>lsthreads script</h2> 
  <p>Connect to a remote JVM using just the host adress and the used JMX port, and then list all active threads and their current states.</p> 
  <div class="highlight highlight-source-scala">
   <pre>#<span class="pl-k">!</span><span class="pl-k">/</span>bin<span class="pl-k">/</span>sh
exec java <span class="pl-k">-</span>jar jajmx.jar <span class="pl-s"><span class="pl-pds">"</span>$0<span class="pl-pds">"</span></span> <span class="pl-s"><span class="pl-pds">"</span>$@<span class="pl-pds">"</span></span>
<span class="pl-k">!</span>#
<span class="pl-k">import</span> <span class="pl-v">jajmx.</span><span class="pl-v">_</span>

<span class="pl-k">val</span> <span class="pl-en">options</span> <span class="pl-k">=</span> args.toList <span class="pl-k">match</span> {
  <span class="pl-k">case</span> host<span class="pl-k">::</span>port<span class="pl-k">::</span>_ <span class="pl-k">=&gt;</span> <span class="pl-en">Some</span>(<span class="pl-en">JMXOptions</span>(host,port.toInt))
  <span class="pl-k">case</span> _ <span class="pl-k">=&gt;</span> <span class="pl-c1">None</span>
}

<span class="pl-en">JMX</span>.once(options) { jmx <span class="pl-k">=&gt;</span>
  <span class="pl-k">for</span> (dump <span class="pl-k">&lt;</span><span class="pl-k">-</span> jmx.threadsDump(<span class="pl-c1">0</span>)) {
    <span class="pl-k">val</span> <span class="pl-en">threads</span> <span class="pl-k">=</span> dump.threads
    <span class="pl-k">val</span> <span class="pl-en">countByState</span> <span class="pl-k">=</span> 
        threads
          .groupBy(_.status)
          .map{ <span class="pl-k">case</span> (state,sublist) <span class="pl-k">=&gt;</span> state <span class="pl-k">-</span><span class="pl-k">&gt;</span> sublist.size}
          .map{ <span class="pl-k">case</span> (state,count) <span class="pl-k">=&gt;</span> state<span class="pl-k">+</span><span class="pl-s"><span class="pl-pds">"</span>:<span class="pl-pds">"</span></span><span class="pl-k">+</span>count}
          .mkString(<span class="pl-s"><span class="pl-pds">"</span> <span class="pl-pds">"</span></span>)
    
    println(<span class="pl-s"><span class="pl-pds">"</span>Total %d threads,  %s<span class="pl-pds">"</span></span>.format(threads.size, countByState))
    <span class="pl-k">for</span> ( ti <span class="pl-k">&lt;</span><span class="pl-k">-</span> threads sortBy {_.id } ) {
      println(<span class="pl-s"><span class="pl-pds">"</span>%d - %s - %s<span class="pl-pds">"</span></span>.format(ti.id, ti.status, ti.name) )
    }
  }
}</pre>
  </div> 
  <h1><a id="user-content-jmx-configuration-notes" class="anchor" href="https://github.com/dacr/jajmx#jmx-configuration-notes" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>JMX Configuration Notes</h1> 
  <h2><a id="user-content-default-jsr160-configuration" class="anchor" href="https://github.com/dacr/jajmx#default-jsr160-configuration" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Default JSR160 Configuration</h2> 
  <div class="highlight highlight-source-shell">
   <pre>JAVA_OPTS=<span class="pl-smi">$JAVA_OPTS</span><span class="pl-s"><span class="pl-pds">"</span> -Dcom.sun.management.jmxremote<span class="pl-pds">"</span></span>
JAVA_OPTS=<span class="pl-smi">$JAVA_OPTS</span><span class="pl-s"><span class="pl-pds">"</span> -Dcom.sun.management.jmxremote.port=2500<span class="pl-pds">"</span></span>
JAVA_OPTS=<span class="pl-smi">$JAVA_OPTS</span><span class="pl-s"><span class="pl-pds">"</span> -Dcom.sun.management.jmxremote.authenticate=false<span class="pl-pds">"</span></span>
JAVA_OPTS=<span class="pl-smi">$JAVA_OPTS</span><span class="pl-s"><span class="pl-pds">"</span> -Dcom.sun.management.jmxremote.ssl=false<span class="pl-pds">"</span></span>
JAVA_OPTS=<span class="pl-smi">$JAVA_OPTS</span><span class="pl-s"><span class="pl-pds">"</span> -Djava.rmi.server.hostname=192.168.0.184<span class="pl-pds">"</span></span></pre>
  </div> 
  <p>With authentication :</p> 
  <div class="highlight highlight-source-shell">
   <pre>JAVA_OPTS=<span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$JAVA_OPTS</span> -Dcom.sun.management.jmxremote.authenticate=true<span class="pl-pds">"</span></span>

<span class="pl-smi">$JAVA_HOME</span>/jre/lib/management/jmxremote.password
<span class="pl-smi">$JAVA_HOME</span>/jre/lib/management/jmxremote.access</pre>
  </div> 
  <h2><a id="user-content-for-jboss-51" class="anchor" href="https://github.com/dacr/jajmx#for-jboss-51" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>FOR JBOSS 5.1</h2> 
  <p>STANDARD JMX can be used to get JBOSS metrics, but unfortunately JVM metrics can't be gotten (Interesting information : <a href="http://labs.consol.de/blog/jmx4perl/jboss-remote-jmx/" target="_blank">http://labs.consol.de/blog/jmx4perl/jboss-remote-jmx/</a>)</p> 
  <ul> 
   <li>ENABLE standard JMX (-Dcom.sun.management.jmxremote*) AND USE A DIFFENT PORT than the one use below : 2090</li> 
   <li>JVM 6 required</li> 
   <li>The following module must be deployed : jmx-remoting.sar/ (if not available, get one in official JBOSS packaging jboss-5.1.0.GA)</li> 
   <li>modify the file ./server/default/deploy/jmx-remoting.sar/META-INF/jboss-service.xml to set the port</li> 
  </ul> 
  <div class="highlight highlight-text-xml">
   <pre>    &lt;?<span class="pl-ent">xml</span><span class="pl-e"> version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-e"> encoding</span>=<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>?&gt;
    &lt;<span class="pl-ent">server</span>&gt;
       &lt;<span class="pl-ent">mbean</span> <span class="pl-e">code</span>=<span class="pl-s"><span class="pl-pds">"</span>org.jboss.mx.remoting.service.JMXConnectorServerService<span class="pl-pds">"</span></span>
          <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>jboss.remoting:service=JMXConnectorServer,protocol=rmi<span class="pl-pds">"</span></span>
          <span class="pl-e">display-name</span>=<span class="pl-s"><span class="pl-pds">"</span>JMX Connector Server (RMI)<span class="pl-pds">"</span></span>&gt;
               &lt;<span class="pl-ent">attribute</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>BindAddress<span class="pl-pds">"</span></span>&gt;10.104.65.101&lt;/<span class="pl-ent">attribute</span>&gt;
                &lt;<span class="pl-ent">attribute</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>RegistryPort<span class="pl-pds">"</span></span>&gt;1090&lt;/<span class="pl-ent">attribute</span>&gt;
       &lt;/<span class="pl-ent">mbean</span>&gt;
    &lt;/<span class="pl-ent">server</span>&gt;</pre>
  </div> 
  <ul> 
   <li>Use the network interface using the option : -Djava.rmi.server.hostname=...</li> 
  </ul> 
  <p>=&gt; We will monitor JBOSS using JMX with 2 ports ! 1090 &amp; 2090, 1090 for jvm mbeans, and 2090 for jboss mbeans</p> 
  <h2><a id="user-content-for-jboss--7x----6" class="anchor" href="https://github.com/dacr/jajmx#for-jboss--7x----6" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>For JBOSS <code>&lt;</code> 7.x &amp; <code>&gt;=</code> 6</h2> 
  <div class="highlight highlight-source-shell">
   <pre>JAVA_OPTS=<span class="pl-smi">$JAVA_OPTS</span><span class="pl-s"><span class="pl-pds">"</span> -Dcom.sun.management.jmxremote<span class="pl-pds">"</span></span>
JAVA_OPTS=<span class="pl-smi">$JAVA_OPTS</span><span class="pl-s"><span class="pl-pds">"</span> -Djboss.platform.mbeanserver<span class="pl-pds">"</span></span>
JAVA_OPTS=<span class="pl-smi">$JAVA_OPTS</span><span class="pl-s"><span class="pl-pds">"</span> -Djavax.management.builder.initial=org.jboss.system.server.jmx.MBeanServerBuilderImpl<span class="pl-pds">"</span></span>
JAVA_OPTS=<span class="pl-smi">$JAVA_OPTS</span><span class="pl-s"><span class="pl-pds">"</span> -Dcom.sun.management.jmxremote.port=2500<span class="pl-pds">"</span></span>
JAVA_OPTS=<span class="pl-smi">$JAVA_OPTS</span><span class="pl-s"><span class="pl-pds">"</span> -Dcom.sun.management.jmxremote.authenticate=false<span class="pl-pds">"</span></span>
JAVA_OPTS=<span class="pl-smi">$JAVA_OPTS</span><span class="pl-s"><span class="pl-pds">"</span> -Dcom.sun.management.jmxremote.ssl=false<span class="pl-pds">"</span></span></pre>
  </div> 
  <p>TAKE CARE, to avoid error messages (ignored by processing), add jboss client jars to classpath</p> 
  <h2><a id="user-content-for-jetty" class="anchor" href="https://github.com/dacr/jajmx#for-jetty" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>For Jetty</h2> 
  <p>Use standard JSR 160 jmxrmi connection, but jetty mbeans must be enabled as by adding such block in jetty.xml configuration file, and setting all "StatsOn" to true :</p> 
  <div class="highlight highlight-text-xml">
   <pre>&lt;<span class="pl-ent">Call</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">"</span>MBeanServer<span class="pl-pds">"</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>java.lang.management.ManagementFactory<span class="pl-pds">"</span></span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>getPlatformMBeanServer<span class="pl-pds">"</span></span>/&gt;

&lt;<span class="pl-ent">Get</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">"</span>Container<span class="pl-pds">"</span></span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>container<span class="pl-pds">"</span></span>&gt;
  &lt;<span class="pl-ent">Call</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>addEventListener<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">Arg</span>&gt;
      &lt;<span class="pl-ent">New</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>org.mortbay.management.MBeanContainer<span class="pl-pds">"</span></span>&gt;
        &lt;<span class="pl-ent">Arg</span>&gt;&lt;<span class="pl-ent">Ref</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">"</span>MBeanServer<span class="pl-pds">"</span></span>/&gt;&lt;/<span class="pl-ent">Arg</span>&gt;
        &lt;<span class="pl-ent">Call</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>start<span class="pl-pds">"</span></span> /&gt;
      &lt;/<span class="pl-ent">New</span>&gt;
    &lt;/<span class="pl-ent">Arg</span>&gt;
  &lt;/<span class="pl-ent">Call</span>&gt;
&lt;/<span class="pl-ent">Get</span>&gt;</pre>
  </div> 
  <p>works at least for jetty 6.1.x. jetty-management.jar must be added to the classpath if not already present.</p> 
  <h2><a id="user-content-for-jboss-7x" class="anchor" href="https://github.com/dacr/jajmx#for-jboss-7x" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>For JBOSS 7.x</h2> 
  <p>jboss-client.jar must be added to the classpath</p> 
  <p>To specify the right management listening network interface</p> 
  <div class="highlight highlight-source-shell">
   <pre> JAVA_OPTS=<span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$JAVA_OPTS</span> -Djboss.bind.address.management=10.134.115.167<span class="pl-pds">"</span></span></pre>
  </div> 
  <pre><code>test@testhost ~/servers/jboss/bin $ ./add-user.sh 

What type of user do you wish to add? 
 a) Management User (mgmt-users.properties) 
 b) Application User (application-users.properties)
(a): a

Enter the details of the new user to add.
Realm (ManagementRealm) : 
Username : admin
Password : 
Re-enter Password : 
The username 'admin' is easy to guess
Are you sure you want to add user 'admin' yes/no? yes
About to add user 'admin' for realm 'ManagementRealm'
Is this correct yes/no? yes
Added user 'admin' to file '/opt/servers/jboss-as-7.1.1.Final/standalone/configuration/mgmt-users.properties'
Added user 'admin' to file '/opt/servers/jboss-as-7.1.1.Final/domain/configuration/mgmt-users.properties'
</code></pre> 
  <h3><a id="user-content-small-checks-with-jboss-7" class="anchor" href="https://github.com/dacr/jajmx#small-checks-with-jboss-7" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Small checks with JBOSS 7</h3> 
  <h4><a id="user-content-using-jconsole-" class="anchor" href="https://github.com/dacr/jajmx#using-jconsole-" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>using jconsole :</h4> 
  <pre><code>  ./jboss-as-7.1.1.Final/bin/jconsole.sh
     service:jmx:remoting-jmx://10.134.115.167:9999    username = admin  password = ""

  if local jboss : 
  jconsole -J-Djava.class.path=/home/dcr/.gentoo/java-config-2/current-user-vm/lib/jconsole.jar:/home/dcr/.gentoo/java-config-2/current-user-vm/lib/tools.jar:/home/dcr/servers/jboss-as-7.1.1.Final/lib/jboss-client.jar
</code></pre> 
  <h4><a id="user-content-using-jajmx-" class="anchor" href="https://github.com/dacr/jajmx#using-jajmx-" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>using JAJMX :</h4> 
  <pre><code> $ java -classpath ./bin/client/jboss-client.jar:/opt/analysis/analysis.jar com.orange.analysis.Main
 Welcome to Scala version 2.10.0 (Java HotSpot(TM) 64-Bit Server VM, Java 1.7.0_09).
 Type in expressions to have them evaluated.
 Type :help for more information.

 scala&gt; val jmx = jajmx.JMX("10.134.115.167", 9999, Some("admin"))
 jmx: fr.janalyse.jmx.JMX = fr.janalyse.jmx.JMXclassicalImpl@7ccea5c6

 scala&gt; jmx.whoami
 res0: Option[fr.janalyse.jmx.ASSignature] = Some(JBossSignature(7.1.1.Final,/home/dcr/servers/jboss-as-7.1.1.Final/standalone,jboss.as))
</code></pre> 
 </article>
</div>