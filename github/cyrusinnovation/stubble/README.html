<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a href="https://github.com/cyrusinnovation/stubble#stubble" aria-hidden="true" class="anchor" id="user-content-stubble" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>stubble</h1> 
  <p>Stub server for testing HTTP interactions</p> 
  <h2><a href="https://github.com/cyrusinnovation/stubble#why-stubble" aria-hidden="true" class="anchor" id="user-content-why-stubble" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Why Stubble?</h2> 
  <p>Stubble was designed to support testing of HTTP interactions between applications. Typically, this would be a web application consuming web services from a backend server, but it could be used for any sort of application that needs to talk to another via HTTP. Stubble allows you to setup interactions as you would with a <a href="http://martinfowler.com/articles/mocksArentStubs.html" target="_blank">mock or stub</a> <a href="http://code.google.com/p/mockito/" target="_blank">library</a> for unit testing. Rather than specifying method calls and return values, Stubble allows you to specify request conditions to match that, when matched, will cause the <code>StubServer</code> to return a specified response.</p> 
  <p>Testing is supported either within the same process, controlling the StubServer programmatically, or remotely, such as from an integration test running in a build, controlling the StubServer with a remote client over HTTP.</p> 
  <h2><a href="https://github.com/cyrusinnovation/stubble#usage" aria-hidden="true" class="anchor" id="user-content-usage" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Usage</h2> 
  <h3><a href="https://github.com/cyrusinnovation/stubble#starting-the-server" aria-hidden="true" class="anchor" id="user-content-starting-the-server" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Starting the Server</h3> 
  <p>Start the server by creating an instance with the desired port on which to serve interactions, then calling the <code>start</code> method:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">StubServer</span>(<span class="pl-c1">8082</span>)
server.start()</pre>
  </div> 
  <h3><a href="https://github.com/cyrusinnovation/stubble#direct-control" aria-hidden="true" class="anchor" id="user-content-direct-control" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Direct Control</h3> 
  <p>Control of the <code>StubServer</code> is done via the <code>StubServerControl</code> interface/trait:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">trait</span> <span class="pl-en">StubServerControl</span> {
  <span class="pl-k">def</span> <span class="pl-en">addInteraction</span>(<span class="pl-v">interaction</span>: <span class="pl-en">Interaction</span>)
  <span class="pl-k">def</span> <span class="pl-en">popInteractions</span>()
  <span class="pl-k">def</span> <span class="pl-en">pushInteractions</span>()
}</pre>
  </div> 
  <p>The trait is mixed into both the <code>StubServer</code> class and the <code>StubbleClient</code> class, the latter being the mechanism for controlling interactions from a remote process. Interactions are setup by passing in an instance of the <code>Interaction</code> class:</p> 
  <div class="highlight highlight-source-scala">
   <pre>server.addInteraction(<span class="pl-en">Interaction</span>(<span class="pl-en">List</span>(<span class="pl-en">PathCondition</span>(<span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>)), <span class="pl-en">Response</span>(<span class="pl-en">HttpResponseStatus</span>.<span class="pl-en">OK</span>, <span class="pl-en">Some</span>(body))))</pre>
  </div> 
  <p>See also the <code>StubbleClientTest</code> and <code>StubServerTest</code> for more examples of setting up interactions.</p> 
  <h3><a href="https://github.com/cyrusinnovation/stubble#remote-control" aria-hidden="true" class="anchor" id="user-content-remote-control" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Remote Control</h3> 
  <p>Adding interactions remotely is much the same as on the server directly, but you must first create a client configured with the same port as the server:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">client</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">StubbleClient</span>(<span class="pl-c1">8082</span>)</pre>
  </div> 
  <h3><a href="https://github.com/cyrusinnovation/stubble#the-interaction-stack" aria-hidden="true" class="anchor" id="user-content-the-interaction-stack" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>The Interaction Stack</h3> 
  <p>Often during integration testing, you may want to start Stubble, start your application, then run a bunch of tests against the application. You probably want each test to be as self-contained as possible, so Stubble allows you to setup an interaction "stack frame" for each test. By calling <code>pushInteractions()</code> before each test and <code>popInteractions()</code> after each test, you can isolate tests from each other, throwing away any state you've setup after each test. A complete typical test might look like this (assuming the StubServer is started by the build, and here the ExampleApplication is small enough to be started for each test):</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">com.cyrusinnovation.stubble.server.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">org.junit.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">org.jboss.netty.handler.codec.http.</span><span class="pl-v">HttpResponseStatus</span>
<span class="pl-k">import</span> <span class="pl-v">org.junit.Assert.</span><span class="pl-v">_</span>

<span class="pl-k">class</span> <span class="pl-en">ExampleTest</span> {
  <span class="pl-k">var</span> <span class="pl-en">client</span><span class="pl-k">:</span> <span class="pl-en">StubbleClient</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">StubbleClient</span>(<span class="pl-c1">8082</span>)
  <span class="pl-k">val</span> <span class="pl-en">app</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">ExampleApplication</span>

  <span class="pl-k">@</span><span class="pl-en">Before</span>
  <span class="pl-k">def</span> <span class="pl-en">setUp</span>() {
    client.pushInteractions()
  }

  <span class="pl-k">@</span><span class="pl-en">After</span>
  <span class="pl-k">def</span> <span class="pl-en">tearDown</span>() {
    client.popInteractions()
  }

  <span class="pl-k">@</span><span class="pl-en">Test</span>
  <span class="pl-k">def</span> <span class="pl-en">addsInteractionsToServer</span>() {
    <span class="pl-k">val</span> <span class="pl-en">interactions</span> <span class="pl-k">=</span> <span class="pl-en">List</span>(<span class="pl-en">Interaction</span>(<span class="pl-en">List</span>(<span class="pl-en">CookieCondition</span>(<span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>chocolate chip<span class="pl-pds">"</span></span>)), <span class="pl-en">Response</span>(<span class="pl-en">HttpResponseStatus</span>.<span class="pl-en">OK</span>, <span class="pl-en">Some</span>(<span class="pl-s"><span class="pl-pds">"</span>gimme cookie!<span class="pl-pds">"</span></span>))),
                            <span class="pl-en">Interaction</span>(<span class="pl-en">List</span>(<span class="pl-en">PathCondition</span>(<span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>)), <span class="pl-en">Response</span>(<span class="pl-en">HttpResponseStatus</span>.<span class="pl-en">OK</span>, <span class="pl-en">Some</span>(<span class="pl-s"><span class="pl-pds">"</span>Hello!<span class="pl-pds">"</span></span>))))
    interactions.foreach(client.addInteraction(_))

    <span class="pl-k">val</span> <span class="pl-en">appResponse</span> <span class="pl-k">=</span> app.somethingThatNeedsABackendServer
    assertEquals(<span class="pl-s"><span class="pl-pds">"</span>Something wonderful happened<span class="pl-pds">"</span></span>, appResponse)
  }
}</pre>
  </div> 
  <p>The interaction stack is sort of analogous to what JUnit does by initializing your test class before each test and throwing it away after, except that often you can't throw away your back end each time, because your application may be making requests of it outside your test flow. Stubble supports setting up the base, background interactions that might be happening outside the test flow by adding them to the first stack frame, which it will never pop off the stack. In other words, if you have interactions that need to be around for the duration of your server's lifetime, set those up before pushing interactions before the first time, and they'll stay around until the <code>StubServer</code> is shut down.</p> 
  <h2><a href="https://github.com/cyrusinnovation/stubble#maven-integration" aria-hidden="true" class="anchor" id="user-content-maven-integration" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Maven Integration</h2> 
  <p>Stubble is designed to fit easily into your Maven build. You can include the stub server and client code by adding a dependency on the <code>stubble-core</code> module:</p> 
  <div class="highlight highlight-text-xml">
   <pre>    &lt;<span class="pl-ent">dependency</span>&gt;
      &lt;<span class="pl-ent">groupId</span>&gt;com.cyrusinnovation&lt;/<span class="pl-ent">groupId</span>&gt;
      &lt;<span class="pl-ent">artifactId</span>&gt;stubble-core&lt;/<span class="pl-ent">artifactId</span>&gt;
      &lt;<span class="pl-ent">version</span>&gt;0.0.1&lt;/<span class="pl-ent">version</span>&gt;
    &lt;/<span class="pl-ent">dependency</span>&gt;</pre>
  </div> 
  <p>A common way of running integration tests with maven is to create a submodule to contain integration tests, that depends on your main project module(s) and starts/stops your server instance. You may want the stub server to start before your server starts and stop after your server shuts down so that, for example, any interactions initiated at startup will succeed.</p> 
  <p>In order to start your server for integration testing, you might bind <a href="http://cargo.codehaus.org/Maven2+plugin" target="_blank">Cargo</a>'s <code>start</code> goal to the <code>pre-integration-test</code> phase and its <code>stop</code> goal to the <code>post-integration-test</code> phase, using the Surefire plugin to run tests in the <code>integration-test</code> phase. When binding a second plugin to the same phase (<code>pre-integration-test</code>, for example), however, Maven executes plugins in declaration order in the pom. In order to start before Cargo and stop after Cargo, then, Stubble provides two plugins, one each for start and stop actions. Therefore, use the <code>start-stubble-plugin</code> before Cargo in the <code>pre-integration-test</code> phase and the <code>stop-stubble-plugin</code> after Cargo in the <code>post-integration-test</code> phase.</p> 
  <p><strong>If you don't understand any of this and haven't tried to sequence actions within a single phase in Maven, be thankful and just copy and paste the below example into your integration-test pom, modifying Cargo for your own application:</strong></p> 
  <div class="highlight highlight-text-xml">
   <pre>  &lt;<span class="pl-ent">properties</span>&gt;
    &lt;<span class="pl-ent">serverPort</span>&gt;8081&lt;/<span class="pl-ent">serverPort</span>&gt;
    &lt;<span class="pl-ent">stubblePort</span>&gt;8082&lt;/<span class="pl-ent">stubblePort</span>&gt;
  &lt;/<span class="pl-ent">properties</span>&gt;

  &lt;<span class="pl-ent">build</span>&gt;
    &lt;<span class="pl-ent">plugins</span>&gt;
      &lt;<span class="pl-ent">plugin</span>&gt;
        &lt;<span class="pl-ent">groupId</span>&gt;com.cyrusinnovation&lt;/<span class="pl-ent">groupId</span>&gt;
        &lt;<span class="pl-ent">artifactId</span>&gt;start-stubble-plugin&lt;/<span class="pl-ent">artifactId</span>&gt;
        &lt;<span class="pl-ent">version</span>&gt;0.0.1&lt;/<span class="pl-ent">version</span>&gt;
        &lt;<span class="pl-ent">configuration</span>&gt;
          &lt;<span class="pl-ent">port</span>&gt;${stubblePort}&lt;/<span class="pl-ent">port</span>&gt;
        &lt;/<span class="pl-ent">configuration</span>&gt;
        &lt;<span class="pl-ent">executions</span>&gt;
          &lt;<span class="pl-ent">execution</span>&gt;
            &lt;<span class="pl-ent">phase</span>&gt;pre-integration-test&lt;/<span class="pl-ent">phase</span>&gt;
            &lt;<span class="pl-ent">goals</span>&gt;
              &lt;<span class="pl-ent">goal</span>&gt;start&lt;/<span class="pl-ent">goal</span>&gt;
            &lt;/<span class="pl-ent">goals</span>&gt;
          &lt;/<span class="pl-ent">execution</span>&gt;
        &lt;/<span class="pl-ent">executions</span>&gt;
      &lt;/<span class="pl-ent">plugin</span>&gt;
      &lt;<span class="pl-ent">plugin</span>&gt;
        &lt;<span class="pl-ent">groupId</span>&gt;org.apache.maven.plugins&lt;/<span class="pl-ent">groupId</span>&gt;
        &lt;<span class="pl-ent">artifactId</span>&gt;maven-surefire-plugin&lt;/<span class="pl-ent">artifactId</span>&gt;
        &lt;<span class="pl-ent">configuration</span>&gt;
          &lt;<span class="pl-ent">skip</span>&gt;true&lt;/<span class="pl-ent">skip</span>&gt;
          &lt;<span class="pl-ent">systemProperties</span>&gt;
            &lt;<span class="pl-ent">property</span>&gt;
              &lt;<span class="pl-ent">name</span>&gt;serverPort&lt;/<span class="pl-ent">name</span>&gt;
              &lt;<span class="pl-ent">value</span>&gt;${serverPort}&lt;/<span class="pl-ent">value</span>&gt;
            &lt;/<span class="pl-ent">property</span>&gt;
            &lt;<span class="pl-ent">property</span>&gt;
              &lt;<span class="pl-ent">name</span>&gt;stubblePort&lt;/<span class="pl-ent">name</span>&gt;
              &lt;<span class="pl-ent">value</span>&gt;${stubblePort}&lt;/<span class="pl-ent">value</span>&gt;
            &lt;/<span class="pl-ent">property</span>&gt;
          &lt;/<span class="pl-ent">systemProperties</span>&gt;
        &lt;/<span class="pl-ent">configuration</span>&gt;
        &lt;<span class="pl-ent">executions</span>&gt;
          &lt;<span class="pl-ent">execution</span>&gt;
            &lt;<span class="pl-ent">id</span>&gt;integration-tests&lt;/<span class="pl-ent">id</span>&gt;
            &lt;<span class="pl-ent">phase</span>&gt;integration-test&lt;/<span class="pl-ent">phase</span>&gt;
            &lt;<span class="pl-ent">goals</span>&gt;
              &lt;<span class="pl-ent">goal</span>&gt;test&lt;/<span class="pl-ent">goal</span>&gt;
            &lt;/<span class="pl-ent">goals</span>&gt;
            &lt;<span class="pl-ent">configuration</span>&gt;
              &lt;<span class="pl-ent">skip</span>&gt;false&lt;/<span class="pl-ent">skip</span>&gt;
            &lt;/<span class="pl-ent">configuration</span>&gt;
          &lt;/<span class="pl-ent">execution</span>&gt;
        &lt;/<span class="pl-ent">executions</span>&gt;
      &lt;/<span class="pl-ent">plugin</span>&gt;
      &lt;<span class="pl-ent">plugin</span>&gt;
        &lt;<span class="pl-ent">groupId</span>&gt;org.codehaus.cargo&lt;/<span class="pl-ent">groupId</span>&gt;
        &lt;<span class="pl-ent">artifactId</span>&gt;cargo-maven2-plugin&lt;/<span class="pl-ent">artifactId</span>&gt;
        &lt;<span class="pl-ent">version</span>&gt;1.2.0&lt;/<span class="pl-ent">version</span>&gt;
        &lt;<span class="pl-ent">executions</span>&gt;
          &lt;<span class="pl-ent">execution</span>&gt;
            &lt;<span class="pl-ent">id</span>&gt;start-container&lt;/<span class="pl-ent">id</span>&gt;
            &lt;<span class="pl-ent">phase</span>&gt;pre-integration-test&lt;/<span class="pl-ent">phase</span>&gt;
            &lt;<span class="pl-ent">goals</span>&gt;
              &lt;<span class="pl-ent">goal</span>&gt;start&lt;/<span class="pl-ent">goal</span>&gt;
            &lt;/<span class="pl-ent">goals</span>&gt;
          &lt;/<span class="pl-ent">execution</span>&gt;
          &lt;<span class="pl-ent">execution</span>&gt;
            &lt;<span class="pl-ent">id</span>&gt;stop-container&lt;/<span class="pl-ent">id</span>&gt;
            &lt;<span class="pl-ent">phase</span>&gt;post-integration-test&lt;/<span class="pl-ent">phase</span>&gt;
            &lt;<span class="pl-ent">goals</span>&gt;
              &lt;<span class="pl-ent">goal</span>&gt;stop&lt;/<span class="pl-ent">goal</span>&gt;
            &lt;/<span class="pl-ent">goals</span>&gt;
          &lt;/<span class="pl-ent">execution</span>&gt;
        &lt;/<span class="pl-ent">executions</span>&gt;
        &lt;<span class="pl-ent">configuration</span>&gt;
          &lt;<span class="pl-ent">wait</span>&gt;false&lt;/<span class="pl-ent">wait</span>&gt;
          &lt;<span class="pl-ent">container</span>&gt;
            &lt;<span class="pl-ent">containerId</span>&gt;tomcat7x&lt;/<span class="pl-ent">containerId</span>&gt;
            &lt;<span class="pl-ent">zipUrlInstaller</span>&gt;
              &lt;<span class="pl-ent">url</span>&gt;
                http://mirror.cc.columbia.edu/pub/software/apache/tomcat/tomcat-7/v7.0.27/bin/apache-tomcat-7.0.27.zip
              &lt;/<span class="pl-ent">url</span>&gt;
              &lt;<span class="pl-ent">downloadDir</span>&gt;${java.io.tmpdir}/cargoinstalls.${user.name}&lt;/<span class="pl-ent">downloadDir</span>&gt;
            &lt;/<span class="pl-ent">zipUrlInstaller</span>&gt;
            &lt;<span class="pl-ent">systemProperties</span>&gt;
              &lt;<span class="pl-ent">stubblePort</span>&gt;${stubblePort}&lt;/<span class="pl-ent">stubblePort</span>&gt;
            &lt;/<span class="pl-ent">systemProperties</span>&gt;
          &lt;/<span class="pl-ent">container</span>&gt;
          &lt;<span class="pl-ent">configuration</span>&gt;
            &lt;<span class="pl-ent">home</span>&gt;${project.build.directory}/tomcat7x&lt;/<span class="pl-ent">home</span>&gt;
            &lt;<span class="pl-ent">properties</span>&gt;
              &lt;<span class="pl-ent">cargo</span>.servlet.port&gt;${serverPort}&lt;/<span class="pl-ent">cargo</span>.servlet.port&gt;
              &lt;<span class="pl-ent">cargo</span>.tomcat.ajp.port&gt;8010&lt;/<span class="pl-ent">cargo</span>.tomcat.ajp.port&gt;
            &lt;/<span class="pl-ent">properties</span>&gt;
            &lt;<span class="pl-ent">deployables</span>&gt;
              &lt;<span class="pl-ent">deployable</span>&gt;
                &lt;<span class="pl-ent">groupId</span>&gt;com.cyrusinnovation&lt;/<span class="pl-ent">groupId</span>&gt;
                &lt;<span class="pl-ent">artifactId</span>&gt;test-server&lt;/<span class="pl-ent">artifactId</span>&gt;
                &lt;<span class="pl-ent">type</span>&gt;war&lt;/<span class="pl-ent">type</span>&gt;
                &lt;<span class="pl-ent">properties</span>&gt;
                  &lt;<span class="pl-ent">context</span>&gt;/&lt;/<span class="pl-ent">context</span>&gt;
                &lt;/<span class="pl-ent">properties</span>&gt;
              &lt;/<span class="pl-ent">deployable</span>&gt;
            &lt;/<span class="pl-ent">deployables</span>&gt;
          &lt;/<span class="pl-ent">configuration</span>&gt;
        &lt;/<span class="pl-ent">configuration</span>&gt;
      &lt;/<span class="pl-ent">plugin</span>&gt;
      &lt;<span class="pl-ent">plugin</span>&gt;
        &lt;<span class="pl-ent">groupId</span>&gt;com.cyrusinnovation&lt;/<span class="pl-ent">groupId</span>&gt;
        &lt;<span class="pl-ent">artifactId</span>&gt;stop-stubble-plugin&lt;/<span class="pl-ent">artifactId</span>&gt;
        &lt;<span class="pl-ent">version</span>&gt;0.0.1&lt;/<span class="pl-ent">version</span>&gt;
        &lt;<span class="pl-ent">configuration</span>&gt;
          &lt;<span class="pl-ent">port</span>&gt;${stubblePort}&lt;/<span class="pl-ent">port</span>&gt;
        &lt;/<span class="pl-ent">configuration</span>&gt;
        &lt;<span class="pl-ent">executions</span>&gt;
          &lt;<span class="pl-ent">execution</span>&gt;
            &lt;<span class="pl-ent">phase</span>&gt;post-integration-test&lt;/<span class="pl-ent">phase</span>&gt;
            &lt;<span class="pl-ent">goals</span>&gt;
              &lt;<span class="pl-ent">goal</span>&gt;stop&lt;/<span class="pl-ent">goal</span>&gt;
            &lt;/<span class="pl-ent">goals</span>&gt;
          &lt;/<span class="pl-ent">execution</span>&gt;
        &lt;/<span class="pl-ent">executions</span>&gt;
      &lt;/<span class="pl-ent">plugin</span>&gt;
    &lt;/<span class="pl-ent">plugins</span>&gt;
  &lt;/<span class="pl-ent">build</span>&gt;</pre>
  </div> 
 </article>
</div>