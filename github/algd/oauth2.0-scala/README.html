<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content-oauth20-scala" class="anchor" href="https://github.com/algd/oauth2.0-scala#oauth20-scala" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>OAuth2.0 scala</h1> 
  <p>This library provides the necessary tools to implement an OAuth 2.0 server. It is based on <a href="https://tools.ietf.org/html/rfc6749" target="_blank">RFC 6749</a>.</p> 
  <h3><a id="user-content-getting-started" class="anchor" href="https://github.com/algd/oauth2.0-scala#getting-started" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Getting Started</h3> 
  <p>This project is using scala 2.11.8. To get started with SBT, add the following to your <code>build.sbt</code> file:</p> 
  <div class="highlight highlight-source-scala">
   <pre>resolvers <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>bintray algd<span class="pl-pds">"</span></span> at <span class="pl-s"><span class="pl-pds">"</span>http://dl.bintray.com/content/algd/maven<span class="pl-pds">"</span></span></pre>
  </div> 
  <p>In case you want to use the akka-http module add the following. It is using akka 2.4.4.</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>io.github.algd<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>oauth2-scala-akka-http<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.4.0<span class="pl-pds">"</span></span></pre>
  </div> 
  <p>Otherwise only add:</p> 
  <div class="highlight highlight-source-scala">
   <pre>libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>io.github.algd<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>oauth2-scala-core<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.4.0<span class="pl-pds">"</span></span></pre>
  </div> 
  <h3><a id="user-content-authorize-endpoint" class="anchor" href="https://github.com/algd/oauth2.0-scala#authorize-endpoint" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Authorize endpoint</h3> 
  <p>After creating a class that extends <code>DataManager</code>, you can instantiate an OAuth authorizer enabling the flows you are interested in:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">myDataManager</span><span class="pl-k">:</span> <span class="pl-en">DataManager</span>[<span class="pl-en">MyUser</span>] <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">MyDataManager</span>

<span class="pl-k">val</span> <span class="pl-en">authorizer</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">BaseAuthorizer</span>(myDataManager) <span class="pl-k">+</span>
                 <span class="pl-k">new</span> <span class="pl-en">ImplicitAuthorizer</span> <span class="pl-k">+</span>
                 <span class="pl-k">new</span> <span class="pl-en">CodeAuthorizer</span>

<span class="pl-k">val</span> <span class="pl-en">params</span> <span class="pl-k">=</span> <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>some_oauth_param<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>)
                
<span class="pl-k">val</span> <span class="pl-en">response</span> <span class="pl-k">=</span> authorizer(user, params)</pre>
  </div> 
  <p>This even allows you to create your custom authorizers. The response of an authorizer will be a <code>Future[UriResponse]</code> containing a validation error or a successful response ready to be converted to a redirection uri.</p> 
  <h3><a id="user-content-token-endpoint" class="anchor" href="https://github.com/algd/oauth2.0-scala#token-endpoint" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Token endpoint</h3> 
  <p>After creating a class that extends <code>DataManager</code>, you can instantiate an OAuth token granter enabling the flows you are interested in:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">myDataManager</span><span class="pl-k">:</span> <span class="pl-en">DataManager</span>[<span class="pl-en">MyUser</span>] <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">MyDataManager</span>

<span class="pl-k">val</span> <span class="pl-en">granter</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">BaseGranter</span>(myDataManager) <span class="pl-k">+</span>
              <span class="pl-k">new</span> <span class="pl-en">AuthorizationCodeGranter</span> <span class="pl-k">+</span>
              <span class="pl-k">new</span> <span class="pl-en">PasswordGranter</span> <span class="pl-k">+</span>
              <span class="pl-k">new</span> <span class="pl-en">ClientCredentialsGranter</span> <span class="pl-k">+</span>
              <span class="pl-k">new</span> <span class="pl-en">RefreshTokenGranter</span>

<span class="pl-k">val</span> <span class="pl-en">params</span> <span class="pl-k">=</span> <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>some_oauth_param<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>)
                
<span class="pl-k">val</span> <span class="pl-en">response</span> <span class="pl-k">=</span> granter(params)</pre>
  </div> 
  <p>This even allows you to create your custom granters. The response of a granter will be a <code>Future[TokenResponse]</code> containing a validation error or a new issued token info.</p> 
  <h3><a id="user-content-akka-http-integration" class="anchor" href="https://github.com/algd/oauth2.0-scala#akka-http-integration" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Akka Http integration</h3> 
  <p>If you are using the akka http module you can extend or import <code>OAuth2Support</code> to enable implicit conversions for authorizers and granters. For example:</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">OAuth2Support.</span><span class="pl-v">_</span>
...
(path(<span class="pl-s"><span class="pl-pds">"</span>authorize<span class="pl-pds">"</span></span>) &amp; post &amp; parameterMap) { params <span class="pl-k">=&gt;</span>
    <span class="pl-k">val</span> <span class="pl-en">user</span> <span class="pl-k">=</span> ...
    authorizer.route(user, params) <span class="pl-c"><span class="pl-c">//</span> ToEntityMarshaller[OAuthError] required</span>
}
...
(path(<span class="pl-s"><span class="pl-pds">"</span>token<span class="pl-pds">"</span></span>) &amp; post &amp; entity(as[<span class="pl-en">FormData</span>])) { form <span class="pl-k">=&gt;</span>
    granter.route(form.fields.toMap)      
}</pre>
  </div> 
  <h3><a id="user-content-datamanager-implementation" class="anchor" href="https://github.com/algd/oauth2.0-scala#datamanager-implementation" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>DataManager implementation</h3> 
  <p>The <a href="https://github.com/algd/oauth2.0-scala/blob/master/oauth2-scala-core/src/main/scala/io/github/algd/oauth/data/DataManager.scala" target="_blank">DataManager class</a> is in charge of integrating the logic with the persistence layer. You should extend the User class adding the data you think that is meaningful when the token is validated.</p> 
  <p>Every method receives an implicit OAuthParams instance that contains all the parameters received by the Granter/Authorizer. You can use this if you want to store some data or to do more validations using custom extra parameters from the request or the context.</p> 
  <h5><a id="user-content-getclientid--getclientid-secret" class="anchor" href="https://github.com/algd/oauth2.0-scala#getclientid--getclientid-secret" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>GetClient(id) / GetClient(id, secret)</h5> 
  <p>The <strong>getClient</strong> method retrieves the data associated to a client in case it exists and the secret, if provided, is valid.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span> Authorization code/implicit grant flow</span>
<span class="pl-k">def</span> <span class="pl-en">getClient</span>(<span class="pl-v">id</span>: <span class="pl-k">String</span>)
(<span class="pl-k">implicit</span> <span class="pl-v">params</span>: <span class="pl-en">OAuthParams</span>, <span class="pl-v">ec</span>: <span class="pl-en">ExecutionContext</span>)<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">Option</span>[<span class="pl-en">Client</span>]]
...
<span class="pl-c"><span class="pl-c">//</span> For every OAuth2 flow</span>
<span class="pl-k">def</span> <span class="pl-en">getClient</span>(<span class="pl-v">id</span>: <span class="pl-k">String</span>, <span class="pl-v">secret</span>: <span class="pl-k">String</span>)
(<span class="pl-k">implicit</span> <span class="pl-v">params</span>: <span class="pl-en">OAuthParams</span>, <span class="pl-v">ec</span>: <span class="pl-en">ExecutionContext</span>)<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">Option</span>[<span class="pl-en">Client</span>]]</pre>
  </div> 
  <p>Example of client record:</p> 
  <table> 
   <thead> 
    <tr> 
     <th>Field</th> 
     <th>Value</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td><em><strong>id</strong></em></td> 
     <td><em>client_id</em></td> 
    </tr> 
    <tr> 
     <td><strong>secret</strong></td> 
     <td>e16b2ab8d12314bf4efbd6203906ea6c</td> 
    </tr> 
    <tr> 
     <td><strong>name</strong></td> 
     <td>Test Client</td> 
    </tr> 
    <tr> 
     <td><strong>scope</strong></td> 
     <td>create,update,delete</td> 
    </tr> 
    <tr> 
     <td><strong>grants</strong></td> 
     <td>authorization_code,implicit,refresh_token,password,client_credentials</td> 
    </tr> 
    <tr> 
     <td><strong>redirect_uri</strong></td> 
     <td><a href="http://test-domain.com%7C" target="_blank">http://test-domain.com|</a></td> 
    </tr>
   </tbody>
  </table> 
  <h5><a id="user-content-getuseruser-password" class="anchor" href="https://github.com/algd/oauth2.0-scala#getuseruser-password" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>GetUser(user, password)</h5> 
  <p>The <strong>getUser</strong> method returns some data of the user after validating its username and password (the returned user id can be the same as the username).</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">getUser</span>(<span class="pl-v">username</span>: <span class="pl-k">String</span>, <span class="pl-v">password</span>: <span class="pl-k">String</span>)
(<span class="pl-k">implicit</span> <span class="pl-v">params</span>: <span class="pl-en">OAuthParams</span>, <span class="pl-v">ec</span>: <span class="pl-en">ExecutionContext</span>)<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">Option</span>[<span class="pl-en">T</span>]]</pre>
  </div> 
  <h5><a id="user-content-generateaccesstokeninfo--generaterefreshtokeninfo--generateauthcodeinfo" class="anchor" href="https://github.com/algd/oauth2.0-scala#generateaccesstokeninfo--generaterefreshtokeninfo--generateauthcodeinfo" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>GenerateAccessToken(info) / GenerateRefreshToken(info) / GenerateAuthCode(info)</h5> 
  <p>These methods receive the authorization data that contains the client, scope and optional user and returns a string that will be used later to retrieve this information.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">generateAuthCode</span>(<span class="pl-v">authInfo</span>: <span class="pl-en">AuthorizationData</span>[<span class="pl-en">T</span>])
(<span class="pl-k">implicit</span> <span class="pl-v">params</span>: <span class="pl-en">OAuthParams</span>, <span class="pl-v">ec</span>: <span class="pl-en">ExecutionContext</span>) <span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-k">String</span>]
...
<span class="pl-k">def</span> <span class="pl-en">generateAccessToken</span>(<span class="pl-v">authInfo</span>: <span class="pl-en">AuthorizationData</span>[<span class="pl-en">T</span>])
(<span class="pl-k">implicit</span> <span class="pl-v">params</span>: <span class="pl-en">OAuthParams</span>, <span class="pl-v">ec</span>: <span class="pl-en">ExecutionContext</span>) <span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-k">String</span>]
...
<span class="pl-k">def</span> <span class="pl-en">generateRefreshToken</span>(<span class="pl-v">authInfo</span>: <span class="pl-en">AuthorizationData</span>[<span class="pl-en">T</span>])
(<span class="pl-k">implicit</span> <span class="pl-v">params</span>: <span class="pl-en">OAuthParams</span>, <span class="pl-v">ec</span>: <span class="pl-en">ExecutionContext</span>) <span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-k">String</span>]</pre>
  </div> 
  <p>This string could be for example the encrypted token information or a key used to retrieve the information if it was stored.</p> 
  <p>Example of Authorization Code AuthInfo record:</p> 
  <table> 
   <thead> 
    <tr> 
     <th>Field</th> 
     <th>Value</th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td><em><strong>code</strong></em></td> 
     <td><em>ABCD</em></td> 
    </tr> 
    <tr> 
     <td><strong>client</strong></td> 
     <td>client_id</td> 
    </tr> 
    <tr> 
     <td><strong>scope</strong></td> 
     <td>create,update</td> 
    </tr> 
    <tr> 
     <td><strong>redirect_uri</strong></td> 
     <td><a href="http://test-domain.com/oauth2/callback%7C" target="_blank">http://test-domain.com/oauth2/callback|</a></td> 
    </tr> 
    <tr> 
     <td><strong>creation_date</strong></td> 
     <td>1473639713645</td> 
    </tr>
   </tbody>
  </table> 
  <h5><a id="user-content-getuserscopeuserinfo" class="anchor" href="https://github.com/algd/oauth2.0-scala#getuserscopeuserinfo" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>GetUserScope(userInfo)</h5> 
  <p>The <strong>getUserScope</strong> method retrieves a set with the permissions of the user given the user info. It could be using some data of the class to deduce the scope, querying a database, etc.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">getUserScope</span>(<span class="pl-v">user</span>: <span class="pl-en">Option</span>[<span class="pl-en">T</span>])
(<span class="pl-k">implicit</span> <span class="pl-v">params</span>: <span class="pl-en">OAuthParams</span>, <span class="pl-v">ec</span>: <span class="pl-en">ExecutionContext</span>)<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">Option</span>[<span class="pl-en">Set</span>[<span class="pl-k">String</span>]]]</pre>
  </div> 
  <h5><a id="user-content-getgrantedscopeclientscope-userscope-requestedscope" class="anchor" href="https://github.com/algd/oauth2.0-scala#getgrantedscopeclientscope-userscope-requestedscope" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>GetGrantedScope(clientScope, userScope, requestedScope)</h5> 
  <p>The <strong>getGrantedScope</strong> method calculates the actual scope of the token. The default implementation is the intersection of permissions of the client scope, the user scope (if it is not client credentials flow) and the requested scope (if provided).</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">getGrantedScope</span>(<span class="pl-v">clientScope</span>: <span class="pl-en">Set</span>[<span class="pl-k">String</span>],
    <span class="pl-v">userScope</span>: <span class="pl-en">Option</span>[<span class="pl-en">Set</span>[<span class="pl-k">String</span>]],
    <span class="pl-v">requestedScope</span>: <span class="pl-en">Option</span>[<span class="pl-en">Set</span>[<span class="pl-k">String</span>]])
    (<span class="pl-k">implicit</span> <span class="pl-v">params</span>: <span class="pl-en">OAuthParams</span>, <span class="pl-v">ec</span>: <span class="pl-en">ExecutionContext</span>)<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">Set</span>[<span class="pl-k">String</span>]] <span class="pl-k">=</span> <span class="pl-en">Future</span>.successful{
    <span class="pl-en">Seq</span>(<span class="pl-en">Some</span>(clientScope), userScope, requestedScope).flatten.reduce(_&amp;_)
}</pre>
  </div> 
  <h5><a id="user-content-isvalidredirecturiuri-clienturis" class="anchor" href="https://github.com/algd/oauth2.0-scala#isvalidredirecturiuri-clienturis" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>IsValidRedirectUri(uri, clientUris)</h5> 
  <p>This method is used when a redirect uri is provided in the authorization code or implicit grant flows. Some examples of validation could be:</p> 
  <ul> 
   <li>clientUris.contains(uri)</li> 
   <li>clientUris.exists(uri.startsWith)</li> 
  </ul> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">isValidRedirectUri</span>(<span class="pl-v">uri</span>: <span class="pl-k">String</span>, <span class="pl-v">clientUris</span>: <span class="pl-en">List</span>[<span class="pl-k">String</span>])
(<span class="pl-k">implicit</span> <span class="pl-v">params</span>: <span class="pl-en">OAuthParams</span>)<span class="pl-k">:</span> <span class="pl-k">Boolean</span></pre>
  </div> 
  <h5><a id="user-content-buildauthorizationdataclient-user-scope-redirecturi" class="anchor" href="https://github.com/algd/oauth2.0-scala#buildauthorizationdataclient-user-scope-redirecturi" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>BuildAuthorizationData(client, user, scope, redirectUri)</h5> 
  <p>This method creates an instance of AuthorizationData that will be associated to an authorization code, token or refresh token. You can override the default implementation if you want to store more information or change the way the creation time is asigned.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">buildAuthorizationData</span>(<span class="pl-v">client</span>: <span class="pl-en">Client</span>, <span class="pl-v">user</span>: <span class="pl-en">Option</span>[<span class="pl-en">T</span>], <span class="pl-v">scope</span>: <span class="pl-en">Option</span>[<span class="pl-en">Set</span>[<span class="pl-k">String</span>]], <span class="pl-v">redirectUri</span>: <span class="pl-en">Option</span>[<span class="pl-k">String</span>] <span class="pl-k">=</span> <span class="pl-c1">None</span>)
    (<span class="pl-k">implicit</span> <span class="pl-v">params</span>: <span class="pl-en">OAuthParams</span>, <span class="pl-v">ec</span>: <span class="pl-en">ExecutionContext</span>) <span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">AuthorizationData</span>[<span class="pl-en">T</span>]] <span class="pl-k">=</span> <span class="pl-en">Future</span>.successful {
    <span class="pl-en">AuthorizationData</span>(client, user, scope, redirectUri)
    <span class="pl-c"><span class="pl-c">/*</span> Or with more info...</span>
<span class="pl-c">    AuthorizationData(client, user, scope, redirectUri).withData("app" -&gt; "testApp") <span class="pl-c">*/</span></span>
}</pre>
  </div> 
  <h5><a id="user-content-getauthcodedatacode--getaccesstokendatatoken--getrefreshtokendatarefreshtoken" class="anchor" href="https://github.com/algd/oauth2.0-scala#getauthcodedatacode--getaccesstokendatatoken--getrefreshtokendatarefreshtoken" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>GetAuthCodeData(code) / GetAccessTokenData(token) / GetRefreshTokenData(refreshToken)</h5> 
  <p>These methods returns the AuthorizationData associated to the code/token/refresh token given a string. So it could be, for example, extracting the information from the string or looking for the value with this key in a database.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">def</span> <span class="pl-en">getAuthCodeData</span>(<span class="pl-v">code</span>: <span class="pl-k">String</span>)
(<span class="pl-k">implicit</span> <span class="pl-v">params</span>: <span class="pl-en">OAuthParams</span>, <span class="pl-v">ec</span>: <span class="pl-en">ExecutionContext</span>)<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">Option</span>[<span class="pl-en">AuthorizationData</span>[<span class="pl-en">T</span>]]]
...
<span class="pl-k">def</span> <span class="pl-en">getAccessTokenData</span>(<span class="pl-v">token</span>: <span class="pl-k">String</span>)
(<span class="pl-k">implicit</span> <span class="pl-v">params</span>: <span class="pl-en">OAuthParams</span>, <span class="pl-v">ec</span>: <span class="pl-en">ExecutionContext</span>) <span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">Option</span>[<span class="pl-en">AuthorizationData</span>[<span class="pl-en">T</span>]]]
...
<span class="pl-k">def</span> <span class="pl-en">getRefreshTokenData</span>(<span class="pl-v">refreshToken</span>: <span class="pl-k">String</span>)
(<span class="pl-k">implicit</span> <span class="pl-v">params</span>: <span class="pl-en">OAuthParams</span>, <span class="pl-v">ec</span>: <span class="pl-en">ExecutionContext</span>)<span class="pl-k">:</span> <span class="pl-en">Future</span>[<span class="pl-en">Option</span>[<span class="pl-en">AuthorizationData</span>[<span class="pl-en">T</span>]]]</pre>
  </div> 
 </article>
</div>