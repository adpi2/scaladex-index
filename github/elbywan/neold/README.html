<div class="announce instapaper_body md" data-path="README.md" id="readme">
 <article class="markdown-body entry-content" itemprop="text">
  <h1><a id="user-content--neold----" class="anchor" href="https://github.com/elbywan/neold#-neold----" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>| Neold | <a href="https://travis-ci.org/elbywan/neold" target="_blank"><img src="https://camo.githubusercontent.com/3ae46f7b25b0b22796f78c533ffc47fa14dd5a46/68747470733a2f2f7472617669732d63692e6f72672f656c627977616e2f6e656f6c642e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/elbywan/neold.svg?branch=master" style="max-width:100%;"></a> | <a href="https://coveralls.io/r/elbywan/neold?branch=master" target="_blank"><img src="https://camo.githubusercontent.com/241da45723516b70de1b09293e53ddb9880d517e/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f656c627977616e2f6e656f6c642f62616467652e7376673f6272616e63683d6d6173746572" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/elbywan/neold/badge.svg?branch=master" style="max-width:100%;"></a></h1> 
  <p><strong>Neold</strong> is an high performance, programmer-friendly asynchronous Neo4j REST client driver written in scala.</p> 
  <hr> 
  <ul> 
   <li>Main branch : releases.</li> 
   <li>Dev branch : snapshots.</li> 
  </ul> 
  <hr> 
  <p>##Installation</p> 
  <p>Add the following lines to your sbt build file :</p> 
  <div class="highlight highlight-source-scala">
   <pre>resolvers <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-en">Resolver</span>.sonatypeRepo(<span class="pl-s"><span class="pl-pds">"</span>releases<span class="pl-pds">"</span></span>)

libraryDependencies <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>com.github.elbywan<span class="pl-pds">"</span></span> <span class="pl-k">%%</span> <span class="pl-s"><span class="pl-pds">"</span>neold<span class="pl-pds">"</span></span> <span class="pl-k">%</span> <span class="pl-s"><span class="pl-pds">"</span>0.2<span class="pl-pds">"</span></span></pre>
  </div> 
  <p>To play around with the library, type <code>sbt console</code>.</p> 
  <p>##Usage</p> 
  <p>Neold can interact with the <a href="http://neo4j.com/docs/stable/rest-api.html" target="_blank">Transactional endpoint</a> or the <a href="http://neo4j.com/docs/stable/rest-api-batch-ops.html" target="_blank">Batch endpoint</a>.</p> 
  <p>*All the sample code below require the following import line :* <code>import org.neold.core.Neold, org.neold.core.Neold._</code></p> 
  <p><em>If you want to copy/paste these code snippets somewhere, don't forget that they are <b>asynchronous</b>.</em></p> 
  <p>*If you want to use the library <b>synchronously</b> :*</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">scala.concurrent.duration.</span><span class="pl-v">Duration</span>
<span class="pl-k">import</span> <span class="pl-v">scala.concurrent.</span>{<span class="pl-v">Await</span>, <span class="pl-v">Future</span>}
<span class="pl-k">import</span> <span class="pl-v">java.util.concurrent.</span><span class="pl-v">TimeUnit</span>

<span class="pl-k">val</span> <span class="pl-en">future</span> <span class="pl-k">=</span> neo.executeImmediate(query, params)
<span class="pl-k">val</span> <span class="pl-en">result</span> <span class="pl-k">=</span> <span class="pl-en">Await</span>.result(future, <span class="pl-en">Duration</span>.create(<span class="pl-c1">5</span>, <span class="pl-en">TimeUnit</span>.<span class="pl-en">SECONDS</span>))</pre>
  </div> 
  <h4><a id="user-content-neold-setup" class="anchor" href="https://github.com/elbywan/neold#neold-setup" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Neold setup</h4> 
  <p>#####Server location</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span>Setups Neold with the default endpoint : http://localhost:7474/db/data</span>
<span class="pl-en">Neold</span>(<span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-c1">7474</span>, <span class="pl-s"><span class="pl-pds">"</span>db/data<span class="pl-pds">"</span></span>)
<span class="pl-en">Neold</span>(<span class="pl-s"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-c1">7474</span>)
<span class="pl-en">Neold</span>()
<span class="pl-c"><span class="pl-c">//</span>Those 3 lines are equivalent</span></pre>
  </div> 
  <p>#####Authentication</p> 
  <p>Provide your <a href="http://neo4j.com/docs/stable/rest-api-security.html#rest-api-authenticate-to-access-the-server" target="_blank">user and password</a> in the <code>username</code> and <code>password</code> parameters. The <code>secure</code> flag (default to false) controls whether the request is sent over https.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-en">Neold</span>(username <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Joe<span class="pl-pds">"</span></span>, password <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Dalton<span class="pl-pds">"</span></span>, secure <span class="pl-k">=</span> <span class="pl-c1">true</span>)</pre>
  </div> 
  <h4><a id="user-content-on-shutdown" class="anchor" href="https://github.com/elbywan/neold#on-shutdown" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>On shutdown</h4> 
  <p>Call <code>Neold.shutdown()</code> to shut down the underlying thread pool.</p> 
  <h3><a id="user-content-transactional-endpoint" class="anchor" href="https://github.com/elbywan/neold#transactional-endpoint" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Transactional endpoint</h3> 
  <p>The transactional endpoint is the default way to interact with Neo4j.</p> 
  <p>####Executing statements and commiting in a single step</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">neo</span> <span class="pl-k">=</span> <span class="pl-en">Neold</span>()

<span class="pl-c"><span class="pl-c">//</span>Single statement</span>
<span class="pl-k">val</span> <span class="pl-en">query</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"""</span>CREATE (n:Node {prop: {PROPERTY}}) RETURN n<span class="pl-pds">"""</span></span>
neo.executeImmediate1(query, <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>PROPERTY<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>myProperty<span class="pl-pds">"</span></span>)){
    <span class="pl-c"><span class="pl-c">//</span>On success</span>
    <span class="pl-v">result</span>: <span class="pl-k">String</span> <span class="pl-k">=&gt;</span> println(result)
}

<span class="pl-c"><span class="pl-c">//</span>Multiple statements</span>
<span class="pl-k">val</span> <span class="pl-en">countQuery</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"""</span>MATCH n RETURN n<span class="pl-pds">"""</span></span>
<span class="pl-k">val</span> <span class="pl-en">insertQuery</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"""</span>CREATE (n:Node {PROPERTIES}) RETURN n<span class="pl-pds">"""</span></span>
<span class="pl-k">val</span> <span class="pl-en">params</span> <span class="pl-k">=</span> <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>PROPERTIES<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"""</span>{ "prop1": "firstProperty", "prop2": "secondProperty" }<span class="pl-pds">"""</span></span>)
<span class="pl-k">val</span> <span class="pl-en">statements</span> <span class="pl-k">=</span> (insertQuery <span class="pl-k">-</span><span class="pl-k">&gt;</span> params) <span class="pl-k">::</span> (countQuery <span class="pl-k">-</span><span class="pl-k">&gt;</span> params) <span class="pl-k">::</span> <span class="pl-en">List</span>()
neo.executeImmediate(<span class="pl-v">statements</span> : _<span class="pl-k">*</span>){
    <span class="pl-c"><span class="pl-c">//</span>On success</span>
    <span class="pl-v">result</span>: <span class="pl-k">String</span> <span class="pl-k">=&gt;</span> println(result)
}</pre>
  </div> 
  <p>####Transactions</p> 
  <p><em>Note: The examples below post one query at a time. It is possible to post multiple queries in a single call.</em></p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">neo</span> <span class="pl-k">=</span> <span class="pl-en">Neold</span>()
<span class="pl-k">val</span> <span class="pl-en">countQuery</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"""</span>MATCH (n:Node {prop: {PROPERTY}}) RETURN n<span class="pl-pds">"""</span></span>
<span class="pl-k">val</span> <span class="pl-en">insertQuery</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"""</span>CREATE (n:Node {prop: {PROPERTY}}) RETURN n<span class="pl-pds">"""</span></span>
<span class="pl-k">val</span> <span class="pl-en">parameters</span> <span class="pl-k">=</span> <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>PROPERTY<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>MyProperty<span class="pl-pds">"</span></span>)</pre>
  </div> 
  <h5><a id="user-content-opening-a-transaction" class="anchor" href="https://github.com/elbywan/neold#opening-a-transaction" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Opening a transaction</h5> 
  <div class="highlight highlight-source-scala">
   <pre>neo.initTransaction(countQuery, parameters){ transaction <span class="pl-k">=&gt;</span> <span class="pl-v">result</span> : <span class="pl-k">String</span> <span class="pl-k">=&gt;</span>
    <span class="pl-c"><span class="pl-c">//</span>Transaction scope</span>
    println(result)
}</pre>
  </div> 
  <h5><a id="user-content-posting-a-statement-to-an-open-transaction" class="anchor" href="https://github.com/elbywan/neold#posting-a-statement-to-an-open-transaction" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Posting a statement to an open transaction</h5> 
  <div class="highlight highlight-source-scala">
   <pre>neo.initTransaction(countQuery, parameters){ transaction <span class="pl-k">=&gt;</span> <span class="pl-v">result</span> : <span class="pl-k">String</span> <span class="pl-k">=&gt;</span>
    transaction.post1(insertQuery, parameters){ <span class="pl-v">result</span> : <span class="pl-k">String</span> <span class="pl-k">=&gt;</span>
        <span class="pl-c"><span class="pl-c">//</span>Print the json result</span>
        println(result)
    }
}</pre>
  </div> 
  <h5><a id="user-content-commit-a-transaction" class="anchor" href="https://github.com/elbywan/neold#commit-a-transaction" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Commit a transaction</h5> 
  <div class="highlight highlight-source-scala">
   <pre>neo.initTransaction(countQuery, parameters){ transaction <span class="pl-k">=&gt;</span> <span class="pl-v">result</span> : <span class="pl-k">String</span> <span class="pl-k">=&gt;</span>
    transaction.post1(insertQuery, parameters){ <span class="pl-v">result</span> : <span class="pl-k">String</span> <span class="pl-k">=&gt;</span>
        <span class="pl-c"><span class="pl-c">//</span>When done, commit</span>
        transaction.commit()
    }
}</pre>
  </div> 
  <h5><a id="user-content-rollback-a-transaction" class="anchor" href="https://github.com/elbywan/neold#rollback-a-transaction" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Rollback a transaction</h5> 
  <div class="highlight highlight-source-scala">
   <pre>neo.initTransaction(countQuery, parameters){ transaction <span class="pl-k">=&gt;</span> <span class="pl-v">result</span> : <span class="pl-k">String</span> <span class="pl-k">=&gt;</span>
    transaction.post1(insertQuery, parameters){ <span class="pl-v">result</span> : <span class="pl-k">String</span> <span class="pl-k">=&gt;</span>
        <span class="pl-c"><span class="pl-c">//</span>When done, rollback</span>
        transaction.rollback()
    }
}</pre>
  </div> 
  <h3><a id="user-content-batch" class="anchor" href="https://github.com/elbywan/neold#batch" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Batch</h3> 
  <p>The batch endpoint is designed for maximum performance. Statements are buffered locally, before being sent to the endpoint for processing.</p> 
  <h4><a id="user-content-adding-statements-to-the-buffer" class="anchor" href="https://github.com/elbywan/neold#adding-statements-to-the-buffer" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Adding statements to the buffer</h4> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">neo</span> <span class="pl-k">=</span> <span class="pl-en">Neold</span>()
<span class="pl-k">val</span> <span class="pl-en">countQuery</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"""</span>MATCH (n:Node {prop: {PROPERTY}}) RETURN n<span class="pl-pds">"""</span></span>
<span class="pl-k">val</span> <span class="pl-en">insertQuery</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"""</span>CREATE (n:Node {prop: {PROPERTY}}) RETURN n<span class="pl-pds">"""</span></span>
<span class="pl-k">val</span> <span class="pl-en">parameters</span> <span class="pl-k">=</span> <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>PROPERTY<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>MyProperty<span class="pl-pds">"</span></span>)

neo.bufferQuery(countQuery, parameters)
neo.bufferQuery(insertQuery, parameters)
neo.bufferQuery(countQuery, parameters)</pre>
  </div> 
  <h4><a id="user-content-executing-the-batch-queue" class="anchor" href="https://github.com/elbywan/neold#executing-the-batch-queue" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Executing the batch queue</h4> 
  <div class="highlight highlight-source-scala">
   <pre>neo.performBatch(){ <span class="pl-v">result</span>: <span class="pl-k">String</span> <span class="pl-k">=&gt;</span>
    println(result)
}</pre>
  </div> 
  <h3><a id="user-content-force--disable-parameter-escaping" class="anchor" href="https://github.com/elbywan/neold#force--disable-parameter-escaping" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Force / disable parameter escaping</h3> 
  <p>When you build a parameter Map, Neold automatically escapes certain characters to comply with the Json format, and adds double quotes around the parameter. Furthermore, when a parameter begins with <code>{</code> or <code>[</code>, it is considered an object or an array, and the quotes are omitted.</p> 
  <p>You can completely disable (or force) the escaping and the quotes by using the following methods :</p> 
  <div class="highlight highlight-source-scala">
   <pre>neo.executeImmediate(
    <span class="pl-c"><span class="pl-c">//</span>Property forcefully escaped using the method :?, even if its first character is a {.</span>
    <span class="pl-s"><span class="pl-pds">"</span>CREATE (n:Node {prop: {escaped}})<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>escaped<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-k">:?</span>(<span class="pl-s"><span class="pl-pds">"</span>{{//<span class="pl-cce">\\</span>escaped//<span class="pl-cce">\\</span>}}<span class="pl-pds">"</span></span>)), 
    <span class="pl-c"><span class="pl-c">//</span>Property not escaped using the method :!, and is passed as an integer instead of a string.</span>
    <span class="pl-s"><span class="pl-pds">"</span>CREATE (n:Node {prop: {notescaped}})<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>notescaped<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-k">:</span><span class="pl-k">!</span>(<span class="pl-s"><span class="pl-pds">"</span>10<span class="pl-pds">"</span></span>)), 
    <span class="pl-s"><span class="pl-pds">"</span>MATCH (n:Node) RETURN n<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">Map</span>(),
    <span class="pl-s"><span class="pl-pds">"</span>MATCH (n:Node) DELETE n<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">Map</span>()
){
    <span class="pl-v">result</span> : <span class="pl-k">String</span> <span class="pl-k">=&gt;</span> println(result) 
    <span class="pl-c"><span class="pl-c">//</span>///</span>
    <span class="pl-c"><span class="pl-c">//</span>/ Json response :</span>
    <span class="pl-c"><span class="pl-c">//</span> {"results":[{"columns":[],"data":[]},{"columns":[],"data":[]},{"columns":["n"],"data":[{"row":[{"prop":"{{//\\escaped//\\}}"}]},{"row":[{"prop":10}]}]},{"columns":[],"data":[]}],"errors":[]}</span>
    <span class="pl-c"><span class="pl-c">//</span>/ Properties :</span>
    <span class="pl-c"><span class="pl-c">//</span> "prop":"{{//\\escaped//\\}}"</span>
    <span class="pl-c"><span class="pl-c">//</span> "prop":10</span>
    <span class="pl-c"><span class="pl-c">//</span>/</span>
}</pre>
  </div> 
  <h3><a id="user-content-result-handling" class="anchor" href="https://github.com/elbywan/neold#result-handling" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Result handling</h3> 
  <p>Every Neo4j result is returned as a raw Json string by default to provide optimal performance. You can either use the Json library of you choice to exploit the data, or use the included adapters and helper methods.</p> 
  <p>Adapters take a Json string as a parameter, and return an Option or an Either object.</p> 
  <h4><a id="user-content-transactional-adapter" class="anchor" href="https://github.com/elbywan/neold#transactional-adapter" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Transactional Adapter</h4> 
  <p>Below a small sample of code which should explain how Adapters work :</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">org.neold.adapters.Adapters.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">org.neold.adapters.Adapters.TransactionalAdapter.</span><span class="pl-v">_</span>

<span class="pl-k">val</span> <span class="pl-en">neo</span> <span class="pl-k">=</span> <span class="pl-en">Neold</span>()
<span class="pl-k">val</span> <span class="pl-en">query</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"""</span>CREATE (n:Node {prop: {PROPERTY}}) RETURN n.prop as prop<span class="pl-pds">"""</span></span>
neo.executeImmediate1(query, <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>PROPERTY<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>myProperty<span class="pl-pds">"</span></span>)){ <span class="pl-v">result</span> : <span class="pl-k">String</span> <span class="pl-k">=&gt;</span>
    <span class="pl-c"><span class="pl-c">//</span>Maps the results to an Option value containing two nested arrays and a map</span>
    <span class="pl-c"><span class="pl-c">//</span>First array : result index</span>
    <span class="pl-c"><span class="pl-c">//</span>Second array : row index</span>
    <span class="pl-c"><span class="pl-c">//</span>Map : column name -&gt; value</span>
    <span class="pl-c"><span class="pl-c">//</span>If there are errors, None</span>
    <span class="pl-k">val</span> <span class="pl-en">resultsOpt</span> <span class="pl-k">=</span> toOption(result)

    <span class="pl-c"><span class="pl-c">//</span>Helper method, by default maps the value at position (result 0 / row 0)</span>
    <span class="pl-c"><span class="pl-c">//</span>Equivalent to resultsOpt.map{ _(0)(0)("prop")}</span>
    println(mapResultRow(resultsOpt){ _(<span class="pl-s"><span class="pl-pds">"</span>prop<span class="pl-pds">"</span></span>)}.getOrElse(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>))

    <span class="pl-c"><span class="pl-c">//</span>Maps the results to a Left value containing the same two arrays / map as above</span>
    <span class="pl-c"><span class="pl-c">//</span>If there are errors, then a Right value is assigned, containing Errors as an Array[(code, message)]</span>
    <span class="pl-k">val</span> <span class="pl-en">resultsEither</span> <span class="pl-k">=</span> toEither(result)
    resultsEither.fold(
        _.foreach{error <span class="pl-k">=&gt;</span> println(error)},
        results <span class="pl-k">=&gt;</span> println(results(<span class="pl-c1">0</span>)(<span class="pl-c1">0</span>)(<span class="pl-s"><span class="pl-pds">"</span>prop<span class="pl-pds">"</span></span>))
    )
}</pre>
  </div> 
  <h4><a id="user-content-batch-adapter" class="anchor" href="https://github.com/elbywan/neold#batch-adapter" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Batch Adapter</h4> 
  <p>Same as above :</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">import</span> <span class="pl-v">org.neold.adapters.Adapters.</span><span class="pl-v">_</span>
<span class="pl-k">import</span> <span class="pl-v">org.neold.adapters.Adapters.BatchAdapter.</span><span class="pl-v">_</span>

<span class="pl-k">val</span> <span class="pl-en">neo</span> <span class="pl-k">=</span> <span class="pl-en">Neold</span>()
<span class="pl-k">val</span> <span class="pl-en">query</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"""</span>CREATE (n:Node {prop: {PROPERTY}}) RETURN n.prop as prop<span class="pl-pds">"""</span></span>

neo.bufferQuery(query, <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>PROPERTY<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>myProperty<span class="pl-pds">"</span></span>))
neo.performBatch(){ <span class="pl-v">result</span> : <span class="pl-k">String</span> <span class="pl-k">=&gt;</span>
    <span class="pl-k">val</span> <span class="pl-en">resultsOpt</span> <span class="pl-k">=</span> toOption(result)
    println(mapResultRow(resultsOpt){ _(<span class="pl-s"><span class="pl-pds">"</span>prop<span class="pl-pds">"</span></span>)}.getOrElse(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>))

    <span class="pl-k">val</span> <span class="pl-en">resultsEither</span> <span class="pl-k">=</span> toEither(result)
    resultsEither.fold(
            _.foreach{error <span class="pl-k">=&gt;</span> println(error)},
            results <span class="pl-k">=&gt;</span> println(results(<span class="pl-c1">0</span>)(<span class="pl-c1">0</span>)(<span class="pl-s"><span class="pl-pds">"</span>prop<span class="pl-pds">"</span></span>))
        )
}</pre>
  </div> 
  <h3><a id="user-content-error-handling" class="anchor" href="https://github.com/elbywan/neold#error-handling" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Error handling</h3> 
  <p>As all functions return Future objects, the methods <code>onSuccess</code> and <code>onFailure</code> can be used to check whether the call was successful or not.</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-c"><span class="pl-c">//</span>Incorrect Neo4j coordinates</span>
<span class="pl-k">val</span> <span class="pl-en">neo</span> <span class="pl-k">=</span> <span class="pl-en">Neold</span>(<span class="pl-s"><span class="pl-pds">"</span>badUrl!<span class="pl-pds">"</span></span>)
<span class="pl-k">val</span> <span class="pl-en">query</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Not important<span class="pl-pds">"</span></span>
neo.executeImmediate1(query).onFailure{
    <span class="pl-k">case</span> <span class="pl-v">f</span> : <span class="pl-en">Exception</span> <span class="pl-k">=&gt;</span> <span class="pl-k">throw</span> f
}</pre>
  </div> 
  <h3><a id="user-content-concurrency-handling" class="anchor" href="https://github.com/elbywan/neold#concurrency-handling" aria-hidden="true" target="_blank">
    <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewbox="0 0 16 16" width="16">
     <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
    </svg></a>Concurrency handling</h3> 
  <p>To synchronize your calls, for instance inside a transaction you can use the Scala comprehensions.</p> 
  <p>If you are not familiar with these concepts the Dispatch homepage contains an excellent <a href="http://dispatch.databinder.net/Working+with+multiple+futures.html" target="_blank">guide</a>.</p> 
  <p>Below an example of a synchronized transaction :</p> 
  <div class="highlight highlight-source-scala">
   <pre><span class="pl-k">val</span> <span class="pl-en">neo</span> <span class="pl-k">=</span> <span class="pl-en">Neold</span>()
<span class="pl-k">val</span> <span class="pl-en">countQuery</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>MATCH (n: UserNode) RETURN count(n) as total<span class="pl-pds">"</span></span>
<span class="pl-k">val</span> <span class="pl-en">createQuery</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>CREATE (n:UserNode {name: {name}}) RETURN n<span class="pl-pds">"</span></span>
<span class="pl-k">val</span> <span class="pl-en">deleteQuery</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>MATCH (n:UserNode) DELETE n<span class="pl-pds">"</span></span>
neo.initTransaction(countQuery){
    transaction <span class="pl-k">=&gt;</span> <span class="pl-v">countBefore</span> : <span class="pl-k">String</span> <span class="pl-k">=&gt;</span>
        println(countBefore)
        <span class="pl-c"><span class="pl-c">//</span>Synced</span>
        <span class="pl-k">for</span>{
            create1 <span class="pl-k">&lt;</span><span class="pl-k">-</span> transaction.post1(createQuery, <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>Toto<span class="pl-pds">"</span></span>))
            countPlusOne <span class="pl-k">&lt;</span><span class="pl-k">-</span> transaction.post1(countQuery)
            create2 <span class="pl-k">&lt;</span><span class="pl-k">-</span> transaction.post1(createQuery, <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>Titi<span class="pl-pds">"</span></span>))
            countPlusTwo <span class="pl-k">&lt;</span><span class="pl-k">-</span> transaction.post1(countQuery)
            deletion <span class="pl-k">&lt;</span><span class="pl-k">-</span> transaction.post1(<span class="pl-s"><span class="pl-pds">"</span>MATCH (n:UserNode) DELETE n<span class="pl-pds">"</span></span>)
            countZero <span class="pl-k">&lt;</span><span class="pl-k">-</span> transaction.post1(countQuery)
            rollBack <span class="pl-k">&lt;</span><span class="pl-k">-</span> transaction.rollback()
        } <span class="pl-k">yield</span>{
            println(create1)
            println(countPlusOne)
            println(create2)
            println(countPlusTwo)
            println(deletion)
            println(countZero)
            println(rollBack)
        }
}</pre>
  </div> 
  <p>##Dependencies</p> 
  <p>The following libraries are used :</p> 
  <ul> 
   <li><a href="https://github.com/dispatch/reboot" target="_blank">Dispatch</a> : asynchronous HTTP interaction library.</li> 
   <li><a href="https://www.playframework.com/documentation/2.4.0-M2/ScalaJson" target="_blank">play-json</a> : Json parsing library.</li> 
  </ul> 
  <p>##TODO</p> 
  <ul> 
   <li>Full REST API support</li> 
   <li>Constraints</li> 
   <li>Better concurrency</li> 
  </ul> 
 </article>
</div>